/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2009 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>


//-------------------------------------------------------------------------
// Data declarations

// extern void *adjust_fdiv; weak
extern _UNKNOWN unk_100160E8; // weak
extern _UNKNOWN unk_100160F0; // weak
extern _UNKNOWN unk_100160F8; // weak
extern char Str2[]; // idb
extern char aWindows20005_0[17]; // weak
extern char aWindows2000219[18]; // weak
extern char aIpc[5]; // weak
extern char aLanman[7]; // weak
extern char aLanman_0[7]; // weak
extern char aPipe[7]; // weak
extern char aSmbclient[11]; // weak
extern char aSmbserver[11]; // weak
extern char asc_100162A8[]; // idb
extern char Source[]; // idb
extern int dword_100162B0; // weak
extern __int16 word_100162B4; // weak
extern int dword_100162B8; // weak
extern int dword_100162BC; // weak
extern char aSessionKeyTo_1[59]; // weak
extern char aSessionKeyTo_0[59]; // weak
extern char aSessionKeyToSe[59]; // weak
extern char aSessionKeyToCl[59]; // weak
extern int dword_100163B0[]; // weak
extern struct _EXCEPTION_POINTERS ExceptionInfo; // idb
extern wchar_t aWinsta_exe[11]; // weak
extern wchar_t aWbemMofSysnull[25]; // weak
extern char Src[]; // idb
extern _UNKNOWN unk_10016892; // weak
extern char aGuest[6]; // weak
extern char aSpoolss[8]; // weak
extern wchar_t aDefault[8]; // weak
extern wchar_t aRaw[4]; // weak
extern wchar_t asc_100168BC[3]; // weak
extern int dword_100168C4; // weak
extern int dword_100168C8; // weak
extern int dword_100168CC; // weak
extern char Format[]; // idb
extern char aXXX02x02x02x02[]; // idb
extern char a08x04x04x02x_0[]; // idb
extern char a08x04x04x02x_1[]; // idb
extern _UNKNOWN unk_10016A10; // weak
extern _UNKNOWN unk_10016AE0; // weak
extern int dword_10017000; // weak
extern char *off_10017060[18]; // weak
extern int dword_100170AC; // weak
extern int dword_100170B0; // weak
extern int dword_100170B4; // weak
extern int dword_100170B8; // weak
extern int dword_100170BC; // weak
extern int dword_100170C0; // weak
extern int dword_100170C4; // weak
extern int dword_100170C8; // weak
extern int dword_100170CC; // weak
extern int dword_100170E0; // weak
extern int dword_100170E4; // weak
extern int dword_100170E8; // weak
extern int dword_100170EC; // weak
extern int dword_100170F0; // weak
extern int dword_100170F8; // weak
extern int dword_100170FC; // weak
extern int dword_10017100; // weak
extern int dword_10017104; // weak
extern int dword_10017108; // weak
extern int dword_1001710C; // weak
extern int dword_10017110; // weak
extern int dword_10017114; // weak
extern int dword_10017118; // weak
extern int dword_1001711C; // weak
extern int dword_10017120; // weak
extern int dword_10017124; // weak
extern int dword_10017128; // weak
extern int dword_1001712C; // weak
extern int dword_10017130; // weak
extern int dword_10017134; // weak
extern int dword_10017138; // weak
extern int dword_1001713C; // weak
extern int dword_10017140; // weak
extern int dword_10017144; // weak
extern char byte_10017148[]; // weak
extern char byte_10017149[]; // weak
extern char byte_1001714A[]; // weak
extern char byte_1001714B[]; // weak
extern char byte_10017180[]; // weak
extern char byte_10017181[]; // weak
extern char byte_10017182[]; // weak
extern char byte_10017183[]; // weak
extern char byte_10017184[]; // weak
extern char byte_10017185[]; // weak
extern char byte_100171B0[]; // weak
extern char byte_100171B1[]; // weak
extern char byte_100171B2[]; // weak
extern char byte_100171B3[]; // weak
extern char byte_100171F0[]; // weak
extern char byte_100171F1[]; // weak
extern char byte_100171F2[]; // weak
extern char byte_100171F3[]; // weak
extern char byte_100171F4[]; // weak
extern char byte_100171F5[]; // weak
extern char byte_10017220[]; // weak
extern char byte_10017221[]; // weak
extern char byte_10017222[]; // weak
extern char byte_10017223[]; // weak
extern _UNKNOWN unk_10017240; // weak
extern _UNKNOWN unk_10017241; // weak
extern _UNKNOWN unk_10017242; // weak
extern _BYTE byte_10017243[61]; // idb
extern char byte_10017280[]; // weak
extern char byte_10017290[]; // weak
extern int dword_10017490; // weak
extern int dword_10017494; // weak
extern _DWORD dword_100174A0[4]; // idb
extern int dword_100174B0; // weak
extern _UNKNOWN unk_100177A8; // weak
extern int dword_100181E8; // weak
extern int dword_100181EC; // weak
extern int dword_100181F0; // weak
extern int dword_100181F4; // weak
extern int dword_100181F8; // weak
extern int dword_100181FC; // weak
extern int dword_10018210; // weak
extern int dword_10018218; // weak
extern int dword_1001821C; // weak
extern int dword_10018224; // weak
extern int dword_10018268; // weak
extern __int16 word_100182F4; // weak
extern __int16 word_100182F8; // weak
extern __int16 word_100182FC; // weak
extern __int16 word_10018300; // weak
extern int dword_10018304; // weak
extern int dword_10018308; // weak
extern int dword_1001830C; // weak
extern int dword_10018310; // weak
extern int dword_10018314; // weak
extern int dword_10018318; // weak
extern int dword_1001831C; // weak
extern int dword_10018320; // weak
extern __int16 word_10018324; // weak
extern int dword_10018328; // weak
extern int dword_1001832C; // weak
extern __int16 word_10018330; // weak
extern int dword_10018534; // weak
extern int dword_10018538; // weak
extern volatile LONG Destination; // idb
extern int dword_10018540; // weak
extern void *Memory; // idb
extern int (__cdecl *dword_10018548)(_DWORD, _DWORD, _DWORD); // weak
extern int (__thiscall *dword_1001854C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__cdecl *dword_10018550)(_DWORD, _DWORD); // weak

//-------------------------------------------------------------------------
// Function declarations

#define __thiscall __cdecl // Test compile in C mode

int __cdecl svchost_1(struct in_addr in, int, int); // idb
// bool __usercall sub_10001190<eax>(struct in_addr a1<esi>);
// signed int __usercall sub_10001230<eax>(int a1<edi>, struct in_addr in, u_short a3);
// signed int __usercall sub_100012E0<eax>(const char *a1<eax>, int a2<esi>, int a3, u_short a4);
// signed int __usercall sub_10001440<eax>(int a1<eax>, int a2, int a3);
int __cdecl sub_10001730(int, size_t Size, int); // idb
// void *__usercall sub_10001B70<eax>(int a1<eax>, int a2);
int __cdecl sub_10001E30(int, size_t Size, int); // idb
// int __usercall sub_100021A0<eax>(int a1<esi>);
// int __usercall sub_10002350<eax>(int a1<eax>, char *Dest);
// int __usercall sub_10002399<eax>(const void *a1<eax>, int a2, int a3, int a4, int a5);
signed int __cdecl sub_100023F0(int a1, int a2, int a3);
signed int __cdecl sub_10002470(int a1, int a2, const void *a3, unsigned int a4);
signed int __cdecl sub_10002560(int a1, void *a2, int a3, int a4, unsigned int a5);
signed int __cdecl sub_100025E0(int a1, int a2, const void *a3, unsigned int a4);
signed int __cdecl sub_10002660(int a1, int a2, void *a3, int *a4, unsigned int a5);
signed int __cdecl sub_100026B0(int a1, int a2, void *a3, int a4, unsigned int a5);
signed int __cdecl sub_10002730(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10002A60(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10002D20(int a1, int a2, int a3);
signed int __cdecl sub_10002EF0(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10003040(int a1, int a2, int a3);
bool __cdecl sub_10003100(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10003190(int a1, int a2, int a3);
signed int __cdecl sub_100032B0(int a1, int a2, int a3, int a4);
signed int __cdecl sub_100033A0(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10003490(int a1, int a2, int a3, unsigned int a4, int a5);
bool __cdecl sub_100034E0(int a1, int a2, const void *a3);
void *__cdecl sub_10003520(int a1, int a2);
signed int __cdecl sub_10003590(int a1);
signed int __cdecl sub_100035E0(int a1, int a2, signed int a3);
signed int __cdecl sub_10003620(int a1, int a2, int a3);
signed int __cdecl sub_100036C0(int a1, int a2, __int16 a3);
signed int __cdecl sub_10003750(int a1, int a2, char a3);
signed int __cdecl sub_100037B0(int a1, int a2, int a3);
signed int __cdecl sub_10003930(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10003970(int a1, int a2, int a3, signed int a4, int a5);
signed int __cdecl sub_10003A60(int a1, int a2, int a3, signed int a4);
signed int __cdecl sub_10003AF0(int a1, int a2, const void *a3, int a4, unsigned int a5);
bool __cdecl sub_10003B90(int a1, int a2, int a3, int *a4);
bool __cdecl sub_10003CE0(int a1, int a2, int a3);
bool __cdecl sub_10003DF0(int a1, int a2, int a3);
signed int __cdecl sub_10003E90(int a1, int a2, int a3, int a4);
bool __cdecl sub_10003F60(int a1, int a2, int a3);
bool __cdecl sub_10003FE0(int a1, int a2, int a3, int *a4);
bool __cdecl sub_10004080(int a1, int a2, int a3);
bool __cdecl sub_10004130(int a1, int a2, int a3);
signed int __cdecl sub_100041A0(int a1, int a2, int a3, int *a4);
bool __cdecl sub_10004370(int a1, int a2, int a3, int *a4);
bool __cdecl sub_10004440(int a1, int a2, int a3, int *a4);
bool __cdecl sub_100044B0(int a1, int a2, int a3, int *a4);
int __cdecl sub_10004550(int a1, int a2);
int __cdecl sub_10004790(int a1, int a2, int a3);
signed int __cdecl sub_100047D0(int a1, int a2, signed int a3, int a4);
signed int __cdecl sub_10004980(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10004B40(int a1, int a2, int a3);
signed int __cdecl sub_10004C40(int a1, int a2, int a3);
signed int __cdecl sub_10004D40(int a1, int a2, int a3, int a4, int a5, int a6, int a7);
signed int __cdecl sub_100051B0(int a1, int a2, int a3);
signed int __cdecl sub_100053A0(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10005710(int a1, int a2, int a3);
signed int __cdecl sub_10005A00(int a1, int a2, int a3);
signed int __cdecl sub_10005F20(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10005F60(int a1, int a2, int a3);
signed int __cdecl sub_10006050(int a1, int a2);
bool __cdecl sub_10006070();
bool __cdecl sub_100060B0();
int __cdecl sub_100060C0(SOCKET s); // idb
int __cdecl sub_100060E0(int a1, int a2);
int __cdecl sub_10006130(SOCKET s, int); // idb
int __cdecl sub_10006170(SOCKET s, int a2, const struct sockaddr *to);
int __cdecl sub_100061C0(SOCKET s, int, struct timeval timeout); // idb
unsigned int __cdecl sub_10006280(SOCKET s, int a2, struct sockaddr *from, struct timeval timeout);
int __cdecl sub_10006350(int, int, u_short hostshort, __int16, int); // idb
signed int __cdecl sub_100063D0(int a1, const void *a2, const void *a3, char a4);
signed int __cdecl sub_10006500(int a1, const void *a2, const void *a3, char a4);
int __cdecl sub_10006600(int a1);
void __cdecl sub_100066F0(int a1);
int __cdecl sub_10006720(int a1);
int __cdecl sub_100068C0(int a1);
int __cdecl sub_10006920(int a1);
signed int __cdecl sub_10006DC0(int a1);
signed int __cdecl sub_10007110(int a1, int a2, int a3);
signed int __cdecl sub_100072C0(int a1, int a2, __int16 a3, char a4);
signed int __cdecl sub_10007500(int a1, int a2, int a3, int a4);
char __cdecl sub_10007710(unsigned __int8 a1, unsigned __int16 a2);
int __cdecl sub_10007750(int a1, int a2, char a3, int a4);
int __cdecl sub_100078E0(int, SOCKET s, int, struct timeval timeout); // idb
int __cdecl sub_10007A30(int a1, int a2, int a3, char a4);
signed int __cdecl sub_10007B00(int a1, int a2, int a3, char a4);
signed int __cdecl sub_10007BA0(int a1, int a2, int a3, char a4);
signed int __cdecl sub_10007BF0(signed int a1, int a2, int a3, int a4);
signed int __cdecl sub_10007CB0(int a1, int a2);
signed int __cdecl sub_10007EC0(int a1, const void *a2, int a3);
signed int __cdecl sub_10007F30(int a1);
u_long __cdecl sub_10008000(int a1, int a2, unsigned int a3, signed int a4);
int __cdecl sub_10008150(int a1, int a2);
signed int __cdecl sub_100082E0(int a1, int a2, int a3, int a4);
void *__cdecl sub_10008320(size_t Size);
// void *__cdecl realloc(void *Memory, size_t NewSize);
signed int __cdecl sub_10008360(int a1);
signed int __cdecl sub_100083C0(int a1, int a2, int a3);
int __cdecl sub_10008430(int a1);
// signed int __usercall sub_10008450<eax>(int a1<edi>, int a2, int a3, int a4);
signed int __cdecl sub_100085A0(int a1, int a2, int a3);
unsigned int __cdecl sub_100086B0(const char *a1, int a2, char a3);
int __cdecl sub_10008730(int, char *Dest); // idb
char __cdecl sub_10008780(int a1, int a2);
char __cdecl sub_100087C0(int a1, void *a2, int a3);
int __cdecl sub_10008800(int a1, int a2, int a3, int a4);
int __cdecl sub_10008840(int a1, int a2, int a3);
int __cdecl sub_10008880(int a1, int a2, int a3);
int __cdecl sub_100088B0(int a1, int a2);
int __cdecl sub_10008900(int a1, int a2);
int __cdecl sub_10008950(int a1);
signed int __cdecl sub_10008980(int a1, int a2, int a3, unsigned int a4);
signed int __cdecl sub_100089C0(int a1);
signed int __cdecl sub_100089F0(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10008A30(int a1, int a2, int a3, unsigned int a4, int a5);
bool __cdecl sub_10008A70(int a1, int a2, int a3);
bool __cdecl sub_10008BE0(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_10008CD0(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10008F00(int a1, int a2, int a3, int a4, int a5, int a6);
_BYTE __cdecl nullsub_1(_DWORD arg0, _DWORD _8);
bool __cdecl sub_10008FD0(int a1, int a2, int a3);
signed int __cdecl sub_10009100(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_100092B0(int a1, int a2, int a3);
signed int __cdecl sub_10009440(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10009510(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_100099F0(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_10009BD0(int a1, int a2, int a3, int a4, int a5, int a6);
bool __cdecl sub_10009D10(int a1, int a2, int a3);
int __cdecl sub_10009DB0(int a1, int a2, int a3, int a4, int a5, int a6);
int __cdecl sub_10009E20(int a1);
bool __cdecl sub_10009E90(int a1, int a2, int a3);
bool __cdecl sub_10009FE0(int a1, int a2, int a3);
bool __cdecl sub_1000A0C0(int a1, int a2, int a3, int a4);
bool __cdecl sub_1000A2B0(int a1, int a2, int a3, int *a4);
int __cdecl sub_1000A2E0(int a1, int a2, char a3);
signed int __cdecl sub_1000A440(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_1000A700(int a1, int a2, int a3);
signed int __cdecl sub_1000A860(int a1, int a2, int a3, int a4, int a5);
unsigned int __cdecl sub_1000A930(int a1, int a2, unsigned int a3, int a4, int a5);
unsigned int __thiscall sub_1000A9A0(int this, const void *a2, size_t Size, void *a4, int a5, int a6, void *Memory, int a8, int a9, int a10, int a11, int a12, __int16 a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, unsigned __int8 a32, struct sockaddr to, struct sockaddr to, struct sockaddr to, struct sockaddr to, char a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, unsigned int a57);
signed int __cdecl sub_1000AF90(int a1, int a2, int a3);
void __cdecl sub_1000B450(int *a1);
int __cdecl sub_1000B490(const void *a1, unsigned int a2, int a3);
signed __int64 __cdecl sub_1000B510(const char *a1, int a2);
signed __int64 __cdecl sub_1000B5B0(int a1, int a2, int a3);
signed __int64 __cdecl sub_1000B610(int a1, int a2, int a3);
signed int __cdecl sub_1000B670(const char *a1, char a2, void *a3);
signed int __cdecl sub_1000B770(int a1, int a2, int a3);
signed int __cdecl sub_1000B7E0(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_1000B860(int a1, int a2, __int16 a3);
bool __cdecl sub_1000B940(int a1, int a2, int a3);
signed int __cdecl sub_1000BA80(int a1, int a2);
signed int __cdecl sub_1000BC10(int a1, int a2, int a3);
signed int __cdecl sub_1000BC40(int a1, int a2, int a3);
signed int __cdecl sub_1000C010(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_1000C1A0(int a1, int a2, int a3, int a4);
signed int __cdecl sub_1000C240(int a1, int a2, int a3);
signed int __cdecl sub_1000C6D0(int a1, int a2, int a3);
signed int __cdecl sub_1000CC40(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_1000CFC0(int a1, int a2, int a3, int *a4, int a5);
signed int __cdecl sub_1000D330(int a1, int a2, int a3, int *a4, int a5);
signed int __cdecl sub_1000D700(signed int a1, int a2, int a3, int a4);
signed int __cdecl sub_1000D7A0(signed int a1, int a2, int a3, int a4);
signed int __cdecl sub_1000D860(signed int a1, int a2, int a3, int a4, int a5);
bool __cdecl sub_1000D9F0(int a1, int a2, int a3);
bool __cdecl sub_1000DBB0(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_1000DEB0(int a1, int a2, int a3);
signed int __cdecl sub_1000E220(int a1, int a2, int a3, int a4);
signed int __cdecl sub_1000E2D0(int a1, int a2, int a3, int a4);
signed int __cdecl sub_1000E430(int a1, int a2, int a3, int *a4);
bool __cdecl sub_1000E6E0(int a1, int a2, int a3, int *a4);
signed int __cdecl sub_1000E750(int a1, int a2, int a3, int a4);
// signed int __usercall sub_1000EA50<eax>(int a1<ebp>, int a2, int a3, int a4, int a5, int a6);
signed int __cdecl sub_1000EDB0(int a1, int a2, int a3);
signed int __cdecl sub_1000EE80(int a1, int a2, int a3, int a4);
int __cdecl sub_1000EED0(int a1, int a2, int a3, int a4);
int __cdecl sub_1000F470(int a1, int a2);
signed int __cdecl sub_1000F6A0(int a1, int a2);
signed int __cdecl sub_1000F910(int a1, int a2, int a3, int a4);
bool __cdecl sub_1000FC80(int a1, int a2, int a3);
signed int __cdecl sub_1000FE30(int a1, int a2, int a3);
int __cdecl sub_10010340(int a1);
int __cdecl sub_10010360(int a1);
bool __cdecl sub_100103A0(int a1, int a2, int a3);
bool __cdecl sub_10010410(int a1, int a2, int a3, int *a4);
int __cdecl sub_100104A0(unsigned int a1, int a2);
int __cdecl sub_100108F0(int a1, void *a2, int a3);
signed int __cdecl sub_10010CF0(int a1, int a2, int a3, unsigned int a4);
int __cdecl sub_10010EA0(int a1, int a2, char a3);
signed int __cdecl sub_10010F60(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_10011040(int a1, int a2, int a3, unsigned int a4, int a5);
_BYTE __cdecl sub_10011220(int a1); // weak
bool __cdecl sub_10011280(int a1, int a2, int a3);
bool __cdecl sub_10011430(int a1, int a2, int a3);
int __cdecl sub_100115A0(int a1);
int __cdecl sub_100115C0(int a1);
_DWORD __cdecl sub_100115F0(_DWORD, _DWORD, _DWORD, _DWORD); // weak
_DWORD __cdecl sub_10011610(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
_DWORD __cdecl sub_10011620(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
int __cdecl sub_10011690(int a1);
signed int __cdecl sub_10011730(int a1, int a2, int a3);
int __cdecl sub_10011880();
bool __cdecl sub_10011890(int a1, int a2, int a3);
int __cdecl sub_100119A0(const void *a1, int a2, int a3);
int __cdecl sub_10011A60(int a1, int a2, int a3);
int __cdecl sub_10011AC0(const void *a1, const void *a2, const void *a3, const void *a4, unsigned int a5, int a6);
u_long __cdecl sub_10011BB0(int a1, int a2, int a3);
unsigned int __cdecl sub_10011C60(int a1, int a2, int a3, unsigned int a4);
signed int __cdecl sub_10011EE0(int a1, int a2, int a3);
signed int __cdecl sub_10011F40(int a1, int a2, int a3);
signed int __cdecl sub_100121E0(int a1, int a2, int a3);
signed int __cdecl sub_100122B0(int a1, int a2, int a3);
int __cdecl sub_10012350(int a1, int a2, int a3);
signed int __cdecl sub_10012380(int a1, int a2);
int __thiscall sub_10012400(void *this, int a2, int a3, int a4);
// int __usercall sub_10012970<eax>(int result<eax>, int a2<esi>);
// signed __int64 __usercall sub_10012A40<edx:eax>(int a1<eax>, int a2<ecx>, int a3, int a4);
signed __int64 __cdecl sub_10012BA0(int a1, int a2);
signed __int64 __cdecl sub_10012C00(int a1, int a2, int a3);
signed __int64 __cdecl sub_10012C50(int a1, int a2, int a3);
// int __usercall sub_10012C70<eax>(int a1<eax>, int a2<ecx>, int a3<ebx>, int a4<edi>, int a5);
// int __usercall sub_100136E0<eax>(int a1<eax>, int a2<ecx>);
int __cdecl sub_10013770(int a1, int a2, signed int a3);
u_long __cdecl sub_10013990(int a1);
int __cdecl sub_100139D0(int a1, int a2);
unsigned int __cdecl sub_100145B0(int a1, const void *a2, unsigned int a3);
u_long __cdecl sub_10014670(int a1, int a2);
int __cdecl sub_10014770(int a1, signed int a2, int a3);
int __cdecl sub_100148A0(int a1, int a2, int a3);
unsigned int __cdecl sub_10014930(int a1, const void *a2, unsigned int a3);
_DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD); // weak
u_long __cdecl sub_10014A20(int a1, int a2);
signed int __cdecl sub_10014A60(int a1, unsigned int a2);
signed int __cdecl sub_10014A80(int a1, int a2, unsigned int a3);
// BOOL __usercall sub_10014C70<eax>(char _CF<cf>, char _ZF<zf>, char _SF<sf>, char _OF<of>, int a5<eax>, int a6<edx>, int a7<ecx>, int a8<ebx>, int a9<edi>, int a10<esi>, char a11);
// int __usercall sub_10014C80<eax>(unsigned int a1<eax>, int a2<ecx>);
// int __usercall sub_10014CAC<eax>(int a1<ebp>, int a2, int a3, unsigned int a4);
int __cdecl loc_10014D3C(int, int, int, int); // weak
int __thiscall sub_10014D9E(void *this);
int __thiscall sub_10014DCE(void *this);
int loc_10014DE3(); // weak
int __fastcall sub_10014DE8(int a1, unsigned int a2, int a3, int a4);
int __cdecl sub_10014E00(int a1, void (__thiscall *a2)(_DWORD), int a3, int a4, int a5);
int __cdecl sub_10014F82(int a1, int a2);
int __cdecl sub_10014FA2(unsigned int a1, unsigned int a2);
signed int __cdecl sub_10014FC6();
signed int __stdcall sub_10014FE8(int a1, int a2, int a3);
// int __usercall sub_100151E4<eax>(int a1<ebp>);
// void __usercall sub_100151F8(int a1<ebp>);
int __stdcall loc_10015200(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_10015226<eax>(int a1<ebp>);
// void __usercall sub_1001523A(int a1<ebp>);
int __stdcall loc_10015242(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_10015269<eax>(int a1<ebp>);
// void __usercall sub_1001527D(int a1<ebp>);
int __stdcall loc_10015285(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_100152AE<eax>(int a1<ebp>);
void __cdecl sub_100152C2();
int __stdcall loc_100152C7(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_100152DD<eax>(int a1<ebp>);
void __cdecl sub_100152F1();
int __stdcall loc_100152F6(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_10015312<eax>(int a1<ebp>);
void __cdecl sub_10015326();
int __stdcall loc_1001532B(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_10015353<eax>(int a1<ebp>);
// void __usercall sub_10015367(int a1<ebp>);
int __stdcall loc_1001536F(int hinstDLL, int fdwReason, int lpReserved); // weak
// int __usercall sub_10015397<eax>(int a1<ebp>);
// void __usercall sub_100153AB(int a1<ebp>);
int __stdcall loc_100153B3(int hinstDLL, int fdwReason, int lpReserved); // weak
void __cdecl sub_100153CD();
BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved);
// int __usercall sub_100153F0<eax>(__int64 a1<edx:eax>, unsigned __int8 a2<cl>);
// BOOL __usercall sub_1001540F<eax>(char _CF<cf>, char _ZF<zf>, char _SF<sf>, char _OF<of>, int a5<eax>, int a6<edx>, int a7<ecx>, int a8<ebx>, int a9<edi>, int a10<esi>, char a11);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// void *__cdecl memcpy(void *Dst, const void *Src, size_t Size);
// int __userpurge sub_100155AD<eax>(int result<eax>, int a2<ebp>, int a3);
// int __usercall sub_100155CC<eax>(int (*a1)(void)<eax>);
bool __cdecl sub_100155D0(int a1);
int __cdecl sub_10015600(int a1, unsigned int a2);
unsigned int __cdecl sub_10015646(int a1);
// int __cdecl XcptFilter(_DWORD, _DWORD); weak
// int __cdecl initterm(_DWORD); weak
// int __cdecl amsg_exit(_DWORD); weak
signed int __stdcall sub_10015706(int a1, int a2, int a3);
// _DWORD __cdecl _SEH_prolog4(_DWORD, _DWORD); weak
// int __stdcall _SEH_epilog4(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); weak
int __cdecl sub_10015765(int a1, int a2, int a3);
DWORD __cdecl sub_1001578A();
// int __stdcall RtlUnwind(_DWORD, _DWORD, _DWORD, _DWORD); weak
int __cdecl svchost_1_SEH(int a2, int a3, int a4, int a5);
// HANDLE __stdcall GetProcessHeap();
// int __stdcall MultiByteToWideChar(UINT CodePage, DWORD dwFlags, LPCSTR lpMultiByteStr, int cbMultiByte, LPWSTR lpWideCharStr, int cchWideChar);
// void __stdcall Sleep(DWORD dwMilliseconds);
// BOOL __stdcall SystemTimeToFileTime(const SYSTEMTIME *lpSystemTime, LPFILETIME lpFileTime);
// void __stdcall GetSystemTime(LPSYSTEMTIME lpSystemTime);
// LONG __stdcall InterlockedExchange(volatile LONG *Target, LONG Value);
// LONG __stdcall InterlockedCompareExchange(volatile LONG *Destination, LONG Exchange, LONG Comperand);
// BOOL __stdcall TerminateProcess(HANDLE hProcess, UINT uExitCode);
// HANDLE __stdcall GetCurrentProcess();
// void __stdcall GetSystemTimeAsFileTime(LPFILETIME lpSystemTimeAsFileTime);
// DWORD __stdcall GetCurrentProcessId();
// DWORD __stdcall GetCurrentThreadId();
// DWORD __stdcall GetTickCount();
// BOOL __stdcall QueryPerformanceCounter(LARGE_INTEGER *lpPerformanceCount);
// LPTOP_LEVEL_EXCEPTION_FILTER __stdcall SetUnhandledExceptionFilter(LPTOP_LEVEL_EXCEPTION_FILTER lpTopLevelExceptionFilter);
// LONG __stdcall UnhandledExceptionFilter(struct _EXCEPTION_POINTERS *ExceptionInfo);
// LPVOID __stdcall HeapAlloc(HANDLE hHeap, DWORD dwFlags, SIZE_T dwBytes);
// u_short __stdcall htons(u_short hostshort);
// u_long __stdcall htonl(u_long hostlong);
// int __stdcall recvfrom(SOCKET s, char *buf, int len, int flags, struct sockaddr *from, int *fromlen);
// int __stdcall recv(SOCKET s, char *buf, int len, int flags);
// int __stdcall sendto(SOCKET s, const char *buf, int len, int flags, const struct sockaddr *to, int tolen);
// int __stdcall send(SOCKET s, const char *buf, int len, int flags);
// int __stdcall closesocket(SOCKET s);
// int __stdcall WSACleanup();
// int __stdcall WSAStartup(WORD wVersionRequested, LPWSADATA lpWSAData);
// u_short __stdcall ntohs(u_short netshort);
// char *__stdcall inet_ntoa(struct in_addr in);
// unsigned __int32 __stdcall inet_addr(const char *cp);
// SOCKET __stdcall socket(int af, int type, int protocol);
// int __stdcall select(int nfds, fd_set *readfds, fd_set *writefds, fd_set *exceptfds, const struct timeval *timeout);
// int __stdcall WSAGetLastError();
// int __stdcall ioctlsocket(SOCKET s, __int32 cmd, u_long *argp);
// int __stdcall connect(SOCKET s, const struct sockaddr *name, int namelen);
// time_t __cdecl time(time_t *Time);
// int __cdecl tolower(int C);
// int __cdecl islower(int C);
// int __cdecl toupper(int C);
// char *__cdecl strncat(char *Dest, const char *Source, size_t Count);
// int __cdecl strncmp(const char *Str1, const char *Str2, size_t MaxCount);
// char *__cdecl strncpy(char *Dest, const char *Source, size_t Count);
// int __cdecl rand();
// int sprintf(char *Dest, const char *Format, ...);
// int sscanf(const char *Src, const char *Format, ...);
// void __cdecl free(void *Memory);
// void *__cdecl malloc(size_t Size);
// int __cdecl _CxxFrameHandler(_DWORD, _DWORD, _DWORD, _DWORD); weak


//----- (10001000) --------------------------------------------------------
signed int __cdecl svchost_1(struct in_addr in, int a2, int a3)
{
  int v3; // ebx@1
  signed int result; // eax@2
  signed int v5; // esi@9
  char v6; // [sp+0h] [bp-F68h]@1
  SOCKET s; // [sp+Ch] [bp-F5Ch]@4
  int v8; // [sp+F54h] [bp-14h]@1
  char *v9; // [sp+F58h] [bp-10h]@1
  int v10; // [sp+F64h] [bp-4h]@1

  v9 = &v6;
  v8 = 0;
  v10 = 0;
  v3 = (int)malloc(0x20u);
  *(_DWORD *)v3 = 0;
  *(_DWORD *)(v3 + 4) = 0;
  *(_DWORD *)(v3 + 8) = 0;
  *(_DWORD *)(v3 + 12) = 0;
  *(_DWORD *)(v3 + 16) = 0;
  *(_DWORD *)(v3 + 20) = 0;
  *(_DWORD *)(v3 + 24) = 0;
  *(_DWORD *)(v3 + 28) = 0;
  if ( sub_10001190(in) == 1 )
  {
    *(_DWORD *)(v3 + 4) = a2;
    *(_DWORD *)(v3 + 8) = L"winsta.exe";
    *(_DWORD *)(v3 + 12) = a3;
    *(_DWORD *)(v3 + 20) = &unk_100177A8;
    *(_DWORD *)(v3 + 24) = L"wbem\\mof\\sysnullevnt.mof";
    *(_DWORD *)(v3 + 28) = 1594;
    if ( sub_10006070() == 1
      && sub_10006DC0((int)&s) == 1
      && (sub_10001230((int)&s, in, 0x1BDu) || sub_10001230((int)&s, in, 0x8Bu))
      && (sub_10001730((int)&s, 0x1388u, (int)&v8) || sub_10001E30((int)&s, 0x1388u, (int)&v8)) )
    {
      v5 = sub_10001440((int)&s, v3, v8);
      sub_10007F30((int)&s);
      sub_100060C0(s);
      sub_100060B0();
      result = v5;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = -1;
  }
  return result;
}
// 1001681C: using guessed type wchar_t aWinsta_exe[11];
// 10016834: using guessed type wchar_t aWbemMofSysnull[25];

//----- (10001190) --------------------------------------------------------
bool __usercall sub_10001190<eax>(struct in_addr a1<esi>)
{
  int v2; // [sp+4h] [bp-F4Ch]@1
  int v3; // [sp+8h] [bp-F48h]@3

  v2 = 0;
  return sub_10006070() == 1
      && sub_10006DC0((int)&v3) == 1
      && (sub_10001230((int)&v3, a1, 0x1BDu) || sub_10001230((int)&v3, a1, 0x8Bu))
      && (sub_10001730((int)&v3, 0x1388u, (int)&v2) || sub_10001E30((int)&v3, 0x1388u, (int)&v2));
}

//----- (10001230) --------------------------------------------------------
signed int __usercall sub_10001230<eax>(int a1<edi>, struct in_addr in, u_short a3)
{
  signed int result; // eax@2
  char *v4; // eax@4
  char *v5; // eax@8
  char v6; // [sp+4h] [bp-14h]@1

  if ( sub_100021A0((int)&v6) <= 0 || sub_10006500(a1, "Guest", &unk_10016892, 10) != 1 )
  {
    result = -1;
  }
  else
  {
    v4 = inet_ntoa(in);
    result = sub_100012E0(v4, a1, (int)&v6, a3);
    if ( result != 1 )
    {
      sub_10006720(a1);
      if ( sub_100063D0(a1, 0, 0, 2) == 1 )
      {
        v5 = inet_ntoa(in);
        result = sub_100012E0(v5, a1, (int)&v6, a3) == 1;
      }
      else
      {
        result = -1;
      }
    }
  }
  return result;
}

//----- (100012E0) --------------------------------------------------------
signed int __usercall sub_100012E0<eax>(const char *a1<eax>, int a2<esi>, int a3, u_short a4)
{
  const char *v4; // edi@1
  int v5; // eax@2
  SOCKET v6; // eax@2
  int v7; // eax@3
  SOCKET v8; // ecx@3
  signed int result; // eax@5
  SOCKET v10; // ST0C_4@8
  u_long argp; // [sp+8h] [bp-108h]@1
  fd_set writefds; // [sp+Ch] [bp-104h]@3

  v4 = a1;
  argp = 1;
  if ( inet_addr(a1) == -1
    || (v5 = inet_addr(v4),
        sub_10006350(a2, v5, a4, 2, 2),
        v6 = socket(*(_WORD *)(a2 + 16), 1, 6),
        *(_DWORD *)a2 = v6,
        ioctlsocket(v6, -2147195266, &argp),
        connect(*(_DWORD *)a2, (const struct sockaddr *)(a2 + 16), 16) != -1) )
    return -1;
  v8 = *(_DWORD *)a2;
  *(_DWORD *)(a2 + 8) = 5;
  writefds.fd_array[0] = v8;
  writefds.fd_count = 1;
  v7 = select(1, 0, &writefds, 0, (const struct timeval *)(a2 + 8));
  if ( v7 == -1 )
  {
    WSAGetLastError();
    sub_100060C0(*(_DWORD *)a2);
    return -1;
  }
  if ( v7 != 1
    || (v10 = *(_DWORD *)a2, argp = 0, ioctlsocket(v10, -2147195266, &argp), sub_10007EC0(a2, "spoolss", 0) != 1) )
  {
    sub_100060C0(*(_DWORD *)a2);
    result = -1;
  }
  else
  {
    sub_100063D0(a2, 0, 0, 1);
    if ( sub_10006050(a2, a3) == 1 )
    {
      result = 1;
    }
    else
    {
      sub_10007F30(a2);
      sub_100060E0(a2, 1);
      result = -1;
    }
  }
  return result;
}

//----- (10001440) --------------------------------------------------------
signed int __usercall sub_10001440<eax>(int a1<eax>, int a2, int a3)
{
  int v3; // ebp@1
  int v4; // esi@1
  signed int v5; // ebp@3
  signed int v6; // edi@3
  int v7; // eax@4
  int v8; // edx@4
  int v9; // ecx@4
  int v10; // edi@4
  int v11; // ebp@4
  __int16 v12; // bp@5
  void *v13; // ebp@10
  void *v15; // [sp+10h] [bp-24h]@1
  int v16; // [sp+14h] [bp-20h]@1
  int v17; // [sp+18h] [bp-1Ch]@1
  int v18; // [sp+1Ch] [bp-18h]@1
  int v19; // [sp+20h] [bp-14h]@1
  int v20; // [sp+24h] [bp-10h]@1
  size_t Size; // [sp+28h] [bp-Ch]@1
  int v22; // [sp+2Ch] [bp-8h]@1
  int v23; // [sp+30h] [bp-4h]@1

  v4 = a1;
  v3 = 0;
  v15 = 0;
  v16 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  Size = 0;
  v22 = 0;
  v23 = 0;
  v17 = 0;
  while ( sub_10001B70(v4, a3) != (void *)1 )
  {
    v6 = 0;
    v5 = 2;
LABEL_18:
    v3 = v5 + 1;
    v17 = v3;
    if ( v3 >= 2 )
      goto LABEL_21;
  }
  sub_100066F0((int)&v18);
  sub_100066F0((int)&Size);
  sub_10003040(v4, (int)&v18, v4 + 2248);
  sub_10003620(v4, (int)&v18, 1);
  sub_10003620(v4, (int)&v18, 1);
  sub_100037B0(v4, (int)&v18, 1);
  sub_100037B0(v4, (int)&v18, 1);
  sub_100037B0(v4, (int)&v18, 1);
  sub_100037B0(v4, (int)&v18, 1);
  sub_10003A60(v4, (int)&v18, (int)L"Default", 16);
  sub_100035E0(v4, (int)&v18, 4);
  v11 = 16 * v3;
  v9 = *(_DWORD *)(v11 + 8 + a2);
  v10 = a2 + v11;
  v7 = *(_DWORD *)(v11 + 8 + a2);
  v8 = v7 + 2;
  do
  {
    v12 = *(_WORD *)v7;
    v7 += 2;
  }
  while ( v12 );
  sub_10003A60(v4, (int)&v18, v9, 2 * ((v7 - v8) >> 1) + 2);
  sub_100035E0(v4, (int)&v18, 4);
  sub_10003A60(v4, (int)&v18, (int)L"RAW", 8);
  sub_100035E0(v4, (int)&v18, 4);
  if ( sub_10005F20(v4, (int)&v18, (int)&Size, 17, 1) != 1 )
  {
    v6 = 0;
    v5 = 2;
    goto LABEL_18;
  }
  if ( v15 )
    free(v15);
  v13 = malloc(Size);
  v15 = v13;
  memset(v13, 0, Size);
  sub_100026B0(v4, (int)&Size, v13, (int)&v16, Size);
  if ( !*(_DWORD *)(v13 + Size - 4) )
  {
    sub_100066F0((int)&v18);
    sub_100066F0((int)&Size);
    sub_10003040(v4, (int)&v18, v4 + 2248);
    sub_10003620(v4, (int)&v18, *(_DWORD *)(v10 + 12));
    sub_100025E0(v4, (int)&v18, *(const void **)(v10 + 4), *(_DWORD *)(v10 + 12));
    sub_100035E0(v4, (int)&v18, 4);
    sub_10003620(v4, (int)&v18, *(_DWORD *)(v10 + 12));
    if ( sub_10005F20(v4, (int)&v18, (int)&Size, 19, 1) == 1 )
    {
      v16 = 0;
      if ( v13 )
        free(v13);
      v15 = malloc(Size);
      sub_100026B0(v4, (int)&Size, v15, (int)&v16, Size);
      if ( *(_DWORD *)(v15 + Size - 4) )
      {
        v6 = 0;
        v5 = 2;
      }
      else
      {
        v5 = v17;
        v6 = 1;
      }
    }
    else
    {
      v6 = 0;
      v5 = 2;
    }
    goto LABEL_18;
  }
  v6 = 0;
LABEL_21:
  sub_100066F0((int)&v18);
  sub_100066F0((int)&Size);
  free(0);
  free(v15);
  return v6;
}
// 100168A4: using guessed type wchar_t aDefault[8];
// 100168B4: using guessed type wchar_t aRaw[4];

//----- (10001730) --------------------------------------------------------
int __cdecl sub_10001730(int a1, size_t Size, int a3)
{
  int v3; // eax@1
  int v4; // ebx@1
  void *v5; // ebp@1
  void *v6; // edi@1
  void *v7; // eax@1
  __int16 v8; // dx@2
  void *v9; // eax@3
  __int16 v10; // cx@4
  unsigned int v11; // eax@5
  int v12; // edi@5
  __int16 v13; // cx@6
  int v14; // ecx@9
  int v15; // edi@9
  void *v16; // edi@9
  size_t v17; // esi@12
  int v18; // eax@13
  size_t v19; // edx@13
  int v20; // ecx@13
  const void **v21; // esi@16
  const void *v22; // eax@17
  __int16 v23; // cx@18
  const void *v24; // eax@19
  __int16 v25; // cx@20
  const void *v26; // eax@21
  __int16 v27; // dx@22
  const void *v28; // eax@23
  __int16 v29; // cx@24
  int v30; // eax@25
  unsigned __int8 v31; // sf@26
  unsigned __int8 v32; // of@26
  int v33; // eax@28
  int v34; // esi@28
  __int16 v35; // cx@29
  LPVOID v36; // edx@30
  int v37; // ecx@30
  SIZE_T v38; // ST3C_4@30
  HANDLE v39; // eax@30
  LPVOID v40; // eax@30
  __int16 v41; // ax@31
  int v42; // eax@32
  __int16 v43; // cx@33
  void *v45; // [sp+10h] [bp-34h]@1
  int v46; // [sp+14h] [bp-30h]@1
  size_t v47; // [sp+18h] [bp-2Ch]@12
  void *v48; // [sp+1Ch] [bp-28h]@1
  int v49; // [sp+20h] [bp-24h]@1
  void *v50; // [sp+24h] [bp-20h]@1
  int v51; // [sp+28h] [bp-1Ch]@1
  int v52; // [sp+2Ch] [bp-18h]@1
  int v53; // [sp+30h] [bp-14h]@1
  int v54; // [sp+34h] [bp-10h]@1
  size_t v55; // [sp+38h] [bp-Ch]@1
  int v56; // [sp+3Ch] [bp-8h]@1
  int v57; // [sp+40h] [bp-4h]@1
  int v58; // [sp+48h] [bp+4h]@15

  v45 = 0;
  v50 = 0;
  v46 = 0;
  v51 = 0;
  v48 = malloc(Size);
  memset(v48, 0, Size);
  v4 = a1;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v55 = 0;
  v56 = 0;
  v57 = 0;
  v7 = malloc(2 * *(_DWORD *)(a1 + 2488) + 4);
  v6 = v7;
  v49 = (int)v7;
  memset(v7, 0, 2 * *(_DWORD *)(a1 + 2488) + 4);
  v5 = malloc(2 * *(_DWORD *)(a1 + 2488));
  memset(v5, 0, 2 * *(_DWORD *)(a1 + 2488));
  MultiByteToWideChar(0, 1u, *(LPCSTR *)(v4 + 2496), *(_DWORD *)(v4 + 2488), (LPWSTR)v5, 2 * *(_DWORD *)(v4 + 2488) + 2);
  v3 = (int)L"\\\\";
  do
  {
    v8 = *(_WORD *)v3;
    *(_WORD *)(v6 - L"\\\\" + v3) = *(_WORD *)v3;
    v3 += 2;
  }
  while ( v8 );
  v9 = v5;
  do
  {
    v10 = *(_WORD *)v9;
    v9 = (char *)v9 + 2;
  }
  while ( v10 );
  v11 = v9 - v5;
  v12 = (int)((char *)v6 - 2);
  do
  {
    v13 = *(_WORD *)(v12 + 2);
    v12 += 2;
  }
  while ( v13 );
  memcpy((void *)v12, v5, v11);
  sub_100037B0(a1, (int)&v52, 1);
  sub_10003A60(a1, (int)&v52, v49, 2 * *(_DWORD *)(a1 + 2488) + 4);
  sub_100035E0(a1, (int)&v52, 4);
  sub_10003620(a1, (int)&v52, 2);
  sub_100037B0(a1, (int)&v52, 1);
  sub_10003AF0(a1, (int)&v52, v48, Size, Size);
  sub_100035E0(a1, (int)&v52, 4);
  sub_10003620(a1, (int)&v52, Size);
  if ( sub_10005F20(a1, (int)&v52, (int)&v55, 35, 1) == 1 )
  {
    v16 = malloc(v55);
    v50 = v16;
    memset(v16, 0, v55);
    sub_100026B0(a1, (int)&v55, v16, (int)&v51, v55);
    v14 = *(_DWORD *)(v16 + v55 - 4);
    v15 = (int)((char *)v16 + 8);
    if ( v14 == 122 )
    {
      v46 = sub_10001730(a1, *(_DWORD *)(v55 + v15 - 20), a3);
    }
    else
    {
      if ( !v14 )
      {
        v17 = *(_WORD *)(v55 + v15 - 16);
        v47 = v17;
        v17 *= 20;
        v45 = malloc(v17);
        memset(v45, 0, v17);
        if ( (signed int)v47 > 0 )
        {
          v20 = v15;
          v18 = (int)((char *)v45 + 8);
          v19 = v47;
          do
          {
            *(_DWORD *)(v18 - 8) = *(_DWORD *)v20;
            *(_DWORD *)(v18 - 4) = *(_DWORD *)(v20 + 4);
            *(_DWORD *)v18 = *(_DWORD *)(v20 + 8);
            *(_DWORD *)(v18 + 4) = *(_DWORD *)(v20 + 12);
            *(_DWORD *)(v18 + 8) = *(_DWORD *)(v20 + 16);
            *(_DWORD *)(v18 - 8) += v20;
            *(_DWORD *)(v18 - 4) += v20;
            *(_DWORD *)v18 += v20;
            v20 += 20;
            v18 += 20;
            --v19;
          }
          while ( v19 );
        }
        v58 = 0;
        if ( (signed int)v47 > 0 )
        {
          v21 = (const void **)v45;
          while ( 1 )
          {
            v22 = *v21;
            do
            {
              v23 = *(_WORD *)v22;
              v22 = (char *)v22 + 2;
            }
            while ( v23 );
            v5 = malloc(2 * ((signed int)(v22 - ((char *)*v21 + 2)) >> 1) + 12);
            v24 = *v21;
            do
            {
              v25 = *(_WORD *)v24;
              v24 = (char *)v24 + 2;
            }
            while ( v25 );
            memset(v5, 0, 2 * ((signed int)(v24 - ((char *)*v21 + 2)) >> 1) + 12);
            v26 = *v21;
            do
            {
              v27 = *(_WORD *)v26;
              v26 = (char *)v26 + 2;
            }
            while ( v27 );
            memcpy(v5, *v21, 2 * ((signed int)(v26 - ((char *)*v21 + 2)) >> 1));
            v28 = *v21;
            do
            {
              v29 = *(_WORD *)v28;
              v28 = (char *)v28 + 2;
            }
            while ( v29 );
            v30 = (signed int)(v28 - ((char *)*v21 + 2)) >> 1;
            *(_DWORD *)((char *)v5 + 2 * v30) = dword_100168C4;
            *(_DWORD *)(v5 + 2 * v30 + 4) = dword_100168C8;
            *((_WORD *)v5 + v30 + 4) = dword_100168CC;
            if ( sub_10001B70(v4, (int)v5) )
              break;
            free(v5);
            v21 += 5;
            v32 = __SETO__(v58 + 1, v47);
            v31 = (signed int)(v58++ + 1 - v47) < 0;
            if ( !(v31 ^ v32) )
              goto LABEL_35;
          }
          v34 = (int)((char *)v45 + 20 * v58);
          v33 = *(_DWORD *)v34;
          v46 = 1;
          do
          {
            v35 = *(_WORD *)v33;
            v33 += 2;
          }
          while ( v35 );
          v38 = 2 * ((v33 - (*(_DWORD *)v34 + 2)) >> 1) + 12;
          v39 = GetProcessHeap();
          v40 = HeapAlloc(v39, 8u, v38);
          *(_DWORD *)a3 = v40;
          v37 = *(_DWORD *)v34;
          v36 = v40;
          do
          {
            v41 = *(_WORD *)v37;
            *(_WORD *)v36 = *(_WORD *)v37;
            v37 += 2;
            v36 = (char *)v36 + 2;
          }
          while ( v41 );
          v42 = *(_DWORD *)a3 - 2;
          do
          {
            v43 = *(_WORD *)(v42 + 2);
            v42 += 2;
          }
          while ( v43 );
          *(_DWORD *)v42 = dword_100168C4;
          *(_DWORD *)(v42 + 4) = dword_100168C8;
          *(_DWORD *)(v42 + 8) = dword_100168CC;
          free(v5);
        }
      }
    }
  }
  else
  {
    v46 = 0;
  }
LABEL_35:
  free(v48);
  free((void *)v49);
  free(v5);
  free(v50);
  free(v45);
  return v46;
}
// 100168BC: using guessed type wchar_t asc_100168BC[3];
// 100168C4: using guessed type int dword_100168C4;
// 100168C8: using guessed type int dword_100168C8;
// 100168CC: using guessed type int dword_100168CC;

//----- (10001B70) --------------------------------------------------------
void *__usercall sub_10001B70<eax>(int a1<eax>, int a2)
{
  int v2; // ebp@1
  int v3; // esi@1
  char v4; // zf@1
  void *result; // eax@2
  int v6; // eax@3
  __int16 v7; // cx@4
  signed int v8; // ebx@5
  int v9; // edi@5
  int v10; // eax@7
  __int16 v11; // cx@8
  size_t v12; // ecx@9
  void *v13; // ebx@11
  int v14; // [sp+Ch] [bp-64h]@1
  void *Memory; // [sp+10h] [bp-60h]@1
  int v16; // [sp+14h] [bp-5Ch]@1
  int v17; // [sp+18h] [bp-58h]@5
  int v18; // [sp+1Ch] [bp-54h]@5
  int v19; // [sp+20h] [bp-50h]@5
  size_t Size; // [sp+24h] [bp-4Ch]@5
  int v21; // [sp+28h] [bp-48h]@5
  int v22; // [sp+2Ch] [bp-44h]@5
  char Dest; // [sp+30h] [bp-40h]@12
  signed int v24; // [sp+74h] [bp+4h]@1

  v2 = a2;
  v4 = a2 == 0;
  v3 = a1;
  Memory = 0;
  v16 = 0;
  v24 = 0;
  v14 = 0;
  if ( v4 )
  {
    result = 0;
  }
  else
  {
    v6 = v2;
    do
    {
      v7 = *(_WORD *)v6;
      v6 += 2;
    }
    while ( v7 );
    v8 = 2 * ((v6 - (v2 + 2)) >> 1) + 2;
    v17 = 0;
    v18 = 0;
    v19 = 0;
    Size = 0;
    v21 = 0;
    v22 = 0;
    result = malloc(2 * *(_DWORD *)(v3 + 2488) + 6);
    v9 = (int)result;
    if ( result )
    {
      memset(result, 0, 2 * *(_DWORD *)(v3 + 2488) + 6);
      v10 = (int)L"\\\\";
      do
      {
        v11 = *(_WORD *)v10;
        *(_WORD *)(v9 - (_DWORD)L"\\\\" + v10) = *(_WORD *)v10;
        v10 += 2;
      }
      while ( v11 );
      MultiByteToWideChar(
        0,
        1u,
        *(LPCSTR *)(v3 + 2496),
        *(_DWORD *)(v3 + 2488),
        (LPWSTR)(v9 + 4),
        2 * *(_DWORD *)(v3 + 2488) + 2);
      sub_100037B0(v3, (int)&v17, 1);
      sub_10003A60(v3, (int)&v17, v2, v8);
      sub_100035E0(v3, (int)&v17, 4);
      sub_10003620(v3, (int)&v17, 0);
      sub_10003620(v3, (int)&v17, 0);
      sub_10003620(v3, (int)&v17, 0);
      sub_10003620(v3, (int)&v17, 0);
      sub_10003620(v3, (int)&v17, 1);
      sub_10003620(v3, (int)&v17, 1);
      sub_100037B0(v3, (int)&v17, 1);
      sub_10003620(v3, (int)&v17, 28);
      sub_100037B0(v3, (int)&v17, 1);
      sub_100037B0(v3, (int)&v17, 1);
      sub_10003620(v3, (int)&v17, 2600);
      sub_10003620(v3, (int)&v17, 3);
      sub_10003620(v3, (int)&v17, 0);
      sub_100036C0(v3, (int)&v17, 0);
      sub_100035E0(v3, (int)&v17, 4);
      sub_10003A60(v3, (int)&v17, v9, 2 * *(_DWORD *)(v3 + 2488) + 4);
      sub_100035E0(v3, (int)&v17, 4);
      sub_10003A60(v3, (int)&v17, v2, v8);
      sub_100035E0(v3, (int)&v17, 4);
      if ( sub_10005F20(v3, (int)&v17, (int)&Size, 69, 1) == 1 )
      {
        v14 = 0;
        v13 = malloc(Size);
        sub_100026B0(v3, (int)&Size, v13, (int)&v14, Size);
        v12 = Size;
        if ( !*(_DWORD *)(v13 + Size - 4) )
        {
          sub_10003100(v3, (int)&Size, v3 + 2248, (int)&v16);
          sub_10002350(v3 + 2252, &Dest);
          v24 = 1;
        }
      }
      else
      {
        v24 = 0;
      }
      ((void (__thiscall *)(size_t))free)(v12);
      free((void *)v9);
      result = (void *)v24;
    }
  }
  return result;
}
// 100168BC: using guessed type wchar_t asc_100168BC[3];

//----- (10001E30) --------------------------------------------------------
int __cdecl sub_10001E30(int a1, size_t Size, int a3)
{
  int v3; // eax@1
  int v4; // ebx@1
  WCHAR *v5; // edi@1
  void *v6; // esi@1
  void *v7; // eax@1
  void *v8; // eax@1
  size_t v9; // ST24_4@1
  __int16 v10; // dx@2
  const void *v11; // edx@3
  WCHAR v12; // ax@4
  unsigned int v13; // eax@5
  int v14; // edi@5
  __int16 v15; // cx@6
  const void *v16; // edx@7
  int v17; // ecx@7
  int v18; // ebp@9
  void *v19; // ebp@9
  int v20; // edi@12
  size_t v21; // esi@12
  size_t v22; // ST48_4@12
  int v23; // eax@13
  int v25; // esi@16
  int *v26; // ebp@17
  int v27; // eax@21
  int v28; // esi@21
  __int16 v29; // cx@22
  SIZE_T v30; // ST48_4@23
  HANDLE v31; // eax@23
  LPVOID v32; // eax@23
  __int16 v33; // ax@24
  void *v35; // [sp+10h] [bp-38h]@1
  int v36; // [sp+14h] [bp-34h]@1
  void *v37; // [sp+18h] [bp-30h]@1
  void *v38; // [sp+1Ch] [bp-2Ch]@1
  int v39; // [sp+20h] [bp-28h]@1
  int v40; // [sp+24h] [bp-24h]@1
  int v41; // [sp+28h] [bp-20h]@12
  void *v42; // [sp+2Ch] [bp-1Ch]@1
  int v43; // [sp+30h] [bp-18h]@1
  int v44; // [sp+34h] [bp-14h]@1
  int v45; // [sp+38h] [bp-10h]@1
  size_t v46; // [sp+3Ch] [bp-Ch]@1
  int v47; // [sp+40h] [bp-8h]@1
  int v48; // [sp+44h] [bp-4h]@1
  int v49; // [sp+4Ch] [bp+4h]@13

  v38 = 0;
  v35 = 0;
  v36 = 0;
  v40 = 0;
  v37 = malloc(Size);
  memset(v37, 0, Size);
  v4 = a1;
  v43 = 0;
  v44 = 0;
  v45 = 0;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v7 = malloc(2 * *(_DWORD *)(a1 + 2488) + 6);
  v6 = v7;
  v39 = (int)v7;
  memset(v7, 0, 2 * *(_DWORD *)(a1 + 2488) + 6);
  v8 = malloc(2 * *(_DWORD *)(a1 + 2488) + 2);
  v5 = (WCHAR *)v8;
  v9 = 2 * *(_DWORD *)(a1 + 2488) + 2;
  v42 = v8;
  memset(v8, 0, v9);
  MultiByteToWideChar(0, 1u, *(LPCSTR *)(v4 + 2496), *(_DWORD *)(v4 + 2488), v5, 2 * *(_DWORD *)(v4 + 2488) + 2);
  v3 = (int)L"\\\\";
  do
  {
    v10 = *(_WORD *)v3;
    *(_WORD *)(v6 - L"\\\\" + v3) = *(_WORD *)v3;
    v3 += 2;
  }
  while ( v10 );
  v11 = v5;
  do
  {
    v12 = *v5;
    ++v5;
  }
  while ( v12 );
  v13 = (char *)v5 - v11;
  v14 = (int)((char *)v6 - 2);
  do
  {
    v15 = *(_WORD *)(v14 + 2);
    v14 += 2;
  }
  while ( v15 );
  memcpy((void *)v14, v11, v13);
  sub_10003620(a1, (int)&v43, 8);
  sub_100037B0(a1, (int)&v43, 1);
  sub_10003A60(a1, (int)&v43, v39, 2 * *(_DWORD *)(a1 + 2488) + 4);
  sub_100035E0(a1, (int)&v43, 4);
  sub_10003620(a1, (int)&v43, 2);
  sub_100037B0(a1, (int)&v43, 1);
  sub_10003AF0(a1, (int)&v43, v37, Size, Size);
  sub_100035E0(a1, (int)&v43, 4);
  sub_10003620(a1, (int)&v43, Size);
  if ( sub_10005F20(a1, (int)&v43, (int)&v46, 0, 1) == 1 )
  {
    v19 = malloc(v46);
    v38 = v19;
    memset(v19, 0, v46);
    sub_100026B0(a1, (int)&v46, v19, (int)&v40, v46);
    v17 = *(_DWORD *)(v19 + v46 - 4);
    v18 = (int)((char *)v19 + 8);
    if ( v17 == 122 )
    {
      v36 = sub_10001E30(a1, *(_DWORD *)(v18 - 20 + v46), a3);
    }
    else
    {
      if ( !v17 )
      {
        v20 = *(_WORD *)(v18 - 16 + v46);
        v21 = 84 * *(_WORD *)(v18 - 16 + v46);
        v22 = 84 * *(_WORD *)(v18 - 16 + v46);
        v41 = *(_WORD *)(v18 - 16 + v46);
        v35 = malloc(v22);
        memset(v35, 0, v21);
        if ( v20 > 0 )
        {
          v16 = (const void *)v18;
          v23 = (int)((char *)v35 + 8);
          v49 = v20;
          do
          {
            memcpy((void *)(v23 - 8), v16, 0x54u);
            *(_DWORD *)(v23 - 4) += v16;
            *(_DWORD *)v23 += v16;
            *(_DWORD *)(v23 + 4) += v16;
            *(_DWORD *)(v23 + 8) += v16;
            *(_DWORD *)(v23 + 12) += v16;
            *(_DWORD *)(v23 + 16) += v16;
            *(_DWORD *)(v23 + 20) += v16;
            *(_DWORD *)(v23 + 24) += v16;
            *(_DWORD *)(v23 + 28) += v16;
            *(_DWORD *)(v23 + 32) += v16;
            *(_DWORD *)(v23 + 36) += v16;
            *(_DWORD *)(v23 - 8) += v16;
            v16 = (char *)v16 + 84;
            v23 += 84;
          }
          while ( v49-- != 1 );
          v20 = v41;
        }
        v25 = 0;
        if ( v20 > 0 )
        {
          v26 = (int *)((char *)v35 + 4);
          while ( !sub_10001B70(v4, *v26) )
          {
            ++v25;
            v26 += 21;
            if ( v25 >= v20 )
              goto LABEL_25;
          }
          v28 = (int)(v35 + 84 * v25 + 4);
          v27 = *(_DWORD *)v28;
          v36 = 1;
          do
          {
            v29 = *(_WORD *)v27;
            v27 += 2;
          }
          while ( v29 );
          v30 = 2 * ((v27 - (*(_DWORD *)v28 + 2)) >> 1) + 2;
          v31 = GetProcessHeap();
          v32 = HeapAlloc(v31, 8u, v30);
          *(_DWORD *)a3 = v32;
          v17 = *(_DWORD *)v28;
          v16 = v32;
          do
          {
            v33 = *(_WORD *)v17;
            *(_WORD *)v16 = *(_WORD *)v17;
            v17 += 2;
            v16 = (char *)v16 + 2;
          }
          while ( v33 );
        }
      }
    }
  }
  else
  {
    v36 = 0;
  }
LABEL_25:
  ((void (__fastcall *)(int, const void *))free)(v17, v16);
  free(v35);
  free(v38);
  free(v42);
  free((void *)v39);
  return v36;
}
// 100168BC: using guessed type wchar_t asc_100168BC[3];

//----- (100021A0) --------------------------------------------------------
int __usercall sub_100021A0<eax>(int a1<esi>)
{
  int result; // eax@4
  __int16 v2; // dx@5
  __int16 v3; // cx@5
  char v4; // al@5
  char v5; // al@5
  char v6; // al@5
  __int16 v7; // dx@5
  int v8; // [sp+4h] [bp-38h]@1
  int v9; // [sp+8h] [bp-34h]@1
  __int16 v10; // [sp+Ch] [bp-30h]@1
  __int16 v11; // [sp+10h] [bp-2Ch]@1
  char v12; // [sp+14h] [bp-28h]@1
  char v13; // [sp+18h] [bp-24h]@1
  char v14; // [sp+1Ch] [bp-20h]@1
  char v15; // [sp+20h] [bp-1Ch]@1
  char v16; // [sp+24h] [bp-18h]@1
  char v17; // [sp+28h] [bp-14h]@1
  char v18; // [sp+2Ch] [bp-10h]@1
  char v19; // [sp+30h] [bp-Ch]@1
  __int16 v20; // [sp+34h] [bp-8h]@1
  __int16 v21; // [sp+38h] [bp-4h]@1

  if ( sscanf(
         "12345678-1234-ABCD-EF00-0123456789AB v1.0",
         "%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02xv%d.%d%n",
         &v9,
         &v10,
         &v11,
         &v12,
         &v13,
         &v14,
         &v15,
         &v16,
         &v17,
         &v18,
         &v19,
         &v20,
         &v21,
         &v8) >= 13
    || sscanf(
         "12345678-1234-ABCD-EF00-0123456789AB v1.0",
         "%x-%x-%x-%02x%02x-%02x%02x%02x%02x%02x%02x v%d.%d%n",
         &v9,
         &v10,
         &v11,
         &v12,
         &v13,
         &v14,
         &v15,
         &v16,
         &v17,
         &v18,
         &v19,
         &v20,
         &v21,
         &v8) >= 13
    || sscanf(
         "12345678-1234-ABCD-EF00-0123456789AB v1.0",
         "%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x %d.%d%n",
         &v9,
         &v10,
         &v11,
         &v12,
         &v13,
         &v14,
         &v15,
         &v16,
         &v17,
         &v18,
         &v19,
         &v20,
         &v21,
         &v8) >= 13 )
  {
    v2 = v11;
    v3 = v10;
    *(_DWORD *)a1 = v9;
    v4 = v12;
    *(_WORD *)(a1 + 4) = v3;
    LOBYTE(v3) = v13;
    *(_WORD *)(a1 + 6) = v2;
    LOBYTE(v2) = v14;
    *(_BYTE *)(a1 + 8) = v4;
    v5 = v15;
    *(_BYTE *)(a1 + 9) = v3;
    LOBYTE(v3) = v16;
    *(_BYTE *)(a1 + 10) = v2;
    LOBYTE(v2) = v17;
    *(_BYTE *)(a1 + 11) = v5;
    v6 = v18;
    *(_BYTE *)(a1 + 12) = v3;
    LOBYTE(v3) = v19;
    *(_BYTE *)(a1 + 13) = v2;
    v7 = v20;
    *(_BYTE *)(a1 + 14) = v6;
    *(_WORD *)(a1 + 18) = v21;
    result = v8;
    *(_BYTE *)(a1 + 15) = v3;
    *(_WORD *)(a1 + 16) = v7;
  }
  else
  {
    result = 0;
    *(_DWORD *)a1 = 0;
    *(_DWORD *)(a1 + 4) = 0;
    *(_DWORD *)(a1 + 8) = 0;
    *(_DWORD *)(a1 + 12) = 0;
    *(_DWORD *)(a1 + 16) = 0;
  }
  return result;
}

//----- (10002350) --------------------------------------------------------
int __usercall sub_10002350<eax>(int a1<eax>, char *Dest)
{
  return sprintf(
           Dest,
           "%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X",
           *(_DWORD *)a1,
           *(_WORD *)(a1 + 4),
           *(_WORD *)(a1 + 6),
           *(_BYTE *)(a1 + 8),
           *(_BYTE *)(a1 + 9),
           *(_BYTE *)(a1 + 10),
           *(_BYTE *)(a1 + 11),
           *(_BYTE *)(a1 + 12),
           *(_BYTE *)(a1 + 13),
           *(_BYTE *)(a1 + 14),
           *(_BYTE *)(a1 + 15));
}

//----- (10002399) --------------------------------------------------------
int __usercall sub_10002399<eax>(const void *a1<eax>, int a2, int a3, int a4, int a5)
{
  int v6; // [sp+Ch] [bp-28h]@1
  int *v7; // [sp+30h] [bp-4h]@1

  memcpy(&v6, a1, 0x24u);
  v6 = v6 & 0xF9930520 | 0x19930520;
  v7 = &v6;
  return _CxxFrameHandler(a2, a3, a4, a5);
}
// 100160E0: using guessed type int __cdecl _CxxFrameHandler(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (100023F0) --------------------------------------------------------
signed int __cdecl sub_100023F0(int a1, int a2, int a3)
{
  void *v3; // eax@2
  int i; // eax@4
  int v5; // edx@5
  signed int result; // eax@6

  if ( a3 + *(_DWORD *)a2 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_4:
    for ( i = 0; i < a3; *(_BYTE *)(v5 + *(_DWORD *)(a2 + 8)) = *(_BYTE *)(a1 + 88) )
      v5 = i++ + *(_DWORD *)a2;
    *(_DWORD *)a2 += a3;
    result = 1;
  }
  else
  {
    while ( 1 )
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        break;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) += 4096;
      if ( a3 + *(_DWORD *)a2 <= *(_DWORD *)(a2 + 4) )
        goto LABEL_4;
    }
    result = 0;
  }
  return result;
}

//----- (10002470) --------------------------------------------------------
signed int __cdecl sub_10002470(int a1, int a2, const void *a3, unsigned int a4)
{
  void *v5; // eax@6
  int v6; // edi@7
  signed int v7; // eax@10
  int v8; // esi@11

  if ( !a4 )
    return 1;
  if ( (signed int)a4 > 8 || (signed int)a4 < 1 )
    return 0;
  if ( (signed int)(a4 + *(_DWORD *)a2) <= *(_DWORD *)(a2 + 4) )
  {
LABEL_8:
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) || (signed int)a4 <= 1 )
    {
      memcpy((void *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)), a3, a4);
    }
    else
    {
      v7 = 0;
      if ( (signed int)a4 > 0 )
      {
        v8 = (int)((char *)a3 + a4 - 1);
        do
          *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + v7++) = *(_BYTE *)v8--;
        while ( v7 < (signed int)a4 );
        *(_DWORD *)a2 += a4;
        return 1;
      }
    }
    *(_DWORD *)a2 += a4;
    return 1;
  }
  while ( 1 )
  {
    v5 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
    if ( !v5 )
      return 0;
    v6 = *(_DWORD *)(a2 + 4) + 4096;
    *(_DWORD *)(a2 + 8) = v5;
    *(_DWORD *)(a2 + 4) = v6;
    if ( (signed int)(a4 + *(_DWORD *)a2) <= v6 )
      goto LABEL_8;
  }
}

//----- (10002560) --------------------------------------------------------
signed int __cdecl sub_10002560(int a1, void *a2, int a3, int a4, unsigned int a5)
{
  signed int v5; // eax@5
  int v6; // edx@6
  char v7; // cl@7

  if ( (signed int)a5 > 8 || a4 < 0 )
    return 0;
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70) || (signed int)a5 <= 1 )
  {
    memcpy(a2, (const void *)(a4 + *(_DWORD *)(a3 + 8)), a5);
    return 1;
  }
  v5 = 0;
  if ( (signed int)a5 <= 0 )
    return 1;
  v6 = (int)(a2 + a5 - 1);
  do
  {
    v7 = *(_BYTE *)(v5++ + *(_DWORD *)(a3 + 8) + a4);
    *(_BYTE *)v6-- = v7;
  }
  while ( v5 < (signed int)a5 );
  return 1;
}

//----- (100025E0) --------------------------------------------------------
signed int __cdecl sub_100025E0(int a1, int a2, const void *a3, unsigned int a4)
{
  signed int result; // eax@4
  int v5; // eax@5

  if ( !a3 || !a4 )
    return 1;
  if ( (signed int)a4 < 0 )
    return 0;
  v5 = *(_DWORD *)a2;
  if ( (signed int)(*(_DWORD *)a2 + a4) <= *(_DWORD *)(a2 + 4) )
  {
LABEL_9:
    memcpy((void *)(v5 + *(_DWORD *)(a2 + 8)), a3, a4);
    *(_DWORD *)a2 += a4;
    return 1;
  }
  result = (signed int)realloc(*(void **)(a2 + 8), *(_DWORD *)a2 + a4);
  if ( result )
  {
    *(_DWORD *)(a2 + 8) = result;
    v5 = *(_DWORD *)a2;
    *(_DWORD *)(a2 + 4) = *(_DWORD *)a2 + a4;
    goto LABEL_9;
  }
  return result;
}

//----- (10002660) --------------------------------------------------------
signed int __cdecl sub_10002660(int a1, int a2, void *a3, int *a4, unsigned int a5)
{
  int v5; // eax@1
  signed int result; // eax@5

  v5 = *a4;
  if ( (signed int)(*a4 + a5) <= *(_DWORD *)a2 && (signed int)a5 <= 8 && v5 >= 0 && sub_10002560(a1, a3, a2, v5, a5) )
  {
    *a4 += a5;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (100026B0) --------------------------------------------------------
signed int __cdecl sub_100026B0(int a1, int a2, void *a3, int a4, unsigned int a5)
{
  signed int result; // eax@2
  int v6; // eax@4
  int v7; // esi@5

  if ( a5 )
  {
    if ( (signed int)a5 < 0 || (v6 = *(_DWORD *)a4, *(_DWORD *)a4 < 0) )
    {
      result = 0;
    }
    else
    {
      v7 = *(_DWORD *)(a2 + 8);
      if ( (signed int)(v6 + a5) > *(_DWORD *)a2 )
      {
        memcpy(a3, (const void *)(v6 + v7), *(_DWORD *)a2 - v6);
        *(_DWORD *)a4 = *(_DWORD *)a2;
        result = 1;
      }
      else
      {
        memcpy(a3, (const void *)(v6 + v7), a5);
        *(_DWORD *)a4 += a5;
        result = 1;
      }
    }
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (10002730) --------------------------------------------------------
signed int __cdecl sub_10002730(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  signed int result; // eax@2
  void *v6; // eax@5
  int v7; // eax@6
  int v8; // eax@7
  int v9; // eax@10
  int v10; // ecx@10
  int v11; // eax@10
  void *v12; // eax@12
  int v13; // eax@13
  void *v14; // eax@18
  int v15; // edx@20
  int v16; // eax@21
  void *v17; // eax@25
  int v18; // eax@26
  void *v19; // eax@30
  int v20; // edi@31
  int v21; // edi@38
  void *v22; // eax@39
  int v23; // ebx@40

  v4 = *(_DWORD *)(a3 + 8);
  if ( !v4 )
    return 1;
  if ( v4 != 3 )
  {
    if ( v4 != 2 )
      goto LABEL_38;
    if ( *(_DWORD *)(a4 + 4) == -1 )
    {
      if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
      {
        do
        {
          v17 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
          if ( !v17 )
            return 0;
          *(_DWORD *)(a2 + 8) = v17;
          v18 = *(_DWORD *)(a2 + 4) + 4096;
          *(_DWORD *)(a2 + 4) = v18;
        }
        while ( *(_DWORD *)a2 + 4 > v18 );
      }
      if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
      {
        *(_DWORD *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = 0;
        goto LABEL_37;
      }
      goto LABEL_15;
    }
    if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
    {
      do
      {
        v19 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
        if ( !v19 )
          return 0;
        v20 = *(_DWORD *)(a2 + 4) + 4096;
        *(_DWORD *)(a2 + 8) = v19;
        *(_DWORD *)(a2 + 4) = v20;
      }
      while ( *(_DWORD *)a2 + 4 > v20 );
    }
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      v15 = *(_DWORD *)(a2 + 8);
      v16 = *(_DWORD *)a2;
      goto LABEL_36;
    }
    v15 = *(_DWORD *)a2;
LABEL_34:
    *(_BYTE *)(v15 + *(_DWORD *)(a2 + 8)) = *(_BYTE *)(a4 + 7);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = *(_BYTE *)(a4 + 6);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 2) = *(_BYTE *)(a4 + 5);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 3) = *(_BYTE *)(a4 + 4);
    goto LABEL_37;
  }
  if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
  {
    do
    {
      v6 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v6 )
        return 0;
      *(_DWORD *)(a2 + 8) = v6;
      v7 = *(_DWORD *)(a2 + 4) + 4096;
      *(_DWORD *)(a2 + 4) = v7;
    }
    while ( *(_DWORD *)a2 + 4 > v7 );
  }
  v8 = *(_DWORD *)a2;
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_DWORD *)(*(_DWORD *)(a2 + 8) + v8) = *(_DWORD *)a4;
  }
  else
  {
    *(_BYTE *)(v8 + *(_DWORD *)(a2 + 8)) = *(_BYTE *)(a4 + 3);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = *(_BYTE *)(a4 + 2);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 2) = *(_BYTE *)(a4 + 1);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 3) = *(_BYTE *)a4;
  }
  v11 = *(_DWORD *)a2 + 4;
  *(_DWORD *)a2 = v11;
  v9 = v11 + 4;
  v10 = *(_DWORD *)(a2 + 4);
  if ( *(_DWORD *)(a4 + 4) != -1 )
  {
    if ( v9 > v10 )
    {
      do
      {
        v14 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
        if ( !v14 )
          return 0;
        *(_DWORD *)(a2 + 4) += 4096;
        *(_DWORD *)(a2 + 8) = v14;
      }
      while ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) );
    }
    v15 = *(_DWORD *)a2;
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      v16 = *(_DWORD *)(a2 + 8);
LABEL_36:
      *(_DWORD *)(v16 + v15) = *(_DWORD *)(a4 + 4);
      goto LABEL_37;
    }
    goto LABEL_34;
  }
  if ( v9 > v10 )
  {
    do
    {
      v12 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v12 )
        return 0;
      *(_DWORD *)(a2 + 8) = v12;
      v13 = *(_DWORD *)(a2 + 4) + 4096;
      *(_DWORD *)(a2 + 4) = v13;
    }
    while ( *(_DWORD *)a2 + 4 > v13 );
  }
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_DWORD *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2) = 0;
    goto LABEL_37;
  }
LABEL_15:
  *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = 0;
  *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = 0;
  *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 2) = 0;
  *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 3) = 0;
LABEL_37:
  *(_DWORD *)a2 += 4;
LABEL_38:
  v21 = a4 + 8;
  if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
  {
    do
    {
      v22 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v22 )
        return 0;
      v23 = *(_DWORD *)(a2 + 4) + 4096;
      *(_DWORD *)(a2 + 8) = v22;
      *(_DWORD *)(a2 + 4) = v23;
    }
    while ( *(_DWORD *)a2 + 4 > v23 );
  }
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_DWORD *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = *(_DWORD *)v21;
    *(_DWORD *)a2 += 4;
    result = 1;
  }
  else
  {
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = *(_BYTE *)(a4 + 11);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = *(_BYTE *)(a4 + 10);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 2) = *(_BYTE *)(a4 + 9);
    *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 3) = *(_BYTE *)v21;
    *(_DWORD *)a2 += 4;
    result = 1;
  }
  return result;
}

//----- (10002A60) --------------------------------------------------------
signed int __cdecl sub_10002A60(int a1, int a2, int a3, int a4)
{
  void *v4; // eax@4
  int v5; // edx@6
  void *v6; // eax@10
  int v7; // eax@11
  int v8; // eax@12
  void *v9; // eax@18
  int v10; // edx@20
  void *v11; // eax@26
  int v12; // eax@27
  int v13; // eax@28
  int v14; // edi@32
  int v15; // eax@36
  int v16; // ecx@37

  if ( *(_DWORD *)(a3 + 8) == 3 )
  {
    if ( *(_DWORD *)a4 == -1 )
    {
      if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
      {
        do
        {
          v6 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
          if ( !v6 )
            return 0;
          *(_DWORD *)(a2 + 8) = v6;
          v7 = *(_DWORD *)(a2 + 4) + 4096;
          *(_DWORD *)(a2 + 4) = v7;
        }
        while ( *(_DWORD *)a2 + 4 > v7 );
      }
      v8 = *(_DWORD *)(a2 + 8);
      if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
      {
        *(_DWORD *)(*(_DWORD *)a2 + v8) = *(_DWORD *)(a4 + 8);
      }
      else
      {
        *(_BYTE *)(v8 + *(_DWORD *)a2) = *(_BYTE *)(a4 + 11);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a4 + 10);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a4 + 9);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)(a4 + 8);
      }
    }
    else
    {
      for ( ; *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4); *(_DWORD *)(a2 + 4) += 4096 )
      {
        v4 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
        if ( !v4 )
          return 0;
        *(_DWORD *)(a2 + 8) = v4;
      }
      v5 = *(_DWORD *)(a2 + 8);
      if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
      {
        *(_DWORD *)(*(_DWORD *)a2 + v5) = *(_DWORD *)a4;
      }
      else
      {
        *(_BYTE *)(v5 + *(_DWORD *)a2) = *(_BYTE *)(a4 + 3);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a4 + 2);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a4 + 1);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)a4;
      }
    }
    *(_DWORD *)a2 += 4;
  }
  if ( *(_DWORD *)(a3 + 8) >= 2 )
  {
    for ( ; *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4); *(_DWORD *)(a2 + 8) = v9 )
    {
      v9 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v9 )
        return 0;
      *(_DWORD *)(a2 + 4) += 4096;
    }
    v10 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)a2 + v10) = *(_DWORD *)(a4 + 4);
    }
    else
    {
      *(_BYTE *)(v10 + *(_DWORD *)a2) = *(_BYTE *)(a4 + 7);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a4 + 6);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a4 + 5);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)(a4 + 4);
    }
    *(_DWORD *)a2 += 4;
  }
  if ( *(_DWORD *)(a3 + 8) >= 1 )
  {
    if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
    {
      do
      {
        v11 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
        if ( !v11 )
          return 0;
        *(_DWORD *)(a2 + 8) = v11;
        v12 = *(_DWORD *)(a2 + 4) + 4096;
        *(_DWORD *)(a2 + 4) = v12;
      }
      while ( *(_DWORD *)a2 + 4 > v12 );
    }
    v13 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)a2 + v13) = *(_DWORD *)(a4 + 8);
    }
    else
    {
      *(_BYTE *)(v13 + *(_DWORD *)a2) = *(_BYTE *)(a4 + 11);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a4 + 10);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a4 + 9);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)(a4 + 8);
    }
    *(_DWORD *)a2 += 4;
  }
  v14 = 0;
  if ( *(_DWORD *)(a4 + 8) > 0 )
  {
    while ( sub_10002470(a1, a2, (const void *)(*(_DWORD *)(a4 + 12) + v14 * *(_DWORD *)a3), *(_DWORD *)a3) )
    {
      ++v14;
      if ( v14 >= *(_DWORD *)(a4 + 8) )
        goto LABEL_35;
    }
    return 0;
  }
LABEL_35:
  if ( !*(_DWORD *)(a3 + 8) )
  {
    v15 = *(_DWORD *)(a3 + 4);
    if ( v15 != -1 )
    {
      v16 = *(_DWORD *)(a4 + 8);
      if ( v15 > v16 )
      {
        if ( !sub_100023F0(a1, a2, *(_DWORD *)a3 * (v15 - v16)) )
          return 0;
      }
    }
  }
  return 1;
}

//----- (10002D20) --------------------------------------------------------
signed int __cdecl sub_10002D20(int a1, int a2, int a3)
{
  void *v3; // eax@2
  int v4; // edi@3
  int v5; // edx@4
  int v6; // ecx@7
  int v7; // eax@7
  void *v8; // eax@8
  int v9; // edx@10
  int v10; // ecx@13
  int v11; // eax@13
  void *v12; // eax@14
  int v13; // edx@16
  int v14; // edx@19
  void *v15; // eax@21
  int v16; // edx@22
  int v17; // eax@23

  if ( *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4) )
  {
    do
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        return 0;
      v4 = *(_DWORD *)(a2 + 4) + 4096;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) = v4;
    }
    while ( *(_DWORD *)a2 + 4 > v4 );
  }
  v5 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_DWORD *)(*(_DWORD *)a2 + v5) = *(_DWORD *)a3;
  }
  else
  {
    *(_BYTE *)(v5 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 3);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a3 + 2);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a3 + 1);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)a3;
  }
  v6 = *(_DWORD *)(a2 + 4);
  v7 = *(_DWORD *)a2 + 6;
  *(_DWORD *)a2 += 4;
  if ( v7 > v6 )
  {
    do
    {
      v8 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v8 )
        return 0;
      *(_DWORD *)(a2 + 8) = v8;
      *(_DWORD *)(a2 + 4) += 4096;
    }
    while ( *(_DWORD *)a2 + 2 > *(_DWORD *)(a2 + 4) );
  }
  v9 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_WORD *)(*(_DWORD *)a2 + v9) = *(_WORD *)(a3 + 4);
  }
  else
  {
    *(_BYTE *)(v9 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 5);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a3 + 4);
  }
  v10 = *(_DWORD *)(a2 + 4);
  v11 = *(_DWORD *)a2 + 4;
  *(_DWORD *)a2 += 2;
  if ( v11 > v10 )
  {
    do
    {
      v12 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v12 )
        return 0;
      *(_DWORD *)(a2 + 8) = v12;
      *(_DWORD *)(a2 + 4) += 4096;
    }
    while ( *(_DWORD *)a2 + 2 > *(_DWORD *)(a2 + 4) );
  }
  v13 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_WORD *)(*(_DWORD *)a2 + v13) = *(_WORD *)(a3 + 6);
  }
  else
  {
    *(_BYTE *)(v13 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 7);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a3 + 6);
  }
  v14 = *(_DWORD *)a2 + 2;
  *(_DWORD *)a2 = v14;
  if ( a3 == -8 )
    return 1;
  if ( v14 + 8 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_23:
    v17 = *(_DWORD *)a2 + *(_DWORD *)(a2 + 8);
    *(_DWORD *)v17 = *(_DWORD *)(a3 + 8);
    *(_DWORD *)(v17 + 4) = *(_DWORD *)(a3 + 12);
    *(_DWORD *)a2 += 8;
    return 1;
  }
  v15 = realloc(*(void **)(a2 + 8), v14 + 8);
  if ( v15 )
  {
    v16 = *(_DWORD *)a2 + 8;
    *(_DWORD *)(a2 + 8) = v15;
    *(_DWORD *)(a2 + 4) = v16;
    goto LABEL_23;
  }
  return 0;
}

//----- (10002EF0) --------------------------------------------------------
signed int __cdecl sub_10002EF0(int a1, int a2, int a3, int a4)
{
  int v4; // ecx@1
  int v5; // edx@3
  int v6; // ecx@6
  int v7; // edx@8
  signed int result; // eax@10
  int v9; // ecx@12
  int v10; // edx@14
  int v11; // ecx@18
  void *v12; // edi@18
  int v13; // eax@20

  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  v4 = *(_DWORD *)a4;
  if ( *(_DWORD *)a4 + 4 > *(_DWORD *)a2 || v4 < 0 )
  {
    result = 0;
  }
  else
  {
    v5 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70) )
    {
      *(_DWORD *)a3 = *(_DWORD *)(v4 + v5);
    }
    else
    {
      *(_BYTE *)(a3 + 3) = *(_BYTE *)(v4 + v5);
      *(_BYTE *)(a3 + 2) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 1);
      *(_BYTE *)(a3 + 1) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 2);
      *(_BYTE *)a3 = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 3);
    }
    v6 = *(_DWORD *)a4 + 4;
    *(_DWORD *)a4 = v6;
    if ( v6 + 2 > *(_DWORD *)a2
      || v6 < 0
      || ((v7 = *(_DWORD *)(a2 + 8), *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70)) ? (*(_WORD *)(a3 + 4) = *(_WORD *)(v6 + v7)) : (*(_BYTE *)(a3 + 5) = *(_BYTE *)(v6 + v7), *(_BYTE *)(a3 + 4) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v6 + 1)),
          (v9 = *(_DWORD *)a4 + 2, *(_DWORD *)a4 = v9, v9 + 2 > *(_DWORD *)a2)
       || v9 < 0
       || ((v10 = *(_DWORD *)(a2 + 8), *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70)) ? (*(_WORD *)(a3 + 6) = *(_WORD *)(v9 + v10)) : (*(_BYTE *)(a3 + 7) = *(_BYTE *)(v9 + v10), *(_BYTE *)(a3 + 6) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v9 + 1)),
           v11 = *(_DWORD *)a4 + 2,
           *(_DWORD *)a4 = v11,
           v12 = (void *)(a3 + 8),
           v11 < 0)) )
    {
      result = 0;
    }
    else
    {
      if ( v11 + 8 > *(_DWORD *)a2 )
      {
        memcpy(v12, (const void *)(v11 + *(_DWORD *)(a2 + 8)), *(_DWORD *)a2 - v11);
        *(_DWORD *)a4 = *(_DWORD *)a2;
        result = 1;
      }
      else
      {
        v13 = v11 + *(_DWORD *)(a2 + 8);
        *(_DWORD *)v12 = *(_DWORD *)v13;
        *(_DWORD *)(a3 + 12) = *(_DWORD *)(v13 + 4);
        *(_DWORD *)a4 += 8;
        result = 1;
      }
    }
  }
  return result;
}

//----- (10003040) --------------------------------------------------------
signed int __cdecl sub_10003040(int a1, int a2, int a3)
{
  void *v3; // eax@2
  int v4; // ebx@3
  int v5; // edx@4

  if ( *(_DWORD *)a2 + 4 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_4:
    v5 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)a2 + v5) = *(_DWORD *)a3;
    }
    else
    {
      *(_BYTE *)(v5 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 3);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a3 + 2);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = *(_BYTE *)(a3 + 1);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = *(_BYTE *)a3;
    }
    *(_DWORD *)a2 += 4;
    if ( sub_10002D20(a1, a2, a3 + 4) )
      return 1;
  }
  else
  {
    while ( 1 )
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        break;
      v4 = *(_DWORD *)(a2 + 4) + 4096;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) = v4;
      if ( *(_DWORD *)a2 + 4 <= v4 )
        goto LABEL_4;
    }
  }
  return 0;
}

//----- (10003100) --------------------------------------------------------
bool __cdecl sub_10003100(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // edx@3
  bool result; // eax@6

  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  v4 = *(_DWORD *)a4;
  if ( *(_DWORD *)a4 + 4 > *(_DWORD *)a2 || v4 < 0 )
  {
    result = 0;
  }
  else
  {
    v5 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70) )
    {
      *(_DWORD *)a3 = *(_DWORD *)(v4 + v5);
    }
    else
    {
      *(_BYTE *)(a3 + 3) = *(_BYTE *)(v4 + v5);
      *(_BYTE *)(a3 + 2) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 1);
      *(_BYTE *)(a3 + 1) = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 2);
      *(_BYTE *)a3 = *(_BYTE *)(*(_DWORD *)(a2 + 8) + v4 + 3);
    }
    *(_DWORD *)a4 += 4;
    result = sub_10002EF0(a1, a2, a3 + 4, a4) != 0;
  }
  return result;
}

//----- (10003190) --------------------------------------------------------
signed int __cdecl sub_10003190(int a1, int a2, int a3)
{
  int v3; // ST00_4@1
  int v4; // ST04_4@1
  int v5; // ST08_4@1
  void *v6; // eax@3
  int v7; // edx@5
  int v8; // edi@8
  int v9; // ecx@8
  int v10; // eax@8
  void *v11; // eax@9
  int v12; // edx@11
  signed int result; // eax@12

  if ( !sub_10002D20(v3, v4, v5) )
    return 0;
  for ( ; *(_DWORD *)a2 + 2 > *(_DWORD *)(a2 + 4); *(_DWORD *)(a2 + 4) += 4096 )
  {
    v6 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
    if ( !v6 )
      return 0;
    *(_DWORD *)(a2 + 8) = v6;
  }
  v7 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_WORD *)(*(_DWORD *)a2 + v7) = *(_WORD *)(a3 + 16);
  }
  else
  {
    *(_BYTE *)(v7 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 17);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)(a3 + 16);
  }
  v9 = *(_DWORD *)(a2 + 4);
  v10 = *(_DWORD *)a2 + 4;
  v8 = a3 + 18;
  *(_DWORD *)a2 += 2;
  if ( v10 > v9 )
  {
    do
    {
      v11 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v11 )
        return 0;
      *(_DWORD *)(a2 + 8) = v11;
      *(_DWORD *)(a2 + 4) += 4096;
    }
    while ( *(_DWORD *)a2 + 2 > *(_DWORD *)(a2 + 4) );
  }
  v12 = *(_DWORD *)(a2 + 8);
  if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
  {
    *(_WORD *)(*(_DWORD *)a2 + v12) = *(_WORD *)v8;
    *(_DWORD *)a2 += 2;
    result = 1;
  }
  else
  {
    *(_BYTE *)(v12 + *(_DWORD *)a2) = *(_BYTE *)(a3 + 19);
    *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)v8;
    *(_DWORD *)a2 += 2;
    result = 1;
  }
  return result;
}

//----- (100032B0) --------------------------------------------------------
signed int __cdecl sub_100032B0(int a1, int a2, int a3, int a4)
{
  int v4; // ST0C_4@1
  int v5; // eax@2
  int v6; // eax@7
  int v7; // ecx@7
  int v8; // edx@9
  signed int result; // eax@10

  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  if ( sub_10002EF0(a1, a2, a3, v4)
    && (v5 = *(_DWORD *)a4, *(_DWORD *)a4 + 2 <= *(_DWORD *)a2)
    && v5 >= 0
    && (*(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70) ? (*(_WORD *)(a3 + 16) = *(_WORD *)(*(_DWORD *)(a2 + 8) + v5)) : (*(_BYTE *)(a3 + 17) = *(_BYTE *)(v5 + *(_DWORD *)(a2 + 8)), *(_BYTE *)(a3 + 16) = *(_BYTE *)(v5 + *(_DWORD *)(a2 + 8) + 1)),
        (v6 = *(_DWORD *)a4 + 2, *(_DWORD *)a4 = v6, v7 = a3 + 18, v6 + 2 <= *(_DWORD *)a2) && v6 >= 0) )
  {
    v8 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 70) )
    {
      *(_WORD *)v7 = *(_WORD *)(v6 + v8);
      *(_DWORD *)a4 += 2;
      result = 1;
    }
    else
    {
      *(_BYTE *)(a3 + 19) = *(_BYTE *)(v6 + v8);
      *(_BYTE *)v7 = *(_BYTE *)(v6 + *(_DWORD *)(a2 + 8) + 1);
      *(_DWORD *)a4 += 2;
      result = 1;
    }
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (100033A0) --------------------------------------------------------
signed int __cdecl sub_100033A0(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  signed int result; // eax@2
  int v6; // edi@3
  __int16 v7; // bx@4
  void *v8; // eax@5
  int v9; // eax@6
  char v10; // [sp+3h] [bp-5h]@1

  v4 = a1;
  v10 = *(_BYTE *)(a1 + 69);
  if ( a3 )
  {
    v6 = 0;
    *(_BYTE *)(a1 + 69) = 16;
    if ( a4 <= 0 )
    {
LABEL_12:
      *(_BYTE *)(v4 + 69) = v10;
      result = 1;
    }
    else
    {
      while ( 1 )
      {
        v7 = *(_BYTE *)(v6 + a3);
        if ( *(_DWORD *)a2 + 2 > *(_DWORD *)(a2 + 4) )
          break;
LABEL_8:
        if ( *(_BYTE *)(v4 + 68) == *(_BYTE *)(v4 + 69) )
        {
          *(_WORD *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = v7;
        }
        else
        {
          *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = HIBYTE(v7);
          *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = v7;
        }
        ++v6;
        *(_DWORD *)a2 += 2;
        if ( v6 >= a4 )
          goto LABEL_12;
      }
      while ( 1 )
      {
        v8 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
        if ( !v8 )
          break;
        *(_DWORD *)(a2 + 8) = v8;
        v9 = *(_DWORD *)(a2 + 4) + 4096;
        *(_DWORD *)(a2 + 4) = v9;
        if ( *(_DWORD *)a2 + 2 <= v9 )
        {
          v4 = a1;
          goto LABEL_8;
        }
      }
      result = 0;
    }
  }
  else
  {
    result = 1;
  }
  return result;
}

//----- (10003490) --------------------------------------------------------
signed int __cdecl sub_10003490(int a1, int a2, int a3, unsigned int a4, int a5)
{
  signed int result; // eax@2

  if ( a5 )
    result = sub_100033A0(a1, a2, a3, a4);
  else
    result = sub_100025E0(a1, a2, (const void *)a3, a4);
  return result;
}

//----- (100034E0) --------------------------------------------------------
bool __cdecl sub_100034E0(int a1, int a2, const void *a3)
{
  *(_DWORD *)a2 = 0;
  return sub_100025E0(a1, a2, a3, strlen((const char *)a3) + 1) != 0;
}

//----- (10003520) --------------------------------------------------------
void *__cdecl sub_10003520(int a1, int a2)
{
  void *result; // eax@2
  int i; // eax@5
  int v4; // ecx@5

  if ( 2 * *(_DWORD *)a1 > *(_DWORD *)(a2 + 4) )
  {
    result = realloc(*(void **)(a2 + 8), 2 * *(_DWORD *)a1);
    *(_DWORD *)(a2 + 8) = result;
    if ( !result )
      return result;
    *(_DWORD *)(a2 + 4) = *(_DWORD *)a2 + 2 * *(_DWORD *)a1;
  }
  v4 = *(_DWORD *)(a2 + 8);
  *(_DWORD *)a2 = 2 * *(_DWORD *)a1;
  for ( i = 0; i < *(_DWORD *)a1; ++i )
  {
    *(_BYTE *)(v4 + 2 * i) = *(_BYTE *)(i + *(_DWORD *)(a1 + 8));
    *(_BYTE *)(v4 + 2 * i + 1) = 0;
  }
  return (void *)1;
}

//----- (10003590) --------------------------------------------------------
signed int __cdecl sub_10003590(int a1)
{
  signed int result; // eax@1
  int v2; // esi@3
  int v3; // esi@3
  int v4; // esi@3
  int v5; // eax@3
  char v6; // zf@3

  result = *(_DWORD *)(a1 + 2244);
  if ( result )
  {
    *(_DWORD *)(a1 + 2244) = result + 4;
  }
  else
  {
    v3 = (((int (__thiscall *)(int))rand)(a1) & 0x3F) << 16;
    v4 = ((unsigned __int8)rand() << 8) + v3;
    v5 = rand() & 0xF8;
    v6 = v5 + v4 == 0;
    v2 = v5 + v4;
    result = 1588392;
    if ( !v6 )
      result = v2;
  }
  return result;
}

//----- (100035E0) --------------------------------------------------------
signed int __cdecl sub_100035E0(int a1, int a2, signed int a3)
{
  signed int result; // eax@2
  int v4; // edx@3

  if ( a3 > 1 )
  {
    v4 = *(_DWORD *)a2 % a3;
    if ( v4 )
      result = sub_100023F0(a1, a2, a3 - v4);
    else
      result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (10003620) --------------------------------------------------------
signed int __cdecl sub_10003620(int a1, int a2, int a3)
{
  void *v3; // eax@2
  int v4; // edx@4
  signed int result; // eax@5

  if ( *(_DWORD *)a2 + 4 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_4:
    v4 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)a2 + v4) = a3;
      *(_DWORD *)a2 += 4;
      result = 1;
    }
    else
    {
      *(_BYTE *)(v4 + *(_DWORD *)a2) = BYTE3(a3);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = BYTE2(a3);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 2) = BYTE1(a3);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 3) = a3;
      *(_DWORD *)a2 += 4;
      result = 1;
    }
  }
  else
  {
    while ( 1 )
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        break;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) += 4096;
      if ( *(_DWORD *)a2 + 4 <= *(_DWORD *)(a2 + 4) )
        goto LABEL_4;
    }
    result = 0;
  }
  return result;
}

//----- (100036C0) --------------------------------------------------------
signed int __cdecl sub_100036C0(int a1, int a2, __int16 a3)
{
  void *v3; // eax@2
  int v4; // edx@4
  signed int result; // eax@5

  if ( *(_DWORD *)a2 + 2 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_4:
    v4 = *(_DWORD *)(a2 + 8);
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_WORD *)(*(_DWORD *)a2 + v4) = a3;
      *(_DWORD *)a2 += 2;
      result = 1;
    }
    else
    {
      *(_BYTE *)(v4 + *(_DWORD *)a2) = HIBYTE(a3);
      *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = a3;
      *(_DWORD *)a2 += 2;
      result = 1;
    }
  }
  else
  {
    while ( 1 )
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        break;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) += 4096;
      if ( *(_DWORD *)a2 + 2 <= *(_DWORD *)(a2 + 4) )
        goto LABEL_4;
    }
    result = 0;
  }
  return result;
}

//----- (10003750) --------------------------------------------------------
signed int __cdecl sub_10003750(int a1, int a2, char a3)
{
  void *v3; // eax@2
  signed int result; // eax@4

  if ( *(_DWORD *)a2 + 1 <= *(_DWORD *)(a2 + 4) )
  {
LABEL_4:
    *(_BYTE *)(*(_DWORD *)a2++ + *(_DWORD *)(a2 + 8)) = a3;
    result = 1;
  }
  else
  {
    while ( 1 )
    {
      v3 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v3 )
        break;
      *(_DWORD *)(a2 + 8) = v3;
      *(_DWORD *)(a2 + 4) += 4096;
      if ( *(_DWORD *)a2 + 1 <= *(_DWORD *)(a2 + 4) )
        goto LABEL_4;
    }
    result = 0;
  }
  return result;
}

//----- (100037B0) --------------------------------------------------------
signed int __cdecl sub_100037B0(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // esi@1
  signed int v5; // ebx@4
  void *v6; // eax@5
  signed int result; // eax@8
  void *v8; // eax@11
  signed int i; // [sp+14h] [bp+8h]@4

  v4 = a2;
  v3 = *(_DWORD *)a2 % 4;
  if ( v3 && !sub_100023F0(a1, a2, 4 - v3) )
    return 0;
  if ( a3 )
  {
    v5 = sub_10003590(a1);
    for ( i = v5; *(_DWORD *)v4 + 4 > *(_DWORD *)(v4 + 4); *(_DWORD *)(v4 + 8) = v6 )
    {
      v6 = realloc(*(void **)(v4 + 8), *(_DWORD *)(v4 + 4) + 4096);
      if ( !v6 )
        return 0;
      *(_DWORD *)(v4 + 4) += 4096;
    }
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)v4 + *(_DWORD *)(v4 + 8)) = v5;
      *(_DWORD *)v4 += 4;
      result = 1;
    }
    else
    {
      *(_BYTE *)(*(_DWORD *)v4 + *(_DWORD *)(v4 + 8)) = BYTE3(i);
      *(_BYTE *)(*(_DWORD *)v4 + *(_DWORD *)(v4 + 8) + 1) = BYTE2(i);
      *(_BYTE *)(*(_DWORD *)v4 + *(_DWORD *)(v4 + 8) + 2) = BYTE1(v5);
      *(_BYTE *)(*(_DWORD *)v4 + *(_DWORD *)(v4 + 8) + 3) = v5;
      *(_DWORD *)v4 += 4;
      result = 1;
    }
  }
  else
  {
    for ( ; *(_DWORD *)a2 + 4 > *(_DWORD *)(a2 + 4); *(_DWORD *)(a2 + 8) = v8 )
    {
      v8 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v8 )
        return 0;
      *(_DWORD *)(a2 + 4) += 4096;
    }
    if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
    {
      *(_DWORD *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = 0;
      *(_DWORD *)a2 += 4;
      result = 1;
    }
    else
    {
      *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) = 0;
      *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = 0;
      *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 2) = 0;
      *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 3) = 0;
      *(_DWORD *)a2 += 4;
      result = 1;
    }
  }
  return result;
}

//----- (10003930) --------------------------------------------------------
signed int __cdecl sub_10003930(int a1, int a2, int a3, int a4)
{
  int v4; // eax@1
  signed int result; // eax@3

  v4 = *(_DWORD *)a3;
  if ( *(_DWORD *)a3 + 1 > *(_DWORD *)a2 || v4 < 0 )
  {
    result = 0;
  }
  else
  {
    *(_BYTE *)a4 = *(_BYTE *)(v4 + *(_DWORD *)(a2 + 8));
    ++*(_DWORD *)a3;
    result = 1;
  }
  return result;
}

//----- (10003970) --------------------------------------------------------
signed int __cdecl sub_10003970(int a1, int a2, int a3, signed int a4, int a5)
{
  int v5; // ebp@1
  int v6; // ebx@2
  void *v7; // eax@4
  int v8; // edx@6

  v5 = 0;
  *(_DWORD *)a2 = 0;
  if ( a4 / 2 > 0 )
  {
    v6 = a3;
    while ( *(_DWORD *)a2 + 2 <= *(_DWORD *)(a2 + 4) )
    {
LABEL_6:
      v8 = *(_DWORD *)(a2 + 8);
      if ( *(_BYTE *)(a1 + 68) == *(_BYTE *)(a1 + 69) )
      {
        *(_WORD *)(*(_DWORD *)a2 + v8) = *(_WORD *)v6;
      }
      else
      {
        *(_BYTE *)(v8 + *(_DWORD *)a2) = *(_BYTE *)(v6 + 1);
        *(_BYTE *)(*(_DWORD *)(a2 + 8) + *(_DWORD *)a2 + 1) = *(_BYTE *)v6;
      }
      ++v5;
      v6 += 2;
      *(_DWORD *)a2 += 2;
      if ( v5 >= a4 / 2 )
        goto LABEL_10;
    }
    while ( 1 )
    {
      v7 = realloc(*(void **)(a2 + 8), *(_DWORD *)(a2 + 4) + 4096);
      if ( !v7 )
        return 0;
      *(_DWORD *)(a2 + 8) = v7;
      *(_DWORD *)(a2 + 4) += 4096;
      if ( *(_DWORD *)a2 + 2 <= *(_DWORD *)(a2 + 4) )
        goto LABEL_6;
    }
  }
LABEL_10:
  if ( a5 && (_WORD)a4 + *(_WORD *)(a2 + 8) != 2 && !sub_100036C0(a1, a2, 0) )
    return 0;
  return 1;
}

//----- (10003A60) --------------------------------------------------------
signed int __cdecl sub_10003A60(int a1, int a2, int a3, signed int a4)
{
  char v4; // zf@1
  int v5; // eax@1
  char v6; // sf@1
  signed int result; // eax@4
  int v8; // [sp+8h] [bp-1Ch]@1
  int v9; // [sp+Ch] [bp-18h]@1
  int v10; // [sp+10h] [bp-14h]@1
  int v11; // [sp+14h] [bp-10h]@1
  int v12; // [sp+18h] [bp-Ch]@1
  int v13; // [sp+1Ch] [bp-8h]@1
  int v14; // [sp+20h] [bp-4h]@1

  v13 = a4 / 2;
  v11 = a4 / 2;
  v14 = a3;
  v5 = *(_DWORD *)a2 & 0x80000003;
  v4 = (*(_DWORD *)a2 & 0x80000003) == 0;
  v6 = (*(_DWORD *)a2 & 0x80000003) < 0;
  v12 = 0;
  v8 = 2;
  v10 = 3;
  v9 = -1;
  if ( v6 )
  {
    v5 = ((v5 - 1) | 0xFFFFFFFC) + 1;
    v4 = v5 == 0;
  }
  if ( v4 || (result = sub_100023F0(a1, a2, 4 - v5)) != 0 )
    result = sub_10002A60(a1, a2, (int)&v8, (int)&v11);
  return result;
}

//----- (10003AF0) --------------------------------------------------------
signed int __cdecl sub_10003AF0(int a1, int a2, const void *a3, int a4, unsigned int a5)
{
  char v5; // zf@1
  int v6; // eax@1
  char v7; // sf@1
  signed int result; // eax@6
  int v9; // [sp+8h] [bp-18h]@1
  int v10; // [sp+Ch] [bp-14h]@1
  int v11; // [sp+10h] [bp-10h]@1
  int v12; // [sp+14h] [bp-Ch]@1
  int v13; // [sp+18h] [bp-8h]@1
  int v14; // [sp+1Ch] [bp-4h]@1

  v12 = 1;
  v14 = 1;
  v9 = a4;
  v11 = a4;
  v6 = *(_DWORD *)a2 & 0x80000003;
  v5 = (*(_DWORD *)a2 & 0x80000003) == 0;
  v7 = (*(_DWORD *)a2 & 0x80000003) < 0;
  v13 = -1;
  v10 = 0;
  if ( v7 )
  {
    v6 = ((v6 - 1) | 0xFFFFFFFC) + 1;
    v5 = v6 == 0;
  }
  if ( (v5 || sub_100023F0(a1, a2, 4 - v6)) && sub_10002730(a1, a2, (int)&v12, (int)&v9) )
    result = sub_100025E0(a1, a2, a3, a5);
  else
    result = 0;
  return result;
}

//----- (10003B90) --------------------------------------------------------
bool __cdecl sub_10003B90(int a1, int a2, int a3, int *a4)
{
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  return sub_10002660(a1, a2, (void *)a3, a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 4), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 5), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 6), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 7), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 8), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 10), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 12), a4, 4u)
      && *(_BYTE *)a3 == 5
      && !*(_BYTE *)(a3 + 1);
}

//----- (10003CE0) --------------------------------------------------------
bool __cdecl sub_10003CE0(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 3), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 4), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 5), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 6), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 7), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 8), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 10), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 12), 4u);
}

//----- (10003DF0) --------------------------------------------------------
bool __cdecl sub_10003DF0(int a1, int a2, int a3)
{
  return sub_10003CE0(a1, a2, a3)
      && sub_10002470(a1, a2, (const void *)(a3 + 16), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 18), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 20), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 24), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 26), 2u);
}

//----- (10003E90) --------------------------------------------------------
signed int __cdecl sub_10003E90(int a1, int a2, int a3, int a4)
{
  int v4; // esi@2
  signed int v5; // ebx@7
  int v6; // edi@8
  unsigned __int8 v7; // sf@11
  unsigned __int8 v8; // of@11
  signed int result; // eax@12
  int v10; // [sp+10h] [bp-4h]@1

  v10 = 0;
  if ( a3 <= 0 )
  {
LABEL_12:
    result = 1;
  }
  else
  {
    v4 = a4 + 2;
    while ( sub_10002470(a1, a2, (const void *)(v4 - 2), 2u)
         && sub_10002470(a1, a2, (const void *)v4, 1u)
         && sub_10002470(a1, a2, (const void *)(v4 + 1), 1u)
         && sub_10003190(a1, a2, v4 + 2) )
    {
      v5 = 0;
      if ( *(_BYTE *)v4 )
      {
        v6 = v4 + 22;
        while ( sub_10003190(a1, a2, v6) )
        {
          ++v5;
          v6 += 20;
          if ( v5 >= *(_BYTE *)v4 )
            goto LABEL_11;
        }
        break;
      }
LABEL_11:
      v4 += 84;
      v8 = __SETO__(v10 + 1, a3);
      v7 = v10++ + 1 - a3 < 0;
      if ( !(v7 ^ v8) )
        goto LABEL_12;
    }
    result = 0;
  }
  return result;
}

//----- (10003F60) --------------------------------------------------------
bool __cdecl sub_10003F60(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 3), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 4), 4u);
}

//----- (10003FE0) --------------------------------------------------------
bool __cdecl sub_10003FE0(int a1, int a2, int a3, int *a4)
{
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  return sub_10002660(a1, a2, (void *)a3, a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 4), a4, 4u);
}

//----- (10004080) --------------------------------------------------------
bool __cdecl sub_10004080(int a1, int a2, int a3)
{
  return sub_10003CE0(a1, a2, a3)
      && sub_10002470(a1, a2, (const void *)(a3 + 16), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 18), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 20), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 21), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 22), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 24), 4u);
}

//----- (10004130) --------------------------------------------------------
bool __cdecl sub_10004130(int a1, int a2, int a3)
{
  return sub_10003CE0(a1, a2, a3)
      && sub_10002470(a1, a2, (const void *)(a3 + 16), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 20), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 22), 2u);
}

//----- (100041A0) --------------------------------------------------------
signed int __cdecl sub_100041A0(int a1, int a2, int a3, int *a4)
{
  int v4; // edi@1
  unsigned __int16 v5; // ax@5
  void *v6; // eax@7
  signed int v7; // eax@10
  void *v8; // eax@13
  void *v10; // edi@15
  unsigned __int8 v11; // sf@19
  unsigned __int8 v12; // of@19
  int v13; // [sp+10h] [bp-4h]@15
  int v14; // [sp+20h] [bp+Ch]@9

  v4 = a3;
  *(_WORD *)(a3 + 16) = 0;
  *(_WORD *)(a3 + 18) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_WORD *)(a3 + 24) = 0;
  *(_DWORD *)(a3 + 34) = 0;
  *(_DWORD *)(a3 + 26) = 0;
  if ( sub_10002660(a1, a2, (void *)(a3 + 16), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 18), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 20), a4, 4u)
    && sub_10002660(a1, a2, (void *)(a3 + 24), a4, 2u) )
  {
    v5 = *(_WORD *)(a3 + 24);
    if ( v5 > 0x2000u )
      return -12;
    if ( !v5 )
      goto LABEL_25;
    v6 = sub_10008320(v5);
    *(_DWORD *)(a3 + 26) = v6;
    if ( !v6 )
      return -17;
    if ( sub_100026B0(a1, a2, v6, (int)a4, *(_WORD *)(a3 + 24)) )
    {
LABEL_25:
      *a4 = (*a4 + 3) & 0xFFFFFFFC;
      v14 = a3 + 30;
      *(_DWORD *)(v4 + 30) = 0;
      if ( sub_10002660(a1, a2, (void *)(v4 + 30), a4, 4u) )
      {
        v7 = *(_DWORD *)v14;
        if ( *(_DWORD *)v14 <= 8192 && v7 >= 1 )
        {
          if ( !v7 )
            return 1;
          v8 = sub_10008320(24 * v7);
          *(_DWORD *)(v4 + 34) = v8;
          if ( !v8 )
            return -17;
          v10 = v8;
          v13 = 0;
          if ( *(_DWORD *)v14 <= 0 )
            return 1;
          while ( 1 )
          {
            *(_WORD *)v10 = 0;
            *((_WORD *)v10 + 1) = 0;
            if ( !sub_10002660(a1, a2, v10, a4, 2u) )
              break;
            if ( !sub_10002660(a1, a2, (char *)v10 + 2, a4, 2u)
              || !sub_100032B0(a1, a2, (int)((char *)v10 + 4), (int)a4) )
              break;
            v10 = (char *)v10 + 24;
            v12 = __SETO__(v13 + 1, *(_DWORD *)v14);
            v11 = v13++ + 1 - *(_DWORD *)v14 < 0;
            if ( !(v11 ^ v12) )
              return 1;
          }
          return -11;
        }
        return -12;
      }
    }
  }
  return -11;
}

//----- (10004370) --------------------------------------------------------
bool __cdecl sub_10004370(int a1, int a2, int a3, int *a4)
{
  void *v4; // ebp@1
  int v5; // eax@1
  int v6; // ecx@1
  void *v7; // ST08_4@1
  void *v9; // [sp+10h] [bp-8h]@1
  void *v10; // [sp+14h] [bp-4h]@1
  void *v11; // [sp+24h] [bp+Ch]@1

  v5 = a3;
  v6 = a3 + 16;
  v7 = (void *)(a3 + 16);
  v4 = (void *)(a3 + 20);
  v11 = (void *)(a3 + 22);
  *(_BYTE *)v11 = 0;
  *(_DWORD *)v6 = 0;
  *(_WORD *)v4 = 0;
  v9 = (void *)(v5 + 23);
  *(_BYTE *)(v5 + 23) = 0;
  v10 = (void *)(v5 + 24);
  *(_DWORD *)(v5 + 24) = 0;
  return sub_10002660(a1, a2, v7, a4, 4u)
      && sub_10002660(a1, a2, v4, a4, 2u)
      && sub_10002660(a1, a2, v11, a4, 1u)
      && sub_10002660(a1, a2, v9, a4, 1u)
      && sub_10002660(a1, a2, v10, a4, 4u);
}

//----- (10004440) --------------------------------------------------------
bool __cdecl sub_10004440(int a1, int a2, int a3, int *a4)
{
  return sub_10002660(a1, a2, (void *)(a3 + 16), a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 20), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 22), a4, 2u);
}

//----- (100044B0) --------------------------------------------------------
bool __cdecl sub_100044B0(int a1, int a2, int a3, int *a4)
{
  void *v4; // ebp@1
  void *v5; // ST08_4@1
  int v6; // eax@1
  void *v8; // [sp+10h] [bp-4h]@1
  void *v9; // [sp+20h] [bp+Ch]@1

  v5 = (void *)(a3 + 16);
  v4 = (void *)(a3 + 20);
  v6 = a3 + 23;
  *(_DWORD *)(a3 + 16) = 0;
  *(_WORD *)(a3 + 20) = 0;
  v9 = (void *)(a3 + 22);
  *(_BYTE *)v9 = 0;
  v8 = (void *)v6;
  *(_BYTE *)v6 = 0;
  return sub_10002660(a1, a2, v5, a4, 4u)
      && sub_10002660(a1, a2, v4, a4, 2u)
      && sub_10002660(a1, a2, v9, a4, 1u)
      && sub_10002660(a1, a2, v8, a4, 1u);
}

//----- (10004550) --------------------------------------------------------
int __cdecl sub_10004550(int a1, int a2)
{
  int v2; // ebp@1
  int v3; // esi@1
  int result; // eax@3
  unsigned int v5; // eax@14
  void *v6; // eax@15
  void *v7; // edi@17
  unsigned __int16 v8; // ax@21
  int v9; // ecx@21
  int v10; // [sp+10h] [bp-Ch]@1
  int v11; // [sp+14h] [bp-8h]@1
  int v12; // [sp+18h] [bp-4h]@1

  v3 = a1;
  v11 = 1;
  v10 = 0;
  v12 = 8;
  v2 = a1 + 1232;
  while ( !*(_DWORD *)v2 )
  {
    result = sub_100061C0(*(_DWORD *)v3, a2, *(struct timeval *)(v3 + 8));
    v11 = result;
    if ( result != 1 )
      return result;
    if ( !*(_DWORD *)(v3 + 1244) )
    {
      if ( !strncmp(*(const char **)(a2 + 8), "ncacn_http", 0xAu) )
      {
        memcpy(*(void **)(a2 + 8), (const void *)(*(_DWORD *)(a2 + 8) + 14), *(_DWORD *)a2 - 14);
        v3 = a1;
        *(_DWORD *)a2 -= 14;
      }
      if ( *(_DWORD *)a2 < 10 )
      {
        v11 = sub_100061C0(*(_DWORD *)v3, a2, *(struct timeval *)(v3 + 8));
        if ( v11 != 1 )
          return v11;
      }
    }
    v12 = 8;
    if ( !sub_10002660(v3, a2, &v10, &v12, 2u) )
      return -8;
LABEL_21:
    v8 = v10;
    v9 = (unsigned __int16)v10;
    *(_DWORD *)(v3 + 1244) = 1;
    if ( *(_DWORD *)a2 >= v9 )
    {
      if ( *(_DWORD *)a2 > (signed int)v8 )
      {
        if ( !sub_100025E0(v3, v2, (const void *)(v8 + *(_DWORD *)(a2 + 8)), *(_DWORD *)a2 - v8) )
          v11 = -17;
        *(_DWORD *)a2 = (unsigned __int16)v10;
      }
      return v11;
    }
  }
  if ( *(_DWORD *)v2 < 10 )
  {
    v11 = sub_100061C0(*(_DWORD *)v3, v2, *(struct timeval *)(v3 + 8));
    if ( v11 != 1 )
      return v11;
  }
  v12 = 8;
  if ( !sub_10002660(v3, v2, &v10, &v12, 2u) )
    return -8;
  v5 = (unsigned __int16)v10;
  if ( *(_DWORD *)(a2 + 4) >= (signed int)(unsigned __int16)v10 )
  {
LABEL_17:
    v7 = *(void **)(a2 + 8);
    if ( *(_DWORD *)v2 <= (signed int)v5 )
    {
      memcpy(v7, *(const void **)(a1 + 1240), *(_DWORD *)v2);
      *(_DWORD *)a2 = *(_DWORD *)v2;
      *(_DWORD *)v2 = 0;
    }
    else
    {
      *(_DWORD *)a2 = v5;
      memcpy(v7, *(const void **)(a1 + 1240), v5);
      memcpy(
        *(void **)(a1 + 1240),
        (const void *)(*(_DWORD *)(a1 + 1240) + (unsigned __int16)v10),
        *(_DWORD *)(a1 + 1232) - (unsigned __int16)v10);
      *(_DWORD *)v2 -= (unsigned __int16)v10;
    }
    v3 = a1;
    goto LABEL_21;
  }
  v6 = realloc(*(void **)(a2 + 8), (unsigned __int16)v10);
  if ( v6 )
  {
    *(_DWORD *)(a2 + 8) = v6;
    v5 = (unsigned __int16)v10;
    *(_DWORD *)(a2 + 4) = (unsigned __int16)v10;
    goto LABEL_17;
  }
  return -17;
}

//----- (10004790) --------------------------------------------------------
int __cdecl sub_10004790(int a1, int a2, int a3)
{
  int result; // eax@1

  result = sub_10006130(*(_DWORD *)a1, a2);
  if ( result == 1 )
  {
    *(_DWORD *)a3 = 0;
    result = sub_10004550(a1, a3);
  }
  return result;
}

//----- (100047D0) --------------------------------------------------------
signed int __cdecl sub_100047D0(int a1, int a2, signed int a3, int a4)
{
  int v4; // edi@1
  int v5; // ecx@3
  __int16 v6; // ax@3
  int v7; // edx@3
  int v8; // eax@3
  int v9; // edx@4
  int v10; // ebp@4
  int v11; // eax@5
  unsigned __int8 v12; // al@6
  char v13; // cl@7
  int v14; // edx@7
  signed int result; // eax@14
  signed int v16; // [sp+8h] [bp-5Ch]@1
  int v17; // [sp+Ch] [bp-58h]@1
  int v18; // [sp+10h] [bp-54h]@1
  char v19; // [sp+14h] [bp-50h]@3
  char v20; // [sp+15h] [bp-4Fh]@3
  char v21; // [sp+16h] [bp-4Eh]@3
  char v22; // [sp+17h] [bp-4Dh]@3
  char v23; // [sp+18h] [bp-4Ch]@3
  char v24; // [sp+19h] [bp-4Bh]@3
  char v25; // [sp+1Ah] [bp-4Ah]@3
  char v26; // [sp+1Bh] [bp-49h]@3
  __int16 v27; // [sp+1Ch] [bp-48h]@6
  _BYTE v28[6]; // [sp+1Eh] [bp-46h]@3
  __int16 v29; // [sp+24h] [bp-40h]@3
  __int16 v30; // [sp+26h] [bp-3Eh]@3
  int v31; // [sp+28h] [bp-3Ch]@3
  __int16 v32; // [sp+2Ch] [bp-38h]@3
  __int16 v33; // [sp+2Eh] [bp-36h]@3
  char v34; // [sp+34h] [bp-30h]@1
  char v35; // [sp+70h] [bp+Ch]@3

  memset(&v34, 0, 0x30u);
  v4 = a3;
  v17 = 0;
  v16 = 1;
  v18 = 0;
  if ( a3 <= 0 || a3 > 32 )
  {
    result = -12;
  }
  else
  {
    v6 = *(_WORD *)(a1 + 1216);
    v7 = *(_DWORD *)(a1 + 1204);
    v35 = *(_BYTE *)(a1 + 69);
    *(_BYTE *)(a1 + 69) = 16;
    *(_WORD *)(a1 + 1218) = v6;
    *(_WORD *)(a1 + 1220) = v6;
    v23 = 16;
    v29 = v6;
    v30 = v6;
    v8 = *(_DWORD *)(a1 + 1072);
    v5 = 0;
    v19 = 5;
    v20 = 0;
    v21 = 11;
    v22 = 3;
    v24 = 0;
    v25 = 0;
    v26 = 0;
    *(_DWORD *)&v28[2] = v7;
    v31 = v8;
    v32 = v4;
    v33 = 0;
    *(_WORD *)v28 = 0;
    if ( v4 > 0 )
    {
      v9 = a4 + 2;
      v10 = v4;
      do
      {
        v11 = 5 * *(_BYTE *)v9;
        v9 += 84;
        --v10;
        v5 += 4 * v11 + 24;
      }
      while ( v10 );
    }
    v12 = *(_BYTE *)(a1 + 2292);
    v27 = v5 + 28;
    if ( (char)v12 >= 2 )
    {
      v13 = *(_BYTE *)(a1 + 2293);
      v14 = *(_DWORD *)(a1 + 2672);
      *(_WORD *)((char *)&v17 + 1) = v12;
      LOBYTE(v17) = v13;
      BYTE3(v17) = 0;
      v18 = v14;
      sub_10008780(a1, (int)&v34);
      *(_WORD *)v28 = sub_100088B0(a1, (int)&v34);
      v27 += *(_WORD *)v28 + 8;
    }
    if ( !sub_10003DF0(a1, a2, (int)&v19)
      || !sub_10003E90(a1, a2, v4, a4)
      || BYTE1(v17) >= 2u && (!sub_10003F60(a1, a2, (int)&v17) || !sub_10008840(a1, a2, (int)&v34)) )
      v16 = -17;
    result = v16;
    *(_BYTE *)(a1 + 69) = v35;
  }
  return result;
}

//----- (10004980) --------------------------------------------------------
signed int __cdecl sub_10004980(int a1, int a2, int a3, int a4, int a5)
{
  __int16 v5; // ax@3
  int v6; // eax@3
  char v7; // cl@3
  int v8; // edx@3
  int v9; // edx@4
  int v10; // ebp@4
  int v11; // ecx@5
  char v12; // dl@8
  int v13; // eax@8
  signed int result; // eax@15
  char v15; // [sp+Fh] [bp-89h]@3
  char v16; // [sp+10h] [bp-88h]@8
  char v17; // [sp+11h] [bp-87h]@8
  char v18; // [sp+12h] [bp-86h]@8
  char v19; // [sp+13h] [bp-85h]@8
  int v20; // [sp+14h] [bp-84h]@8
  char v21; // [sp+18h] [bp-80h]@3
  char v22; // [sp+19h] [bp-7Fh]@3
  char v23; // [sp+1Ah] [bp-7Eh]@3
  char v24; // [sp+1Bh] [bp-7Dh]@3
  char v25; // [sp+1Ch] [bp-7Ch]@3
  char v26; // [sp+1Dh] [bp-7Bh]@3
  char v27; // [sp+1Eh] [bp-7Ah]@3
  char v28; // [sp+1Fh] [bp-79h]@3
  __int16 v29; // [sp+20h] [bp-78h]@6
  _BYTE v30[6]; // [sp+22h] [bp-76h]@3
  __int16 v31; // [sp+28h] [bp-70h]@3
  __int16 v32; // [sp+2Ah] [bp-6Eh]@3
  int v33; // [sp+2Ch] [bp-6Ch]@3
  int v34; // [sp+30h] [bp-68h]@3
  char v35; // [sp+38h] [bp-60h]@8

  if ( a3 <= 0 || a3 + *(_DWORD *)(a1 + 348) > 32 )
  {
    result = -12;
  }
  else
  {
    v5 = *(_WORD *)(a1 + 1216);
    v7 = *(_BYTE *)(a1 + 69);
    v8 = *(_DWORD *)(a1 + 1204);
    *(_WORD *)(a1 + 1218) = v5;
    *(_WORD *)(a1 + 1220) = v5;
    v31 = v5;
    v32 = v5;
    v15 = v7;
    v33 = *(_DWORD *)(a1 + 1072);
    v6 = 0;
    *(_BYTE *)(a1 + 69) = 16;
    v21 = 5;
    v22 = 0;
    v23 = 14;
    v24 = 3;
    v25 = 16;
    v26 = 0;
    v27 = 0;
    v28 = 0;
    *(_DWORD *)&v30[2] = v8;
    v34 = (unsigned __int16)a3;
    *(_WORD *)v30 = 0;
    if ( a3 > 0 )
    {
      v9 = a4 + 2;
      v10 = a3;
      do
      {
        v11 = 5 * *(_BYTE *)v9;
        v9 += 84;
        --v10;
        v6 += 4 * v11 + 24;
      }
      while ( v10 );
    }
    v29 = v6 + 28;
    if ( *(_BYTE *)(a1 + 2292) >= 2 )
    {
      if ( a5 )
      {
        v12 = *(_BYTE *)(a1 + 2293);
        v17 = *(_BYTE *)(a1 + 2292);
        v13 = *(_DWORD *)(a1 + 2672);
        v16 = v12;
        v18 = 0;
        v19 = 0;
        v20 = v13;
        sub_100087C0(a1, &v35, a5);
        *(_WORD *)v30 = sub_10008900(a1, (int)&v35);
        v29 += *(_WORD *)v30 + 8;
      }
    }
    if ( sub_10003DF0(a1, a2, (int)&v21) )
    {
      if ( sub_10003E90(a1, a2, a3, a4) )
      {
        if ( *(_BYTE *)(a1 + 2292) >= 2 )
        {
          if ( a5 )
          {
            if ( sub_10003F60(a1, a2, (int)&v16) )
              sub_10008880(a1, a2, (int)&v35);
          }
        }
      }
    }
    *(_BYTE *)(a1 + 69) = v15;
    result = 1;
  }
  return result;
}

//----- (10004B40) --------------------------------------------------------
signed int __cdecl sub_10004B40(int a1, int a2, int a3)
{
  int v3; // edx@1
  __int16 v4; // cx@1
  int v5; // eax@1
  __int16 v6; // ax@1
  signed int result; // eax@2
  char v8; // zf@2
  char v9; // [sp+8h] [bp-7Ch]@1
  char v10; // [sp+9h] [bp-7Bh]@1
  char v11; // [sp+Ah] [bp-7Ah]@1
  char v12; // [sp+Bh] [bp-79h]@1
  char v13; // [sp+Ch] [bp-78h]@1
  char v14; // [sp+Dh] [bp-77h]@1
  char v15; // [sp+Eh] [bp-76h]@1
  char v16; // [sp+Fh] [bp-75h]@1
  __int16 v17; // [sp+10h] [bp-74h]@1
  __int16 v18; // [sp+12h] [bp-72h]@1
  int v19; // [sp+14h] [bp-70h]@1
  __int16 v20; // [sp+18h] [bp-6Ch]@1
  __int16 v21; // [sp+1Ah] [bp-6Ah]@1
  char v22; // [sp+1Ch] [bp-68h]@1
  char v23; // [sp+1Dh] [bp-67h]@1
  __int16 v24; // [sp+1Eh] [bp-66h]@1
  int v25; // [sp+20h] [bp-64h]@1
  char v26; // [sp+24h] [bp-60h]@1

  v3 = *(_DWORD *)(a1 + 1204);
  v13 = *(_BYTE *)(a1 + 69);
  v4 = *(_WORD *)(a1 + 1220);
  v19 = v3;
  LOWORD(v3) = *(_WORD *)(a1 + 1218);
  v21 = v4;
  LOBYTE(v4) = *(_BYTE *)(a1 + 2292);
  v20 = v3;
  LOBYTE(v3) = *(_BYTE *)(a1 + 2293);
  v23 = v4;
  v22 = v3;
  v10 = 0;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v18 = 0;
  v24 = 0;
  v5 = *(_DWORD *)(a1 + 2672);
  v9 = 5;
  v11 = 16;
  v12 = 3;
  v25 = v5;
  sub_100087C0(a1, &v26, a3);
  v6 = sub_10008900(a1, (int)&v26);
  v17 = v6 + 28;
  v18 = v6;
  if ( !sub_10004080(a1, a2, (int)&v9) || (v8 = sub_10008880(a1, a2, (int)&v26) == 0, result = 1, v8) )
    result = -17;
  return result;
}

//----- (10004C40) --------------------------------------------------------
signed int __cdecl sub_10004C40(int a1, int a2, int a3)
{
  signed int v3; // esi@1
  int v4; // eax@2
  int v6; // [sp+10h] [bp-18h]@1
  int v7; // [sp+14h] [bp-14h]@1
  void *Memory; // [sp+18h] [bp-10h]@1
  int v9; // [sp+1Ch] [bp-Ch]@1
  int v10; // [sp+20h] [bp-8h]@1
  void *v11; // [sp+24h] [bp-4h]@1

  v7 = 0;
  v10 = 0;
  v6 = 0;
  Memory = 0;
  v9 = 0;
  v11 = 0;
  v3 = sub_10004B40(a1, a2, a3);
  if ( v3 == 1 )
  {
    v4 = *(_DWORD *)(a1 + 92);
    if ( v4 )
    {
      if ( v4 == 2 )
      {
        v6 = 0;
        v7 = 8192;
        Memory = sub_10008320(0x2000u);
        if ( !Memory )
        {
          v3 = -17;
          goto LABEL_13;
        }
        v9 = 0;
        v10 = 8192;
        v11 = sub_10008320(0x2000u);
        if ( v11 )
          v3 = sub_10008F00(a1, (int)&v6, (int)&v9, 0, 0, a2);
        else
          v3 = -17;
      }
      else
      {
        v3 = -14;
      }
    }
    else
    {
      v3 = sub_10006130(*(_DWORD *)a1, a2);
    }
  }
  if ( Memory )
  {
    free(Memory);
    Memory = 0;
  }
LABEL_13:
  if ( v11 )
    free(v11);
  return v3;
}

//----- (10004D40) --------------------------------------------------------
signed int __cdecl sub_10004D40(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  void *v7; // eax@1
  int v8; // edi@1
  signed int v9; // ebp@2
  char v10; // zf@3
  void *v11; // ecx@4
  int v12; // edx@4
  char v13; // zf@4
  signed int v14; // eax@5
  int v15; // edi@5
  int v16; // eax@11
  int i; // ecx@11
  void *v18; // eax@14
  char v19; // al@15
  char v20; // zf@15
  int v21; // eax@21
  int v22; // eax@23
  int v23; // eax@32
  int v24; // ecx@32
  signed int v25; // eax@34
  signed int v26; // eax@36
  int v27; // edi@36
  unsigned __int8 v28; // sf@38
  unsigned __int8 v29; // of@38
  unsigned __int16 v30; // ax@40
  unsigned __int16 v31; // dx@40
  int v32; // ecx@40
  int v33; // eax@47
  int v34; // ecx@47
  int v36; // [sp+8h] [bp-20Ch]@1
  int v37; // [sp+Ch] [bp-208h]@1
  void *Memory; // [sp+10h] [bp-204h]@1
  int v39; // [sp+14h] [bp-200h]@3
  int v40; // [sp+18h] [bp-1FCh]@1
  int v41; // [sp+1Ch] [bp-1F8h]@1
  int v42; // [sp+20h] [bp-1F4h]@1
  int v43; // [sp+24h] [bp-1F0h]@1
  int v44; // [sp+28h] [bp-1ECh]@1
  int v45; // [sp+2Ch] [bp-1E8h]@29
  int v46; // [sp+30h] [bp-1E4h]@31
  int v47; // [sp+34h] [bp-1E0h]@32
  int v48; // [sp+38h] [bp-1DCh]@1
  int v49; // [sp+3Ch] [bp-1D8h]@1
  int v50; // [sp+40h] [bp-1D4h]@1
  int v51; // [sp+44h] [bp-1D0h]@1
  int v52; // [sp+48h] [bp-1CCh]@1
  int v53; // [sp+4Ch] [bp-1C8h]@1
  int v54; // [sp+50h] [bp-1C4h]@1
  int v55; // [sp+54h] [bp-1C0h]@1
  int v56; // [sp+58h] [bp-1BCh]@1
  __int16 v57; // [sp+5Ch] [bp-1B8h]@1
  int v58; // [sp+60h] [bp-1B4h]@1
  int v59; // [sp+64h] [bp-1B0h]@1
  int v60; // [sp+68h] [bp-1ACh]@1
  int v61; // [sp+6Ch] [bp-1A8h]@1
  int v62; // [sp+70h] [bp-1A4h]@1
  int v63; // [sp+74h] [bp-1A0h]@1
  int v64; // [sp+78h] [bp-19Ch]@1
  int v65; // [sp+7Ch] [bp-198h]@1
  int v66; // [sp+80h] [bp-194h]@1
  char v67; // [sp+84h] [bp-190h]@27

  v48 = 0;
  v49 = 0;
  v58 = 0;
  v50 = 0;
  v59 = 0;
  v51 = 0;
  v60 = 0;
  v52 = 0;
  v61 = 0;
  v53 = 0;
  v62 = 0;
  v41 = 0;
  v54 = 0;
  v63 = 0;
  v42 = 0;
  v55 = 0;
  v64 = 0;
  v43 = 0;
  v56 = 0;
  v65 = 0;
  v8 = 0;
  v40 = -1;
  v44 = 0;
  v57 = 0;
  v66 = 0;
  v36 = 0;
  v37 = 8192;
  v7 = sub_10008320(0x2000u);
  Memory = v7;
  if ( !v7 )
  {
    v9 = -17;
    goto LABEL_50;
  }
  v10 = *(_DWORD *)(a1 + 92) == 2;
  v39 = 0;
  if ( v10 )
  {
    v11 = *(void **)(a2 + 8);
    v12 = *(_DWORD *)a2;
    *(_DWORD *)a2 = 0;
    *(_DWORD *)(a2 + 8) = v7;
    v13 = *(_DWORD *)(a1 + 124) == 0;
    v36 = v12;
    Memory = v11;
    if ( v13 )
    {
      v15 = a3;
      *(_DWORD *)a3 = 0;
      v9 = sub_10008F00(a1, a2, a3, 0, 0, (int)&v36);
      if ( v9 != 1 )
        goto LABEL_48;
      *(_DWORD *)a2 = 0;
      v36 = 0;
      *(_DWORD *)a3 = 0;
      v14 = sub_10009440(a1, a2, a3, 0, (int)&v36);
    }
    else
    {
      v15 = a3;
      v14 = sub_10009BD0(a1, a2, a3, 0, 0, (int)&v36);
    }
    v9 = v14;
    if ( v14 != 1 )
      goto LABEL_48;
    if ( !sub_10003B90(a1, (int)&v36, (int)&v41, &v39) )
    {
      v9 = -11;
      goto LABEL_48;
    }
    v16 = (unsigned __int16)v43;
    for ( i = v36; (unsigned __int16)v43 > v36; i = v36 )
    {
      *(_DWORD *)a2 = 0;
      *(_DWORD *)v15 = 0;
      *(_DWORD *)(a1 + 304) = v16 - i;
      v9 = sub_10009440(a1, a2, v15, 0, (int)&v36);
      if ( v9 != 1 )
        goto LABEL_48;
      v16 = (unsigned __int16)v43;
    }
    v18 = *(void **)(v15 + 8);
    *(_DWORD *)(v15 + 8) = Memory;
    *(_DWORD *)v15 = i;
    Memory = v18;
    v36 = 0;
  }
  else
  {
    v21 = sub_10006130(*(_DWORD *)a1, a2);
    if ( v21 != 1 )
    {
      v9 = v21;
      goto LABEL_48;
    }
    v15 = a3;
    *(_DWORD *)a3 = 0;
    v22 = sub_10004550(a1, a3);
    if ( v22 != 1 )
    {
      v9 = v22;
      goto LABEL_48;
    }
    v9 = 1;
    if ( !sub_10003B90(a1, a3, (int)&v41, &v39) )
    {
      v9 = -11;
      goto LABEL_48;
    }
  }
  v19 = BYTE2(v41);
  v20 = BYTE2(v41) == 12;
  *(_BYTE *)(a1 + 70) = v42;
  if ( v20 || v19 == 15 )
  {
    v9 = sub_100041A0(a1, v15, (int)&v48, &v39);
    if ( v9 != 1 )
      goto LABEL_48;
    v45 = 0;
    if ( *(int *)((char *)&v55 + 2) > a6 )
    {
      v9 = -21;
      goto LABEL_48;
    }
    v46 = 0;
    if ( *(int *)((char *)&v55 + 2) > 0 )
    {
      v24 = a7;
      v23 = 0;
      v47 = 0;
      do
      {
        if ( !__PAIR__(*(_WORD *)(v23 + *(int *)((char *)&v56 + 2) + 2), *(_WORD *)(v23 + *(int *)((char *)&v56 + 2))) )
        {
          v25 = *(_DWORD *)(a1 + 348);
          v45 = 1;
          if ( v25 >= 32 )
            v25 = 0;
          v27 = a1 + 4 * (5 * v25 + 90);
          *(_DWORD *)v27 = *(_DWORD *)(v24 + 4);
          *(_DWORD *)(v27 + 4) = *(_DWORD *)(v24 + 8);
          *(_DWORD *)(v27 + 8) = *(_DWORD *)(v24 + 12);
          *(_DWORD *)(v27 + 12) = *(_DWORD *)(v24 + 16);
          *(_DWORD *)(v27 + 16) = *(_DWORD *)(v24 + 20);
          *(_DWORD *)(a1 + 4 * v25 + 1076) = *(_WORD *)v24;
          v40 = v25;
          v26 = *(_DWORD *)(a1 + 348);
          if ( v26 < 32 )
            *(_DWORD *)(a1 + 348) = v26 + 1;
        }
        v23 = v47 + 24;
        v24 += 84;
        v29 = __SETO__(v46 + 1, *(int *)((char *)&v55 + 2));
        v28 = v46++ + 1 - *(int *)((char *)&v55 + 2) < 0;
        v47 += 24;
      }
      while ( v28 ^ v29 );
      if ( v45 )
      {
        v32 = v53;
        v31 = HIWORD(v52);
        *(_DWORD *)(a1 + 352) = v40;
        v30 = *(_WORD *)(a1 + 1216);
        *(_DWORD *)(a1 + 1072) = v32;
        if ( (_WORD)v52 < v30 || v31 < v30 )
        {
          if ( v31 > (_WORD)v52 || v31 >= (_WORD)v52 )
            *(_WORD *)(a1 + 1216) = v52;
          else
            *(_WORD *)(a1 + 1216) = v31;
        }
        v9 = 1;
      }
    }
  }
  else
  {
    if ( v19 != 13 && v19 == 3 )
    {
      if ( !sub_10004370(a1, v15, (int)&v58, &v39) )
      {
        v9 = -11;
        goto LABEL_48;
      }
      nullsub_1(v64, &v67);
    }
  }
  v33 = HIWORD(v43);
  v34 = (unsigned __int16)v43;
  *(_DWORD *)a4 = HIWORD(v43);
  *(_DWORD *)a5 = v34 - v33;
LABEL_48:
  v8 = 0;
  if ( Memory )
  {
    free(Memory);
    Memory = 0;
  }
LABEL_50:
  if ( *(int *)((char *)&v54 + 2) != v8 )
  {
    free(*(void **)((char *)&v54 + 2));
    *(int *)((char *)&v54 + 2) = v8;
  }
  if ( *(int *)((char *)&v56 + 2) != v8 )
    free(*(void **)((char *)&v56 + 2));
  return v9;
}

//----- (100051B0) --------------------------------------------------------
signed int __cdecl sub_100051B0(int a1, int a2, int a3)
{
  void *v3; // ebx@1
  signed int v4; // esi@2
  signed int v5; // eax@6
  int v6; // ebx@6
  int v7; // eax@16
  signed int v8; // eax@17
  int v10; // [sp+Ch] [bp-60h]@1
  int v11; // [sp+10h] [bp-5Ch]@9
  int v12; // [sp+14h] [bp-58h]@1
  int v13; // [sp+18h] [bp-54h]@1
  void *Memory; // [sp+1Ch] [bp-50h]@1
  int v15; // [sp+20h] [bp-4Ch]@1
  int v16; // [sp+24h] [bp-48h]@1
  void *v17; // [sp+28h] [bp-44h]@1
  char v18; // [sp+2Ch] [bp-40h]@1

  v16 = 0;
  v17 = 0;
  v3 = 0;
  v10 = 0;
  v15 = 0;
  memset(&v18, 0, 0x40u);
  v12 = 0;
  v13 = 8192;
  Memory = sub_10008320(0x2000u);
  if ( !Memory )
  {
    v4 = -17;
    goto LABEL_24;
  }
  v15 = 0;
  v16 = 8192;
  v17 = sub_10008320(0x2000u);
  if ( v17 )
  {
    if ( *(_DWORD *)(a1 + 1064) )
    {
      v6 = a3;
      v5 = sub_10004980(a1, (int)&v12, a2, a3, 0);
    }
    else
    {
      v6 = a3;
      v5 = sub_100047D0(a1, (int)&v12, a2, a3);
    }
    v4 = v5;
    if ( v5 != 1
      || (v4 = sub_10004D40(a1, (int)&v12, (int)&v15, (int)&v11, (int)&v10, a2, v6), v4 != 1)
      || *(_DWORD *)(a1 + 1064)
      || *(_BYTE *)(a1 + 2292) < 2 )
      goto LABEL_22;
    if ( v11 )
    {
      if ( sub_10008800(a1, (int)((char *)v17 + v10), v11, (int)&v18) )
      {
        v12 = 0;
        v7 = sub_10008950(a1);
        if ( v7 == 3 )
        {
          v8 = sub_10004C40(a1, (int)&v12, (int)&v18);
        }
        else
        {
          if ( v7 != 4 || (v4 = sub_10004980(a1, (int)&v12, a2, v6, (int)&v18), v4 != 1) )
            goto LABEL_22;
          v8 = sub_10004D40(a1, (int)&v12, (int)&v15, (int)&v11, (int)&v10, a2, v6);
        }
        v4 = v8;
      }
      else
      {
        v4 = -12;
      }
    }
    else
    {
      v4 = -12;
    }
  }
  else
  {
    v4 = -17;
  }
LABEL_22:
  v3 = 0;
  if ( Memory )
  {
    free(Memory);
    Memory = 0;
  }
LABEL_24:
  if ( v17 != v3 )
    free(v17);
  return v4;
}

//----- (100053A0) --------------------------------------------------------
signed int __cdecl sub_100053A0(int a1, int a2, int a3, int a4, int a5)
{
  signed int v5; // eax@1
  int v6; // ecx@1
  int v7; // edi@1
  char v8; // zf@1
  unsigned int v9; // ebp@5
  char v10; // cl@5
  int v11; // edx@6
  int v12; // eax@10
  int v13; // eax@15
  int v14; // eax@20
  __int16 v15; // cx@23
  unsigned __int8 v16; // sf@23
  unsigned __int8 v17; // of@23
  __int16 v18; // ax@24
  char v19; // dl@24
  int v20; // ecx@24
  int v21; // ebx@26
  __int16 v22; // dx@32
  int v23; // ecx@32
  signed int result; // eax@33
  signed int v25; // eax@42
  signed int v26; // [sp+10h] [bp-44h]@1
  char v27; // [sp+14h] [bp-40h]@24
  char v28; // [sp+15h] [bp-3Fh]@24
  unsigned __int8 v29; // [sp+16h] [bp-3Eh]@6
  char v30; // [sp+17h] [bp-3Dh]@24
  int v31; // [sp+18h] [bp-3Ch]@24
  char v32; // [sp+1Ch] [bp-38h]@1
  char v33; // [sp+1Dh] [bp-37h]@1
  char v34; // [sp+1Eh] [bp-36h]@1
  char v35; // [sp+1Fh] [bp-35h]@1
  char v36; // [sp+20h] [bp-34h]@5
  char v37; // [sp+21h] [bp-33h]@5
  char v38; // [sp+22h] [bp-32h]@5
  char v39; // [sp+23h] [bp-31h]@5
  __int16 v40; // [sp+24h] [bp-30h]@16
  __int16 v41; // [sp+26h] [bp-2Eh]@5
  int v42; // [sp+28h] [bp-2Ch]@20
  int v43; // [sp+2Ch] [bp-28h]@21
  __int16 v44; // [sp+30h] [bp-24h]@23
  __int16 v45; // [sp+32h] [bp-22h]@23
  __int16 v46; // [sp+34h] [bp-20h]@32
  __int16 v47; // [sp+36h] [bp-1Eh]@32
  int v48; // [sp+38h] [bp-1Ch]@32
  int v49; // [sp+3Ch] [bp-18h]@32
  int v50; // [sp+40h] [bp-14h]@32
  int v51; // [sp+44h] [bp-10h]@32
  int v52; // [sp+48h] [bp-Ch]@32
  int v53; // [sp+4Ch] [bp-8h]@32
  int v54; // [sp+50h] [bp-4h]@32

  v7 = 24;
  v26 = 0;
  v5 = sub_100089C0(a1);
  v6 = *(_DWORD *)a4;
  v8 = *(_DWORD *)a4 == 0;
  v32 = 5;
  v33 = 0;
  v34 = 0;
  v35 = 0;
  if ( v8 )
    v35 = 1;
  if ( *(_DWORD *)(a1 + 2156) )
    v35 |= 0x80u;
  v36 = *(_BYTE *)(a1 + 69);
  v9 = *(_DWORD *)a3 - v6;
  v10 = *(_BYTE *)(a1 + 2292);
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v41 = 0;
  if ( v10 < 3 )
  {
    LOBYTE(v11) = v29;
  }
  else
  {
    v11 = (signed int)(v9 + 32) % 16;
    v29 = v11;
    if ( (_BYTE)v11 )
    {
      LOBYTE(v11) = 16 - v11;
      v29 = v11;
    }
    v7 = (unsigned __int8)v11 + v5 + 32;
  }
  v12 = *(_DWORD *)(a1 + 2156);
  if ( v12 )
  {
    v7 += 16;
    if ( v12 )
    {
      if ( *(_DWORD *)(a1 + 2160) )
      {
        if ( v35 & 1 )
        {
          v7 += 32;
          v26 = 1;
        }
      }
    }
  }
  v13 = *(_WORD *)(a1 + 1216);
  if ( (signed int)(v7 + v9) <= v13 )
  {
    v35 |= 2u;
    v40 = v9 + v7;
    *(_DWORD *)a5 = 1;
  }
  else
  {
    v40 = *(_WORD *)(a1 + 1216);
    if ( *(_BYTE *)(a1 + 2292) >= 3 )
    {
      v29 = 8;
      v7 = v7 - (unsigned __int8)v11 + 8;
    }
    v9 = v13 - v7;
    *(_DWORD *)a5 = 0;
  }
  v14 = *(_DWORD *)(a1 + 1212);
  v42 = *(_DWORD *)(a1 + 1204);
  if ( v14 )
    v43 = *(_DWORD *)a3;
  else
    v43 = 0;
  v15 = *(_WORD *)(a1 + 344);
  v44 = *(_WORD *)(a1 + 4 * *(_DWORD *)(a1 + 352) + 1076);
  v17 = __SETO__(*(_BYTE *)(a1 + 2292), 3);
  v16 = (char)(*(_BYTE *)(a1 + 2292) - 3) < 0;
  v45 = v15;
  if ( !(v16 ^ v17) )
  {
    v18 = sub_100089C0(a1);
    v19 = *(_BYTE *)(a1 + 2293);
    v20 = *(_DWORD *)(a1 + 2672);
    v41 = v18;
    LOBYTE(v18) = *(_BYTE *)(a1 + 2292);
    v27 = v19;
    v28 = v18;
    v30 = 0;
    v31 = v20;
  }
  if ( !sub_10004130(a1, a2, (int)&v32)
    || (v21 = *(_DWORD *)a2, *(_DWORD *)(a1 + 2156))
    && (!sub_10002470(a1, a2, (const void *)(a1 + 2196), 4u)
     || !sub_10002470(a1, a2, (const void *)(a1 + 2200), 4u)
     || !sub_10002470(a1, a2, (const void *)(a1 + 2204), 4u)
     || !sub_10002470(a1, a2, (const void *)(a1 + 2208), 4u)
     || (v21 += 16, v26)
     && (v22 = *(_WORD *)(a1 + 2122),
         v46 = *(_WORD *)(a1 + 2120),
         v47 = v22,
         v50 = *(_DWORD *)(a1 + 2164),
         v51 = *(_DWORD *)(a1 + 2168),
         v23 = *(_DWORD *)(a1 + 2176),
         v52 = *(_DWORD *)(a1 + 2172),
         v48 = 0,
         v53 = v23,
         v54 = 0,
         v49 = 0,
         !sub_10009D10(a1, a2, (int)&v46)))
    || !sub_100025E0(a1, a2, (const void *)(*(_DWORD *)a4 + *(_DWORD *)(a3 + 8)), v9) )
    return -17;
  if ( *(_BYTE *)(a1 + 2292) < 3 )
  {
LABEL_45:
    *(_DWORD *)a4 += v9;
    return 1;
  }
  if ( !sub_100023F0(a1, a2, v29) || !sub_10003F60(a1, a2, (int)&v27) )
    return -17;
  if ( v26 )
    v9 += 32;
  result = sub_10008980(a1, a2, v21, v9 + v29);
  if ( result == 1 )
  {
    if ( *(_BYTE *)(a1 + 2292) >= 5 )
    {
      v25 = sub_100089C0(a1);
      sub_100089F0(a1, a2, v21, v9 + v29, *(_DWORD *)a2 - v25);
    }
    if ( v26 )
      v9 -= 32;
    goto LABEL_45;
  }
  return result;
}

//----- (10005710) --------------------------------------------------------
signed int __cdecl sub_10005710(int a1, int a2, int a3)
{
  signed int result; // eax@2
  int v4; // eax@8
  int v5; // edx@8
  int v6; // ebp@8
  int v7; // ecx@9
  unsigned int v8; // esi@17
  unsigned int v9; // esi@22
  int v10; // [sp+8h] [bp-1FCh]@1
  int v11; // [sp+Ch] [bp-1F8h]@1
  int v12; // [sp+10h] [bp-1F4h]@29
  int v13; // [sp+14h] [bp-1F0h]@21
  char v14; // [sp+18h] [bp-1ECh]@1
  char v15; // [sp+1Ah] [bp-1EAh]@3
  char v16; // [sp+1Bh] [bp-1E9h]@26
  unsigned __int16 v17; // [sp+20h] [bp-1E4h]@17
  unsigned __int16 v18; // [sp+22h] [bp-1E2h]@17
  int v19; // [sp+28h] [bp-1DCh]@8
  char v20; // [sp+30h] [bp-1D4h]@21
  unsigned __int8 v21; // [sp+32h] [bp-1D2h]@23
  char v22; // [sp+38h] [bp-1CCh]@7
  int v23; // [sp+48h] [bp-1BCh]@8
  unsigned __int16 v24; // [sp+4Ch] [bp-1B8h]@10
  unsigned __int16 v25; // [sp+4Eh] [bp-1B6h]@8
  char v26; // [sp+50h] [bp-1B4h]@37
  int v27; // [sp+68h] [bp-19Ch]@38
  char v28; // [sp+74h] [bp-190h]@38

  v11 = 1;
  v10 = 0;
  if ( !sub_10003B90(a1, a2, (int)&v14, &v10) )
    return -11;
  switch ( v15 )
  {
    case 0:
    case 2:
      if ( v15 == 2 )
      {
        if ( !sub_100044B0(a1, a2, (int)&v14, &v10) )
          goto LABEL_6;
        v6 = v19;
      }
      else
      {
        if ( !sub_10004440(a1, a2, (int)&v22, &v10) )
          goto LABEL_6;
        v5 = *(_DWORD *)(a1 + 348);
        v6 = v23;
        v4 = 0;
        v19 = v23;
        *(_DWORD *)(a1 + 344) = v25;
        if ( v5 > 0 )
        {
          v7 = a1 + 1076;
          while ( *(_DWORD *)v7 != v24 )
          {
            ++v4;
            v7 += 4;
            if ( v4 >= *(_DWORD *)(a1 + 348) )
              goto LABEL_14;
          }
          *(_DWORD *)(a1 + 352) = v4;
        }
LABEL_14:
        if ( v4 == v5 )
          return -12;
      }
      v8 = v17 - v10;
      if ( v18 )
      {
        if ( v18 )
        {
          v13 = v17 - v18 - 8;
          if ( !sub_10003FE0(a1, a2, (int)&v20, &v13) )
            goto LABEL_6;
          v9 = v17 - v18 - v10 - 8;
          result = sub_10008A30(a1, a2, 24, v9, v17 - v18);
          v11 = result;
          if ( result != 1 )
            return result;
          v8 = v9 - v21;
        }
      }
      else
      {
        if ( v6 < (signed int)v8 )
          v8 = v6;
      }
      if ( !*(_DWORD *)(a1 + 2156) || !*(_DWORD *)(a1 + 2160) || !(v16 & 1) )
        goto LABEL_35;
      if ( v15 != 2 )
      {
        v12 = 0;
        v10 += 28;
        if ( sub_10002660(a1, a2, &v12, &v10, 4u) )
        {
          if ( !v12 )
            v8 -= 32;
          goto LABEL_35;
        }
        return -12;
      }
      if ( (signed int)v8 >= 8 )
      {
        v10 += 4;
        v12 = 0;
        if ( sub_10002660(a1, a2, &v12, &v10, 4u) )
        {
          if ( !v12 )
            v8 -= 8;
          goto LABEL_35;
        }
        return -12;
      }
LABEL_35:
      if ( sub_100025E0(a1, a3, (const void *)(v10 + *(_DWORD *)(a2 + 8)), v8) )
        return v11;
      v11 = -17;
      return -17;
    case 3:
      if ( sub_10004370(a1, a2, (int)&v26, &v10) )
      {
        nullsub_1(v27, &v28);
        v11 = v27;
        result = v27;
      }
      else
      {
LABEL_6:
        result = -11;
      }
      return result;
    default:
      return -13;
  }
}

//----- (10005A00) --------------------------------------------------------
signed int __cdecl sub_10005A00(int a1, int a2, int a3)
{
  size_t v3; // eax@1
  int v4; // esi@1
  unsigned __int8 v5; // sf@1
  signed int v6; // edi@4
  int v7; // ebx@9
  char v8; // zf@11
  signed int v9; // eax@12
  char v10; // zf@17
  int v11; // eax@26
  unsigned int v12; // ecx@26
  unsigned __int8 v13; // zf@26
  char v14; // sf@26
  unsigned __int8 v15; // of@26
  int v16; // ebx@30
  char v17; // al@31
  char v18; // zf@32
  int v19; // eax@35
  int v20; // ecx@35
  int v21; // eax@39
  int v22; // ecx@39
  int v24; // [sp+Ch] [bp-3Ch]@1
  int v25; // [sp+10h] [bp-38h]@1
  int v26; // [sp+14h] [bp-34h]@1
  size_t v27; // [sp+18h] [bp-30h]@1
  void *v28; // [sp+1Ch] [bp-2Ch]@1
  int v29; // [sp+20h] [bp-28h]@1
  int v30; // [sp+24h] [bp-24h]@1
  void *v31; // [sp+28h] [bp-20h]@1
  unsigned int v32; // [sp+2Ch] [bp-1Ch]@1
  int v33; // [sp+30h] [bp-18h]@1
  void *Memory; // [sp+34h] [bp-14h]@1
  char v35; // [sp+38h] [bp-10h]@24
  char v36; // [sp+3Bh] [bp-Dh]@31
  char v37; // [sp+3Ch] [bp-Ch]@31
  unsigned __int16 v38; // [sp+40h] [bp-8h]@26

  v27 = 0;
  v4 = a1;
  v28 = 0;
  v3 = *(_WORD *)(a1 + 1216) + 256;
  v5 = *(_WORD *)(a1 + 1216) - 7936 < 0;
  v30 = 0;
  v33 = 0;
  v29 = 0;
  v31 = 0;
  v32 = 0;
  Memory = 0;
  v24 = 0;
  v25 = 0;
  v26 = 0;
  v27 = v3;
  if ( v5 ^ __SETO__(v3, 8192) )
  {
    v3 = 8192;
    v27 = 8192;
  }
  v28 = sub_10008320(v3);
  if ( !v28 )
  {
    v6 = -17;
    goto LABEL_49;
  }
  v29 = 0;
  v30 = 8192;
  v31 = sub_10008320(0x2000u);
  if ( !v31 )
  {
    v6 = -17;
    goto LABEL_49;
  }
  v32 = 0;
  v33 = 8192;
  Memory = sub_10008320(0x2000u);
  if ( !Memory )
  {
    v6 = -17;
    goto LABEL_49;
  }
  v7 = a2;
  v29 = 0;
  if ( sub_100053A0(v4, (int)&v29, a2, (int)&v25, (int)&v24) == 1 )
  {
    do
    {
      if ( v24 )
        break;
      v8 = *(_DWORD *)(v4 + 92) == 2;
      a1 = 0;
      if ( v8 )
      {
        v32 = 0;
        sub_100025E0(v4, (int)&v32, v31, v29);
        v29 = 0;
        v9 = sub_10008F00(v4, (int)&v29, (int)&v26, 0, 0, (int)&v32);
      }
      else
      {
        v9 = sub_10006130(*(_DWORD *)v4, (int)&v29);
      }
      v6 = v9;
      if ( v9 != 1 )
        goto LABEL_49;
      ++*(_DWORD *)(v4 + 1224);
      v29 = 0;
    }
    while ( sub_100053A0(v4, (int)&v29, v7, (int)&v25, (int)&v24) == v9 );
  }
  if ( *(_DWORD *)(v4 + 92) == 2 )
  {
    v32 = 0;
    sub_100025E0(v4, (int)&v32, v31, v29);
    v10 = *(_DWORD *)(v4 + 124) == 0;
    ++*(_DWORD *)(v4 + 1224);
    v29 = 0;
    if ( v10 )
    {
      v26 = 0;
      v6 = sub_10008F00(v4, (int)&v29, (int)&v26, 0, 0, (int)&v32);
      if ( v6 != 1
        || !*(_DWORD *)(v4 + 1068)
        || (v32 = 0, v29 = 0, v26 = 0, v6 = sub_10009440(v4, (int)&v29, (int)&v26, 0, (int)&v32), v6 != 1) )
        goto LABEL_49;
    }
    else
    {
      v6 = sub_10009BD0(v4, (int)&v29, (int)&v26, 0, 0, (int)&v32);
      if ( v6 != 1 || !*(_DWORD *)(v4 + 1068) )
        goto LABEL_49;
    }
    a1 = 0;
    if ( !sub_10003B90(v4, (int)&v32, (int)&v35, &a1) )
    {
LABEL_25:
      v6 = -11;
      goto LABEL_49;
    }
    v11 = v38;
    v12 = v32;
    v15 = __SETO__(v38, v32);
    v13 = v38 == v32;
    v14 = (signed int)(v38 - v32) < 0;
    *(_DWORD *)(v4 + 304) = -1;
    if ( !((unsigned __int8)(v14 ^ v15) | v13) )
    {
      do
      {
        *(_DWORD *)(v4 + 304) = v11 - v12;
        v29 = 0;
        v26 = 0;
        v6 = sub_10009440(v4, (int)&v29, (int)&v26, 0, (int)&v32);
        if ( v6 != 1 )
          goto LABEL_49;
        v11 = v38;
        v12 = v32;
      }
      while ( v38 > (signed int)v32 );
    }
    v26 = 0;
    sub_100025E0(v4, (int)&v26, Memory, v12);
    v32 = 0;
  }
  else
  {
    v21 = *(_DWORD *)(v4 + 1068);
    v22 = *(_DWORD *)(v4 + 1224) + 1;
    a1 = 0;
    *(_DWORD *)(v4 + 1224) = v22;
    if ( !v21 )
    {
      v6 = sub_10006130(*(_DWORD *)v4, (int)&v29);
      goto LABEL_49;
    }
    v6 = sub_10004790(v4, (int)&v29, (int)&v26);
    if ( v6 != 1 )
      goto LABEL_49;
    if ( !sub_10003B90(v4, (int)&v26, (int)&v35, &a1) )
    {
      v6 = -11;
      goto LABEL_49;
    }
  }
  v16 = a3;
  v6 = sub_10005710(v4, (int)&v26, a3);
  if ( v6 != 1 || (v17 = v36, *(_BYTE *)(v4 + 70) = v37, ++*(_DWORD *)(v4 + 1228), v17 & 2) )
    goto LABEL_49;
  while ( 1 )
  {
    v18 = *(_DWORD *)(v4 + 92) == 2;
    a1 = 0;
    v26 = 0;
    if ( v18 )
      break;
    v6 = sub_10004550(v4, (int)&v26);
    if ( v6 != 1 )
      goto LABEL_49;
    if ( !sub_10003B90(v4, (int)&v26, (int)&v35, &a1) )
      goto LABEL_25;
LABEL_45:
    ++*(_DWORD *)(v4 + 1228);
    v6 = sub_10005710(v4, (int)&v26, v16);
    if ( v6 != 1 || v36 & 2 )
      goto LABEL_49;
  }
  v29 = 0;
  v32 = 0;
  *(_DWORD *)(v4 + 304) = 5840;
  v6 = sub_10009440(v4, (int)&v29, (int)&v32, 0, (int)&v26);
  if ( v6 != 1 )
    goto LABEL_49;
  if ( !sub_10003B90(v4, (int)&v26, (int)&v35, &a1) )
    goto LABEL_25;
  v19 = v38;
  v20 = v26;
  if ( v38 <= v26 )
    goto LABEL_45;
  while ( 1 )
  {
    *(_DWORD *)(v4 + 304) = v19 - v20;
    v29 = 0;
    v32 = 0;
    v6 = sub_10009440(v4, (int)&v29, (int)&v32, 0, (int)&v26);
    if ( v6 != 1 )
      break;
    v19 = v38;
    v20 = v26;
    if ( v38 <= v26 )
      goto LABEL_45;
  }
LABEL_49:
  if ( *(_DWORD *)(v4 + 1208) )
    ++*(_DWORD *)(v4 + 1204);
  if ( Memory )
  {
    free(Memory);
    Memory = 0;
  }
  if ( v28 )
  {
    free(v28);
    v28 = 0;
  }
  if ( v31 )
    free(v31);
  return v6;
}

//----- (10005F20) --------------------------------------------------------
signed int __cdecl sub_10005F20(int a1, int a2, int a3, int a4, int a5)
{
  char v5; // zf@1
  signed int result; // eax@2

  *(_DWORD *)(a1 + 344) = a4;
  v5 = *(_DWORD *)(a1 + 92) == 1;
  *(_DWORD *)(a1 + 1068) = a5;
  if ( v5 )
    result = sub_1000AF90(a1, a2, a3);
  else
    result = sub_10005A00(a1, a2, a3);
  return result;
}

//----- (10005F60) --------------------------------------------------------
signed int __cdecl sub_10005F60(int a1, int a2, int a3)
{
  signed int result; // eax@1
  int v4; // edx@2
  int v5; // ecx@3
  int v6; // ecx@3
  int v7; // eax@3
  int v8; // eax@3
  int v9; // ecx@3
  int v10; // edx@3
  __int16 v11; // [sp+8h] [bp-54h]@3
  __int16 v12; // [sp+Ah] [bp-52h]@3
  int v13; // [sp+Ch] [bp-50h]@3
  int v14; // [sp+10h] [bp-4Ch]@3
  int v15; // [sp+14h] [bp-48h]@3
  int v16; // [sp+18h] [bp-44h]@3
  int v17; // [sp+1Ch] [bp-40h]@3
  int v18; // [sp+20h] [bp-3Ch]@3
  int v19; // [sp+24h] [bp-38h]@3
  int v20; // [sp+28h] [bp-34h]@3
  int v21; // [sp+2Ch] [bp-30h]@3
  int v22; // [sp+30h] [bp-2Ch]@3

  result = 1;
  if ( *(_DWORD *)(a1 + 92) == 1 )
  {
    *(_DWORD *)(a1 + 348) = 1;
    *(_DWORD *)(a1 + 352) = 0;
    *(_DWORD *)(a1 + 360) = *(_DWORD *)a2;
    *(_DWORD *)(a1 + 364) = *(_DWORD *)(a2 + 4);
    *(_DWORD *)(a1 + 368) = *(_DWORD *)(a2 + 8);
    *(_DWORD *)(a1 + 372) = *(_DWORD *)(a2 + 12);
    v4 = *(_DWORD *)(a2 + 16);
    *(_DWORD *)(a1 + 1064) = 1;
    *(_DWORD *)(a1 + 376) = v4;
  }
  else
  {
    v5 = *(_DWORD *)a2;
    v14 = *(_DWORD *)(a2 + 4);
    v13 = v5;
    v6 = *(_DWORD *)(a2 + 8);
    v7 = *(_DWORD *)(a2 + 16);
    v16 = *(_DWORD *)(a2 + 12);
    v15 = v6;
    LOWORD(v6) = *(_WORD *)(a1 + 348);
    v17 = v7;
    v8 = *(_DWORD *)(a1 + 1000);
    v11 = v6;
    v9 = *(_DWORD *)(a1 + 1004);
    v18 = v8;
    v20 = *(_DWORD *)(a1 + 1008);
    v19 = v9;
    v10 = *(_DWORD *)(a1 + 1016);
    v21 = *(_DWORD *)(a1 + 1012);
    v22 = v10;
    v12 = 1;
    result = sub_100051B0(a1, 1, (int)&v11);
    if ( result == 1 )
    {
      *(_DWORD *)(a1 + 1064) = 1;
      if ( a3 )
        *(_DWORD *)(a1 + 1204) = 1;
    }
  }
  return result;
}

//----- (10006050) --------------------------------------------------------
signed int __cdecl sub_10006050(int a1, int a2)
{
  return sub_10005F60(a1, a2, 0);
}

//----- (10006070) --------------------------------------------------------
bool __cdecl sub_10006070()
{
  bool result; // eax@2
  struct WSAData v1; // [sp+0h] [bp-190h]@1

  if ( WSAStartup(0x202u, &v1) )
    result = 0;
  else
    result = (_WORD)v1.wVersion == 514;
  return result;
}

//----- (100060B0) --------------------------------------------------------
bool __cdecl sub_100060B0()
{
  return WSACleanup() == 0;
}

//----- (100060C0) --------------------------------------------------------
int __cdecl sub_100060C0(SOCKET s)
{
  int result; // eax@1

  result = s;
  if ( s != -1 )
    result = closesocket(s);
  return result;
}

//----- (100060E0) --------------------------------------------------------
int __cdecl sub_100060E0(int a1, int a2)
{
  if ( a2 )
  {
    if ( *(_DWORD *)(a1 + 92) == 2 )
    {
      if ( !*(_DWORD *)(a1 + 72) )
      {
        if ( !*(_DWORD *)(a1 + 312) )
          sub_10007F30(a1);
      }
    }
  }
  if ( *(_DWORD *)a1 != -1 )
    closesocket(*(_DWORD *)a1);
  return sub_10006720(a1);
}

//----- (10006130) --------------------------------------------------------
int __cdecl sub_10006130(SOCKET s, int a2)
{
  int v2; // eax@1
  int result; // eax@3

  v2 = send(s, *(const char **)(a2 + 8), *(_DWORD *)a2, 0);
  if ( v2 == -1 || v2 < 0 )
    result = -7;
  else
    result = 8 * (v2 >= *(_DWORD *)a2) - 7;
  return result;
}

//----- (10006170) --------------------------------------------------------
int __cdecl sub_10006170(SOCKET s, int a2, const struct sockaddr *to)
{
  int v3; // eax@1
  int result; // eax@3

  v3 = sendto(s, *(const char **)(a2 + 8), *(_DWORD *)a2, 0, to, 16);
  if ( v3 == -1 || v3 < 0 )
    result = -7;
  else
    result = 8 * (v3 >= *(_DWORD *)a2) - 7;
  return result;
}

//----- (100061C0) --------------------------------------------------------
signed int __cdecl sub_100061C0(SOCKET s, int a2, struct timeval timeout)
{
  int v3; // eax@1
  int v5; // eax@5
  int v6; // ecx@10
  fd_set readfds; // [sp+Ch] [bp-104h]@1

  readfds.fd_array[0] = s;
  readfds.fd_count = 1;
  v3 = select(s + 1, &readfds, 0, 0, &timeout);
  if ( !v3 )
    return -4;
  if ( v3 == -1 )
    return -8;
  if ( v3 > 0 )
  {
    v5 = recv(s, (char *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)), *(_DWORD *)(a2 + 4) - *(_DWORD *)a2, 0);
    if ( v5 == -1 )
      return -8;
    if ( !v5 )
      return -5;
    *(_DWORD *)a2 += v5;
  }
  v6 = *(_DWORD *)a2;
  *(_DWORD *)(a2 + 8) = *(_DWORD *)(a2 + 8);
  *(_DWORD *)a2 = v6;
  return 1;
}

//----- (10006280) --------------------------------------------------------
unsigned int __cdecl sub_10006280(SOCKET s, int a2, struct sockaddr *from, struct timeval timeout)
{
  int v4; // eax@1
  unsigned int result; // eax@2
  int v6; // eax@5
  int v7; // ecx@7
  int fromlen; // [sp+4h] [bp-108h]@1
  fd_set readfds; // [sp+8h] [bp-104h]@1

  fromlen = 16;
  readfds.fd_array[0] = s;
  readfds.fd_count = 1;
  v4 = select(s + 1, &readfds, 0, 0, &timeout);
  if ( v4 )
  {
    if ( v4 == -1 )
    {
      result = -8;
    }
    else
    {
      v6 = recvfrom(s, *(char **)(a2 + 8), *(_DWORD *)(a2 + 4), 0, from, &fromlen);
      if ( v6 == -1 || v6 < 0 )
      {
        result = -8;
      }
      else
      {
        v7 = *(_DWORD *)(a2 + 8);
        *(_DWORD *)a2 = v6;
        *(_BYTE *)(v6 + v7) = 0;
        *(_BYTE *)(*(_DWORD *)a2 + *(_DWORD *)(a2 + 8) + 1) = 0;
        result = (v6 != 0 ? 6 : 0) - 5;
      }
    }
  }
  else
  {
    result = -4;
  }
  return result;
}

//----- (10006350) --------------------------------------------------------
signed int __cdecl sub_10006350(int a1, int a2, u_short hostshort, __int16 a4, int a5)
{
  signed int result; // eax@1

  *(_DWORD *)(a1 + 92) = a5;
  *(_DWORD *)(a1 + 20) = a2;
  *(_WORD *)(a1 + 18) = htons(hostshort);
  *(_WORD *)(a1 + 16) = a4;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  result = *(_DWORD *)(a1 + 92);
  if ( result )
  {
    if ( result == 1 )
    {
      *(_WORD *)(a1 + 2092) = 944;
      return result;
    }
    if ( result == 2 )
    {
      result = 4280;
    }
    else
    {
      if ( result != 3 )
        return result;
      result = 4088;
    }
  }
  else
  {
    result = 5840;
  }
  *(_WORD *)(a1 + 1216) = result;
  *(_WORD *)(a1 + 1218) = result;
  *(_WORD *)(a1 + 1220) = result;
  return result;
}

//----- (100063D0) --------------------------------------------------------
signed int __cdecl sub_100063D0(int a1, const void *a2, const void *a3, char a4)
{
  int v4; // ebx@8
  signed int result; // eax@11

  if ( a2 )
  {
    sub_100034E0(a1, a1 + 2584, a2);
    sub_10003520(a1 + 2584, a1 + 2596);
  }
  if ( a3 )
  {
    sub_100034E0(a1, a1 + 2608, a3);
    sub_10003520(a1 + 2608, a1 + 2620);
    if ( strlen((const char *)a3) > 0xE )
    {
      *(_DWORD *)(a1 + 2840) = 0;
      *(_DWORD *)(a1 + 2844) = 0;
      *(_DWORD *)(a1 + 2848) = 0;
      *(_DWORD *)(a1 + 2852) = 0;
      *(_DWORD *)(a1 + 2688) |= 0x400u;
    }
    else
    {
      sub_1000B510(*(const char **)(a1 + 2616), a1 + 2840);
    }
    sub_1000B490(*(const void **)(a1 + 2628), *(_DWORD *)(a1 + 2620), a1 + 2856);
  }
  v4 = *(_DWORD *)(a1 + 2688) & 0xFFFFFFCF;
  *(_DWORD *)(a1 + 2688) = v4;
  switch ( a4 )
  {
    case 6:
      *(_DWORD *)(a1 + 2688) = v4 | 0x20;
      goto LABEL_10;
    case 5:
LABEL_10:
      *(_DWORD *)(a1 + 2688) |= 0x10u;
      goto LABEL_11;
    case 1:
    case 2:
    case 3:
    case 4:
LABEL_11:
      *(_BYTE *)(a1 + 2292) = a4;
      result = 1;
      break;
    case 0:
      *(_BYTE *)(a1 + 2292) = 1;
      result = 1;
      break;
    default:
      result = -14;
      break;
  }
  return result;
}

//----- (10006500) --------------------------------------------------------
signed int __cdecl sub_10006500(int a1, const void *a2, const void *a3, char a4)
{
  signed int result; // eax@7

  *(_DWORD *)(a1 + 2688) |= 0x10u;
  *(_DWORD *)(a1 + 112) = 1;
  *(_DWORD *)(a1 + 128) = 1;
  if ( a2 )
  {
    sub_100034E0(a1, a1 + 2584, a2);
    sub_10003520(a1 + 2584, a1 + 2596);
  }
  if ( a3 )
  {
    sub_100034E0(a1, a1 + 2608, a3);
    sub_10003520(a1 + 2608, a1 + 2620);
    if ( strlen((const char *)a3) > 0xE )
    {
      *(_DWORD *)(a1 + 2840) = 0;
      *(_DWORD *)(a1 + 2844) = 0;
      *(_DWORD *)(a1 + 2848) = 0;
      *(_DWORD *)(a1 + 2852) = 0;
      *(_DWORD *)(a1 + 2688) |= 0x400u;
    }
    else
    {
      sub_1000B510(*(const char **)(a1 + 2616), a1 + 2840);
    }
    sub_1000B490(*(const void **)(a1 + 2628), *(_DWORD *)(a1 + 2620), a1 + 2856);
    *(_BYTE *)(a1 + 2293) = a4;
    result = 1;
  }
  else
  {
    *(_BYTE *)(a1 + 2293) = a4;
    result = 1;
  }
  return result;
}

//----- (10006600) --------------------------------------------------------
int __cdecl sub_10006600(int a1)
{
  int result; // eax@1

  sub_100034E0(a1, a1 + 2308, "Windows 2000 2195");
  sub_100034E0(a1, a1 + 2332, "Windows 2000 5.0");
  result = 0;
  *(_DWORD *)(a1 + 2120) = 393221;
  *(_DWORD *)(a1 + 132) = 6;
  *(_DWORD *)(a1 + 136) = 0;
  *(_DWORD *)(a1 + 140) = 4;
  *(_DWORD *)(a1 + 144) = 13;
  *(_DWORD *)(a1 + 148) = 5;
  *(_DWORD *)(a1 + 152) = 7;
  *(_DWORD *)(a1 + 156) = 9;
  *(_DWORD *)(a1 + 2656) = 0;
  *(_DWORD *)(a1 + 2660) = 0;
  *(_BYTE *)(a1 + 2293) = 10;
  *(_DWORD *)(a1 + 112) = 1;
  *(_DWORD *)(a1 + 2688) = -536837481;
  *(_DWORD *)(a1 + 2244) = 0;
  *(_DWORD *)(a1 + 232) = -2147483436;
  *(_BYTE *)(a1 + 224) = 24;
  *(_WORD *)(a1 + 226) = -14329;
  *(_WORD *)(a1 + 228) = -14253;
  *(_DWORD *)(a1 + 240) = 4356;
  *(_WORD *)(a1 + 236) = 10;
  *(_WORD *)(a1 + 238) = 0;
  *(_DWORD *)(a1 + 2680) = 1611661311;
  return result;
}

//----- (100066F0) --------------------------------------------------------
void __cdecl sub_100066F0(int a1)
{
  void *v1; // eax@1

  v1 = *(void **)(a1 + 8);
  *(_DWORD *)a1 = 0;
  *(_DWORD *)(a1 + 4) = 0;
  if ( v1 )
  {
    free(v1);
    *(_DWORD *)(a1 + 8) = 0;
  }
}

//----- (10006720) --------------------------------------------------------
int __cdecl sub_10006720(int a1)
{
  int v1; // eax@1
  signed int v2; // edx@1
  int v3; // ecx@1
  int v4; // eax@1
  int result; // eax@3
  char v6; // [sp+8h] [bp-10h]@1

  *(_DWORD *)(a1 + 92) = 5;
  *(_DWORD *)(a1 + 96) = 5;
  *(_DWORD *)a1 = -1;
  *(_DWORD *)(a1 + 352) = -1;
  *(_DWORD *)(a1 + 344) = -1;
  *(_WORD *)(a1 + 18) = 0;
  *(_DWORD *)(a1 + 348) = 0;
  *(_DWORD *)(a1 + 360) = 0;
  *(_DWORD *)(a1 + 364) = 0;
  *(_DWORD *)(a1 + 368) = 0;
  *(_DWORD *)(a1 + 372) = 0;
  *(_DWORD *)(a1 + 376) = 0;
  *(_DWORD *)(a1 + 1064) = 0;
  *(_DWORD *)(a1 + 1068) = 1;
  *(_DWORD *)(a1 + 1228) = 0;
  *(_DWORD *)(a1 + 1224) = 0;
  *(_DWORD *)(a1 + 1072) = 0;
  *(_DWORD *)(a1 + 1232) = 0;
  *(_DWORD *)(a1 + 1244) = 0;
  v4 = sub_10009E20((int)&v6);
  *(_DWORD *)(a1 + 1256) = *(_DWORD *)v4;
  *(_DWORD *)(a1 + 1260) = *(_DWORD *)(v4 + 4);
  *(_DWORD *)(a1 + 1264) = *(_DWORD *)(v4 + 8);
  *(_DWORD *)(a1 + 1268) = *(_DWORD *)(v4 + 12);
  *(_DWORD *)(a1 + 1252) = 1;
  *(_DWORD *)(a1 + 1248) = 0;
  *(_DWORD *)(a1 + 2096) = 0;
  *(_DWORD *)(a1 + 2108) = 0;
  v3 = a1 + 2028;
  v1 = a1 + 1900;
  v2 = 32;
  do
  {
    *(_DWORD *)(v1 - 132) = 0;
    *(_DWORD *)v1 = 0;
    *(_WORD *)v3 = 0;
    v1 += 4;
    v3 += 2;
    --v2;
  }
  while ( v2 );
  *(_DWORD *)(a1 + 2248) = 0;
  *(_DWORD *)(a1 + 2252) = 0;
  *(_DWORD *)(a1 + 2256) = 0;
  *(_DWORD *)(a1 + 2260) = 0;
  *(_DWORD *)(a1 + 2264) = 0;
  *(_DWORD *)(a1 + 100) = 0;
  *(_DWORD *)(a1 + 312) = 0;
  *(_WORD *)(a1 + 256) = 0;
  *(_WORD *)(a1 + 248) = 0;
  *(_WORD *)(a1 + 252) = 0;
  *(_DWORD *)(a1 + 300) = 0;
  *(_DWORD *)(a1 + 308) = 0;
  *(_DWORD *)(a1 + 116) = 0;
  *(_WORD *)(a1 + 338) = 0;
  *(_DWORD *)(a1 + 120) = 1;
  *(_WORD *)(a1 + 254) = 64;
  *(_WORD *)(a1 + 250) = -257;
  *(_DWORD *)(a1 + 304) = -1;
  *(_DWORD *)(a1 + 316) = 0;
  *(_DWORD *)(a1 + 320) = 0;
  *(_DWORD *)(a1 + 324) = 0;
  *(_DWORD *)(a1 + 328) = 0;
  *(_DWORD *)(a1 + 332) = 0;
  *(_BYTE *)(a1 + 336) = 0;
  *(_DWORD *)(a1 + 2704) = 0;
  *(_DWORD *)(a1 + 2708) = 0;
  result = a1 + 2824;
  *(_DWORD *)(a1 + 2824) = 0;
  *(_DWORD *)(a1 + 2828) = 0;
  *(_DWORD *)(a1 + 2692) = *(_DWORD *)(a1 + 2688);
  return result;
}

//----- (100068C0) --------------------------------------------------------
int __cdecl sub_100068C0(int a1)
{
  int result; // eax@1
  int v2; // esi@1
  int v3; // ebx@2

  result = a1;
  v2 = *(_DWORD *)(a1 + 2240);
  if ( v2 )
  {
    do
    {
      v3 = *(_DWORD *)v2;
      if ( *(_DWORD *)(v2 + 84) )
      {
        free(*(void **)(v2 + 84));
        *(_DWORD *)(v2 + 84) = 0;
      }
      if ( *(_DWORD *)(v2 + 96) )
      {
        free(*(void **)(v2 + 96));
        *(_DWORD *)(v2 + 96) = 0;
      }
      free((void *)v2);
      v2 = v3;
    }
    while ( v3 );
    result = a1;
  }
  *(_DWORD *)(result + 2240) = 0;
  return result;
}

//----- (10006920) --------------------------------------------------------
int __cdecl sub_10006920(int a1)
{
  void *v1; // eax@1
  void *v2; // eax@3
  void *v3; // eax@5
  void *v4; // eax@7
  void *v5; // eax@9
  void *v6; // eax@11
  void *v7; // eax@13
  void *v8; // eax@15
  void *v9; // eax@17
  void *v10; // eax@19
  void *v11; // eax@21
  void *v12; // eax@23
  void *v13; // eax@25
  void *v14; // eax@27
  void *v15; // eax@29
  void *v16; // eax@31
  void *v17; // eax@33
  void *v18; // eax@35
  void *v19; // eax@37
  void *v20; // eax@39
  void *v21; // eax@41
  void *v22; // eax@43
  void *v23; // eax@45
  void *v24; // eax@47
  void *v25; // eax@49
  void *v26; // eax@51
  void *v27; // eax@53
  void *v28; // eax@55
  void *v29; // eax@57
  void *v30; // eax@59
  void *v31; // eax@61
  void *v32; // eax@63
  void *v33; // eax@65
  void *v34; // eax@67

  v1 = *(void **)(a1 + 3896);
  *(_DWORD *)(a1 + 3888) = 0;
  *(_DWORD *)(a1 + 3892) = 0;
  if ( v1 )
  {
    free(v1);
    *(_DWORD *)(a1 + 3896) = 0;
  }
  v2 = *(void **)(a1 + 3908);
  *(_DWORD *)(a1 + 3900) = 0;
  *(_DWORD *)(a1 + 3904) = 0;
  if ( v2 )
  {
    free(v2);
    *(_DWORD *)(a1 + 3908) = 0;
  }
  v3 = *(void **)(a1 + 208);
  *(_DWORD *)(a1 + 200) = 0;
  *(_DWORD *)(a1 + 204) = 0;
  if ( v3 )
  {
    free(v3);
    *(_DWORD *)(a1 + 208) = 0;
  }
  v4 = *(void **)(a1 + 220);
  *(_DWORD *)(a1 + 212) = 0;
  *(_DWORD *)(a1 + 216) = 0;
  if ( v4 )
  {
    free(v4);
    *(_DWORD *)(a1 + 220) = 0;
  }
  v5 = *(void **)(a1 + 1240);
  *(_DWORD *)(a1 + 1232) = 0;
  *(_DWORD *)(a1 + 1236) = 0;
  if ( v5 )
  {
    free(v5);
    *(_DWORD *)(a1 + 1240) = 0;
  }
  v6 = *(void **)(a1 + 2304);
  *(_DWORD *)(a1 + 2296) = 0;
  *(_DWORD *)(a1 + 2300) = 0;
  if ( v6 )
  {
    free(v6);
    *(_DWORD *)(a1 + 2304) = 0;
  }
  v7 = *(void **)(a1 + 2328);
  *(_DWORD *)(a1 + 2320) = 0;
  *(_DWORD *)(a1 + 2324) = 0;
  if ( v7 )
  {
    free(v7);
    *(_DWORD *)(a1 + 2328) = 0;
  }
  v8 = *(void **)(a1 + 2352);
  *(_DWORD *)(a1 + 2344) = 0;
  *(_DWORD *)(a1 + 2348) = 0;
  if ( v8 )
  {
    free(v8);
    *(_DWORD *)(a1 + 2352) = 0;
  }
  v9 = *(void **)(a1 + 2364);
  *(_DWORD *)(a1 + 2356) = 0;
  *(_DWORD *)(a1 + 2360) = 0;
  if ( v9 )
  {
    free(v9);
    *(_DWORD *)(a1 + 2364) = 0;
  }
  v10 = *(void **)(a1 + 2376);
  *(_DWORD *)(a1 + 2368) = 0;
  *(_DWORD *)(a1 + 2372) = 0;
  if ( v10 )
  {
    free(v10);
    *(_DWORD *)(a1 + 2376) = 0;
  }
  v11 = *(void **)(a1 + 2388);
  *(_DWORD *)(a1 + 2380) = 0;
  *(_DWORD *)(a1 + 2384) = 0;
  if ( v11 )
  {
    free(v11);
    *(_DWORD *)(a1 + 2388) = 0;
  }
  v12 = *(void **)(a1 + 2400);
  *(_DWORD *)(a1 + 2392) = 0;
  *(_DWORD *)(a1 + 2396) = 0;
  if ( v12 )
  {
    free(v12);
    *(_DWORD *)(a1 + 2400) = 0;
  }
  v13 = *(void **)(a1 + 2412);
  *(_DWORD *)(a1 + 2404) = 0;
  *(_DWORD *)(a1 + 2408) = 0;
  if ( v13 )
  {
    free(v13);
    *(_DWORD *)(a1 + 2412) = 0;
  }
  v14 = *(void **)(a1 + 2424);
  *(_DWORD *)(a1 + 2416) = 0;
  *(_DWORD *)(a1 + 2420) = 0;
  if ( v14 )
  {
    free(v14);
    *(_DWORD *)(a1 + 2424) = 0;
  }
  v15 = *(void **)(a1 + 2436);
  *(_DWORD *)(a1 + 2428) = 0;
  *(_DWORD *)(a1 + 2432) = 0;
  if ( v15 )
  {
    free(v15);
    *(_DWORD *)(a1 + 2436) = 0;
  }
  v16 = *(void **)(a1 + 2448);
  *(_DWORD *)(a1 + 2440) = 0;
  *(_DWORD *)(a1 + 2444) = 0;
  if ( v16 )
  {
    free(v16);
    *(_DWORD *)(a1 + 2448) = 0;
  }
  v17 = *(void **)(a1 + 2460);
  *(_DWORD *)(a1 + 2452) = 0;
  *(_DWORD *)(a1 + 2456) = 0;
  if ( v17 )
  {
    free(v17);
    *(_DWORD *)(a1 + 2460) = 0;
  }
  v18 = *(void **)(a1 + 2472);
  *(_DWORD *)(a1 + 2464) = 0;
  *(_DWORD *)(a1 + 2468) = 0;
  if ( v18 )
  {
    free(v18);
    *(_DWORD *)(a1 + 2472) = 0;
  }
  v19 = *(void **)(a1 + 2484);
  *(_DWORD *)(a1 + 2476) = 0;
  *(_DWORD *)(a1 + 2480) = 0;
  if ( v19 )
  {
    free(v19);
    *(_DWORD *)(a1 + 2484) = 0;
  }
  v20 = *(void **)(a1 + 2496);
  *(_DWORD *)(a1 + 2488) = 0;
  *(_DWORD *)(a1 + 2492) = 0;
  if ( v20 )
  {
    free(v20);
    *(_DWORD *)(a1 + 2496) = 0;
  }
  v21 = *(void **)(a1 + 2508);
  *(_DWORD *)(a1 + 2500) = 0;
  *(_DWORD *)(a1 + 2504) = 0;
  if ( v21 )
  {
    free(v21);
    *(_DWORD *)(a1 + 2508) = 0;
  }
  v22 = *(void **)(a1 + 2520);
  *(_DWORD *)(a1 + 2512) = 0;
  *(_DWORD *)(a1 + 2516) = 0;
  if ( v22 )
  {
    free(v22);
    *(_DWORD *)(a1 + 2520) = 0;
  }
  v23 = *(void **)(a1 + 2532);
  *(_DWORD *)(a1 + 2524) = 0;
  *(_DWORD *)(a1 + 2528) = 0;
  if ( v23 )
  {
    free(v23);
    *(_DWORD *)(a1 + 2532) = 0;
  }
  v24 = *(void **)(a1 + 2544);
  *(_DWORD *)(a1 + 2536) = 0;
  *(_DWORD *)(a1 + 2540) = 0;
  if ( v24 )
  {
    free(v24);
    *(_DWORD *)(a1 + 2544) = 0;
  }
  v25 = *(void **)(a1 + 2556);
  *(_DWORD *)(a1 + 2548) = 0;
  *(_DWORD *)(a1 + 2552) = 0;
  if ( v25 )
  {
    free(v25);
    *(_DWORD *)(a1 + 2556) = 0;
  }
  v26 = *(void **)(a1 + 2568);
  *(_DWORD *)(a1 + 2560) = 0;
  *(_DWORD *)(a1 + 2564) = 0;
  if ( v26 )
  {
    free(v26);
    *(_DWORD *)(a1 + 2568) = 0;
  }
  v27 = *(void **)(a1 + 2580);
  *(_DWORD *)(a1 + 2572) = 0;
  *(_DWORD *)(a1 + 2576) = 0;
  if ( v27 )
  {
    free(v27);
    *(_DWORD *)(a1 + 2580) = 0;
  }
  v28 = *(void **)(a1 + 2592);
  *(_DWORD *)(a1 + 2584) = 0;
  *(_DWORD *)(a1 + 2588) = 0;
  if ( v28 )
  {
    free(v28);
    *(_DWORD *)(a1 + 2592) = 0;
  }
  v29 = *(void **)(a1 + 2604);
  *(_DWORD *)(a1 + 2596) = 0;
  *(_DWORD *)(a1 + 2600) = 0;
  if ( v29 )
  {
    free(v29);
    *(_DWORD *)(a1 + 2604) = 0;
  }
  v30 = *(void **)(a1 + 2616);
  *(_DWORD *)(a1 + 2608) = 0;
  *(_DWORD *)(a1 + 2612) = 0;
  if ( v30 )
  {
    free(v30);
    *(_DWORD *)(a1 + 2616) = 0;
  }
  v31 = *(void **)(a1 + 2628);
  *(_DWORD *)(a1 + 2620) = 0;
  *(_DWORD *)(a1 + 2624) = 0;
  if ( v31 )
  {
    free(v31);
    *(_DWORD *)(a1 + 2628) = 0;
  }
  v32 = *(void **)(a1 + 2316);
  *(_DWORD *)(a1 + 2308) = 0;
  *(_DWORD *)(a1 + 2312) = 0;
  if ( v32 )
  {
    free(v32);
    *(_DWORD *)(a1 + 2316) = 0;
  }
  v33 = *(void **)(a1 + 2340);
  *(_DWORD *)(a1 + 2332) = 0;
  *(_DWORD *)(a1 + 2336) = 0;
  if ( v33 )
  {
    free(v33);
    *(_DWORD *)(a1 + 2340) = 0;
  }
  v34 = *(void **)(a1 + 2640);
  *(_DWORD *)(a1 + 2632) = 0;
  *(_DWORD *)(a1 + 2636) = 0;
  if ( v34 )
  {
    free(v34);
    *(_DWORD *)(a1 + 2640) = 0;
  }
  return sub_100068C0(a1);
}

//----- (10006DC0) --------------------------------------------------------
signed int __cdecl sub_10006DC0(int a1)
{
  int v1; // ebp@1
  int v2; // ebp@1
  int v3; // ebp@1
  void *v4; // eax@1
  int v5; // ebx@2
  int v6; // ebx@2
  int v7; // ebx@2
  __int16 v8; // dx@2
  int v9; // ebx@2
  int v10; // ebx@2
  int v11; // ebx@2
  int v12; // ebx@2
  int v13; // ebx@2
  int v14; // ebx@2
  void *v15; // eax@2
  void *v16; // eax@3
  signed int result; // eax@4
  int v18; // edx@5

  memset((void *)a1, 0, 0xF48u);
  *(_DWORD *)(a1 + 4) = -1;
  *(_DWORD *)(a1 + 36) = 0;
  *(_WORD *)(a1 + 34) = htons(0x1122u);
  *(_WORD *)(a1 + 32) = 2;
  *(_DWORD *)(a1 + 80) = 1;
  *(_DWORD *)(a1 + 72) = 0;
  *(_DWORD *)(a1 + 76) = 0;
  *(_BYTE *)(a1 + 68) = 16;
  *(_BYTE *)(a1 + 69) = 16;
  *(_BYTE *)(a1 + 70) = 16;
  *(_BYTE *)(a1 + 88) = 0;
  *(_DWORD *)(a1 + 12) = 0;
  *(_DWORD *)(a1 + 8) = 120;
  *(_DWORD *)(a1 + 2276) = 0;
  *(_DWORD *)(a1 + 2280) = 0;
  v1 = (unsigned __int8)rand();
  v2 = ((rand() << 8) | v1) << 8;
  v3 = ((unsigned __int8)rand() | v2) << 8;
  *(_DWORD *)(a1 + 2672) = (unsigned __int8)rand() | v3;
  *(_BYTE *)(a1 + 2292) = 1;
  *(_DWORD *)(a1 + 2272) = 0;
  *(_DWORD *)(a1 + 2676) = 3;
  *(_DWORD *)(a1 + 2680) = 1611661311;
  *(_DWORD *)(a1 + 1000) = dword_100170E0;
  *(_DWORD *)(a1 + 1004) = dword_100170E4;
  *(_DWORD *)(a1 + 1008) = dword_100170E8;
  *(_DWORD *)(a1 + 1012) = dword_100170EC;
  *(_DWORD *)(a1 + 1016) = dword_100170F0;
  *(_DWORD *)(a1 + 356) = 1;
  *(_DWORD *)(a1 + 1060) = 1;
  *(_DWORD *)(a1 + 1204) = 1;
  *(_DWORD *)(a1 + 1208) = 1;
  *(_DWORD *)(a1 + 1212) = 1;
  *(_WORD *)(a1 + 1216) = 5840;
  *(_WORD *)(a1 + 1218) = 5840;
  *(_WORD *)(a1 + 1220) = 5840;
  *(_DWORD *)(a1 + 1244) = 0;
  *(_DWORD *)(a1 + 1232) = 0;
  *(_DWORD *)(a1 + 1236) = 8192;
  v4 = sub_10008320(0x2000u);
  *(_DWORD *)(a1 + 1240) = v4;
  if ( v4
    && (*(_DWORD *)(a1 + 2100) = 1,
        *(_WORD *)(a1 + 2092) = 944,
        *(_DWORD *)(a1 + 1896) = 0,
        *(_DWORD *)(a1 + 2104) = 0,
        *(_DWORD *)(a1 + 2112) = 1,
        *(_DWORD *)(a1 + 2268) = 250,
        *(_DWORD *)(a1 + 2160) = 1,
        *(_WORD *)(a1 + 2214) = 7,
        v5 = (unsigned __int8)rand(),
        v6 = ((rand() << 8) | v5) << 8,
        v7 = ((unsigned __int8)rand() | v6) << 8,
        *(_DWORD *)(a1 + 2164) = (unsigned __int8)rand() | v7,
        BYTE1(v7) = rand() & 0xF | 0x40,
        LOBYTE(v7) = rand(),
        *(_WORD *)(a1 + 2168) = v7,
        LOBYTE(v7) = rand(),
        BYTE1(v7) = rand(),
        v8 = *(_WORD *)(a1 + 2168) & 0x3FFF | 0x8000,
        *(_WORD *)(a1 + 2170) = v7,
        *(_WORD *)(a1 + 2168) = v8,
        v9 = (unsigned __int8)rand(),
        v10 = ((rand() << 8) | v9) << 8,
        v11 = ((unsigned __int8)rand() | v10) << 8,
        *(_DWORD *)(a1 + 2172) = (unsigned __int8)rand() | v11,
        v12 = (unsigned __int8)rand(),
        v13 = ((rand() << 8) | v12) << 8,
        v14 = ((unsigned __int8)rand() | v13) << 8,
        *(_DWORD *)(a1 + 2176) = (unsigned __int8)rand() | v14,
        *(_BYTE *)(a1 + 110) = 16,
        *(_DWORD *)(a1 + 100) = 0,
        *(_DWORD *)(a1 + 104) = 0,
        *(_BYTE *)(a1 + 108) = 32,
        *(_BYTE *)(a1 + 109) = 0,
        *(_DWORD *)(a1 + 128) = 0,
        *(_DWORD *)(a1 + 124) = 1,
        *(_BYTE *)(a1 + 276) = 3,
        *(_DWORD *)(a1 + 244) = 65536,
        *(_DWORD *)(a1 + 284) = 0,
        *(_DWORD *)(a1 + 112) = 0,
        sub_100034E0(a1, a1 + 212, "LANMAN"),
        sub_100034E0(a1, a1 + 200, "IPC$"),
        *(_DWORD *)(a1 + 288) = 0,
        *(_DWORD *)(a1 + 3888) = 0,
        *(_DWORD *)(a1 + 3892) = 8192,
        v15 = sub_10008320(0x2000u),
        *(_DWORD *)(a1 + 3896) = v15,
        v15)
    && (*(_DWORD *)(a1 + 3900) = 0,
        *(_DWORD *)(a1 + 3904) = 8192,
        v16 = sub_10008320(0x2000u),
        *(_DWORD *)(a1 + 3908) = v16,
        v16) )
  {
    sub_10006720(a1);
    sub_10006600(a1);
    v18 = *(_DWORD *)(a1 + 2688) & 0xBFFFFFFF | 0x2880004;
    *(_DWORD *)(a1 + 112) = 0;
    *(_DWORD *)(a1 + 2688) = v18;
    result = 1;
  }
  else
  {
    sub_10006920(a1);
    result = -17;
  }
  return result;
}
// 100170E0: using guessed type int dword_100170E0;
// 100170E4: using guessed type int dword_100170E4;
// 100170E8: using guessed type int dword_100170E8;
// 100170EC: using guessed type int dword_100170EC;
// 100170F0: using guessed type int dword_100170F0;

//----- (10007110) --------------------------------------------------------
signed int __cdecl sub_10007110(int a1, int a2, int a3)
{
  char v3; // bl@1
  signed int result; // eax@18

  v3 = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a1 + 69) = 16;
  if ( sub_100025E0(a1, a2, (const void *)a3, 4u)
    && sub_10002470(a1, a2, (const void *)(a3 + 4), 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 5), 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 6), 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 7), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 9), 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 10), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 12), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 14), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 16), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 18), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 20), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 22), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 24), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 26), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 28), 2u)
    && sub_10002470(a1, a2, (const void *)(a3 + 30), 2u) )
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = 1;
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = 0;
  }
  return result;
}

//----- (100072C0) --------------------------------------------------------
signed int __cdecl sub_100072C0(int a1, int a2, __int16 a3, char a4)
{
  char v4; // zf@2
  int v5; // eax@4
  signed int v6; // ebp@4
  int v8; // edi@12
  __int16 v9; // ax@19
  __int16 v10; // ax@20
  char v11; // zf@22
  __int16 v12; // ax@23
  __int16 v13; // ax@24
  __int16 v14; // ax@30
  __int16 v15; // cx@30
  __int16 v16; // dx@30
  int v17; // edi@34
  char v18; // [sp+Fh] [bp-7Dh]@4
  char v19; // [sp+10h] [bp-7Ch]@11
  char v20; // [sp+11h] [bp-7Bh]@11
  __int16 v21; // [sp+12h] [bp-7Ah]@11
  int v22; // [sp+14h] [bp-78h]@2
  char v23; // [sp+18h] [bp-74h]@12
  char v24; // [sp+19h] [bp-73h]@12
  char v25; // [sp+1Ah] [bp-72h]@12
  char v26; // [sp+1Bh] [bp-71h]@12
  char v27; // [sp+1Ch] [bp-70h]@12
  char v28; // [sp+1Dh] [bp-6Fh]@12
  char v29; // [sp+1Eh] [bp-6Eh]@12
  __int16 v30; // [sp+1Fh] [bp-6Dh]@12
  char v31; // [sp+21h] [bp-6Bh]@18
  __int16 v32; // [sp+22h] [bp-6Ah]@22
  __int16 v33; // [sp+24h] [bp-68h]@12
  __int16 v34; // [sp+26h] [bp-66h]@12
  __int16 v35; // [sp+28h] [bp-64h]@12
  __int16 v36; // [sp+2Ah] [bp-62h]@12
  __int16 v37; // [sp+2Ch] [bp-60h]@12
  __int16 v38; // [sp+2Eh] [bp-5Eh]@12
  __int16 v39; // [sp+30h] [bp-5Ch]@30
  __int16 v40; // [sp+32h] [bp-5Ah]@30
  __int16 v41; // [sp+34h] [bp-58h]@30
  __int16 v42; // [sp+36h] [bp-56h]@30
  char v43; // [sp+38h] [bp-54h]@9

  if ( !*(_DWORD *)(a1 + 300) || (v4 = *(_DWORD *)(a1 + 80) == 0, v22 = 1, v4) )
    v22 = 0;
  v18 = *(_BYTE *)(a1 + 69);
  v5 = *(_DWORD *)(a1 + 92);
  v6 = 1;
  *(_BYTE *)(a1 + 69) = 16;
  if ( v5 != 2 && v5 )
  {
    if ( v5 != 4 && v5 != 1 )
    {
      *(_BYTE *)(a1 + 69) = v18;
      return -14;
    }
    v6 = sub_1000B860(a1, (int)&v43, a3);
    if ( v6 != 1 )
      goto LABEL_39;
  }
  else
  {
    v19 = 0;
    v20 = 0;
    v21 = a3;
  }
  v8 = *(_DWORD *)(a1 + 92);
  v23 = -1;
  v24 = 83;
  v25 = 77;
  v26 = 66;
  v27 = a4;
  v28 = 0;
  v29 = 0;
  v30 = 0;
  v33 = 0;
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  v38 = 0;
  if ( v8 != 4 && a4 != -43 && a4 != -48 && a4 != -47 && a4 != -42 && a4 != -41 )
  {
    v31 = *(_BYTE *)(a1 + 224);
    if ( a4 == 114 )
    {
      v9 = *(_WORD *)(a1 + 228);
      if ( *(_DWORD *)(a1 + 80) )
        v10 = v9 | 0x8000;
      else
        v10 = v9 & 0x7FFF;
      v11 = *(_DWORD *)(a1 + 112) == 0;
      v32 = v10;
      if ( v11 )
        goto LABEL_30;
      v12 = v10 | 0x800;
    }
    else
    {
      v13 = *(_WORD *)(a1 + 226);
      if ( *(_DWORD *)(a1 + 112) )
        v13 |= 0x800u;
      if ( v22 )
        v12 = v13 | 0x8000;
      else
        v12 = v13 & 0x7FFF;
    }
    v32 = v12;
LABEL_30:
    v14 = *(_WORD *)(a1 + 250);
    v15 = *(_WORD *)(a1 + 252);
    v39 = *(_WORD *)(a1 + 248);
    v16 = *(_WORD *)(a1 + 254);
    v40 = v14;
    v41 = v15;
    v42 = v16;
    goto LABEL_32;
  }
  v31 = 0;
  v32 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  v42 = 0;
LABEL_32:
  if ( v8 != 2 && v8 )
  {
    v17 = a2;
    if ( !sub_1000B940(a1, a2, (int)&v43) )
      goto LABEL_38;
  }
  else
  {
    v17 = a2;
    if ( !sub_1000B770(a1, a2, (int)&v19) )
    {
LABEL_38:
      v6 = -17;
      goto LABEL_39;
    }
  }
  if ( !sub_10007110(a1, v17, (int)&v23) )
    goto LABEL_38;
LABEL_39:
  *(_BYTE *)(a1 + 69) = v18;
  return v6;
}

//----- (10007500) --------------------------------------------------------
signed int __cdecl sub_10007500(int a1, int a2, int a3, int a4)
{
  int v4; // esi@1
  char v5; // al@1
  char v7; // al@19
  int v8; // [sp+10h] [bp-4h]@3
  char v9; // [sp+18h] [bp+4h]@1

  v4 = a1;
  v5 = *(_BYTE *)(a1 + 70);
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_DWORD *)(a3 + 24) = 0;
  *(_DWORD *)(a3 + 28) = 0;
  v9 = v5;
  *(_BYTE *)(v4 + 70) = 16;
  if ( sub_100026B0(v4, a2, (void *)a3, a4, 4u)
    && sub_10002660(v4, a2, (void *)(a3 + 4), (int *)a4, 1u)
    && sub_10002660(v4, a2, &v8, (int *)a4, 2u)
    && sub_10002660(v4, a2, (char *)&v8 + 2, (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 9), (int *)a4, 1u)
    && sub_10002660(v4, a2, (void *)(a3 + 10), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 12), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 14), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 16), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 18), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 20), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 22), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 24), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 26), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 28), (int *)a4, 2u)
    && sub_10002660(v4, a2, (void *)(a3 + 30), (int *)a4, 2u) )
  {
    if ( HIWORD(v8) == -16384 )
    {
      *(_WORD *)(a3 + 7) = v8;
      *(_BYTE *)(a3 + 6) = 0;
      *(_BYTE *)(a3 + 5) = -64;
      *(_BYTE *)(v4 + 70) = v9;
      return 1;
    }
    *(_WORD *)(a3 + 7) = HIWORD(v8);
    v7 = v8;
    *(_BYTE *)(a3 + 6) = BYTE1(v8);
    *(_BYTE *)(a3 + 5) = v7;
  }
  *(_BYTE *)(v4 + 70) = v9;
  return 1;
}

//----- (10007710) --------------------------------------------------------
char __cdecl sub_10007710(unsigned __int8 a1, unsigned __int16 a2)
{
  char v3; // [sp+4h] [bp-3Ch]@1
  char v4; // [sp+5h] [bp-3Bh]@1
  __int16 v5; // [sp+3Dh] [bp-3h]@1
  char v6; // [sp+3Fh] [bp-1h]@1

  v3 = 0;
  memset(&v4, 0, 0x38u);
  v5 = 0;
  v6 = 0;
  return nullsub_1(a2 | (a1 << 24), &v3);
}

//----- (10007750) --------------------------------------------------------
int __cdecl sub_10007750(int a1, int a2, char a3, int a4)
{
  int result; // eax@3
  char v5; // zf@16
  signed int v6; // ecx@16
  char *v7; // edi@16
  __int16 *v8; // esi@16
  __int16 v9; // dx@20
  __int16 v10; // cx@20
  unsigned int v11; // eax@20
  signed int v12; // [sp+10h] [bp-30h]@1
  char v13; // [sp+14h] [bp-2Ch]@1
  __int16 v14; // [sp+18h] [bp-28h]@1
  char v15; // [sp+1Ah] [bp-26h]@1
  char v16; // [sp+1Bh] [bp-25h]@1
  char v17; // [sp+1Ch] [bp-24h]@1
  char v18; // [sp+1Dh] [bp-23h]@1
  char v19; // [sp+1Eh] [bp-22h]@1
  char v20; // [sp+1Fh] [bp-21h]@1
  char v21; // [sp+20h] [bp-20h]@4
  char v22; // [sp+24h] [bp-1Ch]@6
  int v23; // [sp+25h] [bp-1Bh]@8
  char v24; // [sp+29h] [bp-17h]@20
  unsigned int v25; // [sp+2Ah] [bp-16h]@20
  char v26; // [sp+2Eh] [bp-12h]@16
  __int16 v27; // [sp+38h] [bp-8h]@20
  __int16 v28; // [sp+3Ah] [bp-6h]@20
  __int16 v29; // [sp+3Ch] [bp-4h]@20
  __int16 v30; // [sp+3Eh] [bp-2h]@20

  v14 = 0;
  v15 = 0;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  v12 = 1;
  if ( !sub_1000B7E0(a1, a2, (int)&v13, (int *)a4) )
    return -11;
  if ( v13 )
  {
    nullsub_1(a1, a2);
    return -12;
  }
  if ( !sub_10007500(a1, a2, (int)&v21, a4) )
    return -11;
  if ( v22 != a3 )
    return -13;
  if ( !(_BYTE)v23 && !HIWORD(v23) )
    goto LABEL_16;
  if ( HIWORD(v23) == 22 )
  {
    if ( (_BYTE)v23 == -64 )
    {
      v12 = -1073741802;
      goto LABEL_16;
    }
LABEL_21:
    sub_10007710(v23, HIWORD(v23));
    return HIWORD(v23) | ((unsigned __int8)v23 << 24);
  }
  if ( HIWORD(v23) != -32768 || (_BYTE)v23 != 5 )
    goto LABEL_21;
  v12 = 83918848;
LABEL_16:
  v5 = 1;
  v6 = 2;
  v7 = &v26;
  v8 = &v14;
  do
  {
    if ( !v6 )
      break;
    v5 = *(_DWORD *)v8 == *(_DWORD *)v7;
    v8 += 2;
    v7 += 4;
    --v6;
  }
  while ( v5 );
  v9 = v28;
  *(_WORD *)(a1 + 254) = v30;
  v10 = v29;
  *(_WORD *)(a1 + 250) = v9;
  LOBYTE(v9) = v24;
  *(_DWORD *)(a1 + 116) = !v5;
  *(_WORD *)(a1 + 248) = v27;
  v11 = v25;
  *(_WORD *)(a1 + 278) = v25;
  *(_DWORD *)(a1 + 300) = (v11 >> 15) & 1;
  result = v12;
  *(_WORD *)(a1 + 252) = v10;
  *(_BYTE *)(a1 + 277) = v9;
  return result;
}

//----- (100078E0) --------------------------------------------------------
int __cdecl sub_100078E0(int a1, SOCKET s, int a3, struct timeval timeout)
{
  int v4; // edi@1
  char v5; // cl@1
  unsigned __int8 v6; // sf@9
  unsigned __int8 v7; // of@9
  signed int v8; // ecx@9
  char v9; // zf@9
  int result; // eax@15
  char v11; // [sp+13h] [bp-9h]@1
  int v12; // [sp+14h] [bp-8h]@1
  int v13; // [sp+18h] [bp-4h]@1

  v5 = *(_BYTE *)(a1 + 70);
  *(_BYTE *)(a1 + 70) = 0;
  v13 = 2;
  v12 = 0;
  v11 = v5;
  *(_DWORD *)a3 = 0;
  v4 = sub_100061C0(s, a3, timeout);
  if ( v4 == 1 )
  {
    while ( !sub_10002660(a1, a3, &v12, &v13, 2u) )
    {
      *(_DWORD *)a3 = 0;
      *(_DWORD *)a3 = 0;
      v4 = sub_100061C0(s, a3, timeout);
      if ( v4 != 1 )
        goto LABEL_15;
    }
    v12 += 4;
    if ( **(_BYTE **)(a3 + 8) == -123 )
    {
      if ( dword_100181E8
        || (v12 = 0, *(_DWORD *)a3 = 0,
                     dword_100181E8 = 1,
                     sub_100078E0(a1, s, a3, (struct timeval)858993459200i64) != 1) )
        v4 = -19;
    }
    else
    {
      v8 = *(_DWORD *)a3;
      v7 = __SETO__((unsigned __int16)v12, *(_DWORD *)a3);
      v9 = (unsigned __int16)v12 == *(_DWORD *)a3;
      v6 = (unsigned __int16)v12 - *(_DWORD *)a3 < 0;
      dword_100181E8 = 0;
      if ( v9 || v6 ^ v7 )
      {
        v4 = 1;
      }
      else
      {
        if ( v8 < (unsigned __int16)v12 )
        {
          do
            v4 = sub_100061C0(s, a3, timeout);
          while ( v4 == 1 && *(_DWORD *)a3 < (signed int)(unsigned __int16)v12 );
        }
      }
    }
  }
LABEL_15:
  *(_BYTE *)(a1 + 70) = v11;
  result = v4;
  dword_100181E8 = 0;
  return result;
}
// 100181E8: using guessed type int dword_100181E8;

//----- (10007A30) --------------------------------------------------------
int __cdecl sub_10007A30(int a1, int a2, int a3, char a4)
{
  int result; // eax@1
  SOCKET v5; // ST14_4@1
  int v6; // [sp+8h] [bp-4h]@1

  v5 = *(_DWORD *)a3;
  v6 = 0;
  result = sub_10006130(v5, a1);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(a3 + 120) )
    {
      *(_DWORD *)a2 = 0;
      result = sub_100078E0(a3, *(_DWORD *)a3, a2, *(struct timeval *)(a3 + 8));
      if ( result == 1 )
      {
        if ( a4 == -1 )
        {
          result = (((**(_BYTE **)(a2 + 8) == -126) - 1) & 0xFFFFFFF3) + 1;
        }
        else
        {
          v6 = 0;
          for ( result = sub_10007750(a3, a2, a4, (int)&v6); result != 1; result = sub_10007750(a3, a2, a4, (int)&v6) )
          {
            if ( result != -13 )
              break;
            *(_DWORD *)a2 = 0;
            result = sub_100078E0(a3, *(_DWORD *)a3, a2, *(struct timeval *)(a3 + 8));
            if ( result != 1 )
              break;
            v6 = 0;
          }
        }
      }
    }
    else
    {
      result = 1;
    }
  }
  return result;
}

//----- (10007B00) --------------------------------------------------------
signed int __cdecl sub_10007B00(int a1, int a2, int a3, char a4)
{
  signed int result; // eax@1
  SOCKET v5; // edx@1
  int v6; // [sp+4h] [bp-14h]@1
  struct sockaddr from; // [sp+8h] [bp-10h]@4

  v5 = *(_DWORD *)a3;
  v6 = 0;
  result = sub_10006170(v5, a1, (const struct sockaddr *)(a3 + 16));
  if ( result == 1 )
  {
    if ( *(_DWORD *)(a3 + 120) )
    {
      *(_DWORD *)a2 = 0;
      result = sub_10006280(*(_DWORD *)a3, a2, &from, *(struct timeval *)(a3 + 8));
      if ( result == 1 )
      {
        if ( a4 == -1 )
        {
          result = **(_BYTE **)(a2 + 8) != *(_BYTE *)(a3 + 110) ? -12 : 1;
        }
        else
        {
          v6 = 0;
          result = sub_10007750(a3, a2, a4, (int)&v6);
        }
      }
    }
    else
    {
      result = 1;
    }
  }
  return result;
}

//----- (10007BA0) --------------------------------------------------------
signed int __cdecl sub_10007BA0(int a1, int a2, int a3, char a4)
{
  int v4; // eax@1
  signed int result; // eax@3

  v4 = *(_DWORD *)(a1 + 92);
  if ( v4 != 2 && v4 )
    result = sub_10007B00(a2, a3, a1, a4);
  else
    result = sub_10007A30(a2, a3, a1, a4);
  return result;
}

//----- (10007BF0) --------------------------------------------------------
signed int __cdecl sub_10007BF0(signed int a1, int a2, int a3, int a4)
{
  unsigned __int16 v4; // ax@1
  signed int v5; // esi@1
  signed int result; // eax@2
  int v7; // ebp@2
  int v8; // edi@2
  char v9; // [sp+14h] [bp+4h]@1

  v5 = a1;
  v9 = *(_BYTE *)(a1 + 69);
  v4 = *(_WORD *)(v5 + 260);
  *(_BYTE *)(v5 + 69) = 16;
  if ( v4 >= 9u )
  {
    if ( v4 > 0xAu )
    {
      *(_BYTE *)(v5 + 69) = v9;
      return -15;
    }
    if ( *(_DWORD *)(v5 + 128) && *(_DWORD *)(v5 + 112) )
    {
      v8 = a3;
      v7 = a2;
      result = sub_1000D860(v5, a2, a3, 0, a4);
    }
    else
    {
      v8 = a3;
      v7 = a2;
      result = sub_1000D7A0(v5, a2, a3, 0);
    }
  }
  else
  {
    v8 = a3;
    v7 = a2;
    result = sub_1000D700(v5, a2, a3, 0);
  }
  if ( result == 1 )
  {
    *(_DWORD *)v8 = 0;
    *(_DWORD *)v7 = 0;
    result = sub_1000C1A0(v5, v7, v8, 0);
  }
  *(_BYTE *)(v5 + 69) = v9;
  return result;
}

//----- (10007CB0) --------------------------------------------------------
signed int __cdecl sub_10007CB0(int a1, int a2)
{
  int v2; // edi@1
  const char *v3; // esi@1
  char v4; // cl@1
  char v5; // zf@1
  int v6; // eax@4
  void *v8; // eax@9
  const char v9; // al@13
  int v10; // esi@18
  int v11; // ebx@21
  char *v12; // eax@23
  char v13; // cl@24
  char v14; // zf@26
  signed int v15; // ecx@26
  int v16; // edi@26
  char *v17; // esi@26
  char v18; // [sp+Fh] [bp-1A5h]@1
  signed int v19; // [sp+10h] [bp-1A4h]@10
  int v20; // [sp+14h] [bp-1A0h]@1
  int v21; // [sp+18h] [bp-19Ch]@1
  void *v22; // [sp+1Ch] [bp-198h]@1
  unsigned int v23; // [sp+20h] [bp-194h]@25
  char v24; // [sp+24h] [bp-190h]@14
  char v25; // [sp+25h] [bp-18Fh]@25

  v4 = *(_BYTE *)(a1 + 69);
  v3 = *(const char **)(a1 + 220);
  v21 = 0;
  v2 = 0;
  v22 = 0;
  v5 = *(_DWORD *)(a1 + 128) == 0;
  v20 = 0;
  v18 = v4;
  if ( v5 && *(_BYTE *)(a1 + 2292) == 1 )
  {
    *(_DWORD *)(a1 + 112) = 0;
LABEL_4:
    *(_WORD *)(a1 + 228) &= 0xF7FFu;
    *(_WORD *)(a1 + 226) &= 0xF7FFu;
    v6 = *(_DWORD *)(a1 + 232) & 0x7FFFFFFF;
    goto LABEL_5;
  }
  if ( !*(_DWORD *)(a1 + 112) )
    goto LABEL_4;
  *(_WORD *)(a1 + 226) |= 0x800u;
  *(_WORD *)(a1 + 228) |= 0x800u;
  v6 = *(_DWORD *)(a1 + 232) | 0x80000000;
LABEL_5:
  *(_DWORD *)(a1 + 232) = v6;
  if ( *(_DWORD *)(a1 + 312) )
    return 1;
  *(_BYTE *)(a1 + 69) = 16;
  v20 = 0;
  v21 = 8192;
  v8 = sub_10008320(0x2000u);
  v22 = v8;
  if ( v8 )
  {
    if ( v3 )
    {
      if ( *v3 == 92 )
      {
        do
          v9 = (v3++)[1];
        while ( v9 == 92 );
      }
      sub_100086B0(v3, (int)&v24, 0);
    }
    else
    {
      v24 = 0;
    }
    if ( ntohs(*(_WORD *)(a1 + 18)) != 139 && *(_DWORD *)(a1 + 100) != 1 )
    {
      v10 = a2;
    }
    else
    {
      v10 = a2;
      v19 = sub_1000BC10(a1, (int)&v20, a1 + 3900);
      if ( v19 != 1 )
        goto LABEL_34;
    }
    v11 = a1 + 3900;
    *(_DWORD *)(a1 + 3900) = 0;
    v20 = 0;
    v19 = sub_1000EA50(a1, a1, (int)&v20, a1 + 3900, 0, v10);
    if ( v19 != 1 || (*(_DWORD *)v11 = 0, v20 = 0, v19 = sub_10007BF0(a1, (int)&v20, a1 + 3900, v10), v19 != 1) )
      goto LABEL_34;
    v12 = &v24;
    *(_DWORD *)v11 = 0;
    v20 = 0;
    do
      v13 = *v12++;
    while ( v13 );
    v23 = v12 - &v25;
    if ( v12 != &v25 )
    {
      v16 = (int)"lanman";
      v17 = &v24;
      v15 = 7;
      v14 = 1;
      do
      {
        if ( !v15 )
          break;
        v14 = *v17++ == *(_BYTE *)v16++;
        --v15;
      }
      while ( v14 );
      if ( v14 )
      {
        v2 = 0;
        goto LABEL_34;
      }
      v2 = 0;
    }
    v19 = sub_1000E220(a1, (int)&v20, a1 + 3900, v2);
LABEL_34:
    v8 = v22;
    goto LABEL_35;
  }
  v19 = -17;
LABEL_35:
  *(_BYTE *)(a1 + 69) = v18;
  if ( v8 != (void *)v2 )
    free(v8);
  return v19;
}

//----- (10007EC0) --------------------------------------------------------
signed int __cdecl sub_10007EC0(int a1, const void *a2, int a3)
{
  void *v4; // eax@4

  if ( a2 )
  {
    if ( !sub_100034E0(a1, a1 + 212, a2) )
      return -17;
  }
  else
  {
    v4 = *(void **)(a1 + 220);
    *(_DWORD *)(a1 + 216) = 0;
    *(_DWORD *)(a1 + 212) = 0;
    if ( v4 )
    {
      free(v4);
      *(_DWORD *)(a1 + 220) = 0;
    }
  }
  return sub_10007CB0(a1, a3);
}

//----- (10007F30) --------------------------------------------------------
signed int __cdecl sub_10007F30(int a1)
{
  void *v1; // eax@1
  char v2; // bl@1
  signed int v3; // edi@2
  int v5; // [sp+10h] [bp-18h]@1
  size_t Size; // [sp+14h] [bp-14h]@1
  void *v7; // [sp+18h] [bp-10h]@1
  int v8; // [sp+1Ch] [bp-Ch]@1
  int v9; // [sp+20h] [bp-8h]@1
  void *Memory; // [sp+24h] [bp-4h]@1

  v2 = *(_BYTE *)(a1 + 69);
  v9 = 0;
  v8 = 0;
  Memory = 0;
  *(_BYTE *)(a1 + 69) = 16;
  v5 = 0;
  Size = 8192;
  v1 = sub_10008320(0x2000u);
  v7 = v1;
  if ( v1 )
  {
    v8 = 0;
    v9 = 8192;
    Memory = sub_10008320(Size);
    if ( Memory )
      v3 = sub_1000EE80(a1, (int)&v5, (int)&v8, 0);
    else
      v3 = -17;
    v1 = v7;
  }
  else
  {
    v3 = -17;
  }
  *(_BYTE *)(a1 + 69) = v2;
  if ( v1 )
  {
    free(v1);
    v7 = 0;
  }
  if ( Memory )
    free(Memory);
  return v3;
}

//----- (10008000) --------------------------------------------------------
u_long __cdecl sub_10008000(int a1, int a2, unsigned int a3, signed int a4)
{
  u_long result; // eax@2
  int v5; // edx@3
  int v6; // ecx@3
  int v7; // ecx@3
  char v8; // [sp+10h] [bp-98h]@2
  int v9; // [sp+20h] [bp-88h]@3
  int v10; // [sp+24h] [bp-84h]@3
  int v11; // [sp+28h] [bp-80h]@3
  int v12; // [sp+2Ch] [bp-7Ch]@3
  char v13; // [sp+38h] [bp-70h]@2
  char v14; // [sp+90h] [bp-18h]@3

  *(_DWORD *)(a2 + 14) = 0;
  *(_DWORD *)(a2 + 18) = 0;
  *(_BYTE *)(a2 + 14) = a4;
  *(_BYTE *)(a2 + 15) = BYTE1(a4);
  *(_BYTE *)(a2 + 16) = a4 >> 16;
  *(_BYTE *)(a2 + 17) = a4 >> 24;
  if ( *(_DWORD *)(a1 + 112) )
  {
    memset(&v13, 0, 0x58u);
    sub_10013990((int)&v13);
    sub_100145B0((int)&v13, (const void *)(a1 + 2712), 0x10u);
    sub_100145B0((int)&v13, (const void *)a2, a3);
    result = sub_10014670((int)&v13, (int)&v8);
  }
  else
  {
    sub_10013770((int)&v8, a1 + 2856, 16);
    v5 = *(_DWORD *)(a1 + 2860);
    v6 = *(_DWORD *)(a1 + 2856);
    v11 = *(_DWORD *)(a1 + 2864);
    v9 = v6;
    v7 = *(_DWORD *)(a1 + 2868);
    v10 = v5;
    v12 = v7;
    sub_1000B5B0((int)&v9, a1 + 2824, (int)&v14);
    memset(&v13, 0, 0x58u);
    sub_10013990((int)&v13);
    sub_100145B0((int)&v13, &v8, 0x10u);
    sub_100145B0((int)&v13, &v14, 0x18u);
    sub_100145B0((int)&v13, (const void *)a2, a3);
    result = sub_10014670((int)&v13, (int)&v8);
  }
  return result;
}

//----- (10008150) --------------------------------------------------------
int __cdecl sub_10008150(int a1, int a2)
{
  int v2; // ebx@1
  int v3; // eax@3
  int v4; // ecx@3
  int v5; // edx@3
  int result; // eax@4
  unsigned int v7; // [sp+Ch] [bp-9Ch]@1
  int v8; // [sp+10h] [bp-98h]@2
  int v9; // [sp+14h] [bp-94h]@2
  int v10; // [sp+20h] [bp-88h]@3
  int v11; // [sp+24h] [bp-84h]@3
  int v12; // [sp+28h] [bp-80h]@3
  int v13; // [sp+2Ch] [bp-7Ch]@3
  char v14; // [sp+38h] [bp-70h]@2
  char v15; // [sp+90h] [bp-18h]@3

  v2 = *(_DWORD *)(a2 + 8);
  v7 = *(_DWORD *)a2 - 4;
  *(_BYTE *)(v2 + 18) = *(_BYTE *)(a1 + 308);
  *(_BYTE *)(v2 + 19) = *(_WORD *)(a1 + 308) >> 8;
  *(_BYTE *)(v2 + 20) = *(_BYTE *)(a1 + 310);
  *(_BYTE *)(v2 + 21) = *(_BYTE *)(a1 + 311);
  *(_DWORD *)(v2 + 22) = 0;
  if ( *(_DWORD *)(a1 + 112) )
  {
    memset(&v14, 0, 0x58u);
    sub_10013990((int)&v14);
    sub_100145B0((int)&v14, (const void *)(a1 + 2712), 0x10u);
    sub_100145B0((int)&v14, (const void *)(v2 + 4), v7);
    sub_10014670((int)&v14, (int)&v8);
    *(_DWORD *)(v2 + 18) = v8;
    *(_DWORD *)(v2 + 22) = v9;
  }
  else
  {
    sub_10013770((int)&v8, a1 + 2856, 16);
    v3 = *(_DWORD *)(a1 + 2860);
    v4 = *(_DWORD *)(a1 + 2864);
    v10 = *(_DWORD *)(a1 + 2856);
    v5 = *(_DWORD *)(a1 + 2868);
    v11 = v3;
    v12 = v4;
    v13 = v5;
    sub_1000B5B0((int)&v10, a1 + 2824, (int)&v15);
    memset(&v14, 0, 0x58u);
    sub_10013990((int)&v14);
    sub_100145B0((int)&v14, &v8, 0x10u);
    sub_100145B0((int)&v14, &v15, 0x18u);
    sub_100145B0((int)&v14, (const void *)(v2 + 4), v7);
    sub_10014670((int)&v14, (int)&v8);
    *(_DWORD *)(v2 + 18) = v8;
    *(_DWORD *)(v2 + 22) = v9;
  }
  result = *(_DWORD *)(a1 + 308) + 2;
  *(_DWORD *)(a1 + 308) = result;
  return result;
}

//----- (100082E0) --------------------------------------------------------
signed int __cdecl sub_100082E0(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@2
  int v5; // eax@3

  if ( *(_DWORD *)(a2 + 540) == 12 )
  {
    v5 = *(_DWORD *)(a2 + 136);
    *(_DWORD *)a3 = *(_DWORD *)(v5 + 20);
    *(_DWORD *)a4 = *(_DWORD *)(v5 + 24);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (10008320) --------------------------------------------------------
void *__cdecl sub_10008320(size_t Size)
{
  void *v1; // edx@1
  unsigned int i; // ecx@2
  unsigned int v3; // edi@2

  v1 = malloc(Size);
  if ( v1 )
  {
    memset(v1, 0, 4 * (Size >> 2));
    v3 = (unsigned int)((char *)v1 + 4 * (Size >> 2));
    for ( i = Size & 3; i; --i )
      *(_BYTE *)v3++ = 0;
  }
  return v1;
}

//----- (10008360) --------------------------------------------------------
signed int __cdecl sub_10008360(int a1)
{
  __int64 v2; // qax@1
  int v3; // eax@1
  DWORD v4; // ecx@1
  int v5; // edx@1
  struct _FILETIME FileTime; // [sp+4h] [bp-18h]@1
  struct _SYSTEMTIME SystemTime; // [sp+Ch] [bp-10h]@1

  GetSystemTime(&SystemTime);
  SystemTimeToFileTime(&SystemTime, &FileTime);
  LODWORD(v2) = FileTime.dwHighDateTime;
  *(_DWORD *)(a1 + 4) = 0;
  HIDWORD(v2) = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = v2;
  v3 = sub_100153F0(v2, 0x20u);
  v4 = FileTime.dwLowDateTime;
  *(_DWORD *)(a1 + 4) = v5;
  *(_DWORD *)a1 = v3;
  *(_DWORD *)(a1 + 4) = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = v4 | v3;
  return 1;
}

//----- (100083C0) --------------------------------------------------------
signed int __cdecl sub_100083C0(int a1, int a2, int a3)
{
  int v3; // eax@1
  char v4; // cl@5
  signed int result; // eax@10

  v3 = 0;
  if ( a3 <= 0 )
  {
LABEL_10:
    *(_BYTE *)(a2 + a3) = 0;
    result = 1;
  }
  else
  {
    while ( 1 )
    {
      if ( v3 <= a3 - 2 && !*(_BYTE *)(a1 + 2 * v3) && !*(_BYTE *)(a1 + 2 * v3 + 1) )
      {
        *(_BYTE *)(v3 + a2) = *(_BYTE *)(a1 + 2 * v3);
        return 1;
      }
      v4 = *(_BYTE *)(a1 + 2 * v3);
      if ( v4 < 32 )
        break;
      if ( v4 < 0 || v4 == 127 || *(_BYTE *)(a1 + 2 * v3 + 1) )
        break;
      *(_BYTE *)(v3++ + a2) = v4;
      if ( v3 >= a3 )
        goto LABEL_10;
    }
    result = 0;
  }
  return result;
}

//----- (10008430) --------------------------------------------------------
int __cdecl sub_10008430(int a1)
{
  int i; // eax@1

  for ( i = 0; *(_BYTE *)(i + a1) || *(_BYTE *)(i + a1 + 1); i += 2 )
    ;
  return i + 2;
}

//----- (10008450) --------------------------------------------------------
signed int __usercall sub_10008450<eax>(int a1<edi>, int a2, int a3, int a4)
{
  int v4; // ebx@1
  unsigned __int8 v5; // zf@1
  unsigned __int8 v6; // sf@1
  signed int v7; // eax@5
  int v8; // edi@5
  int v9; // ebx@8
  __int16 v11; // [sp-4h] [bp-1Ch]@6
  unsigned __int8 v12; // [sp+13h] [bp-5h]@1
  int v13; // [sp+14h] [bp-4h]@1

  v4 = a3;
  *(_DWORD *)a3 = 0;
  v5 = *(_DWORD *)a4 == 0;
  v6 = *(_DWORD *)a4 < 0;
  v13 = 0;
  v12 = 0;
  if ( v6 | v5 )
    return 1;
  while ( sub_10003930(a2, a4, (int)&v13, (int)&v12) )
  {
    if ( (char)v12 >= 0 )
      goto LABEL_12;
    if ( (v12 & 0xE0) == -64 )
    {
      LOWORD(a1) = v12 & 0x1F;
      v8 = a1 << 6;
      v7 = sub_10003930(a2, a4, (int)&v13, (int)&v12);
      if ( !v7 )
        return 0;
      LOWORD(v7) = v12 & 0x3F;
      a1 = v7 | v8;
      v11 = a1;
LABEL_13:
      if ( !sub_100036C0(a2, v4, v11) )
        return 0;
      goto LABEL_14;
    }
    if ( (v12 & 0xF0) != -32 )
    {
LABEL_12:
      v11 = v12;
      goto LABEL_13;
    }
    LOWORD(v4) = v12 & 0xF;
    v9 = v4 << 6;
    if ( !sub_10003930(a2, a4, (int)&v13, (int)&v12)
      || (LOWORD(a1) = v12 & 0x3F, a1 = (v9 | a1) << 6, !sub_10003930(a2, a4, (int)&v13, (int)&v12))
      || !sub_100036C0(a2, a3, ((_WORD)a1 | v12 & 0x3F) << 6) )
      return 0;
    v4 = a3;
LABEL_14:
    if ( v13 >= *(_DWORD *)a4 )
      return 1;
  }
  return 0;
}

//----- (100085A0) --------------------------------------------------------
signed int __cdecl sub_100085A0(int a1, int a2, int a3)
{
  unsigned __int8 v3; // zf@1
  unsigned __int8 v4; // sf@1
  char v5; // al@3
  char v7; // [sp-4h] [bp-18h]@6
  unsigned int v8; // [sp+Ch] [bp-8h]@1
  int v9; // [sp+10h] [bp-4h]@1

  *(_DWORD *)a2 = 0;
  v3 = *(_DWORD *)a3 == 0;
  v4 = *(_DWORD *)a3 < 0;
  v8 = 0;
  v9 = 0;
  if ( v4 | v3 )
    return 1;
  while ( sub_10002660(a1, a3, &v8, &v9, 2u) )
  {
    v5 = v8;
    if ( (_WORD)v8 < 0x80u )
      goto LABEL_10;
    if ( (_WORD)v8 >= 0x800u )
    {
      if ( !sub_10003750(a1, a2, (v8 >> 12) & 0xF | 0xE0) || !sub_10003750(a1, a2, (v8 >> 6) & 0x3F | 0x80) )
        return 0;
      v5 = v8 & 0x3F | 0x80;
LABEL_10:
      v7 = v5;
      goto LABEL_11;
    }
    if ( !sub_10003750(a1, a2, (v8 >> 6) & 0x1F | 0xC0) )
      return 0;
    v7 = v8 & 0x3F | 0x80;
LABEL_11:
    if ( !sub_10003750(a1, a2, v7) )
      return 0;
    if ( v9 >= *(_DWORD *)a3 )
      return 1;
  }
  return 0;
}

//----- (100086B0) --------------------------------------------------------
unsigned int __cdecl sub_100086B0(const char *a1, int a2, char a3)
{
  signed int v3; // edi@1
  int *v4; // esi@2
  unsigned int result; // eax@5

  v3 = 0;
  if ( (signed int)strlen(a1) < 0 )
  {
LABEL_5:
    result = strlen(a1);
  }
  else
  {
    v4 = (int *)a1;
    while ( *(_BYTE *)v4 != a3 )
    {
      *((_BYTE *)v4 + a2 - (_DWORD)a1) = tolower(*(_BYTE *)v4);
      ++v3;
      v4 = (int *)((char *)v4 + 1);
      if ( v3 > (signed int)strlen(a1) )
        goto LABEL_5;
    }
    *(_BYTE *)(v3 + a2) = 0;
    result = v3;
  }
  return result;
}

//----- (10008730) --------------------------------------------------------
int __cdecl sub_10008730(int a1, char *Dest)
{
  return sprintf(
           Dest,
           "%08X-%04X-%04X-%02X%02X-%02X%02X%02X%02X%02X%02X",
           *(_DWORD *)a1,
           *(_WORD *)(a1 + 4),
           *(_WORD *)(a1 + 6),
           *(_BYTE *)(a1 + 8),
           *(_BYTE *)(a1 + 9),
           *(_BYTE *)(a1 + 10),
           *(_BYTE *)(a1 + 11),
           *(_BYTE *)(a1 + 12),
           *(_BYTE *)(a1 + 13),
           *(_BYTE *)(a1 + 14),
           *(_BYTE *)(a1 + 15));
}

//----- (10008780) --------------------------------------------------------
char __cdecl sub_10008780(int a1, int a2)
{
  signed int v2; // eax@1
  signed int v3; // ebx@10
  int v4; // eax@12
  int v5; // ecx@12
  __int16 v6; // cx@15
  int v7; // ebx@15
  int v8; // eax@19
  __int16 v9; // dx@19

  LOBYTE(v2) = *(_BYTE *)(a1 + 2293);
  if ( (_BYTE)v2 == 68 )
  {
    LOBYTE(v2) = a2;
    *(_DWORD *)a2 = 0;
    *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 2676);
    *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 2364);
    *(_DWORD *)(a2 + 12) = *(_DWORD *)(a1 + 2508);
    *(_DWORD *)(a2 + 16) = *(_DWORD *)(a1 + 2412);
    *(_DWORD *)(a2 + 20) = *(_DWORD *)(a1 + 2556);
    *(_DWORD *)(a2 + 24) = *(_DWORD *)(a1 + 2508);
  }
  else
  {
    if ( (_BYTE)v2 == 9 || (_BYTE)v2 == 10 )
    {
      memset((void *)a2, 0, 0x30u);
      if ( !*(_DWORD *)(a1 + 80) )
        *(_DWORD *)(a1 + 2688) &= 0xFFFFFFFEu;
      *(_DWORD *)(a1 + 2692) = *(_DWORD *)(a1 + 2688);
      v3 = 0;
      do
        *(_BYTE *)(a1 + v3++ + 2832) = rand();
      while ( v3 < 8 );
      *(_DWORD *)a2 = dword_100162B8;
      *(_DWORD *)(a2 + 4) = dword_100162BC;
      *(_DWORD *)(a2 + 8) = 1;
      v4 = *(_DWORD *)(a1 + 2688);
      *(_DWORD *)(a2 + 12) = v4;
      v5 = *(_DWORD *)(a1 + 92);
      if ( v5 == 1 || v5 == 4 )
        *(_DWORD *)(a2 + 12) = v4 | 0x40;
      v7 = *(_DWORD *)(a2 + 12) & 0xFFFFCFFF;
      v6 = 0;
      *(_DWORD *)(a2 + 44) = 0;
      *(_WORD *)(a2 + 26) = 0;
      *(_DWORD *)(a2 + 40) = 0;
      *(_WORD *)(a2 + 18) = 0;
      *(_DWORD *)(a2 + 12) = v7;
      if ( BYTE1(v7) & 0x20 )
      {
        if ( *(_DWORD *)(a1 + 2356) )
        {
          *(_DWORD *)(a2 + 44) = *(_DWORD *)(a1 + 2508);
          *(_WORD *)(a2 + 26) = *(_WORD *)(a1 + 2500) - 1;
        }
        else
        {
          *(_DWORD *)(a2 + 12) = v7 & 0xFFFFDFFF;
          *(_WORD *)(a2 + 26) = 0;
        }
      }
      v8 = *(_DWORD *)(a2 + 12);
      v9 = *(_WORD *)(a2 + 26);
      *(_WORD *)(a2 + 24) = v9;
      if ( BYTE1(v8) & 0x10 )
      {
        if ( *(_DWORD *)(a1 + 2356) )
        {
          *(_DWORD *)(a2 + 40) = *(_DWORD *)(a1 + 2364);
          v6 = *(_WORD *)(a1 + 2356) - 1;
        }
        else
        {
          *(_DWORD *)(a2 + 12) = v8 & 0xFFFFEFFF;
        }
        *(_WORD *)(a2 + 18) = v6;
      }
      *(_WORD *)(a2 + 16) = *(_WORD *)(a2 + 18);
      if ( *(_DWORD *)(a1 + 2688) & 0x2000000 )
      {
        *(_BYTE *)(a2 + 32) = *(_BYTE *)(a1 + 2656);
        *(_BYTE *)(a2 + 33) = *(_BYTE *)(a1 + 2657);
        *(_WORD *)(a2 + 34) = *(_WORD *)(a1 + 2658);
        *(_BYTE *)(a2 + 36) = *(_BYTE *)(a1 + 2660);
        *(_BYTE *)(a2 + 37) = *(_BYTE *)(a1 + 2661);
        *(_BYTE *)(a2 + 38) = *(_BYTE *)(a1 + 2662);
        *(_BYTE *)(a2 + 39) = *(_BYTE *)(a1 + 2663);
      }
      v2 = 32;
      if ( *(_DWORD *)(a2 + 12) & 0x2000000 )
        v2 = 40;
      *(_DWORD *)(a2 + 28) = v2;
      *(_DWORD *)(a2 + 20) = v2 + v9;
    }
  }
  return v2;
}
// 100162B8: using guessed type int dword_100162B8;
// 100162BC: using guessed type int dword_100162BC;

//----- (100087C0) --------------------------------------------------------
char __cdecl sub_100087C0(int a1, void *a2, int a3)
{
  char result; // al@1

  result = *(_BYTE *)(a1 + 2293);
  switch ( result )
  {
    case 68:
      result = nullsub_1(a1, a2);
      break;
    case 9:
      result = sub_10011220(a1);
      break;
    case 10:
      result = sub_100108F0(a1, a2, a3);
      break;
  }
  return result;
}
// 10011220: using guessed type _BYTE __cdecl sub_10011220(int a1);

//----- (10008800) --------------------------------------------------------
int __cdecl sub_10008800(int a1, int a2, int a3, int a4)
{
  char v4; // al@1
  int result; // eax@2
  int i; // eax@4

  v4 = *(_BYTE *)(a1 + 2293);
  if ( v4 == 10 )
  {
    result = sub_1000F910(a1, a2, a3, a4);
  }
  else
  {
    if ( v4 == 9 )
    {
      for ( i = 0; ; ++i )
      {
        if ( i >= a3 - 2 )
          return 0;
        if ( *(_BYTE *)(i + a2) == 78 && *(_BYTE *)(i + a2 + 1) == 84 && *(_BYTE *)(i + a2 + 2) == 76 )
          break;
      }
      result = sub_1000F910(a1, a2 + i, a3 - i, a4) != 0;
    }
    else
    {
      result = v4 == 68;
    }
  }
  return result;
}

//----- (10008840) --------------------------------------------------------
int __cdecl sub_10008840(int a1, int a2, int a3)
{
  char v3; // al@1
  int result; // eax@2

  v3 = *(_BYTE *)(a1 + 2293);
  switch ( v3 )
  {
    case 10:
      result = sub_1000FC80(a1, a2, a3);
      break;
    case 9:
      result = sub_10011280(a1, a2, a3);
      break;
    case 68:
      result = sub_10011730(a1, a2, a3);
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (10008880) --------------------------------------------------------
int __cdecl sub_10008880(int a1, int a2, int a3)
{
  char v3; // al@1
  int result; // eax@2

  v3 = *(_BYTE *)(a1 + 2293);
  if ( v3 == 10 )
  {
    result = sub_1000FE30(a1, a2, a3);
  }
  else
  {
    if ( v3 == 9 )
      result = sub_10011430(a1, a2, a3);
    else
      result = 0;
  }
  return result;
}

//----- (100088B0) --------------------------------------------------------
int __cdecl sub_100088B0(int a1, int a2)
{
  char v2; // al@1
  int result; // eax@2

  v2 = *(_BYTE *)(a1 + 2293);
  switch ( v2 )
  {
    case 10:
      result = sub_10010340(a2);
      break;
    case 9:
      result = sub_100115A0(a2);
      break;
    case 68:
      result = sub_10011690(a2);
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (10008900) --------------------------------------------------------
int __cdecl sub_10008900(int a1, int a2)
{
  char v2; // al@1
  int result; // eax@2

  v2 = *(_BYTE *)(a1 + 2293);
  switch ( v2 )
  {
    case 10:
      result = sub_10010360(a2);
      break;
    case 9:
      result = sub_100115C0(a2);
      break;
    case 68:
      result = sub_10011880();
      break;
    default:
      result = 0;
      break;
  }
  return result;
}

//----- (10008950) --------------------------------------------------------
int __cdecl sub_10008950(int a1)
{
  char v1; // al@1
  int result; // eax@2

  v1 = *(_BYTE *)(a1 + 2293);
  if ( v1 == 10 )
  {
    result = 3;
  }
  else
  {
    if ( v1 == 9 )
      result = 4;
    else
      result = ((v1 != 68) - 1) & 2;
  }
  return result;
}

//----- (10008980) --------------------------------------------------------
signed int __cdecl sub_10008980(int a1, int a2, int a3, unsigned int a4)
{
  char v4; // al@1
  signed int result; // eax@2

  v4 = *(_BYTE *)(a1 + 2293);
  switch ( v4 )
  {
    case 10:
      result = sub_10010CF0(a1, a2, a3, a4);
      break;
    case 9:
      result = sub_100115F0(a1, a2, a3, a4);
      break;
    case 68:
      result = sub_10011C60(a1, a2, a3, a4);
      break;
    default:
      result = -32;
      break;
  }
  return result;
}
// 100115F0: using guessed type _DWORD __cdecl sub_100115F0(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (100089C0) --------------------------------------------------------
signed int __cdecl sub_100089C0(int a1)
{
  char v1; // al@1
  signed int result; // eax@6

  v1 = *(_BYTE *)(a1 + 2293);
  if ( v1 != 10 && v1 != 9 )
  {
    if ( v1 == 68 )
      result = 32;
    else
      result = 0;
  }
  else
  {
    result = 16;
  }
  return result;
}

//----- (100089F0) --------------------------------------------------------
signed int __cdecl sub_100089F0(int a1, int a2, int a3, int a4, int a5)
{
  char v5; // al@1
  signed int result; // eax@2
  unsigned int v7; // eax@8
  char v8; // [sp+0h] [bp-18h]@9
  char v9; // [sp+1h] [bp-17h]@9
  char v10; // [sp+2h] [bp-16h]@9
  char v11; // [sp+3h] [bp-15h]@9
  char v12; // [sp+4h] [bp-14h]@9
  char v13; // [sp+5h] [bp-13h]@9
  char v14; // [sp+6h] [bp-12h]@9
  char v15; // [sp+7h] [bp-11h]@9
  char v16; // [sp+8h] [bp-10h]@9

  v5 = *(_BYTE *)(a1 + 2293);
  switch ( v5 )
  {
    case 10:
      result = sub_10010F60(a1, a2, a3, a4, a5);
      break;
    case 9:
      result = sub_10011610(a1, a2, a3, a4, a5);
      break;
    case 68:
      v7 = *(_DWORD *)(a1 + 1224) + *(_DWORD *)(a1 + 1228);
      if ( *(_BYTE *)(a1 + 2292) >= 6 )
      {
        v8 = v7 >> 24;
        v9 = v7 >> 16;
        v11 = v7;
        v13 = 0;
        v14 = 0;
        v15 = 0;
        v10 = BYTE1(v7);
        v12 = -128;
        sub_10011BB0(a1 + 2712, (int)&v8, (int)&v16);
        sub_10011A60(a3 + *(_DWORD *)(a2 + 8), (int)&v16, a4);
      }
      result = 1;
      break;
    default:
      result = -32;
      break;
  }
  return result;
}
// 10011610: using guessed type _DWORD __cdecl sub_10011610(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (10008A30) --------------------------------------------------------
signed int __cdecl sub_10008A30(int a1, int a2, int a3, unsigned int a4, int a5)
{
  char v5; // al@1
  signed int result; // eax@2
  unsigned int v7; // eax@8
  char v8; // [sp+0h] [bp-18h]@9
  char v9; // [sp+1h] [bp-17h]@9
  char v10; // [sp+2h] [bp-16h]@9
  char v11; // [sp+3h] [bp-15h]@9
  char v12; // [sp+4h] [bp-14h]@9
  char v13; // [sp+5h] [bp-13h]@9
  char v14; // [sp+6h] [bp-12h]@9
  char v15; // [sp+7h] [bp-11h]@9
  char v16; // [sp+8h] [bp-10h]@9

  v5 = *(_BYTE *)(a1 + 2293);
  switch ( v5 )
  {
    case 10:
      result = sub_10011040(a1, a2, a3, a4, a5);
      break;
    case 9:
      result = sub_10011620(a1, a2, a3, a4, a5);
      break;
    case 68:
      v7 = *(_DWORD *)(a1 + 1224) + *(_DWORD *)(a1 + 1228);
      if ( *(_BYTE *)(a1 + 2292) >= 6 )
      {
        v8 = v7 >> 24;
        v9 = v7 >> 16;
        v11 = v7;
        v12 = 0;
        v13 = 0;
        v14 = 0;
        v15 = 0;
        v10 = BYTE1(v7);
        sub_10011BB0(a1 + 2712, (int)&v8, (int)&v16);
        sub_10011A60(a3 + *(_DWORD *)(a2 + 8), (int)&v16, a4);
      }
      result = 1;
      break;
    default:
      result = -32;
      break;
  }
  return result;
}
// 10011620: using guessed type _DWORD __cdecl sub_10011620(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (10008A70) --------------------------------------------------------
bool __cdecl sub_10008A70(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 3), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 5), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 7), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 11), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 15), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 17), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 19), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 21), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 23), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 25), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 29), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 31), 1u);
}

//----- (10008BE0) --------------------------------------------------------
bool __cdecl sub_10008BE0(int a1, int a2, int a3, int *a4)
{
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  return sub_10002660(a1, a2, (void *)a3, a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 7), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 9), a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 13), a4, 2u);
}

//----- (10008CD0) --------------------------------------------------------
signed int __cdecl sub_10008CD0(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // edx@1
  unsigned int v6; // ecx@1
  int v7; // ebp@1
  __int16 v8; // di@1
  int v9; // esi@1
  char v10; // zf@1
  int v11; // eax@3
  unsigned int v12; // ecx@10
  __int16 v13; // ax@20
  int v14; // ebp@20
  signed int v15; // edi@20
  signed int result; // eax@28
  char v17; // [sp+10h] [bp-24h]@1
  char v18; // [sp+11h] [bp-23h]@1
  char v19; // [sp+12h] [bp-22h]@1
  __int16 v20; // [sp+13h] [bp-21h]@1
  __int16 v21; // [sp+15h] [bp-1Fh]@1
  int v22; // [sp+17h] [bp-1Dh]@1
  int v23; // [sp+1Bh] [bp-19h]@1
  __int16 v24; // [sp+1Fh] [bp-15h]@1
  __int16 v25; // [sp+21h] [bp-13h]@1
  __int16 v26; // [sp+23h] [bp-11h]@1
  __int16 v27; // [sp+25h] [bp-Fh]@1
  __int16 v28; // [sp+27h] [bp-Dh]@1
  int v29; // [sp+29h] [bp-Bh]@1
  int v30; // [sp+2Dh] [bp-7h]@1
  char v31; // [sp+38h] [bp+4h]@1

  v5 = a2;
  v9 = a1;
  v8 = *(_WORD *)(a1 + 256);
  v31 = *(_BYTE *)(a1 + 69);
  LOWORD(v6) = -1;
  v10 = a2 == 0;
  LOWORD(v7) = 1;
  *(_BYTE *)(v9 + 69) = 16;
  v17 = 14;
  LOWORD(v30) = 1;
  v18 = -1;
  v19 = 0;
  v20 = 64;
  v21 = v8;
  v22 = 0;
  v23 = -1;
  v24 = 8;
  v25 = 0;
  v26 = -1;
  v27 = -1;
  v28 = 64;
  v29 = 0;
  BYTE2(v30) = 0;
  if ( !v10 )
  {
    if ( *(_DWORD *)v5 == 7 )
    {
      v11 = *(_DWORD *)(v5 + 12);
      if ( *(_DWORD *)(v11 + 540) == 4 )
      {
        if ( *(_DWORD *)(v11 + 1104) == 5 )
        {
          if ( *(_DWORD *)(v11 + 1668) == 5 )
          {
            if ( *(_DWORD *)(v11 + 2232) == 4 )
            {
              if ( *(_DWORD *)(v11 + 2796) == 4 )
              {
                if ( *(_DWORD *)(v11 + 3360) == 5 )
                {
                  if ( *(_DWORD *)(v11 + 3924) == 5 )
                  {
                    v21 = **(_WORD **)(v11 + 136);
                    v22 = **(_DWORD **)(v11 + 700);
                    v23 = **(_DWORD **)(v11 + 1264);
                    v24 = **(_WORD **)(v11 + 1828);
                    v25 = **(_WORD **)(v11 + 2392);
                    v12 = **(_DWORD **)(v11 + 2956);
                    v27 = **(_DWORD **)(v11 + 2956);
                    v6 = v12 >> 16;
                    v26 = v6;
                    v29 = **(_DWORD **)(v11 + 3520);
                    if ( v21 == -1 )
                      v21 = v8;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  if ( a4 )
  {
    if ( v24 & 4 )
    {
      v7 = *(_WORD *)a4 + 3;
      a2 = *(_WORD *)a4;
    }
    else
    {
      LOWORD(v7) = *(_WORD *)a4 + 1;
    }
    LOWORD(v30) = v7;
  }
  if ( v27 == -1 )
  {
    if ( (_WORD)v6 == -1 )
    {
      v27 = v30 - 1;
      v26 = 0;
      v25 = v30 - 1;
    }
  }
  v13 = v7;
  v14 = a5;
  v15 = sub_100072C0(v9, a5, v13 + 63, 47);
  if ( v15 == 1 )
  {
    if ( !sub_10008A70(v9, v14, (int)&v17)
      || v24 & 4 && !sub_10002470(v9, v14, &a2, 2u)
      || a4 && *(_DWORD *)a4 > 0 && !sub_100025E0(v9, v14, *(const void **)(a4 + 8), *(_DWORD *)a4) )
      v15 = -17;
  }
  result = v15;
  *(_BYTE *)(v9 + 69) = v31;
  return result;
}

//----- (10008F00) --------------------------------------------------------
signed int __cdecl sub_10008F00(int a1, int a2, int a3, int a4, int a5, int a6)
{
  signed int result; // eax@1
  int v7; // ebp@1
  int v8; // edi@1
  int v9; // esi@1
  int v10; // ST00_4@1
  int v11; // ebx@4
  signed int v12; // edi@4
  char v13; // [sp+10h] [bp-10h]@5
  unsigned __int16 v14; // [sp+15h] [bp-Bh]@7

  v7 = a5;
  v9 = a1;
  v8 = a2;
  v10 = a1;
  a1 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  result = sub_10008CD0(v10, a4, a5, a6, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(v9 + 116) )
      sub_10008150(v9, v8);
    v11 = a3;
    v12 = sub_10007BA0(v9, v8, a3, 47);
    if ( v12 == 1 )
    {
      if ( sub_10008BE0(v9, v11, (int)&v13, &a1) )
      {
        if ( !v7 && v14 != *(_DWORD *)a6 )
          return -1;
      }
      else
      {
        v12 = -12;
      }
    }
    result = v12;
  }
  return result;
}

//----- (10008FD0) --------------------------------------------------------
bool __cdecl sub_10008FD0(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 3), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 5), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 7), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 11), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 13), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 15), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 19), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 21), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 25), 2u);
}

//----- (10009100) --------------------------------------------------------
signed int __cdecl sub_10009100(int a1, int a2, int a3, int *a4)
{
  int *v4; // edi@1
  int v5; // eax@1
  int *v6; // ST0C_4@1
  int v7; // eax@15
  int v8; // ecx@15
  signed int result; // eax@17
  int v10; // [sp+20h] [bp+10h]@1

  v4 = a4;
  v5 = *a4;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  v6 = a4;
  *(_DWORD *)(a3 + 20) = 0;
  *(_DWORD *)(a3 + 24) = 0;
  v10 = v5;
  *(_DWORD *)(a3 + 28) = 0;
  if ( sub_10002660(a1, a2, (void *)a3, v6, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 1), v4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 2), v4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 3), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 5), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 7), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 9), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 11), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 13), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 15), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 17), v4, 4u)
    && sub_10002660(a1, a2, (void *)(a3 + 21), v4, 4u)
    && sub_10002660(a1, a2, (void *)(a3 + 25), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 27), v4, 1u)
    && (v7 = *(_WORD *)(a3 + 13), v8 = v7 + v10 - 32, v8 >= 0)
    && v8 <= *(_DWORD *)a2 )
  {
    *(_DWORD *)(a3 + 28) = v7 + *(_DWORD *)(a2 + 8) + v10 - 32;
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (100092B0) --------------------------------------------------------
signed int __cdecl sub_100092B0(int a1, int a2, int a3)
{
  int v3; // ecx@1
  char v4; // bl@1
  __int16 v5; // bp@1
  int v6; // eax@6
  signed int v7; // edi@15
  bool v8; // eax@16
  char v10; // [sp+10h] [bp-1Ch]@1
  char v11; // [sp+11h] [bp-1Bh]@1
  char v12; // [sp+12h] [bp-1Ah]@1
  __int16 v13; // [sp+13h] [bp-19h]@1
  __int16 v14; // [sp+15h] [bp-17h]@1
  int v15; // [sp+17h] [bp-15h]@1
  __int16 v16; // [sp+1Bh] [bp-11h]@1
  __int16 v17; // [sp+1Dh] [bp-Fh]@1
  int v18; // [sp+1Fh] [bp-Dh]@1
  __int16 v19; // [sp+23h] [bp-9h]@2
  int v20; // [sp+25h] [bp-7h]@4
  __int16 v21; // [sp+29h] [bp-3h]@1

  v3 = *(_DWORD *)(a1 + 304);
  v5 = *(_WORD *)(a1 + 256);
  v4 = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a1 + 69) = 16;
  v10 = 12;
  v21 = 0;
  v11 = -1;
  v12 = 0;
  v13 = 59;
  v14 = v5;
  v15 = 0;
  v16 = 4280;
  v17 = 0;
  v18 = 0;
  if ( v3 == -1 )
    v19 = 0;
  else
    v19 = v3;
  v20 = 0;
  if ( a2 )
  {
    if ( *(_DWORD *)a2 == 7 )
    {
      v6 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v6 + 540) == 4 )
      {
        if ( *(_DWORD *)(v6 + 1104) == 5 )
        {
          if ( *(_DWORD *)(v6 + 1668) == 4 )
          {
            if ( *(_DWORD *)(v6 + 2232) == 4 )
            {
              if ( *(_DWORD *)(v6 + 2796) == 5 )
              {
                if ( *(_DWORD *)(v6 + 3360) == 4 )
                {
                  if ( *(_DWORD *)(v6 + 3924) == 5 )
                  {
                    v14 = **(_WORD **)(v6 + 136);
                    v15 = **(_DWORD **)(v6 + 700);
                    v16 = **(_WORD **)(v6 + 1264);
                    v17 = **(_WORD **)(v6 + 1828);
                    v18 = **(_DWORD **)(v6 + 2392);
                    v19 = **(_WORD **)(v6 + 2956);
                    v20 = **(_DWORD **)(v6 + 3520);
                    if ( v14 == -1 )
                      v14 = v5;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  v7 = sub_100072C0(a1, a3, 59, 46);
  if ( v7 == 1 )
  {
    v8 = sub_10008FD0(a1, a3, (int)&v10);
    *(_BYTE *)(a1 + 69) = v4;
    if ( !v8 )
      return -17;
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v4;
  }
  return v7;
}

//----- (10009440) --------------------------------------------------------
signed int __cdecl sub_10009440(int a1, int a2, int a3, int a4, int a5)
{
  signed int result; // eax@1
  int v6; // edi@1
  int v7; // esi@1
  int v8; // ST08_4@1
  signed int v9; // eax@4
  int v10; // ebx@4
  signed int v11; // edi@4
  char v12; // [sp+8h] [bp-20h]@6
  unsigned __int16 v13; // [sp+13h] [bp-15h]@7
  const void *v14; // [sp+24h] [bp-4h]@7

  v7 = a1;
  v6 = a2;
  v8 = a1;
  a1 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  result = sub_100092B0(v8, a4, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(v7 + 116) )
      sub_10008150(v7, v6);
    v10 = a3;
    v9 = sub_10007BA0(v7, v6, a3, 46);
    v11 = v9;
    if ( v9 == 1 || v9 == 83918848 )
    {
      v11 = 1;
      if ( sub_10009100(v7, v10, (int)&v12, &a1) )
      {
        if ( !sub_100025E0(v7, a5, v14, v13) )
          return -17;
      }
      else
      {
        v11 = -12;
      }
    }
    result = v11;
  }
  return result;
}

//----- (10009510) --------------------------------------------------------
signed int __cdecl sub_10009510(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ecx@1
  signed int v6; // edi@1
  char v7; // al@1
  char v8; // zf@1
  signed int v9; // edx@3
  int v10; // eax@5
  int v11; // esi@7
  int v12; // esi@15
  int v13; // ecx@19
  signed int v14; // edi@22
  char v16; // [sp+13h] [bp-11Dh]@1
  char v17; // [sp+14h] [bp-11Ch]@5
  __int16 v18; // [sp+15h] [bp-11Bh]@5
  __int16 v19; // [sp+17h] [bp-119h]@5
  __int16 v20; // [sp+19h] [bp-117h]@5
  __int16 v21; // [sp+1Bh] [bp-115h]@5
  char v22; // [sp+1Dh] [bp-113h]@5
  char v23; // [sp+1Eh] [bp-112h]@5
  __int16 v24; // [sp+1Fh] [bp-111h]@5
  int v25; // [sp+21h] [bp-10Fh]@5
  int v26; // [sp+25h] [bp-10Bh]@5
  __int16 v27; // [sp+29h] [bp-107h]@19
  int v28; // [sp+2Bh] [bp-105h]@5
  char v29; // [sp+2Fh] [bp-101h]@5
  char v30; // [sp+30h] [bp-100h]@5
  __int16 v31; // [sp+31h] [bp-FFh]@5
  __int16 v32; // [sp+33h] [bp-FDh]@5
  __int16 v33; // [sp+35h] [bp-FBh]@5
  unsigned int v34; // [sp+38h] [bp-F8h]@3
  int v35; // [sp+3Ch] [bp-F4h]@1
  int v36; // [sp+40h] [bp-F0h]@3
  int v37; // [sp+44h] [bp-ECh]@1
  char v38; // [sp+48h] [bp-E8h]@1
  __int16 v39; // [sp+D8h] [bp-58h]@5
  int v40; // [sp+104h] [bp-2Ch]@1

  v7 = *(_BYTE *)(a1 + 69);
  memcpy(&v38, (const void *)(a1 + 112), 0xE4u);
  v5 = 0;
  v8 = v40 == 0;
  v16 = v7;
  v35 = 0;
  v37 = 0;
  *(_BYTE *)(a1 + 69) = 16;
  v6 = 7;
  if ( v8 || !*(_DWORD *)(a1 + 80) )
  {
    v36 = 0;
    v34 = 0;
    v9 = 0;
  }
  else
  {
    v9 = 1;
    v36 = 1;
    v34 = 1;
    v6 = 14;
  }
  v17 = 16;
  v18 = -1;
  v19 = -1;
  v32 = v39;
  v10 = v6 + v9;
  LOWORD(v28) = 0;
  v20 = 0;
  v21 = 4096;
  v22 = 0;
  v23 = 0;
  v26 = 0;
  v24 = 8;
  v25 = 1000;
  v30 = 0;
  v29 = 2;
  v31 = 38;
  v33 = v6 + v9;
  if ( a2 )
  {
    if ( *(_DWORD *)a2 == 8 )
    {
      v11 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v11 + 540) == 4 )
      {
        if ( *(_DWORD *)(v11 + 1104) == 4 )
        {
          if ( *(_DWORD *)(v11 + 1668) == 4 )
          {
            if ( *(_DWORD *)(v11 + 2232) == 3 )
            {
              if ( *(_DWORD *)(v11 + 2796) == 4 )
              {
                if ( *(_DWORD *)(v11 + 3360) == 5 )
                {
                  if ( *(_DWORD *)(v11 + 3924) == 4 )
                  {
                    if ( *(_DWORD *)(v11 + 4488) == 4 )
                    {
                      v12 = *(_DWORD *)(a2 + 12);
                      v19 = **(_WORD **)(v12 + 136);
                      v20 = **(_WORD **)(v12 + 700);
                      v21 = **(_WORD **)(v12 + 1264);
                      v22 = **(_BYTE **)(v12 + 1828);
                      v24 = **(_WORD **)(v12 + 2392);
                      v25 = **(_DWORD **)(v12 + 2956);
                      v31 = **(_WORD **)(v12 + 3520);
                      v32 = **(_WORD **)(v12 + 4084);
                      if ( v32 == -1 )
                        v32 = v39;
                      v5 = 0;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  v18 = v5;
  if ( a4 != v5 )
  {
    LOWORD(v28) = *(_WORD *)a4;
    v19 = v28;
    HIWORD(v26) = v5;
    v13 = (4 - (v9 + v6 + 35) % 4) % 4;
    HIWORD(v28) = v9 + (_WORD)v6 + 32 + (_WORD)v13 + 35;
    v27 = v9 + (_WORD)v6 + 32 + (_WORD)v13 + 35;
    v35 = (4 - (v9 + v6 + 35) % 4) % 4;
    v10 = v28 + v9 + v13 + v6;
    v33 = v28 + (_WORD)v9 + v13 + (_WORD)v6;
  }
  if ( v19 == -1 )
    v19 = v28;
  v14 = sub_100072C0(a1, a5, v10 + 67, 37);
  if ( v14 == 1 )
  {
    if ( !sub_10002470(a1, a5, &v17, 1u)
      || !sub_10002470(a1, a5, &v18, 2u)
      || !sub_10002470(a1, a5, &v19, 2u)
      || !sub_10002470(a1, a5, &v20, 2u)
      || !sub_10002470(a1, a5, &v21, 2u)
      || !sub_10002470(a1, a5, &v22, v14)
      || !sub_10002470(a1, a5, &v23, v14)
      || !sub_10002470(a1, a5, &v24, 2u)
      || !sub_10002470(a1, a5, &v25, 4u)
      || !sub_10002470(a1, a5, &v26, 2u)
      || !sub_10002470(a1, a5, (char *)&v26 + 2, 2u)
      || !sub_10002470(a1, a5, &v27, 2u)
      || !sub_10002470(a1, a5, &v28, 2u)
      || !sub_10002470(a1, a5, (char *)&v28 + 2, 2u)
      || !sub_10002470(a1, a5, &v29, v14)
      || !sub_10002470(a1, a5, &v30, v14)
      || !sub_10002470(a1, a5, &v31, 2u)
      || !sub_10002470(a1, a5, &v32, 2u)
      || !sub_10002470(a1, a5, &v33, 2u)
      || (signed int)v34 > 0 && !sub_10002470(a1, a5, &v37, v34)
      || !a3 && !sub_10003490(a1, a5, (int)"\\PIPE\\", 7u, v36)
      || !sub_100025E0(a1, a5, &v37, v35)
      || a4 && *(_DWORD *)a4 > 0 && !sub_100025E0(a1, a5, *(const void **)(a4 + 8), *(_DWORD *)a4) )
      v14 = -17;
  }
  *(_BYTE *)(a1 + 69) = v16;
  return v14;
}

//----- (100099F0) --------------------------------------------------------
signed int __cdecl sub_100099F0(int a1, int a2, int a3, int *a4)
{
  int *v4; // edi@1
  int v5; // eax@13
  int v6; // edx@13
  int v7; // ecx@15
  int v8; // ecx@16
  int v9; // edx@16
  signed int result; // eax@17
  int v11; // [sp+20h] [bp+10h]@1

  v4 = a4;
  v11 = *a4 - 32;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_DWORD *)(a3 + 24) = 0;
  *(_DWORD *)(a3 + 28) = 0;
  *(_WORD *)(a3 + 32) = 0;
  *(_BYTE *)(a3 + 34) = 0;
  if ( sub_10002660(a1, a2, (void *)a3, v4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 1), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 3), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 5), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 7), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 9), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 11), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 13), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 15), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 17), v4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 19), v4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 20), v4, 1u)
    && (v6 = *(_BYTE *)(a3 + 19), *(_DWORD *)(a3 + 21) = *v4 + *(_DWORD *)(a2 + 8),
                                  v5 = *v4 + 2 * v6,
                                  v5 < *(_DWORD *)a2)
    && (*v4 = v5, sub_10002660(a1, a2, (void *)(a3 + 25), v4, 2u))
    && (v7 = *(_WORD *)(a3 + 9), v7 + v11 <= *(_DWORD *)a2)
    && (v9 = v7 + *(_DWORD *)(a2 + 8),
        v8 = *(_WORD *)(a3 + 15),
        *(_DWORD *)(a3 + 27) = v11 + v9,
        v8 + v11 <= *(_DWORD *)a2) )
  {
    *(_DWORD *)(a3 + 31) = v11 + v8 + *(_DWORD *)(a2 + 8);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (10009BD0) --------------------------------------------------------
signed int __cdecl sub_10009BD0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  signed int result; // eax@1
  int v7; // ebx@1
  int v8; // esi@1
  int v9; // ebp@4
  signed int v10; // ebx@6
  int v11; // edi@6
  int v12; // eax@6
  unsigned int v13; // ST10_4@10
  const void *v14; // ST0C_4@10
  int v15; // ST08_4@10
  char v16; // [sp+Ch] [bp-24h]@9
  unsigned __int16 v17; // [sp+19h] [bp-17h]@10
  const void *v18; // [sp+2Bh] [bp-5h]@10

  v7 = a2;
  v8 = a1;
  a1 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  result = sub_10009510(v8, a4, a5, a6, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(v8 + 116) )
      sub_10008150(v8, v7);
    v9 = *(_DWORD *)(v8 + 120);
    if ( !*(_DWORD *)(v8 + 1068) )
      *(_DWORD *)(v8 + 120) = 0;
    v11 = a3;
    v10 = sub_10007BA0(v8, v7, a3, 37);
    v12 = *(_DWORD *)(v8 + 1068);
    *(_DWORD *)(v8 + 120) = v9;
    if ( v12 && (v10 == 1 || v10 == 83918848) )
    {
      v10 = 1;
      if ( sub_100099F0(v8, v11, (int)&v16, &a1) )
      {
        v13 = v17;
        v14 = v18;
        v15 = a6;
        *(_DWORD *)a6 = 0;
        if ( !sub_100025E0(v8, v15, v14, v13) )
          return -17;
      }
      else
      {
        a1 = (((*(_DWORD *)(v8 + 92) != 4) - 1) & 0x4E) + 36;
        if ( !sub_10002660(v8, v11, &v16, &a1, 1u) || v16 )
          v10 = -12;
      }
    }
    result = v10;
  }
  return result;
}

//----- (10009D10) --------------------------------------------------------
bool __cdecl sub_10009D10(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 4), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 8), 4u)
      && sub_10002D20(a1, a2, a3 + 12)
      && sub_10002470(a1, a2, (const void *)(a3 + 28), 4u);
}

//----- (10009DB0) --------------------------------------------------------
int __cdecl sub_10009DB0(int a1, int a2, int a3, int a4, int a5, int a6)
{
  int result; // eax@1
  int v7; // edx@1
  int v8; // ebx@1
  int v9; // esi@2
  char v10; // zf@3
  signed int v11; // ecx@3
  int *v12; // edi@3
  unsigned __int8 v13; // sf@8
  unsigned __int8 v14; // of@8
  int v15; // ebx@9
  int v16; // ecx@9
  int v17; // eax@9
  int v18; // ecx@9

  v7 = a6;
  v8 = *(_DWORD *)a6;
  result = 0;
  if ( *(_DWORD *)a6 <= 0 )
  {
LABEL_9:
    v15 = a5 + 16 * v8;
    v16 = a2;
    *(_DWORD *)v15 = a1;
    v17 = a3;
    *(_DWORD *)(v15 + 4) = v16;
    v18 = a4;
    *(_DWORD *)(v15 + 8) = v17;
    *(_DWORD *)(v15 + 12) = v18;
    result = *(_DWORD *)v7 + 1;
    *(_DWORD *)v7 = result;
  }
  else
  {
    v9 = a5;
    a6 = a5;
    while ( 1 )
    {
      v11 = 4;
      v12 = &a1;
      v10 = 1;
      do
      {
        if ( !v11 )
          break;
        v10 = *(_DWORD *)v9 == *v12;
        v9 += 4;
        ++v12;
        --v11;
      }
      while ( v10 );
      if ( v10 )
        break;
      ++result;
      v9 = a6 + 16;
      v14 = __SETO__(result, *(_DWORD *)v7);
      v13 = result - *(_DWORD *)v7 < 0;
      a6 += 16;
      if ( !(v13 ^ v14) )
        goto LABEL_9;
    }
  }
  return result;
}

//----- (10009E20) --------------------------------------------------------
int __cdecl sub_10009E20(int a1)
{
  int result; // eax@3

  if ( dword_10017000 )
    dword_100181EC = time(0);
  HIWORD(dword_100181F4) = dword_100181EC;
  LOWORD(dword_100181F4) = (unsigned int)dword_100181EC >> 16;
  result = a1;
  ++dword_100181F0;
  *(_DWORD *)a1 = dword_100181F0;
  *(_DWORD *)(a1 + 4) = dword_100181F4;
  *(_DWORD *)(a1 + 8) = dword_100181F8;
  dword_10017000 = 0;
  *(_DWORD *)(a1 + 12) = dword_100181FC;
  return result;
}
// 10017000: using guessed type int dword_10017000;
// 100181EC: using guessed type int dword_100181EC;
// 100181F0: using guessed type int dword_100181F0;
// 100181F4: using guessed type int dword_100181F4;
// 100181F8: using guessed type int dword_100181F8;
// 100181FC: using guessed type int dword_100181FC;

//----- (10009E90) --------------------------------------------------------
bool __cdecl sub_10009E90(int a1, int a2, int a3)
{
  return sub_100025E0(a1, a2, (const void *)a3, 8u)
      && sub_10002D20(a1, a2, a3 + 8)
      && sub_10002D20(a1, a2, a3 + 24)
      && sub_10002D20(a1, a2, a3 + 40)
      && sub_10002470(a1, a2, (const void *)(a3 + 56), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 60), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 64), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 68), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 70), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 72), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 74), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 76), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 78), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 79), 1u);
}

//----- (10009FE0) --------------------------------------------------------
bool __cdecl sub_10009FE0(int a1, int a2, int a3)
{
  return sub_10009E90(a1, a2, a3)
      && sub_10002470(a1, a2, (const void *)(a3 + 80), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 81), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 82), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 84), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 88), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 92), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 94), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 96), 4u);
}

//----- (1000A0C0) --------------------------------------------------------
bool __cdecl sub_1000A0C0(int a1, int a2, int a3, int a4)
{
  memset((void *)a3, 0, 0x50u);
  return sub_10002660(a1, a2, (void *)a3, (int *)a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 1), (int *)a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 2), (int *)a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 3), (int *)a4, 1u)
      && sub_100026B0(a1, a2, (void *)(a3 + 4), a4, 3u)
      && sub_10002660(a1, a2, (void *)(a3 + 7), (int *)a4, 1u)
      && sub_10002EF0(a1, a2, a3 + 8, a4)
      && sub_10002EF0(a1, a2, a3 + 24, a4)
      && sub_10002EF0(a1, a2, a3 + 40, a4)
      && sub_10002660(a1, a2, (void *)(a3 + 56), (int *)a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 60), (int *)a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 64), (int *)a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 68), (int *)a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 70), (int *)a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 72), (int *)a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 74), (int *)a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 76), (int *)a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 78), (int *)a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 79), (int *)a4, 1u);
}

//----- (1000A2B0) --------------------------------------------------------
bool __cdecl sub_1000A2B0(int a1, int a2, int a3, int *a4)
{
  *(_DWORD *)(a3 + 80) = 0;
  return sub_10002660(a1, a2, (void *)(a3 + 80), a4, 4u) != 0;
}

//----- (1000A2E0) --------------------------------------------------------
int __cdecl sub_1000A2E0(int a1, int a2, char a3)
{
  int result; // eax@1
  int v4; // esi@1
  int v5; // edx@3
  int v6; // edi@3
  int v7; // edx@5

  result = a2;
  *(_BYTE *)(a2 + 1) = a3;
  *(_BYTE *)a2 = 4;
  *(_BYTE *)(a2 + 2) = 0;
  *(_BYTE *)(a2 + 3) = 0;
  *(_BYTE *)(a2 + 4) = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a2 + 5) = 0;
  *(_BYTE *)(a2 + 6) = 0;
  v4 = *(_DWORD *)(a1 + 1248);
  *(_BYTE *)(a2 + 7) = *(_BYTE *)(a1 + 2 * v4 + 2029);
  if ( !*(_DWORD *)(a1 + 2156) || a3 )
  {
    v5 = 0;
    v6 = a2 + 8;
    *(_DWORD *)(a2 + 8) = 0;
    *(_DWORD *)(a2 + 12) = 0;
    *(_DWORD *)(a2 + 16) = 0;
  }
  else
  {
    v6 = a2 + 8;
    *(_DWORD *)(a2 + 8) = *(_DWORD *)(a1 + 2196);
    *(_DWORD *)(a2 + 12) = *(_DWORD *)(a1 + 2200);
    *(_DWORD *)(a2 + 16) = *(_DWORD *)(a1 + 2204);
    v5 = *(_DWORD *)(a1 + 2208);
  }
  *(_DWORD *)(v6 + 12) = v5;
  v7 = a1 + 4 * (5 * v4 + 90);
  *(_DWORD *)(a2 + 24) = *(_DWORD *)v7;
  *(_DWORD *)(a2 + 28) = *(_DWORD *)(v7 + 4);
  *(_DWORD *)(a2 + 32) = *(_DWORD *)(v7 + 8);
  *(_DWORD *)(a2 + 36) = *(_DWORD *)(v7 + 12);
  *(_DWORD *)(a2 + 40) = *(_DWORD *)(16 * v4 + a1 + 1256);
  *(_DWORD *)(a2 + 44) = *(_DWORD *)(16 * v4 + a1 + 1260);
  *(_DWORD *)(a2 + 48) = *(_DWORD *)(16 * v4 + a1 + 1264);
  *(_DWORD *)(a2 + 52) = *(_DWORD *)(16 * v4 + a1 + 1268);
  if ( *(_DWORD *)(a1 + 2104) )
    *(_DWORD *)(a2 + 56) = *(_DWORD *)(a1 + 1896);
  else
    *(_DWORD *)(a2 + 56) = 0;
  *(_DWORD *)(a2 + 60) = *(_WORD *)(a1 + 20 * v4 + 376) | 16 * *(_WORD *)(a1 + 20 * v4 + 378);
  *(_DWORD *)(a2 + 64) = *(_DWORD *)(a1 + 4 * v4 + 1900);
  *(_WORD *)(a2 + 68) = *(_WORD *)(a1 + 344);
  *(_WORD *)(a2 + 70) = -1;
  *(_WORD *)(a2 + 72) = -1;
  *(_WORD *)(a2 + 74) = 0;
  *(_WORD *)(a2 + 76) = 0;
  if ( *(_BYTE *)(a1 + 2292) < 2 || a3 )
  {
    *(_BYTE *)(a2 + 78) = 0;
    *(_BYTE *)(a2 + 79) = *(_BYTE *)(a1 + 2 * v4 + 2028);
  }
  else
  {
    *(_BYTE *)(a2 + 78) = *(_BYTE *)(a1 + 2293);
    *(_BYTE *)(a2 + 79) = *(_BYTE *)(a1 + 2 * v4 + 2028);
  }
  return result;
}

//----- (1000A440) --------------------------------------------------------
signed int __cdecl sub_1000A440(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // ecx@1
  int v6; // edi@1
  signed int v7; // eax@1
  int v8; // edx@1
  int v9; // ebp@3
  int v10; // eax@4
  int v11; // ebp@9
  __int16 v12; // dx@26
  int v13; // ecx@26
  signed int result; // eax@28
  int v15; // [sp+10h] [bp-8Ch]@1
  int v16; // [sp+10h] [bp-8Ch]@23
  char v17; // [sp+14h] [bp-88h]@1
  char v18; // [sp+15h] [bp-87h]@1
  __int16 v19; // [sp+16h] [bp-86h]@1
  int v20; // [sp+18h] [bp-84h]@1
  __int16 v21; // [sp+1Ch] [bp-80h]@26
  __int16 v22; // [sp+1Eh] [bp-7Eh]@26
  int v23; // [sp+20h] [bp-7Ch]@26
  int v24; // [sp+24h] [bp-78h]@26
  int v25; // [sp+28h] [bp-74h]@26
  int v26; // [sp+2Ch] [bp-70h]@26
  int v27; // [sp+30h] [bp-6Ch]@26
  int v28; // [sp+34h] [bp-68h]@26
  int v29; // [sp+38h] [bp-64h]@26
  char v30; // [sp+3Ch] [bp-60h]@5
  char v31; // [sp+3Eh] [bp-5Eh]@6
  __int16 v32; // [sp+86h] [bp-16h]@22
  __int16 v33; // [sp+88h] [bp-14h]@16
  char v34; // [sp+8Ch] [bp-10h]@4

  v7 = sub_100089C0(a1);
  v8 = *(_DWORD *)a4;
  v5 = *(_WORD *)(a1 + 2092);
  v20 = v7;
  v6 = *(_DWORD *)a3 - v8;
  v15 = v5;
  v17 = *(_BYTE *)(a1 + 2292);
  v18 = 0;
  v19 = 0;
  if ( v17 >= 2 )
    v15 = v5 - ((sub_100089C0(a1) + 11) & 0xFFFFFFF8);
  v9 = *(_DWORD *)(a1 + 1252);
  if ( *(_DWORD *)(a1 + 1248) > v9 - 1 )
  {
    v10 = sub_10009E20((int)&v34);
    *(_DWORD *)(16 * v9 + a1 + 1256) = *(_DWORD *)v10;
    *(_DWORD *)(16 * v9 + a1 + 1260) = *(_DWORD *)(v10 + 4);
    *(_DWORD *)(16 * v9 + a1 + 1264) = *(_DWORD *)(v10 + 8);
    *(_DWORD *)(16 * v9 + a1 + 1268) = *(_DWORD *)(v10 + 12);
    ++*(_DWORD *)(a1 + 1252);
    *(_DWORD *)(a1 + 1248) = v9;
  }
  sub_1000A2E0(a1, (int)&v30, 0);
  if ( !*(_DWORD *)(a1 + 2112) )
    v31 = 8;
  if ( a5 > 0 || *(_DWORD *)a4 > 0 )
  {
    v11 = v15;
  }
  else
  {
    v11 = v15;
    if ( v15 >= v6 )
      goto LABEL_13;
  }
  v31 |= 4u;
LABEL_13:
  if ( a5 > 0 )
  {
    if ( v11 >= v6 )
      v31 |= 2u;
  }
  v33 = a5;
  if ( !a5 )
  {
    if ( *(_DWORD *)(a1 + 2156) )
    {
      if ( *(_DWORD *)(a1 + 2160) )
        v6 += 32;
    }
  }
  if ( v6 > v11 )
    v6 = v11;
  v32 = v6;
  if ( !sub_10009E90(a1, a2, (int)&v30) )
    return -17;
  v16 = *(_DWORD *)a2;
  if ( !a5 && *(_DWORD *)(a1 + 2156) && *(_DWORD *)(a1 + 2160) )
  {
    v12 = *(_WORD *)(a1 + 2122);
    v21 = *(_WORD *)(a1 + 2120);
    v22 = v12;
    v25 = *(_DWORD *)(a1 + 2164);
    v26 = *(_DWORD *)(a1 + 2168);
    v13 = *(_DWORD *)(a1 + 2176);
    v27 = *(_DWORD *)(a1 + 2172);
    v23 = 0;
    v28 = v13;
    v29 = 0;
    v24 = 0;
    if ( !sub_10009D10(a1, a2, (int)&v21)
      || !sub_100025E0(a1, a2, (const void *)(*(_DWORD *)a4 + *(_DWORD *)(a3 + 8)), v6 - 32) )
      return -17;
  }
  else
  {
    if ( !sub_100025E0(a1, a2, (const void *)(*(_DWORD *)a4 + *(_DWORD *)(a3 + 8)), v6) )
      return -17;
  }
  *(_DWORD *)a4 += v6;
  if ( *(_BYTE *)(a1 + 2292) < 2 )
    return 1;
  if ( !sub_10002470(a1, a2, &v17, 1u) || !sub_10002470(a1, a2, &v18, 1u) || !sub_10002470(a1, a2, &v19, 2u) )
    return -17;
  result = sub_10008980(a1, a2, v16, v6);
  if ( result != 1 )
    return result;
  sub_100089F0(a1, a2, v16, v6, *(_DWORD *)a2 - v20);
  return 1;
}

//----- (1000A700) --------------------------------------------------------
signed int __cdecl sub_1000A700(int a1, int a2, int a3)
{
  signed int v3; // ebp@1
  int v4; // esi@1
  unsigned __int8 v5; // bl@1
  __int16 v6; // dx@1
  __int16 v7; // cx@1
  int v8; // eax@1
  int v9; // edi@3
  int v10; // ebx@5
  signed int result; // eax@8
  char v12; // [sp+10h] [bp-64h]@1
  char v13; // [sp+12h] [bp-62h]@1
  int v14; // [sp+50h] [bp-24h]@1
  __int16 v15; // [sp+5Ah] [bp-1Ah]@1
  __int16 v16; // [sp+5Ch] [bp-18h]@1
  char v17; // [sp+5Eh] [bp-16h]@2
  char v18; // [sp+60h] [bp-14h]@1
  char v19; // [sp+61h] [bp-13h]@1
  __int16 v20; // [sp+62h] [bp-12h]@1
  int v21; // [sp+64h] [bp-10h]@1
  int v22; // [sp+68h] [bp-Ch]@1
  __int16 v23; // [sp+6Ch] [bp-8h]@1
  __int16 v24; // [sp+6Eh] [bp-6h]@1
  int v25; // [sp+70h] [bp-4h]@1

  v4 = a1;
  v5 = *(_BYTE *)(a1 + 2292);
  v3 = sub_100089C0(a1);
  a1 = v5;
  sub_1000A2E0(v4, (int)&v12, 9);
  v6 = *(_WORD *)(a2 + 76);
  HIBYTE(v7) = *(_BYTE *)(a2 + 7);
  v18 = 1;
  v19 = 0;
  v24 = 0;
  v20 = 32;
  LOBYTE(v7) = *(_BYTE *)(a2 + 79);
  v8 = *(_DWORD *)(a2 + 64);
  v25 = 0;
  v13 = 0;
  v16 = v6;
  v14 = v8;
  v15 = 20;
  v23 = v7;
  v21 = 65535;
  v22 = 65535;
  if ( (char)v5 >= 2 )
    v17 = *(_BYTE *)(v4 + 2293);
  v9 = a3;
  if ( !sub_10009FE0(v4, a3, (int)&v12) )
    return -17;
  if ( *(_BYTE *)(v4 + 2292) < 2 )
    return 1;
  v10 = (*(_DWORD *)v9 - 77) & 0xFFFFFFFC;
  if ( !sub_10002470(v4, v9, &a1, 1u)
    || !sub_10002470(v4, v9, (char *)&a1 + 1, 1u)
    || !sub_10002470(v4, v9, (char *)&a1 + 2, 2u) )
    return -17;
  result = sub_10008980(v4, v9, 80, v10);
  if ( result != 1 )
    return result;
  sub_100089F0(v4, v9, 80, v10, *(_DWORD *)v9 - v3);
  return 1;
}

//----- (1000A860) --------------------------------------------------------
signed int __cdecl sub_1000A860(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // ebp@1
  int v6; // edi@1
  unsigned int v7; // esi@1
  signed int result; // eax@12
  char v9; // [sp+10h] [bp-50h]@1
  char v10; // [sp+12h] [bp-4Eh]@1
  __int16 v11; // [sp+5Ah] [bp-6h]@10
  __int16 v12; // [sp+5Ch] [bp-4h]@8

  v5 = *(_WORD *)(a1 + 2092);
  v6 = *(_DWORD *)a4;
  v7 = *(_DWORD *)a3 - *(_DWORD *)a4;
  sub_1000A2E0(a1, (int)&v9, 2);
  v10 = 8;
  if ( a5 > 0 || v6 > 0 || (signed int)v5 < (signed int)v7 )
    v10 = 12;
  if ( a5 > 0 )
  {
    if ( (signed int)v5 >= (signed int)v7 )
      v10 |= 2u;
  }
  v12 = a5;
  if ( (signed int)v7 > (signed int)v5 )
    v7 = v5;
  v11 = v7;
  if ( sub_10009E90(a1, a2, (int)&v9) && sub_100025E0(a1, a2, (const void *)(*(_DWORD *)a4 + *(_DWORD *)(a3 + 8)), v7) )
  {
    *(_DWORD *)a4 += v7;
    result = 1;
  }
  else
  {
    result = -17;
  }
  return result;
}

//----- (1000A930) --------------------------------------------------------
unsigned int __cdecl sub_1000A930(int a1, int a2, unsigned int a3, int a4, int a5)
{
  signed int v5; // ecx@1
  unsigned int v6; // eax@4
  unsigned int result; // eax@7

  v5 = 80;
  if ( *(_DWORD *)(a1 + 2156) && *(_DWORD *)(a1 + 2160) && !a5 )
  {
    v6 = a3 - 8;
    v5 = 88;
  }
  else
  {
    v6 = a3;
  }
  if ( (signed int)v6 <= 0 )
    result = -12;
  else
    result = (sub_100025E0(a1, a4, (const void *)(v5 + *(_DWORD *)(a2 + 8)), v6) != 0 ? 0x12 : 0) - 17;
  return result;
}

//----- (1000A9A0) --------------------------------------------------------
unsigned int __thiscall sub_1000A9A0(int this, const void *a2, size_t Size, void *a4, int a5, int a6, void *Memory, int a8, int a9, int a10, int a11, int a12, __int16 a13, int a14, int a15, int a16, int a17, int a18, int a19, int a20, int a21, int a22, int a23, int a24, int a25, int a26, int a27, int a28, int a29, int a30, int a31, unsigned __int8 a32, struct sockaddr to, struct sockaddr to, struct sockaddr to, struct sockaddr to, char a37, int a38, int a39, int a40, int a41, int a42, int a43, int a44, int a45, int a46, int a47, int a48, int a49, int a50, int a51, int a52, int a53, int a54, int a55, int a56, unsigned int a57)
{
  int v54; // ebx@1
  int v55; // edi@1
  unsigned int v56; // esi@2
  struct timeval v57; // ST20_8@7
  SOCKET v58; // ecx@7
  char v59; // al@13
  char v60; // zf@14
  signed int v61; // ecx@14
  int *v62; // edi@14
  int *v63; // esi@14
  SOCKET v64; // eax@19
  __int16 v65; // dx@19
  signed int v66; // eax@21
  struct timeval v67; // ST20_8@32
  SOCKET v68; // edx@32
  int v70; // esi@44
  int v71; // ST10_4@44
  int v72; // ST14_4@44
  int v73; // eax@44
  int v74; // ST18_4@44
  unsigned int v75; // ST0C_4@44
  const void *v76; // ST08_4@44
  unsigned int v77; // ST24_4@51
  const void *v78; // ST20_4@51
  int v79; // ST1C_4@51
  void *v80; // [sp+4h] [bp+4h]@1
  int v81; // [sp+4h] [bp+4h]@7
  char v82; // [sp+4h] [bp+4h]@9
  int v83; // [sp+4h] [bp+4h]@32
  int v84; // [sp+4h] [bp+4h]@45
  char v85; // [sp+4h] [bp+4h]@46
  char Dest; // [sp+ECh] [bp+ECh]@34
  int v87; // [sp+114h] [bp+114h]@1
  SOCKET v88; // [sp+114h] [bp+114h]@19
  char v89; // [sp+114h] [bp+114h]@21
  char v90; // [sp+114h] [bp+114h]@23
  char v91; // [sp+114h] [bp+114h]@24
  char v92; // [sp+114h] [bp+114h]@25
  char v93; // [sp+114h] [bp+114h]@26
  char v94; // [sp+114h] [bp+114h]@28
  int v95; // [sp+26Ch] [bp+26Ch]@19
  int v96; // [sp+27Ch] [bp+27Ch]@19
  int v97; // [sp+280h] [bp+280h]@19
  int v98; // [sp+284h] [bp+284h]@19
  int v99; // [sp+288h] [bp+288h]@19
  int v100; // [sp+28Ch] [bp+28Ch]@19
  int v101; // [sp+5F4h] [bp+5F4h]@19
  int v102; // [sp+5F8h] [bp+5F8h]@19
  int v103; // [sp+5FCh] [bp+5FCh]@19
  int v104; // [sp+600h] [bp+600h]@19
  int v105; // [sp+604h] [bp+604h]@19
  int v106; // [sp+608h] [bp+608h]@19
  int v107; // [sp+880h] [bp+880h]@19
  __int16 v108; // [sp+900h] [bp+900h]@19
  int v109; // [sp+1044h] [bp+1044h]@5
  int v110; // [sp+1044h] [bp+1044h]@7
  char v111; // [sp+1044h] [bp+1044h]@21
  char v112; // [sp+1044h] [bp+1044h]@23
  char v113; // [sp+1044h] [bp+1044h]@24
  char v114; // [sp+1044h] [bp+1044h]@25
  char v115; // [sp+1044h] [bp+1044h]@26
  char v116; // [sp+1044h] [bp+1044h]@28
  int v117; // [sp+1044h] [bp+1044h]@32
  int v118; // [sp+1048h] [bp+1048h]@5
  void *v119; // [sp+104Ch] [bp+104Ch]@5
  int v120; // [sp+104Ch] [bp+104Ch]@41
  void *v121; // [sp+104Ch] [bp+104Ch]@42

  sub_10014C80(0x105Cu, this);
  a6 = 0;
  Memory = 0;
  v54 = (int)a2;
  a10 = dword_100170B0;
  a12 = dword_100170B8;
  memcpy(&v87, a2, 0xF48u);
  a9 = dword_100170AC;
  a4 = 0;
  a5 = 0;
  v80 = 0;
  a8 = 0;
  a11 = dword_100170B4;
  a2 = 0;
  Size = 8192;
  v55 = 0;
  a4 = sub_10008320(0x2000u);
  if ( !a4 )
  {
    v56 = -17;
    goto LABEL_37;
  }
  a5 = 0;
  a6 = 8192;
  Memory = sub_10008320(Size);
  if ( !Memory )
  {
    v56 = -17;
    goto LABEL_39;
  }
  v109 = 0;
  v118 = 8192;
  v119 = sub_10008320(0x2000u);
  if ( !v119 )
  {
    v56 = -17;
    goto LABEL_37;
  }
  v57 = *(struct timeval *)(v54 + 8);
  v58 = *(_DWORD *)v54;
  v81 = 0;
  a2 = 0;
  a5 = 0;
  v110 = 0;
  v56 = sub_10006280(v58, (int)&a2, &to, v57);
  if ( v56 != 1 )
    goto LABEL_37;
  while ( 2 )
  {
    if ( (signed int)a2 < 80 )
      goto LABEL_32;
    *(_BYTE *)(v54 + 70) = *((_BYTE *)a4 + 4);
    if ( !sub_1000A0C0(v54, (int)&a2, (int)&a13, (int)&v82) )
    {
LABEL_48:
      v56 = -11;
      goto LABEL_37;
    }
    if ( a27 != *(_DWORD *)(v54 + 1896) )
    {
      if ( a27 != v55 )
        *(_DWORD *)(v54 + 1896) = a27;
    }
    v59 = HIBYTE(a13);
    *(_BYTE *)a4 = HIBYTE(a13);
    switch ( v59 )
    {
      case 0:
        v61 = 4;
        v62 = &a9;
        v63 = &a19;
        v60 = 1;
        do
        {
          if ( !v61 )
            break;
          v60 = *v63 == *v62;
          ++v63;
          ++v62;
          --v61;
        }
        while ( v60 );
        if ( v60 )
        {
          v64 = *(_DWORD *)v54;
          v95 = (unsigned __int16)a30;
          v96 = dword_100170BC;
          v97 = dword_100170C0;
          v98 = dword_100170C4;
          v99 = dword_100170C8;
          v100 = dword_100170CC;
          v88 = v64;
          LOBYTE(v65) = 0;
          HIBYTE(v65) = BYTE3(a14);
          v107 = a29;
          v108 = *(&a32 + 3) | v65;
          v102 = 1;
          v101 = 0;
          v103 = a23;
          v104 = a24;
          v105 = a25;
          v106 = a26;
          sub_10009DB0(a23, a24, a25, a26, v54 + 1256, v54 + 1252);
          switch ( v95 )
          {
            case 0:
              v56 = sub_10012380(v54, (int)&a2);
              if ( v56 != 1 )
                goto LABEL_36;
              v66 = sub_10011EE0((int)&v89, (int)&a2, (int)&v111);
              break;
            case 1:
              v56 = sub_10012380(v54, (int)&a2);
              if ( v56 != 1 )
                goto LABEL_36;
              v66 = sub_100122B0((int)&v90, (int)&a2, (int)&v112);
              break;
            case 2:
              v66 = sub_10012350((int)&v91, (int)&a2, (int)&v113);
              break;
            case 3:
              v66 = sub_10011F40((int)&v92, (int)&a2, (int)&v114);
              break;
            case 4:
              v66 = sub_100121E0((int)&v93, (int)&a2, (int)&v115);
              break;
            default:
              goto LABEL_35;
          }
          v56 = v66;
          if ( v66 != 1
            || (a5 = 0, v56 = sub_1000A860((int)&v94, (int)&a5, (int)&v116, (int)&a8, 0), v56 != 1)
            || (v56 = sub_10006170(*(_DWORD *)v54, (int)&a5, &to), v56 != 1) )
            goto LABEL_36;
          v55 = 0;
LABEL_32:
          v67 = *(struct timeval *)(v54 + 8);
          v68 = *(_DWORD *)v54;
          v83 = v55;
          a2 = (const void *)v55;
          a5 = v55;
          v117 = v55;
          v56 = sub_10006280(v68, (int)&a2, &to, v67);
          if ( v56 != 1 )
            goto LABEL_37;
          continue;
        }
        sub_10008730((int)&a19, &Dest);
LABEL_35:
        v56 = -10;
LABEL_36:
        v55 = 0;
LABEL_37:
        if ( Memory != (void *)v55 )
        {
          free(Memory);
          Memory = (void *)v55;
        }
LABEL_39:
        if ( a4 != (void *)v55 )
        {
          free(a4);
          a4 = (void *)v55;
        }
        if ( v120 != v55 )
          free(v121);
        return v56;
      case 9:
        if ( *(_DWORD *)(v54 + 2112) == v55 )
          goto LABEL_32;
        v77 = (unsigned int)a2;
        v78 = a4;
        v79 = Size;
        *(_DWORD *)Size = v55;
        v56 = (sub_100025E0(v54, v79, v78, v77) != 0 ? 0x12 : 0) - 17;
        goto LABEL_37;
      case 1:
      case 4:
      case 5:
      case 0xA:
        goto LABEL_32;
      case 2:
        v70 = Size;
        v71 = a23;
        v72 = a24;
        v73 = a26;
        v74 = a25;
        *(_DWORD *)Size = v55;
        v75 = (unsigned int)a2;
        v76 = a4;
        *(_DWORD *)(v54 + 1248) = sub_10009DB0(v71, v72, v74, v73, v54 + 1256, v54 + 1252);
        v56 = (sub_100025E0(v54, v70, v76, v75) != 0 ? 0x12 : 0) - 17;
        goto LABEL_37;
      case 3:
      case 6:
        v84 = v55;
        if ( !sub_1000A0C0(v54, (int)&a2, (int)&a37, (int)&v84) || !sub_1000A2B0(v54, (int)&a2, (int)&a37, (int *)&v85) )
          goto LABEL_48;
        v56 = a57;
        goto LABEL_37;
      case 7:
        v56 = 1;
        *(_DWORD *)(v54 + 2096) = 1;
        goto LABEL_37;
      case 8:
        v56 = -10;
        *(_DWORD *)(v54 + 2096) = v55;
        goto LABEL_37;
      default:
        v56 = -13;
        goto LABEL_37;
    }
  }
}
// 100170AC: using guessed type int dword_100170AC;
// 100170B0: using guessed type int dword_100170B0;
// 100170B4: using guessed type int dword_100170B4;
// 100170B8: using guessed type int dword_100170B8;
// 100170BC: using guessed type int dword_100170BC;
// 100170C0: using guessed type int dword_100170C0;
// 100170C4: using guessed type int dword_100170C4;
// 100170C8: using guessed type int dword_100170C8;
// 100170CC: using guessed type int dword_100170CC;

//----- (1000AF90) --------------------------------------------------------
signed int __cdecl sub_1000AF90(int a1, int a2, int a3)
{
  int *v3; // eax@1
  signed int v4; // ecx@1
  int v5; // ebx@1
  signed int i; // edi@4
  int v7; // ebp@7
  int v8; // ecx@8
  unsigned int v9; // eax@10
  unsigned __int8 v10; // zf@17
  char v11; // sf@17
  unsigned __int8 v12; // of@17
  int v13; // ecx@22
  unsigned __int8 v14; // sf@22
  unsigned __int8 v15; // of@22
  signed int v16; // ebp@27
  unsigned __int16 v17; // ax@32
  int *v18; // eax@41
  int v19; // eax@41
  int v20; // ecx@41
  int v21; // ecx@42
  size_t v22; // ST10_4@42
  void *v23; // eax@42
  int v24; // ebp@46
  signed int v25; // ebx@53
  void **v26; // esi@53
  int v28; // [sp+0h] [bp-270h]@10
  int v29; // [sp+4h] [bp-26Ch]@10
  void *v30; // [sp+8h] [bp-268h]@10
  int v31; // [sp+Ch] [bp-264h]@10
  int v32; // [sp+10h] [bp-260h]@10
  int v33; // [sp+14h] [bp-25Ch]@1
  size_t Size; // [sp+18h] [bp-258h]@3
  int v35; // [sp+1Ch] [bp-254h]@1
  void *Memory; // [sp+20h] [bp-250h]@1
  int v37; // [sp+24h] [bp-24Ch]@7
  int v38; // [sp+28h] [bp-248h]@1
  int v39; // [sp+2Ch] [bp-244h]@1
  void *v40; // [sp+30h] [bp-240h]@1
  int v41; // [sp+34h] [bp-23Ch]@7
  int v42; // [sp+38h] [bp-238h]@1
  int v43; // [sp+3Ch] [bp-234h]@7
  int v44; // [sp+40h] [bp-230h]@10
  int v45; // [sp+44h] [bp-22Ch]@10
  int v46; // [sp+48h] [bp-228h]@10
  int v47; // [sp+4Ch] [bp-224h]@10
  int v48; // [sp+50h] [bp-220h]@10
  int v49; // [sp+54h] [bp-21Ch]@10
  int v50; // [sp+58h] [bp-218h]@10
  int v51; // [sp+5Ch] [bp-214h]@10
  int v52; // [sp+60h] [bp-210h]@10
  int v53; // [sp+64h] [bp-20Ch]@10
  int v54; // [sp+68h] [bp-208h]@10
  unsigned __int8 v55; // [sp+6Ch] [bp-204h]@10
  struct sockaddr v56; // [sp+70h] [bp-200h]@10
  struct sockaddr v57; // [sp+80h] [bp-1F0h]@10
  struct sockaddr v58; // [sp+90h] [bp-1E0h]@10
  int v59; // [sp+94h] [bp-1DCh]@1
  struct sockaddr v60; // [sp+A0h] [bp-1D0h]@10
  char v61; // [sp+B0h] [bp-1C0h]@10
  int v62; // [sp+B4h] [bp-1BCh]@10
  int v63; // [sp+B8h] [bp-1B8h]@10
  int v64; // [sp+BCh] [bp-1B4h]@10
  int v65; // [sp+C0h] [bp-1B0h]@10
  int v66; // [sp+C4h] [bp-1ACh]@10
  int v67; // [sp+C8h] [bp-1A8h]@10
  int v68; // [sp+CCh] [bp-1A4h]@10
  int v69; // [sp+D0h] [bp-1A0h]@10
  int v70; // [sp+D4h] [bp-19Ch]@10
  int v71; // [sp+D8h] [bp-198h]@10
  int v72; // [sp+DCh] [bp-194h]@10
  int v73; // [sp+E0h] [bp-190h]@10
  int v74; // [sp+E4h] [bp-18Ch]@10
  int v75; // [sp+E8h] [bp-188h]@10
  int v76; // [sp+ECh] [bp-184h]@10
  int v77; // [sp+F0h] [bp-180h]@10
  int v78; // [sp+F4h] [bp-17Ch]@10
  int v79; // [sp+F8h] [bp-178h]@10
  int v80; // [sp+FCh] [bp-174h]@10
  unsigned int v81; // [sp+100h] [bp-170h]@10

  v5 = 0;
  v35 = 0;
  v39 = 0;
  Memory = 0;
  v40 = 0;
  v42 = 0;
  v38 = 0;
  BYTE3(v32) = -1;
  v33 = 0;
  v3 = &v59;
  v4 = 40;
  do
  {
    v3[1] = 0;
    *v3 = 0;
    *(v3 - 1) = 0;
    v3 += 3;
    --v4;
  }
  while ( v4 );
  Size = 0;
  v35 = 8192;
  Memory = sub_10008320(0x2000u);
  if ( Memory )
  {
    v38 = 0;
    v39 = 8192;
    v40 = sub_10008320(0x2000u);
    if ( v40 )
    {
      v43 = *(_DWORD *)(a1 + 2112);
      v7 = 0;
      v41 = 0;
      v37 = 0;
      *(_DWORD *)(a1 + 2112) = 0;
      v38 = 0;
      for ( i = sub_1000A440(a1, (int)&v38, a2, (int)&v41, 0); i == 1; i = sub_1000A440(
                                                                             a1,
                                                                             (int)&v38,
                                                                             a2,
                                                                             (int)&v41,
                                                                             v7) )
      {
        i = sub_10006170(*(_DWORD *)a1, (int)&v38, (const struct sockaddr *)(a1 + 16));
        if ( i != 1 )
          break;
        if ( *(_DWORD *)(a1 + 2112) )
        {
          while ( 1 )
          {
            v9 = sub_1000A9A0(
                   v8,
                   (const void *)a1,
                   (size_t)&Size,
                   (char *)&v32 + 3,
                   v28,
                   v29,
                   v30,
                   v31,
                   v32,
                   v33,
                   0,
                   v35,
                   (__int16)Memory,
                   v37,
                   v38,
                   v39,
                   (int)v40,
                   v41,
                   v42,
                   v43,
                   v44,
                   v45,
                   v46,
                   v47,
                   v48,
                   v49,
                   v50,
                   v51,
                   v52,
                   v53,
                   v54,
                   v55,
                   v56,
                   v57,
                   v58,
                   v60,
                   v61,
                   v62,
                   v63,
                   v64,
                   v65,
                   v66,
                   v67,
                   v68,
                   v69,
                   v70,
                   v71,
                   v72,
                   v73,
                   v74,
                   v75,
                   v76,
                   v77,
                   v78,
                   v79,
                   v80,
                   v81);
            i = v9;
            if ( v9 == -4 )
              break;
            if ( v9 != 1 )
              goto LABEL_53;
            if ( BYTE3(v32) != 9 )
              goto LABEL_62;
            v33 = 0;
            if ( !sub_1000A0C0(a1, (int)&Size, (int)&v44, (int)&v33) )
            {
LABEL_63:
              i = -11;
              goto LABEL_53;
            }
            if ( *(unsigned __int16 *)&v57.sa_data[10] == v7 )
              goto LABEL_19;
            if ( *(unsigned __int16 *)&v57.sa_data[10] > v7 )
            {
LABEL_16:
              i = -12;
              goto LABEL_53;
            }
          }
          v12 = __SETO__(v42 + 1, 3);
          v10 = v42 == 2;
          v11 = v42++ - 2 < 0;
          if ( !((unsigned __int8)(v11 ^ v12) | v10) )
            break;
        }
        else
        {
LABEL_19:
          if ( !*(_DWORD *)(a1 + 2096) )
          {
            i = sub_1000A9A0(
                  (int)((char *)&v32 + 3),
                  (const void *)a1,
                  (size_t)&Size,
                  (char *)&v32 + 3,
                  v28,
                  v29,
                  v30,
                  v31,
                  v32,
                  v33,
                  0,
                  v35,
                  (__int16)Memory,
                  v37,
                  v38,
                  v39,
                  (int)v40,
                  v41,
                  v42,
                  v43,
                  v44,
                  v45,
                  v46,
                  v47,
                  v48,
                  v49,
                  v50,
                  v51,
                  v52,
                  v53,
                  v54,
                  v55,
                  v56,
                  v57,
                  v58,
                  v60,
                  v61,
                  v62,
                  v63,
                  v64,
                  v65,
                  v66,
                  v67,
                  v68,
                  v69,
                  v70,
                  v71,
                  v72,
                  v73,
                  v74,
                  v75,
                  v76,
                  v77,
                  v78,
                  v79,
                  v80,
                  v81);
            if ( i != 1 )
              break;
            if ( BYTE3(v32) != 7 )
              goto LABEL_62;
          }
          v13 = v41;
          *(_DWORD *)(a1 + 2112) = v43;
          ++*(_WORD *)(a1 + 2 * *(_DWORD *)(a1 + 1248) + 2028);
          ++v7;
          v15 = __SETO__(v13, *(_DWORD *)a2);
          v14 = v13 - *(_DWORD *)a2 < 0;
          v42 = 0;
          if ( !(v14 ^ v15) || BYTE3(v32) == 2 )
          {
            ++*(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1768);
            if ( !*(_DWORD *)(a1 + 1068) )
              break;
            v16 = 0;
            while ( 1 )
            {
              v33 = 0;
              if ( BYTE3(v32) != 2 )
              {
                i = sub_1000A9A0(
                      (int)((char *)&v32 + 3),
                      (const void *)a1,
                      (size_t)&Size,
                      (char *)&v32 + 3,
                      v28,
                      v29,
                      v30,
                      v31,
                      v32,
                      v33,
                      0,
                      v35,
                      (__int16)Memory,
                      v37,
                      v38,
                      v39,
                      (int)v40,
                      v41,
                      v42,
                      v43,
                      v44,
                      v45,
                      v46,
                      v47,
                      v48,
                      v49,
                      v50,
                      v51,
                      v52,
                      v53,
                      v54,
                      v55,
                      v56,
                      v57,
                      v58,
                      v60,
                      v61,
                      v62,
                      v63,
                      v64,
                      v65,
                      v66,
                      v67,
                      v68,
                      v69,
                      v70,
                      v71,
                      v72,
                      v73,
                      v74,
                      v75,
                      v76,
                      v77,
                      v78,
                      v79,
                      v80,
                      v81);
                if ( i != 1 )
                  goto LABEL_53;
                if ( BYTE3(v32) != 2 )
                  break;
              }
              BYTE3(v32) = -1;
              if ( !sub_1000A0C0(a1, (int)&Size, (int)&v44, (int)&v33) )
                goto LABEL_63;
              v17 = *(_WORD *)&v57.sa_data[10];
              if ( BYTE2(v44) & 7 )
              {
                if ( BYTE2(v44) & 2 )
                {
                  v37 = *(unsigned __int16 *)&v57.sa_data[10];
                  v16 = 1;
                }
                v38 = 0;
                if ( !(BYTE2(v44) & 8) )
                {
                  i = sub_1000A700(a1, (int)&v44, (int)&v38);
                  if ( i != 1
                    || (i = sub_10006170(*(_DWORD *)a1, (int)&v38, (const struct sockaddr *)(a1 + 16)), i != 1) )
                    goto LABEL_53;
                  v17 = *(_WORD *)&v57.sa_data[10];
                }
              }
              else
              {
                v37 = *(unsigned __int16 *)&v57.sa_data[10];
                v16 = 1;
              }
              if ( v17 > 0x28u )
                goto LABEL_53;
              v19 = 3 * v17;
              v20 = *(&v59 + v19);
              v18 = &v59 + v19;
              if ( !v20 )
              {
                v22 = Size;
                *v18 = Size;
                v23 = sub_10008320(v22);
                v21 = 12 * *(unsigned __int16 *)&v57.sa_data[10];
                *(_DWORD *)&v58.sa_data[12 * *(unsigned __int16 *)&v57.sa_data[10] + 6] = v23;
                if ( !v23 || !sub_100025E0(a1, (int)((char *)&v58 + v21), Memory, Size) )
                  goto LABEL_6;
              }
              if ( v16 )
              {
                if ( v37 < 0 )
                {
LABEL_52:
                  ++*(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1900);
                  i = 1;
                  goto LABEL_53;
                }
                v24 = (int)&v58;
                while ( 1 )
                {
                  v33 = 0;
                  if ( !sub_1000A0C0(a1, v24, (int)&v44, (int)&v33) )
                    goto LABEL_16;
                  if ( *(_BYTE *)(a1 + 2292) >= 5
                    && (i = sub_10008A30(
                              a1,
                              v24,
                              80,
                              *(unsigned __int16 *)&v57.sa_data[8],
                              (*(unsigned __int16 *)&v57.sa_data[8] + 3) & 0xFFFFFFFC),
                        i != 1)
                    || (i = sub_1000A930(a1, v24, *(unsigned __int16 *)&v57.sa_data[8], a3, v5), i != 1) )
                    goto LABEL_53;
                  ++v5;
                  v24 += 12;
                  if ( v5 > v37 )
                    goto LABEL_52;
                }
              }
            }
LABEL_62:
            i = -13;
            break;
          }
        }
        v38 = 0;
      }
    }
    else
    {
LABEL_6:
      i = -17;
    }
  }
  else
  {
    i = -17;
  }
LABEL_53:
  v26 = (void **)&v58.sa_data[6];
  v25 = 40;
  do
  {
    if ( *v26 )
    {
      free(*v26);
      *v26 = 0;
    }
    v26 += 3;
    --v25;
  }
  while ( v25 );
  if ( Memory )
  {
    free(Memory);
    Memory = 0;
  }
  if ( v40 )
    free(v40);
  return i;
}

//----- (1000B450) --------------------------------------------------------
void __cdecl sub_1000B450(int *a1)
{
  int *v1; // esi@1
  char v2; // al@4

  v1 = a1;
  if ( *(_BYTE *)a1 )
  {
    do
    {
      if ( islower(*(_BYTE *)v1) )
        *(_BYTE *)v1 = toupper(*(_BYTE *)v1);
      v2 = *((_BYTE *)v1 + 1);
      v1 = (int *)((char *)v1 + 1);
    }
    while ( v2 );
  }
}

//----- (1000B490) --------------------------------------------------------
int __cdecl sub_1000B490(const void *a1, unsigned int a2, int a3)
{
  __int16 *v3; // eax@1
  int v4; // ecx@1
  char v5; // zf@1
  __int16 v7; // [sp+8h] [bp-208h]@1
  __int16 v8; // [sp+208h] [bp-8h]@1

  memset(&v7, 0, 0x200u);
  v8 = 0;
  memcpy(&v7, a1, a2);
  v4 = 0;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  v5 = v7 == 0;
  *(_DWORD *)(a3 + 12) = 0;
  v3 = &v7;
  if ( !v5 )
  {
    do
    {
      ++v3;
      ++v4;
    }
    while ( *v3 );
  }
  return sub_10013770(a3, (int)&v7, 2 * v4);
}

//----- (1000B510) --------------------------------------------------------
signed __int64 __cdecl sub_1000B510(const char *a1, int a2)
{
  const char *v2; // esi@1
  unsigned int v3; // eax@3
  int v5; // [sp+4h] [bp-10h]@1
  int v6; // [sp+8h] [bp-Ch]@1
  int v7; // [sp+Ch] [bp-8h]@1
  __int16 v8; // [sp+10h] [bp-4h]@1
  char v9; // [sp+12h] [bp-2h]@1

  v5 = 0;
  v6 = 0;
  v2 = a1;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  if ( a1 )
  {
    v3 = strlen(a1);
    if ( v3 > 0xE )
      v3 = 14;
    memcpy(&v5, a1, 4 * (v3 >> 2));
    memcpy(&v5 + (v3 >> 2), &v2[4 * (v3 >> 2)], v3 & 3);
    *((_BYTE *)&v5 + v3) = 0;
  }
  else
  {
    LOBYTE(v5) = 0;
  }
  v9 = 0;
  sub_1000B450(&v5);
  *(_DWORD *)a2 = 0;
  *(_DWORD *)(a2 + 4) = 0;
  *(_DWORD *)(a2 + 8) = 0;
  *(_DWORD *)(a2 + 12) = 0;
  return sub_10012BA0((int)&v5, a2);
}

//----- (1000B5B0) --------------------------------------------------------
signed __int64 __cdecl sub_1000B5B0(int a1, int a2, int a3)
{
  int v4; // edx@1
  int v5; // eax@1
  int v6; // edx@1
  int v7; // eax@1
  int v8; // [sp+0h] [bp-18h]@1
  int v9; // [sp+4h] [bp-14h]@1
  int v10; // [sp+8h] [bp-10h]@1
  int v11; // [sp+Ch] [bp-Ch]@1
  int v12; // [sp+10h] [bp-8h]@1
  char v13; // [sp+14h] [bp-4h]@1

  v4 = *(_DWORD *)a1;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v5 = *(_DWORD *)(a1 + 4);
  v8 = v4;
  v6 = *(_DWORD *)(a1 + 8);
  v9 = v5;
  v7 = *(_DWORD *)(a1 + 12);
  v10 = v6;
  v11 = v7;
  return sub_10012C00((int)&v8, a2, a3);
}

//----- (1000B610) --------------------------------------------------------
signed __int64 __cdecl sub_1000B610(int a1, int a2, int a3)
{
  int v4; // edx@1
  int v5; // [sp+0h] [bp-18h]@1
  int v6; // [sp+4h] [bp-14h]@1
  int v7; // [sp+8h] [bp-10h]@1
  int v8; // [sp+Ch] [bp-Ch]@1
  int v9; // [sp+10h] [bp-8h]@1
  char v10; // [sp+14h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v4 = *(_DWORD *)(a1 + 4);
  v5 = *(_DWORD *)a1;
  v7 = -1111638595;
  v6 = v4;
  v8 = -1111638595;
  return sub_10012C00((int)&v5, a2, a3);
}

//----- (1000B670) --------------------------------------------------------
signed int __cdecl sub_1000B670(const char *a1, char a2, void *a3)
{
  unsigned int v3; // eax@1
  signed int v4; // ebp@1
  signed int result; // eax@2
  signed int v6; // ecx@3
  const char v7; // al@4
  int v8; // edx@7
  char v9; // sf@7
  signed int i; // eax@10
  int v11; // [sp+8h] [bp-20h]@1
  int v12; // [sp+Ch] [bp-1Ch]@1
  int v13; // [sp+10h] [bp-18h]@1
  int v14; // [sp+14h] [bp-14h]@1
  int v15; // [sp+18h] [bp-10h]@1
  int v16; // [sp+1Ch] [bp-Ch]@1
  int v17; // [sp+20h] [bp-8h]@1
  int v18; // [sp+24h] [bp-4h]@1

  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v17 = 0;
  v18 = 0;
  v3 = strlen(a1);
  v4 = v3;
  if ( (signed int)v3 <= 15 )
  {
    v6 = 0;
    if ( (signed int)v3 > 0 )
    {
      do
      {
        v7 = a1[v6];
        if ( v7 >= 97 )
        {
          if ( v7 <= 122 )
            a1[v6] = v7 - 32;
        }
        v8 = a1[v6] & 0x8000000F;
        v9 = (a1[v6] & 0x8000000F) < 0;
        *((_BYTE *)&v11 + 2 * v6) = a1[v6] / 16 + 65;
        if ( v9 )
          v8 = ((v8 - 1) | 0xFFFFFFF0) + 1;
        *((_BYTE *)&v11 + 2 * v6++ + 1) = v8 + 65;
      }
      while ( v6 < v4 );
    }
    for ( i = v4; i < 15; ++i )
    {
      *((_BYTE *)&v11 + 2 * i) = 67;
      *((_BYTE *)&v11 + 2 * i + 1) = 65;
    }
    BYTE2(v18) = a2 / 16 + 65;
    BYTE3(v18) = a2 % 16 + 65;
    memcpy(a3, &v11, 0x20u);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (1000B770) --------------------------------------------------------
signed int __cdecl sub_1000B770(int a1, int a2, int a3)
{
  char v3; // bl@1
  signed int result; // eax@4

  v3 = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a1 + 69) = 0;
  if ( sub_10002470(a1, a2, (const void *)a3, 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
    && sub_10002470(a1, a2, (const void *)(a3 + 2), 2u) )
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = 1;
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = 0;
  }
  return result;
}

//----- (1000B7E0) --------------------------------------------------------
signed int __cdecl sub_1000B7E0(int a1, int a2, int a3, int *a4)
{
  int v4; // esi@1
  char v5; // al@1
  signed int result; // eax@4
  char v7; // [sp+14h] [bp+4h]@1

  v4 = a1;
  v5 = *(_BYTE *)(a1 + 70);
  *(_DWORD *)a3 = 0;
  v7 = v5;
  *(_BYTE *)(v4 + 70) = 0;
  if ( sub_10002660(v4, a2, (void *)a3, a4, 1u)
    && sub_10002660(v4, a2, (void *)(a3 + 1), a4, 1u)
    && sub_10002660(v4, a2, (void *)(a3 + 2), a4, 2u) )
  {
    *(_BYTE *)(v4 + 70) = v7;
    result = 1;
  }
  else
  {
    *(_BYTE *)(v4 + 70) = v7;
    result = 0;
  }
  return result;
}

//----- (1000B860) --------------------------------------------------------
signed int __cdecl sub_1000B860(int a1, int a2, __int16 a3)
{
  __int16 v3; // ax@1
  signed int result; // eax@3
  char v5; // [sp+8h] [bp-20h]@1

  v3 = time(0);
  *(_BYTE *)a2 = *(_BYTE *)(a1 + 110);
  *(_WORD *)(a2 + 2) = v3;
  *(_BYTE *)(a2 + 1) = 2;
  *(_DWORD *)(a2 + 4) = *(_DWORD *)(a1 + 36);
  *(_WORD *)(a2 + 8) = *(_WORD *)(a1 + 34);
  *(_BYTE *)(a2 + 14) = 32;
  *(_BYTE *)(a2 + 48) = 32;
  *(_WORD *)(a2 + 10) = a3 + 68;
  *(_WORD *)(a2 + 12) = 0;
  *(_BYTE *)(a2 + 47) = 0;
  *(_BYTE *)(a2 + 81) = 0;
  if ( sub_1000B670(*(const char **)(a1 + 2508), *(_BYTE *)(a1 + 109), &v5) )
  {
    memcpy((void *)(a2 + 15), &v5, 0x20u);
    if ( sub_1000B670(*(const char **)(a1 + 2496), *(_BYTE *)(a1 + 108), &v5) )
    {
      memcpy((void *)(a2 + 49), &v5, 0x20u);
      result = 1;
    }
    else
    {
      result = -2;
    }
  }
  else
  {
    result = -2;
  }
  return result;
}

//----- (1000B940) --------------------------------------------------------
bool __cdecl sub_1000B940(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 2u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 4), 4u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 8), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 10), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 12), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 14), 1u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 15), 0x20u)
      && sub_10002470(a1, a2, (const void *)(a3 + 47), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 48), 1u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 49), 0x20u)
      && sub_10002470(a1, a2, (const void *)(a3 + 81), 1u);
}

//----- (1000BA80) --------------------------------------------------------
signed int __cdecl sub_1000BA80(int a1, int a2)
{
  const char *v2; // eax@1
  char v3; // bl@1
  signed int result; // eax@11
  char v5; // [sp+8h] [bp-94h]@7
  char v6; // [sp+9h] [bp-93h]@7
  __int16 v7; // [sp+Ah] [bp-92h]@7
  const char *v8; // [sp+Ch] [bp-90h]@4
  int v9; // [sp+10h] [bp-8Ch]@7
  int v10; // [sp+14h] [bp-88h]@4
  int v11; // [sp+18h] [bp-84h]@1
  int v12; // [sp+1Ch] [bp-80h]@1
  int v13; // [sp+20h] [bp-7Ch]@1
  int v14; // [sp+24h] [bp-78h]@1
  int v15; // [sp+28h] [bp-74h]@1
  int v16; // [sp+2Ch] [bp-70h]@1
  int v17; // [sp+30h] [bp-6Ch]@1
  int v18; // [sp+34h] [bp-68h]@1
  int v19; // [sp+38h] [bp-64h]@1
  int v20; // [sp+3Ch] [bp-60h]@1
  int v21; // [sp+40h] [bp-5Ch]@1
  int v22; // [sp+44h] [bp-58h]@1
  int v23; // [sp+48h] [bp-54h]@1
  int v24; // [sp+4Ch] [bp-50h]@1
  int v25; // [sp+50h] [bp-4Ch]@1
  int v26; // [sp+54h] [bp-48h]@1
  char v27; // [sp+58h] [bp-44h]@7
  char v28; // [sp+59h] [bp-43h]@8
  char v29; // [sp+79h] [bp-23h]@7
  char v30; // [sp+7Ah] [bp-22h]@7
  char v31; // [sp+7Bh] [bp-21h]@9
  char v32; // [sp+9Bh] [bp-1h]@7

  v11 = 0;
  v12 = 0;
  v19 = 0;
  v13 = 0;
  v20 = 0;
  v14 = 0;
  v21 = 0;
  v15 = 0;
  v22 = 0;
  v16 = 0;
  v23 = 0;
  v17 = 0;
  v3 = *(_BYTE *)(a1 + 69);
  v24 = 0;
  v25 = 0;
  v18 = 0;
  v2 = *(const char **)(a1 + 2496);
  v26 = 0;
  *(_BYTE *)(a1 + 69) = 0;
  if ( !v2 || !*(_DWORD *)(a1 + 104) )
    v2 = "*SMBSERVER";
  LOBYTE(v10) = *(_BYTE *)(a1 + 108);
  v8 = *(const char **)(a1 + 2508);
  if ( !v8 || !*(_DWORD *)(a1 + 104) )
    v8 = "*SMBCLIENT";
  LOBYTE(v9) = *(_BYTE *)(a1 + 109);
  v6 = 0;
  v29 = 0;
  v32 = 0;
  v27 = 32;
  v30 = 32;
  v5 = -127;
  v7 = 68;
  if ( sub_1000B670(v2, v10, &v11) )
  {
    memcpy(&v28, &v11, 0x20u);
    if ( sub_1000B670(v8, v9, &v19) )
    {
      memcpy(&v31, &v19, 0x20u);
      if ( sub_1000B770(a1, a2, (int)&v5) && sub_100025E0(a1, a2, &v27, 0x44u) )
      {
        *(_BYTE *)(a1 + 69) = v3;
        result = 1;
      }
      else
      {
        *(_BYTE *)(a1 + 69) = v3;
        result = -17;
      }
    }
    else
    {
      *(_BYTE *)(a1 + 69) = v3;
      result = -2;
    }
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = -2;
  }
  return result;
}

//----- (1000BC10) --------------------------------------------------------
signed int __cdecl sub_1000BC10(int a1, int a2, int a3)
{
  signed int result; // eax@1

  result = sub_1000BA80(a1, a2);
  if ( result == 1 )
    result = sub_10007BA0(a1, a2, a3, -1);
  return result;
}

//----- (1000BC40) --------------------------------------------------------
signed int __cdecl sub_1000BC40(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // eax@2
  int *v5; // eax@4
  char v6; // dl@4
  char v7; // cl@5
  char *v8; // eax@6
  char v9; // cl@7
  size_t v10; // edi@8
  char *v11; // eax@11
  char *v12; // eax@11
  char v13; // cl@12
  char *v14; // eax@13
  char v15; // cl@14
  char *v16; // eax@15
  char v17; // dl@16
  int v18; // edx@17
  char v19; // cl@17
  int v20; // eax@17
  int v21; // eax@19
  signed int result; // eax@26
  int v23; // eax@29
  unsigned int v24; // ebx@31
  struct in_addr v25; // [sp-4h] [bp-36Ch]@9
  char v26; // [sp+12h] [bp-356h]@4
  char v27; // [sp+13h] [bp-355h]@1
  char v28; // [sp+14h] [bp-354h]@17
  char v29; // [sp+15h] [bp-353h]@17
  char v30; // [sp+16h] [bp-352h]@17
  __int16 v31; // [sp+17h] [bp-351h]@31
  __int16 v32; // [sp+19h] [bp-34Fh]@17
  __int16 v33; // [sp+1Bh] [bp-34Dh]@28
  int v34; // [sp+1Dh] [bp-34Bh]@31
  unsigned int v35; // [sp+24h] [bp-344h]@4
  unsigned int v36; // [sp+28h] [bp-340h]@17
  int v37; // [sp+2Ch] [bp-33Ch]@2
  const void *v38; // [sp+30h] [bp-338h]@4
  unsigned int v39; // [sp+34h] [bp-334h]@6
  const void *v40; // [sp+38h] [bp-330h]@4
  int v41; // [sp+3Ch] [bp-32Ch]@1
  __int16 v42; // [sp+40h] [bp-328h]@1
  char *v43; // [sp+44h] [bp-324h]@15
  char Dest; // [sp+48h] [bp-320h]@1
  char v45; // [sp+49h] [bp-31Fh]@1
  __int16 v46; // [sp+365h] [bp-3h]@1
  char v47; // [sp+367h] [bp-1h]@1

  Dest = 0;
  memset(&v45, 0, 0x31Cu);
  v46 = 0;
  v47 = 0;
  v41 = dword_100162B0;
  v3 = *(_DWORD *)(a1 + 300);
  v27 = 0;
  v42 = word_100162B4;
  if ( !v3 || (v4 = *(_DWORD *)(a1 + 80), v37 = 1, !v4) )
    v37 = 0;
  v6 = *(_BYTE *)(a1 + 69);
  v38 = &v27;
  v5 = &v41;
  v26 = v6;
  *(_BYTE *)(a1 + 69) = 16;
  v35 = 1;
  v40 = &v41;
  do
  {
    v7 = *(_BYTE *)v5;
    v5 = (int *)((char *)v5 + 1);
  }
  while ( v7 );
  v39 = (char *)v5 - ((char *)&v41 + 1) + 1;
  strncpy(&Dest, "\\\\", 0x31Fu);
  v8 = &Dest;
  do
    v9 = *v8++;
  while ( v9 );
  v10 = 799 - (v8 - &v45);
  if ( *(_DWORD *)(a1 + 64) )
    v25 = *(struct in_addr *)(a1 + 64);
  else
    v25 = *(struct in_addr *)(a1 + 20);
  v12 = inet_ntoa(v25);
  strncat(&Dest, v12, v10);
  v11 = &Dest;
  do
    v13 = *v11++;
  while ( v13 );
  strncat(&Dest, L"\\", 799 - (v11 - &v45));
  v14 = &Dest;
  do
    v15 = *v14++;
  while ( v15 );
  strncat(&Dest, *(const char **)(a1 + 208), 799 - (v14 - &v45));
  v16 = &Dest;
  v43 = &Dest;
  do
    v17 = *v16++;
  while ( v17 );
  v20 = v16 - &v45;
  v18 = v20 + 1;
  v19 = 4;
  v36 = v20 + 1;
  v28 = 4;
  v29 = -1;
  v30 = 0;
  v32 = 8;
  if ( a2 )
  {
    if ( *(_DWORD *)a2 == 4 )
    {
      v21 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v21 + 540) == 4 )
      {
        if ( *(_DWORD *)(v21 + 1104) == 12 && *(_DWORD *)(v21 + 1668) == 12 && *(_DWORD *)(v21 + 2232) == 12 )
        {
          v32 = **(_WORD **)(v21 + 136);
          if ( !sub_100082E0(a1, v21 + 564, (int)&v36, (int)&v43)
            || !sub_100082E0(a1, *(_DWORD *)(a2 + 12) + 1128, (int)&v35, (int)&v38)
            || !sub_100082E0(a1, *(_DWORD *)(a2 + 12) + 1692, (int)&v39, (int)&v40) )
          {
            result = -16;
            *(_BYTE *)(a1 + 69) = v26;
            return result;
          }
          v18 = v36;
          v19 = v28;
        }
      }
    }
  }
  v33 = v35;
  if ( v37 )
    v23 = v35 + 2 * v18 + 6;
  else
    v23 = v18 + v35 + 6;
  LOWORD(v34) = v23;
  v31 = (_WORD)v23 + 2 * (unsigned __int8)v19 + 35;
  result = sub_100072C0(a1, a3, (_WORD)v23 + 2 * (unsigned __int8)v19 + 35, 117);
  v24 = result;
  if ( result == 1 )
  {
    if ( sub_10002470(a1, a3, &v28, 1u)
      && sub_10002470(a1, a3, &v29, v24)
      && sub_10002470(a1, a3, &v30, v24)
      && sub_10002470(a1, a3, &v31, 2u)
      && sub_10002470(a1, a3, &v32, 2u)
      && sub_10002470(a1, a3, &v33, 2u)
      && sub_10002470(a1, a3, &v34, 2u)
      && sub_100025E0(a1, a3, v38, v35)
      && sub_10003490(a1, a3, (int)&Dest, v36, v37)
      && sub_100025E0(a1, a3, v40, v39) )
    {
      *(_BYTE *)(a1 + 69) = v26;
      result = v24;
    }
    else
    {
      result = -17;
      *(_BYTE *)(a1 + 69) = v26;
    }
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v26;
  }
  return result;
}
// 100162B0: using guessed type int dword_100162B0;
// 100162B4: using guessed type __int16 word_100162B4;

//----- (1000C010) --------------------------------------------------------
signed int __cdecl sub_1000C010(int a1, int a2, int a3, int *a4)
{
  char v4; // al@5
  int v5; // ebx@9
  int v6; // edi@10

  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_BYTE *)(a3 + 24) = 0;
  if ( !sub_10002660(a1, a2, (void *)a3, a4, 1u)
    || !sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u)
    || !sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u)
    || !sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u) )
    return 0;
  v4 = *(_BYTE *)a3;
  if ( *(_BYTE *)a3 == 2 )
    goto LABEL_20;
  if ( v4 != 3 )
  {
    if ( v4 != 7
      || !sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u)
      || !sub_10002660(a1, a2, (void *)(a3 + 7), a4, 4u)
      || !sub_10002660(a1, a2, (void *)(a3 + 11), a4, 4u) )
      return 0;
LABEL_20:
    if ( sub_10002660(a1, a2, (void *)(a3 + 15), a4, 2u) )
    {
      *(_DWORD *)(a3 + 17) = *a4 + *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a3 + 21) = 0;
      return 1;
    }
    return 0;
  }
  if ( !sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u) || !sub_10002660(a1, a2, (void *)(a3 + 15), a4, 2u) )
    return 0;
  *(_DWORD *)(a3 + 17) = *(_DWORD *)(a2 + 8) + *a4;
  *(_DWORD *)(a3 + 21) = 0;
  v5 = *a4;
  if ( *a4 < *(_DWORD *)a2 )
  {
    v6 = *(_DWORD *)(a2 + 8);
    while ( *(_BYTE *)(v6 + v5) )
    {
      ++v5;
      if ( v5 >= *(_DWORD *)a2 )
        return 1;
    }
    *(_DWORD *)(a3 + 21) = v6 + v5 + 1;
  }
  return 1;
}

//----- (1000C1A0) --------------------------------------------------------
signed int __cdecl sub_1000C1A0(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@1
  int v5; // edi@1
  int v6; // esi@1
  int v7; // ST08_4@1
  int v8; // ebx@4
  signed int v9; // edi@4
  char v10; // [sp+8h] [bp-1Ch]@5

  v6 = a1;
  v5 = a2;
  v7 = a1;
  a1 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  result = sub_1000BC40(v7, a4, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(v6 + 116) )
      sub_10008150(v6, v5);
    v8 = a3;
    v9 = sub_10007BA0(v6, v5, a3, 117);
    if ( v9 == 1 )
    {
      if ( !sub_1000C010(v6, v8, (int)&v10, &a1) || v10 != 2 && v10 != 3 && v10 != 7 )
        v9 = -12;
    }
    result = v9;
  }
  return result;
}

//----- (1000C240) --------------------------------------------------------
signed int __cdecl sub_1000C240(int a1, int a2, int a3)
{
  int v3; // ebx@1
  int v4; // ebp@1
  int v5; // eax@1
  signed int v6; // edi@3
  int v7; // eax@5
  signed __int16 v8; // dx@7
  int v9; // ecx@9
  unsigned int v10; // eax@21
  int v11; // eax@28
  char v12; // zf@34
  signed int v13; // ecx@34
  char *v14; // edi@34
  int v15; // esi@34
  unsigned int v16; // edi@41
  char v17; // zf@42
  int v18; // edx@42
  int v19; // eax@46
  int v20; // eax@48
  signed int result; // eax@48
  unsigned int v22; // ebx@48
  unsigned int v23; // [sp+10h] [bp-68h]@10
  unsigned int v24; // [sp+14h] [bp-64h]@13
  unsigned int v25; // [sp+18h] [bp-60h]@16
  unsigned int v26; // [sp+1Ch] [bp-5Ch]@19
  const void *v27; // [sp+20h] [bp-58h]@7
  int v28; // [sp+24h] [bp-54h]@3
  int v29; // [sp+28h] [bp-50h]@10
  int v30; // [sp+2Ch] [bp-4Ch]@13
  int v31; // [sp+30h] [bp-48h]@16
  int v32; // [sp+34h] [bp-44h]@21
  int v33; // [sp+38h] [bp-40h]@1
  char v34; // [sp+3Ch] [bp-3Ch]@5
  char v35; // [sp+3Dh] [bp-3Bh]@5
  char v36; // [sp+3Eh] [bp-3Ah]@5
  char v37; // [sp+3Fh] [bp-39h]@5
  char v38; // [sp+40h] [bp-38h]@5
  char v39; // [sp+41h] [bp-37h]@5
  char v40; // [sp+42h] [bp-36h]@5
  char v41; // [sp+43h] [bp-35h]@5
  char v42; // [sp+44h] [bp-34h]@39
  unsigned __int8 v43; // [sp+5Ch] [bp-1Ch]@21
  char v44; // [sp+5Dh] [bp-1Bh]@21
  char v45; // [sp+5Eh] [bp-1Ah]@21
  __int16 v46; // [sp+5Fh] [bp-19h]@48
  __int16 v47; // [sp+61h] [bp-17h]@22
  unsigned __int16 v48; // [sp+63h] [bp-15h]@24
  __int16 v49; // [sp+65h] [bp-13h]@26
  int v50; // [sp+67h] [bp-11h]@26
  _BYTE v51[6]; // [sp+6Bh] [bp-Dh]@26
  int v52; // [sp+71h] [bp-7h]@48
  char v53; // [sp+7Ch] [bp+4h]@5

  v4 = a1;
  v5 = *(_DWORD *)(a1 + 300);
  v3 = 0;
  v33 = 0;
  if ( v5 && *(_DWORD *)(a1 + 80) )
  {
    v6 = 1;
    v28 = 1;
  }
  else
  {
    v28 = 0;
    v6 = 1;
  }
  v53 = *(_BYTE *)(a1 + 69);
  v7 = *(_DWORD *)(v4 + 2608);
  v34 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v40 = 0;
  v41 = 0;
  *(_BYTE *)(v4 + 69) = 16;
  if ( v7 > 0 && *(_DWORD *)(v4 + 128) )
  {
    v27 = *(const void **)(v4 + 2616);
    v8 = v7;
  }
  else
  {
    v27 = 0;
    v8 = 0;
  }
  v9 = (int)&unk_10016892;
  if ( *(_DWORD *)(v4 + 2584) <= 0 )
  {
    v29 = (int)&unk_10016892;
    v23 = v6;
  }
  else
  {
    v29 = *(_DWORD *)(v4 + 2592);
    v23 = *(_DWORD *)(v4 + 2584);
  }
  if ( *(_DWORD *)(v4 + 2356) <= 0 )
  {
    v30 = (int)&unk_10016892;
    v24 = v6;
  }
  else
  {
    v30 = *(_DWORD *)(v4 + 2364);
    v24 = *(_DWORD *)(v4 + 2356);
  }
  if ( *(_DWORD *)(v4 + 2308) <= 0 )
  {
    v31 = (int)&unk_10016892;
    v25 = v6;
  }
  else
  {
    v31 = *(_DWORD *)(v4 + 2316);
    v25 = *(_DWORD *)(v4 + 2308);
  }
  if ( *(_DWORD *)(v4 + 2332) <= 0 )
  {
    v26 = v6;
  }
  else
  {
    v9 = *(_DWORD *)(v4 + 2340);
    v26 = *(_DWORD *)(v4 + 2332);
  }
  v10 = *(_DWORD *)(v4 + 240);
  v32 = v9;
  v43 = 10;
  v44 = -1;
  v45 = 0;
  if ( v10 <= 0 )
    v47 = 4096;
  else
    v47 = v10;
  v48 = *(_WORD *)(v4 + 236);
  if ( v48 <= 0u )
    v48 = 25;
  v50 = *(_DWORD *)(v4 + 284);
  v49 = 0;
  *(_DWORD *)&v51[2] = 0;
  if ( a2 )
  {
    if ( *(_DWORD *)a2 >= 4 )
    {
      v11 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v11 + 540) == 4 )
      {
        if ( *(_DWORD *)(v11 + 1104) == 4 )
        {
          if ( *(_DWORD *)(v11 + 1668) == 4 )
          {
            if ( *(_DWORD *)(v11 + 2232) == 5 )
            {
              v47 = **(_WORD **)(v11 + 136);
              v48 = **(_WORD **)(v11 + 700);
              v49 = **(_WORD **)(v11 + 1264);
              v50 = **(_DWORD **)(v11 + 1828);
            }
          }
        }
      }
    }
  }
  *(_WORD *)v51 = v8;
  if ( (unsigned __int16)v8 >= (_WORD)v6 )
  {
    v13 = 2;
    v14 = &v34;
    v15 = v4 + 2824;
    v12 = 1;
    do
    {
      if ( !v13 )
        break;
      v12 = *(_DWORD *)v15 == *(_DWORD *)v14;
      v15 += 4;
      v14 += 4;
      --v13;
    }
    while ( v12 );
    if ( !v12 )
    {
      sub_1000B5B0(v4 + 2840, v4 + 2824, (int)&v42);
      v8 = 24;
      v27 = &v42;
      *(_WORD *)v51 = 24;
    }
    v3 = 0;
  }
  v16 = 0;
  if ( v28 == v3 )
  {
    v19 = v26 + v25 + v23 + v24;
  }
  else
  {
    v18 = v8 & 1;
    v17 = v18 == 0;
    if ( v18 < 0 )
      v17 = ((v18 - 1) | 0xFFFFFFFE) == -1;
    if ( v17 )
      v16 = 1;
    v19 = v16 + 2 * (v26 + v25 + v24 + v23);
  }
  v20 = *(_DWORD *)v51 + v19;
  LOWORD(v52) = v20;
  v46 = (_WORD)v20 + 2 * v43 + 35;
  result = sub_100072C0(v4, a3, (_WORD)v20 + 2 * v43 + 35, 115);
  v22 = result;
  if ( result == 1 )
  {
    if ( sub_10002470(v4, a3, &v43, 1u)
      && sub_10002470(v4, a3, &v44, v22)
      && sub_10002470(v4, a3, &v45, v22)
      && sub_10002470(v4, a3, &v46, 2u)
      && sub_10002470(v4, a3, &v47, 2u)
      && sub_10002470(v4, a3, &v48, 2u)
      && sub_10002470(v4, a3, &v49, 2u)
      && sub_10002470(v4, a3, &v50, 4u)
      && sub_10002470(v4, a3, v51, 2u)
      && sub_10002470(v4, a3, &v51[2], 4u)
      && sub_10002470(v4, a3, &v52, 2u)
      && sub_100025E0(v4, a3, v27, *(unsigned __int16 *)v51)
      && sub_10002470(v4, a3, &v33, v16)
      && sub_10003490(v4, a3, v29, v23, v28)
      && sub_10003490(v4, a3, v30, v24, v28)
      && sub_10003490(v4, a3, v31, v25, v28)
      && sub_10003490(v4, a3, v32, v26, v28) )
    {
      *(_BYTE *)(v4 + 69) = v53;
      result = v22;
    }
    else
    {
      *(_BYTE *)(v4 + 69) = v53;
      result = -17;
    }
  }
  else
  {
    *(_BYTE *)(v4 + 69) = v53;
  }
  return result;
}

//----- (1000C6D0) --------------------------------------------------------
signed int __cdecl sub_1000C6D0(int a1, int a2, int a3)
{
  int v3; // eax@1
  signed int v4; // edi@3
  int v5; // eax@5
  int v6; // ecx@7
  int v7; // eax@9
  signed int v8; // ebp@16
  char v9; // dl@18
  int v10; // ecx@18
  int v11; // eax@18
  __int16 v12; // cx@18
  char v13; // zf@18
  int v14; // eax@22
  signed __int16 v15; // ax@30
  const void *v16; // ebx@30
  int v17; // ecx@30
  int v18; // edx@30
  int v19; // ecx@30
  int v20; // edx@30
  int v21; // ecx@30
  int v22; // eax@30
  int v23; // ecx@30
  char v24; // zf@33
  int v25; // eax@33
  int v26; // eax@37
  signed int result; // eax@39
  unsigned int v28; // ebp@39
  int v29; // eax@39
  int v30; // ebx@56
  char v31; // [sp+13h] [bp-99h]@5
  char v32; // [sp+14h] [bp-98h]@18
  char v33; // [sp+15h] [bp-97h]@18
  char v34; // [sp+16h] [bp-96h]@18
  __int16 v35; // [sp+17h] [bp-95h]@39
  __int16 v36; // [sp+19h] [bp-93h]@18
  __int16 v37; // [sp+1Bh] [bp-91h]@18
  __int16 v38; // [sp+1Dh] [bp-8Fh]@18
  int v39; // [sp+1Fh] [bp-8Dh]@18
  unsigned int v40; // [sp+23h] [bp-89h]@30
  int v41; // [sp+27h] [bp-85h]@20
  int v42; // [sp+2Bh] [bp-81h]@18
  int v43; // [sp+2Fh] [bp-7Dh]@39
  unsigned int v44; // [sp+34h] [bp-78h]@10
  unsigned int v45; // [sp+38h] [bp-74h]@13
  unsigned int v46; // [sp+3Ch] [bp-70h]@7
  unsigned int v47; // [sp+40h] [bp-6Ch]@32
  int v48; // [sp+44h] [bp-68h]@3
  unsigned int v49; // [sp+48h] [bp-64h]@16
  int v50; // [sp+4Ch] [bp-60h]@30
  int v51; // [sp+50h] [bp-5Ch]@30
  int v52; // [sp+54h] [bp-58h]@30
  int v53; // [sp+58h] [bp-54h]@30
  int v54; // [sp+5Ch] [bp-50h]@30
  char v55; // [sp+60h] [bp-4Ch]@30
  int v56; // [sp+64h] [bp-48h]@7
  const void *v57; // [sp+68h] [bp-44h]@30
  int v58; // [sp+6Ch] [bp-40h]@13
  int v59; // [sp+70h] [bp-3Ch]@18
  int v60; // [sp+74h] [bp-38h]@10
  int v61; // [sp+78h] [bp-34h]@1
  char v62; // [sp+7Ch] [bp-30h]@30
  char v63; // [sp+94h] [bp-18h]@30

  v3 = *(_DWORD *)(a1 + 300);
  v61 = 0;
  if ( v3 && *(_DWORD *)(a1 + 80) )
  {
    v4 = 1;
    v48 = 1;
  }
  else
  {
    v48 = 0;
    v4 = 1;
  }
  v31 = *(_BYTE *)(a1 + 69);
  v5 = *(_DWORD *)(a1 + 2584);
  *(_BYTE *)(a1 + 69) = 16;
  if ( v5 > 0 && *(_DWORD *)(a1 + 128) )
  {
    v56 = *(_DWORD *)(a1 + 2592);
    v46 = v5;
    v6 = (int)&unk_10016892;
  }
  else
  {
    v6 = (int)&unk_10016892;
    v56 = (int)&unk_10016892;
    v46 = v4;
  }
  v7 = *(_DWORD *)(a1 + 2356);
  if ( v7 <= 0 )
  {
    v60 = v6;
    v44 = v4;
  }
  else
  {
    v60 = *(_DWORD *)(a1 + 2364);
    v44 = v7;
  }
  if ( *(_DWORD *)(a1 + 2308) <= 0 )
  {
    v58 = v6;
    v45 = v4;
  }
  else
  {
    v45 = *(_DWORD *)(a1 + 2308);
    v58 = *(_DWORD *)(a1 + 2316);
  }
  if ( *(_DWORD *)(a1 + 2332) <= 0 )
  {
    v49 = v4;
    v8 = v4;
  }
  else
  {
    v6 = *(_DWORD *)(a1 + 2340);
    v8 = *(_DWORD *)(a1 + 2332);
    v49 = *(_DWORD *)(a1 + 2332);
  }
  v36 = *(_WORD *)(a1 + 240);
  v11 = *(_DWORD *)(a1 + 284);
  v59 = v6;
  v12 = *(_WORD *)(a1 + 236);
  v39 = v11;
  v13 = *(_DWORD *)(a1 + 80) == 0;
  v37 = v12;
  v10 = *(_DWORD *)(a1 + 232);
  v9 = 13;
  v32 = 13;
  v33 = -1;
  v34 = 0;
  v38 = 0;
  v42 = v10;
  if ( v13 )
    v42 = v10 & 0xFFFFFFFB;
  v41 = 0;
  if ( a2 )
  {
    if ( *(_DWORD *)a2 >= 4 )
    {
      v14 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v14 + 540) == 4 )
      {
        if ( *(_DWORD *)(v14 + 1104) == 4 )
        {
          if ( *(_DWORD *)(v14 + 1668) == 4 )
          {
            if ( *(_DWORD *)(v14 + 2232) == 5 )
            {
              v36 = **(_WORD **)(v14 + 136);
              v37 = **(_WORD **)(v14 + 700);
              v38 = **(_WORD **)(v14 + 1264);
              v39 = **(_DWORD **)(v14 + 1828);
            }
          }
        }
      }
    }
    LOWORD(v4) = 1;
  }
  if ( *(_DWORD *)(a1 + 2608) && *(_DWORD *)(a1 + 128) )
  {
    v50 = 0;
    v51 = 0;
    v52 = 0;
    v53 = 0;
    v54 = 0;
    v17 = *(_DWORD *)(a1 + 2840);
    v55 = 0;
    v18 = *(_DWORD *)(a1 + 2844);
    v50 = v17;
    v19 = *(_DWORD *)(a1 + 2848);
    v51 = v18;
    v20 = *(_DWORD *)(a1 + 2852);
    v52 = v19;
    v53 = v20;
    sub_1000B5B0((int)&v50, a1 + 2824, (int)&v62);
    v21 = *(_DWORD *)(a1 + 2860);
    v50 = *(_DWORD *)(a1 + 2856);
    v22 = *(_DWORD *)(a1 + 2864);
    v51 = v21;
    v23 = *(_DWORD *)(a1 + 2868);
    v52 = v22;
    v16 = &v62;
    LOWORD(v40) = 24;
    v53 = v23;
    sub_1000B5B0((int)&v50, a1 + 2824, (int)&v63);
    v9 = v32;
    v57 = &v63;
    v15 = 24;
  }
  else
  {
    LOWORD(v40) = v4;
    v15 = 0;
    v16 = &unk_10016892;
    v57 = 0;
  }
  HIWORD(v40) = v15;
  v47 = 0;
  if ( v48 )
  {
    v25 = ((unsigned __int16)v40 + (unsigned __int16)v15) & 0x80000001;
    v24 = v25 == 0;
    if ( v25 < 0 )
      v24 = ((v25 - 1) | 0xFFFFFFFE) == -1;
    if ( v24 )
      v47 = 1;
    v26 = v47 + 2 * (v8 + v45 + v44 + v46);
  }
  else
  {
    v26 = v8 + v45 + v44 + v46;
  }
  v29 = v40 + *(unsigned int *)((char *)&v40 + 2) + v26;
  LOWORD(v43) = v29;
  v35 = (_WORD)v29 + 2 * (unsigned __int8)v9 + 35;
  result = sub_100072C0(a1, a3, (_WORD)v29 + 2 * (unsigned __int8)v9 + 35, 115);
  v28 = result;
  if ( result == 1 )
  {
    if ( sub_10002470(a1, a3, &v32, 1u)
      && sub_10002470(a1, a3, &v33, v28)
      && sub_10002470(a1, a3, &v34, v28)
      && sub_10002470(a1, a3, &v35, 2u)
      && sub_10002470(a1, a3, &v36, 2u)
      && sub_10002470(a1, a3, &v37, 2u)
      && sub_10002470(a1, a3, &v38, 2u)
      && sub_10002470(a1, a3, &v39, 4u)
      && sub_10002470(a1, a3, &v40, 2u)
      && sub_10002470(a1, a3, (char *)&v40 + 2, 2u)
      && sub_10002470(a1, a3, &v41, 4u)
      && sub_10002470(a1, a3, &v42, 4u)
      && sub_10002470(a1, a3, &v43, 2u)
      && sub_100025E0(a1, a3, v16, (unsigned __int16)v40)
      && sub_100025E0(a1, a3, v57, HIWORD(v40))
      && sub_100025E0(a1, a3, &v61, v47)
      && (v30 = v48, sub_10003490(a1, a3, v56, v46, v48))
      && sub_10003490(a1, a3, v60, v44, v30)
      && sub_10003490(a1, a3, v58, v45, v30)
      && sub_10003490(a1, a3, v59, v49, v30) )
    {
      *(_BYTE *)(a1 + 69) = v31;
      result = v28;
    }
    else
    {
      *(_BYTE *)(a1 + 69) = v31;
      result = -17;
    }
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v31;
  }
  return result;
}

//----- (1000CC40) --------------------------------------------------------
signed int __cdecl sub_1000CC40(int a1, int a2, int a3, int a4, int a5)
{
  unsigned int v5; // ebx@1
  int v6; // eax@1
  signed int v7; // ecx@3
  int v8; // eax@5
  int v9; // edi@5
  int v10; // eax@8
  int v11; // eax@11
  __int16 v12; // ax@11
  __int16 v13; // dx@11
  char v14; // zf@11
  __int16 v15; // ax@15
  char v16; // zf@18
  int v17; // eax@22
  signed int v18; // ebp@24
  int v19; // ebx@42
  char v21; // [sp+12h] [bp-C6h]@1
  char v22; // [sp+13h] [bp-C5h]@5
  unsigned int v23; // [sp+14h] [bp-C4h]@6
  unsigned int v24; // [sp+18h] [bp-C0h]@9
  unsigned __int8 v25; // [sp+1Ch] [bp-BCh]@11
  char v26; // [sp+1Dh] [bp-BBh]@11
  char v27; // [sp+1Eh] [bp-BAh]@11
  __int16 v28; // [sp+1Fh] [bp-B9h]@24
  __int16 v29; // [sp+21h] [bp-B7h]@11
  __int16 v30; // [sp+23h] [bp-B5h]@11
  __int16 v31; // [sp+25h] [bp-B3h]@11
  int v32; // [sp+27h] [bp-B1h]@11
  _BYTE v33[6]; // [sp+2Bh] [bp-ADh]@11
  int v34; // [sp+31h] [bp-A7h]@13
  int v35; // [sp+35h] [bp-A3h]@24
  int v36; // [sp+3Ch] [bp-9Ch]@3
  int v37; // [sp+40h] [bp-98h]@6
  int v38; // [sp+44h] [bp-94h]@9
  char v39; // [sp+48h] [bp-90h]@13
  char v40; // [sp+78h] [bp-60h]@14

  v6 = *(_DWORD *)(a1 + 300);
  v5 = 0;
  v21 = 0;
  if ( v6 && *(_DWORD *)(a1 + 80) )
  {
    v7 = 1;
    v36 = 1;
  }
  else
  {
    v36 = 0;
    v7 = 1;
  }
  v9 = *(_DWORD *)(a1 + 2688);
  v22 = *(_BYTE *)(a1 + 69);
  v8 = *(_DWORD *)(a1 + 2308);
  *(_BYTE *)(a1 + 69) = 16;
  if ( v8 <= 0 )
  {
    v37 = (int)&unk_10016892;
    v23 = v7;
  }
  else
  {
    v37 = *(_DWORD *)(a1 + 2316);
    v23 = v8;
  }
  v10 = *(_DWORD *)(a1 + 2332);
  if ( v10 <= 0 )
  {
    v38 = (int)&unk_10016892;
    v24 = v7;
  }
  else
  {
    v38 = *(_DWORD *)(a1 + 2340);
    v24 = v10;
  }
  v12 = *(_WORD *)(a1 + 236);
  v13 = *(_WORD *)(a1 + 240);
  v32 = *(_DWORD *)(a1 + 284);
  v14 = *(_DWORD *)(a1 + 80) == 0;
  v30 = v12;
  v11 = *(_DWORD *)(a1 + 232);
  v25 = 12;
  v26 = -1;
  v27 = 0;
  v29 = v13;
  v31 = 0;
  *(_DWORD *)&v33[2] = 0;
  if ( v14 )
    v11 &= 0xFFFFFFFBu;
  v34 = v11 | 0x80000000;
  sub_10008780(a1, (int)&v39);
  *(_DWORD *)(a1 + 2688) = v9;
  if ( a4 != 1 )
  {
    sub_100087C0(a1, &v40, a5);
    *(_DWORD *)(a1 + 2688) = v9;
  }
  v15 = sub_100088B0(a1, (int)&v39);
  if ( a4 != 1 )
    v15 = sub_10008900(a1, (int)&v40);
  *(_WORD *)v33 = v15;
  if ( v36 )
  {
    v16 = (v15 & 1) == 0;
    if ( (v15 & 1) < 0 )
      v16 = (((v15 & 1) - 1) | 0xFFFFFFFE) == -1;
    if ( v16 )
      v5 = 1;
    v17 = v5 + 2 * (v24 + v23);
  }
  else
  {
    v17 = v23 + v24;
  }
  LOWORD(v35) = *(_WORD *)v33 + v17;
  v28 = *(_WORD *)v33 + v17 + 2 * v25 + 35;
  v18 = sub_100072C0(a1, a3, *(_WORD *)v33 + v17 + 2 * v25 + 35, 115);
  if ( v18 == 1 )
  {
    if ( !sub_10002470(a1, a3, &v25, 1u)
      || !sub_10002470(a1, a3, &v26, v18)
      || !sub_10002470(a1, a3, &v27, v18)
      || !sub_10002470(a1, a3, &v28, 2u)
      || !sub_10002470(a1, a3, &v29, 2u)
      || !sub_10002470(a1, a3, &v30, 2u)
      || !sub_10002470(a1, a3, &v31, 2u)
      || !sub_10002470(a1, a3, &v32, 4u)
      || !sub_10002470(a1, a3, v33, 2u)
      || !sub_10002470(a1, a3, &v33[2], 4u)
      || !sub_10002470(a1, a3, &v34, 4u)
      || !sub_10002470(a1, a3, &v35, 2u) )
      goto LABEL_44;
    if ( a4 == v18 )
    {
      if ( !sub_10008840(a1, a3, (int)&v39) )
        goto LABEL_44;
    }
    else
    {
      if ( !sub_10008880(a1, a3, (int)&v40) )
      {
LABEL_44:
        v18 = -17;
        goto LABEL_45;
      }
    }
    if ( !sub_100025E0(a1, a3, &v21, v5)
      || (v19 = v36, !sub_10003490(a1, a3, v37, v23, v36))
      || !sub_10003490(a1, a3, v38, v24, v19) )
      goto LABEL_44;
  }
LABEL_45:
  *(_BYTE *)(a1 + 69) = v22;
  return v18;
}

//----- (1000CFC0) --------------------------------------------------------
signed int __cdecl sub_1000CFC0(int a1, int a2, int a3, int *a4, int a5)
{
  int v6; // ebx@9
  int v7; // eax@11
  int v8; // eax@11
  char v9; // cl@11
  char v10; // al@13
  int v11; // eax@16
  int v12; // eax@19
  int v13; // ebx@23
  int v14; // edx@26
  int v15; // eax@29
  int v16; // ebx@34
  int v17; // ebx@35
  int v18; // eax@36
  int v19; // [sp-Ch] [bp-24h]@26
  int v20; // [sp+8h] [bp-10h]@17
  int v21; // [sp+8h] [bp-10h]@27
  int v22; // [sp+Ch] [bp-Ch]@1
  int v23; // [sp+10h] [bp-8h]@1
  int v24; // [sp+14h] [bp-4h]@1

  v23 = 0;
  v22 = 0;
  v24 = 0;
  if ( !sub_100036C0(a1, a2, 0) )
    return -17;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_BYTE *)(a3 + 20) = 0;
  if ( sub_10002660(a1, a2, (void *)a3, a4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 7), a4, 2u) )
  {
    v6 = *a4;
    *(_DWORD *)(a1 + 2288) = (*(_BYTE *)(a3 + 5) & 1) == 1;
    *(_DWORD *)(a3 + 9) = 0;
    *(_DWORD *)(a3 + 13) = 0;
    *(_DWORD *)(a3 + 17) = 0;
    if ( v6 < *(_DWORD *)a2 - 2 )
    {
      if ( *(_DWORD *)a5 )
      {
        v8 = *(_DWORD *)(a2 + 8);
        v6 = (v6 + 1) & 0xFFFFFFFE;
        v9 = *(_BYTE *)(v8 + v6);
        v7 = v6 + v8;
        if ( v9 >= 32 )
        {
          if ( v9 < 127 )
          {
            v10 = *(_BYTE *)(v7 + 1);
            if ( v10 >= 32 )
            {
              if ( v10 < 127 )
              {
                *(_DWORD *)a5 = 0;
                v6 = *a4;
              }
            }
          }
        }
      }
      v11 = v6 + *(_DWORD *)(a2 + 8);
      *(_DWORD *)(a3 + 9) = v11;
      if ( *(_DWORD *)a5 )
      {
        v20 = sub_10008430(v11);
        if ( !sub_10003970(a1, (int)&v22, *(_DWORD *)(a3 + 9), v20, 1) || !sub_100085A0(a1, a1 + 2296, (int)&v22) )
          goto LABEL_32;
        v12 = v20;
      }
      else
      {
        if ( !sub_100034E0(a1, a1 + 2296, (const void *)v11) )
        {
          sub_100066F0((int)&v22);
          return -17;
        }
        v12 = *(_DWORD *)(a1 + 2296);
      }
      v13 = v12 + v6;
      sub_100066F0((int)&v22);
      *(_DWORD *)(a3 + 9) = *(_DWORD *)(a1 + 2304);
      if ( v13 < *(_DWORD *)a2 - 2 )
      {
        if ( *(_DWORD *)a5 )
          v13 = (v13 + 1) & 0xFFFFFFFE;
        v14 = *(_DWORD *)(a2 + 8);
        *(_DWORD *)(a3 + 13) = v14 + v13;
        v19 = v14 + v13;
        if ( *(_DWORD *)a5 )
        {
          v21 = sub_10008430(v19);
          if ( !sub_10003970(a1, (int)&v22, *(_DWORD *)(a3 + 13), v21, 1) || !sub_100085A0(a1, a1 + 2320, (int)&v22) )
          {
            sub_100066F0((int)&v22);
            return -17;
          }
          v15 = v21;
LABEL_34:
          v16 = v15 + v13;
          sub_100066F0((int)&v22);
          *(_DWORD *)(a3 + 13) = *(_DWORD *)(a1 + 2328);
          if ( v16 < *(_DWORD *)a2 - 2 )
          {
            v17 = *(_DWORD *)(a2 + 8) + v16;
            *(_DWORD *)(a3 + 17) = v17;
            if ( *(_DWORD *)a5 )
            {
              v18 = sub_10008430(v17);
              if ( !sub_10003970(a1, a1 + 2368, *(_DWORD *)(a3 + 17), v18, 1) || !sub_100085A0(a1, a1 + 2344, a1 + 2368) )
                return -17;
            }
            else
            {
              if ( !sub_100034E0(a1, a1 + 2344, (const void *)v17) || !sub_10008450(a1, a1, a1 + 2368, a1 + 2344) )
                return -17;
            }
            *(_DWORD *)(a3 + 17) = *(_DWORD *)(a1 + 2352);
          }
          return 1;
        }
        if ( sub_100034E0(a1, a1 + 2320, (const void *)v19) )
        {
          v15 = *(_DWORD *)(a1 + 2320);
          goto LABEL_34;
        }
LABEL_32:
        sub_100066F0((int)&v22);
        return -17;
      }
    }
    return 1;
  }
  return -12;
}

//----- (1000D330) --------------------------------------------------------
signed int __cdecl sub_1000D330(int a1, int a2, int a3, int *a4, int a5)
{
  int v6; // esi@10
  int v7; // esi@11
  int v8; // eax@11
  int v9; // eax@13
  int v10; // eax@13
  char v11; // cl@13
  char v12; // al@15
  int v13; // eax@18
  int v14; // eax@21
  int v15; // esi@25
  int v16; // edx@28
  int v17; // eax@31
  int v18; // esi@36
  int v19; // esi@39
  int v20; // ebp@40
  int v21; // [sp-Ch] [bp-24h]@28
  int v22; // [sp+8h] [bp-10h]@19
  int v23; // [sp+8h] [bp-10h]@29
  int v24; // [sp+Ch] [bp-Ch]@1
  int v25; // [sp+10h] [bp-8h]@1
  int v26; // [sp+14h] [bp-4h]@1

  v25 = 0;
  v24 = 0;
  v26 = 0;
  if ( !sub_100036C0(a1, a2, 0) )
    return -17;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_WORD *)(a3 + 24) = 0;
  *(_BYTE *)(a3 + 26) = 0;
  if ( sub_10002660(a1, a2, (void *)a3, a4, 1u) )
  {
    if ( sub_10002660(a1, a2, (void *)(a3 + 1), a4, 1u) )
    {
      if ( sub_10002660(a1, a2, (void *)(a3 + 2), a4, 1u) )
      {
        if ( sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u) )
        {
          if ( sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u) )
          {
            if ( sub_10002660(a1, a2, (void *)(a3 + 7), a4, 2u) )
            {
              if ( sub_10002660(a1, a2, (void *)(a3 + 9), a4, 2u) )
              {
                *(_DWORD *)(a1 + 2288) = (*(_BYTE *)(a3 + 5) & 1) == 1;
                v6 = *a4;
                if ( *a4 < *(_DWORD *)a2 - 2 )
                {
                  v8 = v6 + *(_DWORD *)(a2 + 8);
                  v7 = *(_WORD *)(a3 + 7) + v6;
                  *(_DWORD *)(a3 + 11) = v8;
                  *a4 = v7;
                  *(_DWORD *)(a3 + 15) = 0;
                  *(_DWORD *)(a3 + 19) = 0;
                  *(_DWORD *)(a3 + 23) = 0;
                  if ( v7 < *(_DWORD *)a2 - 2 )
                  {
                    if ( *(_DWORD *)a5 )
                    {
                      v10 = *(_DWORD *)(a2 + 8);
                      v7 = (v7 + 1) & 0xFFFFFFFE;
                      v11 = *(_BYTE *)(v10 + v7);
                      v9 = v7 + v10;
                      if ( v11 >= 32 )
                      {
                        if ( v11 < 127 )
                        {
                          v12 = *(_BYTE *)(v9 + 1);
                          if ( v12 >= 32 )
                          {
                            if ( v12 < 127 )
                            {
                              *(_DWORD *)a5 = 0;
                              v7 = *a4;
                            }
                          }
                        }
                      }
                    }
                    v13 = v7 + *(_DWORD *)(a2 + 8);
                    *(_DWORD *)(a3 + 15) = v13;
                    if ( *(_DWORD *)a5 )
                    {
                      v22 = sub_10008430(v13);
                      if ( !sub_10003970(a1, (int)&v24, *(_DWORD *)(a3 + 15), v22, 1)
                        || !sub_100085A0(a1, a1 + 2296, (int)&v24) )
                        goto LABEL_34;
                      v14 = v22;
                    }
                    else
                    {
                      if ( !sub_100034E0(a1, a1 + 2296, (const void *)v13) )
                      {
                        sub_100066F0((int)&v24);
                        return -17;
                      }
                      v14 = *(_DWORD *)(a1 + 2296);
                    }
                    v15 = v14 + v7;
                    sub_100066F0((int)&v24);
                    *(_DWORD *)(a3 + 15) = *(_DWORD *)(a1 + 2304);
                    if ( v15 < *(_DWORD *)a2 - 2 )
                    {
                      if ( *(_DWORD *)a5 )
                        v15 = (v15 + 1) & 0xFFFFFFFE;
                      v16 = *(_DWORD *)(a2 + 8);
                      *(_DWORD *)(a3 + 19) = v16 + v15;
                      v21 = v16 + v15;
                      if ( *(_DWORD *)a5 )
                      {
                        v23 = sub_10008430(v21);
                        if ( !sub_10003970(a1, (int)&v24, *(_DWORD *)(a3 + 19), v23, 1)
                          || !sub_100085A0(a1, a1 + 2320, (int)&v24) )
                        {
                          sub_100066F0((int)&v24);
                          return -17;
                        }
                        v17 = v23;
LABEL_36:
                        v18 = v17 + v15;
                        sub_100066F0((int)&v24);
                        *(_DWORD *)(a3 + 19) = *(_DWORD *)(a1 + 2328);
                        if ( v18 < *(_DWORD *)a2 - 2 )
                        {
                          if ( *(_DWORD *)a5 )
                            v18 = (v18 + 1) & 0xFFFFFFFE;
                          v19 = *(_DWORD *)(a2 + 8) + v18;
                          *(_DWORD *)(a3 + 23) = v19;
                          if ( *(_DWORD *)a5 )
                          {
                            v20 = sub_10008430(v19);
                            sub_100066F0(a1 + 2416);
                            if ( !sub_10003970(a1, a1 + 2416, *(_DWORD *)(a3 + 23), v20, 1)
                              || !sub_100085A0(a1, a1 + 2392, a1 + 2416) )
                              return -17;
                          }
                          else
                          {
                            sub_100066F0(a1 + 2392);
                            if ( !sub_100034E0(a1, a1 + 2392, *(const void **)(a3 + 23))
                              || !sub_10008450(a3, a1, a1 + 2416, a1 + 2392) )
                              return -17;
                          }
                          *(_DWORD *)(a3 + 23) = *(_DWORD *)(a1 + 2400);
                        }
                        return 1;
                      }
                      if ( sub_100034E0(a1, a1 + 2320, (const void *)v21) )
                      {
                        v17 = *(_DWORD *)(a1 + 2320);
                        goto LABEL_36;
                      }
LABEL_34:
                      sub_100066F0((int)&v24);
                      return -17;
                    }
                  }
                  return 1;
                }
              }
            }
          }
        }
      }
    }
  }
  return -12;
}

//----- (1000D700) --------------------------------------------------------
signed int __cdecl sub_1000D700(signed int a1, int a2, int a3, int a4)
{
  int v4; // esi@1
  int v5; // eax@2
  signed int result; // eax@4
  int v7; // ebx@4
  int v8; // edi@5
  int v9; // [sp+8h] [bp-1Ch]@1
  char v10; // [sp+Ch] [bp-18h]@6

  v4 = a1;
  v9 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  if ( !*(_DWORD *)(a1 + 300) || (v5 = *(_DWORD *)(a1 + 80), a1 = 1, !v5) )
    a1 = 0;
  v7 = a2;
  result = sub_1000C240(v4, a4, a2);
  if ( result == 1 )
  {
    v8 = a3;
    result = sub_10007BA0(v4, v7, a3, 115);
    if ( result == 1 )
      result = sub_1000CFC0(v4, v8, (int)&v10, &v9, (int)&a1);
  }
  return result;
}

//----- (1000D7A0) --------------------------------------------------------
signed int __cdecl sub_1000D7A0(signed int a1, int a2, int a3, int a4)
{
  int v4; // esi@1
  int v5; // eax@2
  signed int result; // eax@4
  int v7; // ebx@4
  int v8; // edi@5
  int v9; // [sp+8h] [bp-1Ch]@1
  char v10; // [sp+Ch] [bp-18h]@8

  v4 = a1;
  v9 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  if ( !*(_DWORD *)(a1 + 300) || (v5 = *(_DWORD *)(a1 + 80), a1 = 1, !v5) )
    a1 = 0;
  v7 = a2;
  result = sub_1000C6D0(v4, a4, a2);
  if ( result == 1 )
  {
    v8 = a3;
    result = sub_10007BA0(v4, v7, a3, 115);
    if ( result == 1 )
    {
      if ( *(_DWORD *)(v4 + 116) )
      {
        sub_10008000(v4, *(_DWORD *)(v8 + 8) + 4, *(_DWORD *)v8 - 4, 1);
        *(_DWORD *)(v4 + 308) = 2;
      }
      result = sub_1000CFC0(v4, v8, (int)&v10, &v9, (int)&a1);
    }
  }
  return result;
}

//----- (1000D860) --------------------------------------------------------
signed int __cdecl sub_1000D860(signed int a1, int a2, int a3, int a4, int a5)
{
  int v5; // esi@1
  int v6; // eax@2
  signed int result; // eax@4
  int v8; // ebx@4
  int v9; // ebp@4
  int v10; // edi@5
  int v11; // [sp+10h] [bp-60h]@1
  char v12; // [sp+14h] [bp-5Ch]@7
  unsigned __int16 v13; // [sp+1Bh] [bp-55h]@8
  int v14; // [sp+1Fh] [bp-51h]@8
  char v15; // [sp+30h] [bp-40h]@4

  v5 = a1;
  v11 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  if ( !*(_DWORD *)(a1 + 300) || (v6 = *(_DWORD *)(a1 + 80), a1 = 1, !v6) )
    a1 = 0;
  v8 = a2;
  v9 = a4;
  memset(&v15, 0, 0x40u);
  result = sub_1000CC40(v5, a4, a2, 1, 0);
  if ( result == 1 )
  {
    v10 = a3;
    result = sub_10007BA0(v5, v8, a3, 115);
    if ( result == 1 || result == -1073741802 )
    {
      result = sub_1000D330(v5, v10, (int)&v12, &v11, (int)&a1);
      if ( result == 1 )
      {
        if ( sub_10008800(v5, v14, v13, (int)&v15) )
        {
          if ( a5 )
            nullsub_1(v5, &v15);
          *(_DWORD *)v10 = 0;
          *(_DWORD *)v8 = 0;
          result = sub_1000CC40(v5, v9, v8, 3, (int)&v15);
          if ( result == 1 )
          {
            result = sub_10007BA0(v5, v8, v10, 115);
            if ( result == 1 )
            {
              if ( *(_DWORD *)(v5 + 116) )
              {
                sub_10008000(v5, *(_DWORD *)(v10 + 8) + 4, *(_DWORD *)v10 - 4, 1);
                *(_DWORD *)(v5 + 308) = 2;
              }
              v11 = (((*(_DWORD *)(v5 + 92) != 4) - 1) & 0x4E) + 36;
              result = sub_1000D330(v5, v10, (int)&v12, &v11, (int)&a1);
            }
          }
        }
        else
        {
          result = -12;
        }
      }
    }
  }
  return result;
}

//----- (1000D9F0) --------------------------------------------------------
bool __cdecl sub_1000D9F0(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 1), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 2), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 3), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 5), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 6), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 8), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 12), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 16), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 20), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 24), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 28), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 32), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 36), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 40), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 44), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 48), 1u)
      && sub_10002470(a1, a2, (const void *)(a3 + 49), 2u);
}

//----- (1000DBB0) --------------------------------------------------------
bool __cdecl sub_1000DBB0(int a1, int a2, int a3, int a4, int a5)
{
  bool result; // eax@25

  memset((void *)a4, 0, 0x68u);
  if ( !sub_10002660(a1, a2, (void *)a4, (int *)a5, 1u)
    || !sub_10002660(a1, a2, (void *)(a4 + 1), (int *)a5, 1u)
    || !sub_10002660(a1, a2, (void *)(a4 + 2), (int *)a5, 1u)
    || !sub_10002660(a1, a2, (void *)(a4 + 3), (int *)a5, 2u)
    || !sub_10002660(a1, a2, (void *)(a4 + 5), (int *)a5, 1u)
    || !sub_10002660(a1, a2, (void *)(a4 + 6), (int *)a5, 2u)
    || !sub_10002660(a1, a2, (void *)(a4 + 8), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 12), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 16), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 20), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 24), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 28), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 32), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 36), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 40), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 44), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 48), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 52), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 56), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 60), (int *)a5, 4u)
    || !sub_10002660(a1, a2, (void *)(a4 + 64), (int *)a5, 2u)
    || !sub_10002660(a1, a2, (void *)(a4 + 66), (int *)a5, 2u)
    || !sub_10002660(a1, a2, (void *)(a4 + 68), (int *)a5, 1u) )
    goto LABEL_36;
  if ( *(_BYTE *)a4 == 34 )
    return sub_10002660(a1, a2, (void *)(a4 + 101), (int *)a5, 2u) != 0;
  if ( *(_BYTE *)a4 == 42
    && sub_100026B0(a1, a2, (void *)(a4 + 69), a5, 0x10u)
    && sub_100026B0(a1, a2, (void *)(a4 + 85), a5, 8u)
    && sub_10002660(a1, a2, (void *)(a4 + 93), (int *)a5, 4u)
    && sub_10002660(a1, a2, (void *)(a4 + 97), (int *)a5, 4u)
    && sub_10002660(a1, a2, (void *)(a4 + 101), (int *)a5, 2u) )
    result = 1;
  else
LABEL_36:
    result = 0;
  return result;
}

//----- (1000DEB0) --------------------------------------------------------
signed int __cdecl sub_1000DEB0(int a1, int a2, int a3)
{
  int v3; // ecx@1
  int v4; // edi@1
  char v5; // zf@2
  char v6; // zf@4
  int v7; // eax@9
  signed int result; // eax@24
  int v9; // eax@31
  signed int v10; // esi@35
  unsigned int v11; // [sp+Ch] [bp-12Ch]@1
  char v12; // [sp+13h] [bp-125h]@4
  int v13; // [sp+14h] [bp-124h]@2
  int v14; // [sp+18h] [bp-120h]@1
  unsigned __int8 v15; // [sp+1Ch] [bp-11Ch]@4
  char v16; // [sp+1Dh] [bp-11Bh]@4
  char v17; // [sp+1Eh] [bp-11Ah]@4
  __int16 v18; // [sp+1Fh] [bp-119h]@35
  char v19; // [sp+21h] [bp-117h]@4
  __int16 v20; // [sp+22h] [bp-116h]@5
  int v21; // [sp+24h] [bp-114h]@4
  int v22; // [sp+28h] [bp-110h]@4
  int v23; // [sp+2Ch] [bp-10Ch]@4
  int v24; // [sp+30h] [bp-108h]@4
  int v25; // [sp+34h] [bp-104h]@4
  int v26; // [sp+38h] [bp-100h]@4
  int v27; // [sp+3Ch] [bp-FCh]@4
  int v28; // [sp+40h] [bp-F8h]@4
  int v29; // [sp+44h] [bp-F4h]@4
  int v30; // [sp+48h] [bp-F0h]@4
  char v31; // [sp+4Ch] [bp-ECh]@4
  __int16 v32; // [sp+4Dh] [bp-EBh]@5
  char v33; // [sp+4Fh] [bp-E9h]@4
  char v34; // [sp+50h] [bp-E8h]@1
  unsigned int v35; // [sp+B4h] [bp-84h]@1
  int v36; // [sp+BCh] [bp-7Ch]@1
  int v37; // [sp+10Ch] [bp-2Ch]@1

  memcpy(&v34, (const void *)(a1 + 112), 0xE4u);
  v4 = v35;
  v14 = v36;
  v3 = 0;
  v11 = v35;
  if ( !v37 || (v5 = *(_DWORD *)(a1 + 80) == 0, v13 = 1, v5) )
    v13 = 0;
  v6 = v13 == 0;
  v12 = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a1 + 69) = 16;
  v15 = 24;
  v16 = -1;
  v17 = 0;
  v19 = 0;
  v21 = 22;
  v22 = 0;
  v23 = 131487;
  v25 = 0;
  v24 = 0;
  v26 = 0;
  v27 = 3;
  v28 = 1;
  v29 = 64;
  v30 = 2;
  v31 = 3;
  v33 = 0;
  if ( v6 )
  {
    v20 = v4 - 1;
    v32 = v4;
  }
  else
  {
    v20 = 2 * v4 - 2;
    v32 = 2 * v4 + 1;
  }
  if ( a2 )
  {
    if ( *(_DWORD *)a2 == 14 )
    {
      v7 = *(_DWORD *)(a2 + 12);
      if ( *(_DWORD *)(v7 + 540) == 3 )
      {
        if ( *(_DWORD *)(v7 + 1104) == 4 )
        {
          if ( *(_DWORD *)(v7 + 1668) != 5
            || *(_DWORD *)(v7 + 2232) != 5
            || *(_DWORD *)(v7 + 2796) != 5
            || *(_DWORD *)(v7 + 3360) != 5
            || *(_DWORD *)(v7 + 3924) != 5
            || *(_DWORD *)(v7 + 4488) != 5
            || *(_DWORD *)(v7 + 5052) != 5
            || *(_DWORD *)(v7 + 5616) != 5
            || *(_DWORD *)(v7 + 6180) != 5
            || *(_DWORD *)(v7 + 6744) != 5
            || *(_DWORD *)(v7 + 7308) != 3
            || *(_DWORD *)(v7 + 7872) != 12 )
          {
            v3 = 0;
          }
          else
          {
            v19 = **(_BYTE **)(v7 + 136);
            v20 = **(_WORD **)(v7 + 700);
            v21 = **(_DWORD **)(v7 + 1264);
            v22 = **(_DWORD **)(v7 + 1828);
            v23 = **(_DWORD **)(v7 + 2392);
            v25 = **(_DWORD **)(v7 + 2956);
            v24 = **(_DWORD **)(v7 + 3520);
            v26 = **(_DWORD **)(v7 + 4084);
            v27 = **(_DWORD **)(v7 + 4648);
            v28 = **(_DWORD **)(v7 + 5212);
            v29 = **(_DWORD **)(v7 + 5776);
            v30 = **(_DWORD **)(v7 + 6340);
            v31 = **(_BYTE **)(v7 + 6904);
            if ( !sub_100082E0(a1, v7 + 7332, (int)&v11, (int)&v14) )
            {
              *(_BYTE *)(a1 + 69) = v12;
              return -16;
            }
            v3 = 0;
            if ( (signed int)v11 <= 1 )
            {
              v14 = v36;
              v11 = v4;
            }
          }
        }
      }
    }
  }
  if ( v13 == v3 )
  {
    if ( v20 == -1 )
      v20 = v11 - 1;
    LOWORD(v9) = v11;
  }
  else
  {
    if ( v20 == -1 )
      v20 = 2 * v11 - 2;
    v9 = 2 * v11 + 1;
  }
  v32 = v9;
  v18 = (_WORD)v9 + 2 * v15 + 35;
  v10 = sub_100072C0(a1, a3, v18, -94);
  if ( v10 == 1 )
  {
    if ( !sub_1000D9F0(a1, a3, (int)&v15)
      || v13 && !sub_10002470(a1, a3, &v33, v10)
      || !sub_10003490(a1, a3, v14, v11, v13) )
      v10 = -17;
  }
  result = v10;
  *(_BYTE *)(a1 + 69) = v12;
  return result;
}

//----- (1000E220) --------------------------------------------------------
signed int __cdecl sub_1000E220(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@1
  int v5; // edi@1
  int v6; // esi@1
  int v7; // ST0C_4@1
  int v8; // ebx@4
  signed int v9; // edi@4
  char v10; // [sp+8h] [bp-68h]@5
  __int16 v11; // [sp+Eh] [bp-62h]@6

  v6 = a1;
  v5 = a2;
  v7 = a1;
  a1 = (((*(_DWORD *)(a1 + 92) != 4) - 1) & 0x4E) + 36;
  result = sub_1000DEB0(v7, a4, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(v6 + 116) )
      sub_10008150(v6, v5);
    v8 = a3;
    v9 = sub_10007BA0(v6, v5, a3, -94);
    if ( v9 == 1 )
    {
      if ( sub_1000DBB0(v6, v8, (int)&a1, (int)&v10, (int)&a1) )
      {
        result = v9;
        *(_WORD *)(v6 + 256) = v11;
        return result;
      }
      v9 = -12;
    }
    result = v9;
  }
  return result;
}

//----- (1000E2D0) --------------------------------------------------------
signed int __cdecl sub_1000E2D0(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@1
  int v5; // esi@1
  char v6; // al@1
  signed int v7; // ebp@2
  int v8; // ebp@4
  int v9; // edi@5
  char *v10; // eax@6
  const void *v11; // edx@6
  int v12; // edi@6
  char v13; // cl@7
  void *v14; // eax@15
  char v15; // zf@15
  char v17; // [sp+Fh] [bp-11h]@1
  unsigned __int8 v18; // [sp+10h] [bp-10h]@1
  __int16 v19; // [sp+11h] [bp-Fh]@10
  unsigned int v20; // [sp+14h] [bp-Ch]@1
  int v21; // [sp+18h] [bp-8h]@1
  void *Memory; // [sp+1Ch] [bp-4h]@1
  char v23; // [sp+24h] [bp+4h]@1

  v5 = a1;
  v6 = *(_BYTE *)(a1 + 69);
  v4 = 0;
  v17 = 2;
  v23 = v6;
  *(_BYTE *)(v5 + 69) = 16;
  v18 = 0;
  v20 = 0;
  v21 = 1024;
  Memory = sub_10008320(0x400u);
  if ( !Memory )
  {
    v7 = -17;
    goto LABEL_15;
  }
  *(_DWORD *)a4 = 0;
  if ( *(_DWORD *)(v5 + 132) > 0 )
  {
    v8 = v5 + 136;
    do
    {
      v9 = *(_DWORD *)v8;
      if ( !sub_100025E0(v5, (int)&v20, &v17, 1u) )
        goto LABEL_14;
      v11 = off_10017060[v9];
      v10 = off_10017060[v9];
      v12 = (int)(v10 + 1);
      do
        v13 = *v10++;
      while ( v13 );
      if ( !sub_100025E0(v5, (int)&v20, v11, (unsigned int)&v10[-v12 + 1]) )
        goto LABEL_14;
      ++v4;
      v8 += 4;
    }
    while ( v4 < *(_DWORD *)(v5 + 132) );
  }
  v19 = v20;
  v7 = sub_100072C0(v5, a3, (_WORD)v20 + 2 * v18 + 35, 114);
  if ( v7 == 1
    && (!sub_10002470(v5, a3, &v18, 1u) || !sub_10002470(v5, a3, &v19, 2u) || !sub_100025E0(v5, a3, Memory, v20)) )
LABEL_14:
    v7 = -17;
LABEL_15:
  v14 = Memory;
  v15 = Memory == 0;
  *(_BYTE *)(v5 + 69) = v23;
  if ( !v15 )
    free(v14);
  return v7;
}
// 10017060: using guessed type char *off_10017060[18];

//----- (1000E430) --------------------------------------------------------
signed int __cdecl sub_1000E430(int a1, int a2, int a3, int *a4)
{
  unsigned __int16 v4; // ax@15
  char v5; // zf@15
  int v6; // eax@18
  int v7; // eax@18
  int v8; // eax@22
  int v9; // esi@22
  signed int result; // eax@25
  int v11; // [sp+10h] [bp-Ch]@12
  int v12; // [sp+14h] [bp-8h]@14
  int v13; // [sp+18h] [bp-4h]@18

  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  *(_DWORD *)(a3 + 8) = 0;
  *(_DWORD *)(a3 + 12) = 0;
  *(_DWORD *)(a3 + 16) = 0;
  *(_DWORD *)(a3 + 20) = 0;
  *(_DWORD *)(a3 + 24) = 0;
  *(_DWORD *)(a3 + 28) = 0;
  *(_DWORD *)(a3 + 32) = 0;
  *(_BYTE *)(a3 + 36) = 0;
  if ( sub_10002660(a1, a2, (void *)a3, a4, 1u)
    && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 5), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 7), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 9), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 11), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 13), a4, 4u)
    && sub_10002660(a1, a2, (void *)(a3 + 17), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 19), a4, 2u)
    && sub_10002660(a1, a2, (void *)(a3 + 21), a4, 2u)
    && (v11 = a3 + 23, sub_10002660(a1, a2, (void *)(a3 + 23), a4, 2u))
    && sub_10002660(a1, a2, (void *)(a3 + 25), a4, 2u)
    && (v12 = a3 + 27, sub_10002660(a1, a2, (void *)(a3 + 27), a4, 2u)) )
  {
    v4 = *(_WORD *)v11;
    v5 = *(_WORD *)v11 == 0;
    *(_DWORD *)(a3 + 29) = 0;
    *(_DWORD *)(a3 + 33) = 0;
    if ( !v5 )
      *(_DWORD *)(a3 + 29) = *a4 + *(_DWORD *)(a2 + 8);
    if ( *(_WORD *)v12 > v4 )
    {
      v6 = *(_DWORD *)(a3 + 29) + v4;
      *(_DWORD *)(a3 + 33) = v6;
      v7 = sub_10008430(v6);
      *a4 += v7 + *(_WORD *)v11;
      v13 = v7;
      if ( sub_100025E0(a1, a1 + 2368, *(const void **)(a3 + 33), v7) )
      {
        if ( sub_100085A0(a1, a1 + 2344, a1 + 2368) )
        {
          if ( v13 + *(_WORD *)v11 < *(_WORD *)v12 )
          {
            if ( *a4 < *(_DWORD *)a2 )
            {
              v8 = sub_10008430(*a4 + *(_DWORD *)(a2 + 8));
              v9 = v8;
              if ( v8 > 0 )
              {
                if ( sub_100025E0(a1, a1 + 2512, (const void *)(*a4 + *(_DWORD *)(a2 + 8)), v8) )
                {
                  *a4 += v9;
                  sub_100085A0(a1, a1 + 2488, a1 + 2512);
                }
              }
            }
          }
        }
      }
    }
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (1000E6E0) --------------------------------------------------------
bool __cdecl sub_1000E6E0(int a1, int a2, int a3, int *a4)
{
  *(_DWORD *)a3 = 0;
  *(_WORD *)(a3 + 4) = 0;
  return sub_10002660(a1, a2, (void *)a3, a4, 1u)
      && sub_10002660(a1, a2, (void *)(a3 + 1), a4, 2u)
      && sub_10002660(a1, a2, (void *)(a3 + 3), a4, 2u);
}

//----- (1000E750) --------------------------------------------------------
signed int __cdecl sub_1000E750(int a1, int a2, int a3, int a4)
{
  unsigned __int8 v4; // cl@15
  char v5; // zf@15
  int v6; // eax@17
  unsigned __int8 v7; // cf@17
  unsigned __int8 v8; // zf@17
  int v9; // eax@18
  int v10; // eax@22
  int v11; // esi@22
  int v13; // [sp+10h] [bp-Ch]@14
  int v14; // [sp+14h] [bp-8h]@13
  int v15; // [sp+18h] [bp-4h]@18

  memset((void *)a3, 0, 0x40u);
  *(_BYTE *)(a3 + 64) = 0;
  if ( !sub_10002660(a1, a2, (void *)a3, (int *)a4, 1u)
    || !sub_10002660(a1, a2, (void *)(a3 + 1), (int *)a4, 2u)
    || !sub_10002660(a1, a2, (void *)(a3 + 3), (int *)a4, 1u)
    || !sub_10002660(a1, a2, (void *)(a3 + 4), (int *)a4, 2u)
    || !sub_10002660(a1, a2, (void *)(a3 + 6), (int *)a4, 2u)
    || !sub_10002660(a1, a2, (void *)(a3 + 8), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 12), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 16), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 20), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 24), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 28), (int *)a4, 4u)
    || !sub_10002660(a1, a2, (void *)(a3 + 32), (int *)a4, 2u)
    || (v14 = a3 + 34, !sub_10002660(a1, a2, (void *)(a3 + 34), (int *)a4, 1u))
    || (v13 = a3 + 35, !sub_10002660(a1, a2, (void *)(a3 + 35), (int *)a4, 2u)) )
    return 0;
  v4 = *(_BYTE *)v14;
  v5 = *(_BYTE *)v14 == 0;
  *(_DWORD *)(a3 + 37) = 0;
  *(_DWORD *)(a3 + 41) = 0;
  *(_DWORD *)(a3 + 61) = 0;
  if ( v5 )
  {
    if ( *(_WORD *)v13 > 0u )
    {
      if ( !sub_100026B0(a1, a2, (void *)(a3 + 45), a4, 0x10u) )
        return 0;
      if ( *(_WORD *)v13 > 0x10u )
        *(_DWORD *)(a3 + 61) = *(_DWORD *)a4 + *(_DWORD *)(a2 + 8);
    }
    return 1;
  }
  if ( *(_DWORD *)a4 + v4 <= *(_DWORD *)a2 )
  {
    v6 = *(_DWORD *)(a2 + 8) + *(_DWORD *)a4;
    v7 = *(_WORD *)v13 < (unsigned __int16)v4;
    v8 = *(_WORD *)v13 == v4;
    *(_DWORD *)(a3 + 37) = v6;
    if ( !(v7 | v8) )
    {
      v9 = v4 + v6;
      *(_DWORD *)(a3 + 41) = v9;
      v15 = sub_10008430(v9);
      *(_DWORD *)a4 += v15 + *(_BYTE *)v14;
      sub_100066F0(a1 + 2368);
      if ( sub_100025E0(a1, a1 + 2368, *(const void **)(a3 + 41), v15) )
      {
        if ( sub_100085A0(a1, a1 + 2344, a1 + 2368) )
        {
          if ( v15 + *(_BYTE *)v14 < *(_WORD *)v13 )
          {
            if ( *(_DWORD *)a4 < *(_DWORD *)a2 )
            {
              v10 = sub_10008430(*(_DWORD *)a4 + *(_DWORD *)(a2 + 8));
              v11 = v10;
              if ( v10 > 0 )
              {
                if ( sub_100025E0(a1, a1 + 2512, (const void *)(*(_DWORD *)a4 + *(_DWORD *)(a2 + 8)), v10) )
                {
                  *(_DWORD *)a4 += v11;
                  sub_100085A0(a1, a1 + 2488, a1 + 2512);
                  return 1;
                }
              }
            }
          }
        }
      }
    }
    return 1;
  }
  return 0;
}

//----- (1000EA50) --------------------------------------------------------
signed int __usercall sub_1000EA50<eax>(int a1<ebp>, int a2, int a3, int a4, int a5, int a6)
{
  signed int result; // eax@1
  bool v7; // eax@1
  signed int v8; // edi@2
  int v9; // eax@7
  int v10; // edx@7
  int v11; // ecx@7
  __int16 v12; // dx@7
  int v13; // edx@7
  int v14; // ecx@7
  int v15; // edx@7
  int v16; // ecx@7
  int v17; // edx@7
  char v18; // zf@7
  int v19; // ecx@8
  char v20; // zf@21
  __int16 v21; // cx@21
  char v22; // al@21
  __int16 v23; // dx@21
  __int16 v24; // ax@21
  int v25; // edx@21
  int v26; // eax@21
  int v27; // edx@21
  int v28; // eax@22
  char v29; // [sp+Bh] [bp-F5h]@2
  int v30; // [sp+Ch] [bp-F4h]@1
  int v31; // [sp+10h] [bp-F0h]@1
  char v32; // [sp+14h] [bp-ECh]@30
  unsigned __int16 v33; // [sp+15h] [bp-EBh]@31
  char v34; // [sp+1Ch] [bp-E4h]@20
  __int16 v35; // [sp+1Dh] [bp-E3h]@21
  char v36; // [sp+1Fh] [bp-E1h]@21
  unsigned __int16 v37; // [sp+21h] [bp-DFh]@21
  __int16 v38; // [sp+23h] [bp-DDh]@21
  __int16 v39; // [sp+25h] [bp-DBh]@21
  int v40; // [sp+29h] [bp-D7h]@21
  unsigned __int16 v41; // [sp+2Dh] [bp-D3h]@21
  unsigned __int16 v42; // [sp+2Fh] [bp-D1h]@21
  unsigned __int16 v43; // [sp+31h] [bp-CFh]@21
  __int16 v44; // [sp+33h] [bp-CDh]@21
  int v45; // [sp+39h] [bp-C7h]@22
  char v46; // [sp+44h] [bp-BCh]@6
  __int16 v47; // [sp+45h] [bp-BBh]@7
  char v48; // [sp+47h] [bp-B9h]@7
  __int16 v49; // [sp+48h] [bp-B8h]@7
  __int16 v50; // [sp+4Ah] [bp-B6h]@7
  int v51; // [sp+4Ch] [bp-B4h]@7
  int v52; // [sp+50h] [bp-B0h]@7
  int v53; // [sp+54h] [bp-ACh]@7
  int v54; // [sp+58h] [bp-A8h]@7
  int v55; // [sp+5Ch] [bp-A4h]@7
  int v56; // [sp+60h] [bp-A0h]@7
  unsigned __int16 v57; // [sp+64h] [bp-9Ch]@7
  unsigned __int8 v58; // [sp+66h] [bp-9Ah]@7
  unsigned __int16 v59; // [sp+67h] [bp-99h]@18
  int v60; // [sp+69h] [bp-97h]@8
  int v61; // [sp+6Dh] [bp-93h]@16
  char v62; // [sp+88h] [bp-78h]@18

  v7 = *(_DWORD *)(a2 + 92) != 4;
  v31 = 0;
  v30 = ((v7 - 1) & 0x4E) + 36;
  result = sub_1000E2D0(a2, a5, a3, (int)&v31);
  if ( result == 1 )
  {
    v29 = 0;
    v8 = sub_10007BA0(a2, a3, a4, 114);
    if ( v8 == 1 )
    {
      if ( !sub_10002660(a2, a4, &v29, &v30, 1u) )
        return -12;
      v30 = (((*(_DWORD *)(a2 + 92) != 4) - 1) & 0x4E) + 36;
      if ( v29 == 17 )
      {
        if ( !sub_1000E750(a2, a4, (int)&v46, (int)&v30) )
          return -12;
        v11 = v51;
        LOWORD(v9) = v47;
        *(_BYTE *)(a2 + 276) = v48;
        v12 = v49;
        *(_DWORD *)(a2 + 268) = v11;
        LOWORD(v11) = v50;
        *(_WORD *)(a2 + 262) = v12;
        v13 = v53;
        *(_WORD *)(a2 + 264) = v11;
        v14 = v56;
        *(_DWORD *)(a2 + 284) = v13;
        v15 = v55;
        *(_DWORD *)(a2 + 292) = v14;
        v16 = v57;
        *(_DWORD *)(a2 + 288) = v15;
        v17 = v52;
        *(_DWORD *)(a2 + 296) = v16;
        v18 = v58 == 8;
        *(_DWORD *)(a2 + 272) = v17;
        v10 = v54;
        *(_WORD *)(a2 + 258) = v9;
        *(_DWORD *)(a2 + 280) = v10;
        if ( v18 )
        {
          v19 = v60;
          *(_DWORD *)(a2 + 2824) = *(_DWORD *)v60;
          *(_DWORD *)(a2 + 2828) = *(_DWORD *)(v19 + 4);
        }
        if ( v31 )
        {
          *(_WORD *)(a2 + 260) = -1;
        }
        else
        {
          v9 = (unsigned __int16)v9;
          if ( (signed int)(unsigned __int16)v9 > *(_DWORD *)(a2 + 132) )
            return -15;
          *(_WORD *)(a2 + 260) = *(_WORD *)(a2 + 4 * v9 + 136);
        }
        if ( a6 )
        {
          nullsub_1(v10, a1);
          if ( v60 && v61 && v54 & 4 )
          {
            sub_100083C0(v61, (int)&v62, v59 - v58);
            return v8;
          }
          goto LABEL_34;
        }
        return 1;
      }
      if ( v29 == 13 )
      {
        if ( !sub_1000E430(a2, a4, (int)&v34, &v30) )
          return -12;
        v20 = v44 == 8;
        v22 = v36;
        v21 = v35;
        *(_DWORD *)(a2 + 268) = v37;
        v23 = v39;
        *(_BYTE *)(a2 + 276) = v22;
        v24 = v38;
        *(_WORD *)(a2 + 264) = v23;
        v25 = v42;
        *(_WORD *)(a2 + 262) = v24;
        *(_DWORD *)(a2 + 284) = v40;
        v26 = v41;
        *(_DWORD *)(a2 + 292) = v25;
        v27 = v43;
        *(_WORD *)(a2 + 258) = v21;
        *(_DWORD *)(a2 + 288) = v26;
        *(_DWORD *)(a2 + 296) = v27;
        if ( v20 )
        {
          v28 = v45;
          *(_DWORD *)(a2 + 2824) = *(_DWORD *)v45;
          *(_DWORD *)(a2 + 2828) = *(_DWORD *)(v28 + 4);
        }
        if ( v31 )
        {
          *(_WORD *)(a2 + 260) = -1;
        }
        else
        {
          if ( (signed int)(unsigned __int16)v21 > *(_DWORD *)(a2 + 132) )
            return -12;
          *(_WORD *)(a2 + 260) = *(_WORD *)(a2 + 4 * (unsigned __int16)v21 + 136);
        }
      }
      else
      {
        if ( v29 != 1 )
        {
          v8 = -12;
          goto LABEL_34;
        }
        if ( !sub_1000E6E0(a2, a4, (int)&v32, &v30) || (signed int)v33 > *(_DWORD *)(a2 + 132) )
          return -12;
        *(_WORD *)(a2 + 258) = v33;
        *(_WORD *)(a2 + 260) = 0;
      }
      if ( !a6 )
        return 1;
    }
LABEL_34:
    result = v8;
  }
  return result;
}
// 1000EA50: could not find valid save-restore pair for ebp

//----- (1000EDB0) --------------------------------------------------------
signed int __cdecl sub_1000EDB0(int a1, int a2, int a3)
{
  char v3; // bl@1
  signed int v4; // ebp@1
  signed int result; // eax@7
  char v6; // [sp+10h] [bp-8h]@1
  char v7; // [sp+11h] [bp-7h]@1
  char v8; // [sp+12h] [bp-6h]@1
  __int16 v9; // [sp+13h] [bp-5h]@1
  __int16 v10; // [sp+15h] [bp-3h]@1

  v3 = *(_BYTE *)(a1 + 69);
  *(_BYTE *)(a1 + 69) = 16;
  v6 = 2;
  v7 = -1;
  v8 = 0;
  v10 = 0;
  v9 = 39;
  v4 = sub_100072C0(a1, a3, 39, 116);
  if ( v4 != 1
    || sub_10002470(a1, a3, &v6, 1u)
    && sub_10002470(a1, a3, &v7, v4)
    && sub_10002470(a1, a3, &v8, v4)
    && sub_10002470(a1, a3, &v9, 2u)
    && sub_10002470(a1, a3, &v10, 2u) )
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = v4;
  }
  else
  {
    *(_BYTE *)(a1 + 69) = v3;
    result = -17;
  }
  return result;
}

//----- (1000EE80) --------------------------------------------------------
signed int __cdecl sub_1000EE80(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@1

  result = sub_1000EDB0(a1, a4, a2);
  if ( result == 1 )
  {
    if ( *(_DWORD *)(a1 + 116) )
      sub_10008150(a1, a2);
    result = sub_10007BA0(a1, a2, a3, 116);
  }
  return result;
}

//----- (1000EED0) --------------------------------------------------------
int __cdecl sub_1000EED0(int a1, int a2, int a3, int a4)
{
  unsigned int v4; // esi@1
  int v5; // eax@1
  int result; // eax@2
  int v7; // ecx@2
  int v8; // edx@2
  int v9; // ecx@2
  int v10; // edx@2
  int v11; // ecx@4
  int v12; // ecx@4
  int v13; // eax@4
  int v14; // ecx@4
  signed int v15; // eax@7
  int v16; // eax@8
  unsigned int v17; // esi@8
  int v18; // edx@8
  signed int v19; // eax@10
  signed int v20; // eax@11
  int v21; // esi@11
  int v22; // ecx@11
  int v23; // eax@11
  int v24; // ecx@11
  char v25; // dl@16
  char v26; // al@16
  char v27; // cl@16
  char v28; // dl@16
  char v29; // cl@16
  char v30; // al@16
  char v31; // dl@16
  int v32; // edx@16
  int v33; // eax@16
  int v34; // ecx@16
  int v35; // [sp+Ch] [bp-4B4h]@1
  int v36; // [sp+10h] [bp-4B0h]@1
  int v37; // [sp+14h] [bp-4ACh]@1
  int v38; // [sp+18h] [bp-4A8h]@1
  int v39; // [sp+1Ch] [bp-4A4h]@1
  int v40; // [sp+20h] [bp-4A0h]@1
  int v41; // [sp+24h] [bp-49Ch]@4
  int v42; // [sp+28h] [bp-498h]@4
  int v43; // [sp+2Ch] [bp-494h]@4
  int v44; // [sp+30h] [bp-490h]@4
  int v45; // [sp+34h] [bp-48Ch]@4
  char v46; // [sp+38h] [bp-488h]@4
  int v47; // [sp+3Ch] [bp-484h]@2
  int v48; // [sp+40h] [bp-480h]@2
  int v49; // [sp+44h] [bp-47Ch]@2
  int v50; // [sp+48h] [bp-478h]@2
  int v51; // [sp+4Ch] [bp-474h]@2
  char v52; // [sp+50h] [bp-470h]@2
  int v53; // [sp+54h] [bp-46Ch]@8
  int v54; // [sp+58h] [bp-468h]@1
  char v55; // [sp+5Ch] [bp-464h]@4
  char v56; // [sp+6Ch] [bp-454h]@16
  char v57; // [sp+148h] [bp-378h]@4
  char v58; // [sp+1A0h] [bp-320h]@7
  char v59[399]; // [sp+1A1h] [bp-31Fh]@7
  char v60; // [sp+330h] [bp-190h]@10
  char v61[399]; // [sp+331h] [bp-18Fh]@10

  v35 = 257;
  v4 = 0;
  v36 = 0;
  v37 = 0;
  v38 = 0;
  v54 = 0;
  v39 = 0;
  v40 = 0;
  sub_10003520(a1 + 2608, a1 + 2620);
  v5 = *(_DWORD *)(a2 + 20);
  if ( !(v5 & 0x80000) )
  {
    v47 = 0;
    v48 = 0;
    v49 = 0;
    v50 = 0;
    v51 = 0;
    v7 = *(_DWORD *)(a1 + 2840);
    v52 = 0;
    v8 = *(_DWORD *)(a1 + 2844);
    v47 = v7;
    v9 = *(_DWORD *)(a1 + 2848);
    v48 = v8;
    v10 = *(_DWORD *)(a1 + 2852);
    v49 = v9;
    v50 = v10;
    sub_1000B5B0((int)&v47, a2 + 24, a1 + 2888);
    sub_1000B5B0(a1 + 2856, a2 + 24, a1 + 2912);
    result = a3;
    *(_DWORD *)a3 = 24;
    *(_DWORD *)a4 = 24;
    return result;
  }
  if ( !*(_DWORD *)(a1 + 2272) )
  {
    *(_DWORD *)(a1 + 2888) = 0;
    *(_DWORD *)(a1 + 2892) = 0;
    *(_DWORD *)(a1 + 2896) = 0;
    *(_DWORD *)(a1 + 2900) = 0;
    *(_DWORD *)(a1 + 2904) = 0;
    *(_DWORD *)(a1 + 2908) = 0;
    v11 = *(_DWORD *)(a1 + 2836);
    *(_DWORD *)(a1 + 2888) = *(_DWORD *)(a1 + 2832);
    *(_DWORD *)(a1 + 2892) = v11;
    v12 = *(_DWORD *)(a1 + 2860);
    v41 = *(_DWORD *)(a1 + 2856);
    v13 = *(_DWORD *)(a1 + 2864);
    v42 = v12;
    v14 = *(_DWORD *)(a1 + 2868);
    v43 = v13;
    v45 = 0;
    v44 = v14;
    v46 = 0;
    sub_10013990((int)&v57);
    sub_100145B0((int)&v57, (const void *)(a2 + 24), 8u);
    sub_100145B0((int)&v57, (const void *)(a1 + 2832), 8u);
    sub_10014670((int)&v57, (int)&v55);
    sub_10012C50(a1 + 2912, (int)&v55, (int)&v41);
    sub_10012C50(a1 + 2920, (int)&v55, (int)((char *)&v42 + 3));
    result = sub_10012C50(a1 + 2928, (int)&v55, (int)((char *)&v44 + 2));
    *(_DWORD *)a3 = 24;
    *(_DWORD *)a4 = 24;
    return result;
  }
  if ( *(_DWORD *)(a1 + 2584) > 0 )
  {
    do
    {
      if ( v4 >= 0xC8 )
        break;
      *(&v58 + 2 * v4) = toupper(*(_BYTE *)(*(_DWORD *)(a1 + 2592) + v4));
      v15 = *(_DWORD *)(a1 + 2584);
      v59[2 * v4++] = 0;
    }
    while ( (signed int)v4 < v15 );
  }
  v16 = *(_DWORD *)(a1 + 2356);
  v18 = 2 * v4;
  v17 = 0;
  v53 = v18;
  if ( v16 > 0 )
  {
    do
    {
      if ( v17 >= 0xC8 )
        break;
      *(&v60 + 2 * v17) = toupper(*(_BYTE *)(*(_DWORD *)(a1 + 2364) + v17));
      v19 = *(_DWORD *)(a1 + 2356);
      v61[2 * v17++] = 0;
    }
    while ( (signed int)v17 < v19 );
  }
  v22 = *(_DWORD *)(a1 + 2860);
  v41 = *(_DWORD *)(a1 + 2856);
  v23 = *(_DWORD *)(a1 + 2864);
  v42 = v22;
  v24 = *(_DWORD *)(a1 + 2868);
  v45 = 0;
  v43 = v23;
  v20 = *(_DWORD *)(a1 + 2704);
  v46 = 0;
  v44 = v24;
  v21 = 2 * v17;
  if ( *(_DWORD *)(a1 + 2708) | v20 )
  {
    v40 = *(_DWORD *)(a1 + 2708);
    goto LABEL_15;
  }
  v20 = sub_10008360((int)&v39);
  if ( !v20 )
  {
    v40 = 0;
LABEL_15:
    v39 = v20;
  }
  v37 = v39;
  v38 = v40;
  sub_10014930((int)&v56, &v41, 0x10u);
  sub_10014A10(&v56, &v58, v53);
  sub_10014A10(&v56, &v60, v21);
  sub_10014A20((int)&v56, a1 + 3356);
  sub_10014930((int)&v56, (const void *)(a1 + 3356), 0x10u);
  sub_10014A10(&v56, a2 + 24, 8);
  sub_10014A10(&v56, a1 + 2832, 8);
  sub_10014A20((int)&v56, a1 + 2888);
  v25 = *(_BYTE *)(a1 + 2833);
  v26 = *(_BYTE *)(a1 + 2834);
  *(_BYTE *)(a1 + 2904) = *(_BYTE *)(a1 + 2832);
  v27 = *(_BYTE *)(a1 + 2835);
  *(_BYTE *)(a1 + 2905) = v25;
  v28 = *(_BYTE *)(a1 + 2836);
  *(_BYTE *)(a1 + 2907) = v27;
  v29 = *(_BYTE *)(a1 + 2838);
  *(_BYTE *)(a1 + 2906) = v26;
  v30 = *(_BYTE *)(a1 + 2837);
  *(_BYTE *)(a1 + 2908) = v28;
  v31 = *(_BYTE *)(a1 + 2839);
  *(_BYTE *)(a1 + 2910) = v29;
  *(_BYTE *)(a1 + 2909) = v30;
  *(_BYTE *)(a1 + 2911) = v31;
  *(_DWORD *)a3 = 24;
  sub_10014930((int)&v56, (const void *)(a1 + 3356), 0x10u);
  sub_10014A10(&v56, a2 + 24, 8);
  sub_10014A10(&v56, &v35, 16);
  sub_10014A10(&v56, a1 + 2832, 8);
  sub_10014A10(&v56, &v54, 4);
  sub_10014A10(&v56, *(_DWORD *)(a2 + 60), *(_WORD *)(a2 + 42));
  sub_10014A20((int)&v56, a1 + 2912);
  v32 = v36;
  v33 = v37;
  *(_DWORD *)(a1 + 2928) = v35;
  v34 = v38;
  *(_DWORD *)(a1 + 2932) = v32;
  *(_DWORD *)(a1 + 2936) = v33;
  *(_DWORD *)(a1 + 2940) = v34;
  LOBYTE(v32) = *(_BYTE *)(a1 + 2832);
  LOBYTE(v34) = *(_BYTE *)(a1 + 2834);
  *(_BYTE *)(a1 + 2945) = *(_BYTE *)(a1 + 2833);
  LOBYTE(v33) = *(_BYTE *)(a1 + 2836);
  *(_BYTE *)(a1 + 2944) = v32;
  LOBYTE(v32) = *(_BYTE *)(a1 + 2835);
  *(_BYTE *)(a1 + 2948) = v33;
  LOBYTE(v33) = *(_BYTE *)(a1 + 2839);
  *(_BYTE *)(a1 + 2946) = v34;
  LOBYTE(v34) = *(_BYTE *)(a1 + 2837);
  *(_BYTE *)(a1 + 2947) = v32;
  LOBYTE(v32) = *(_BYTE *)(a1 + 2838);
  *(_BYTE *)(a1 + 2951) = v33;
  *(_BYTE *)(a1 + 2949) = v34;
  *(_BYTE *)(a1 + 2950) = v32;
  *(_DWORD *)(a1 + 2952) = 0;
  if ( *(_WORD *)(a2 + 42) > 0x190u )
    *(_WORD *)(a2 + 42) = 400;
  memcpy((void *)(a1 + 2956), *(const void **)(a2 + 60), *(_WORD *)(a2 + 42));
  result = *(_WORD *)(a2 + 42) + 44;
  *(_DWORD *)a4 = result;
  return result;
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);
// 1000EED0: using guessed type char var_31F[399];
// 1000EED0: using guessed type char var_18F[399];

//----- (1000F470) --------------------------------------------------------
int __cdecl sub_1000F470(int a1, int a2)
{
  char v2; // zf@3
  signed int v3; // ecx@3
  int *v4; // edi@3
  int v5; // esi@3
  char v6; // dl@8
  char v7; // al@8
  char v8; // cl@8
  char v9; // dl@8
  char v10; // cl@8
  char v11; // al@8
  char v12; // dl@8
  char v13; // zf@11
  signed int v14; // ecx@11
  int *v15; // edi@11
  int v16; // esi@11
  int v18; // [sp+Ch] [bp-218h]@1
  int v19; // [sp+10h] [bp-214h]@1
  int v20; // [sp+14h] [bp-210h]@1
  int v21; // [sp+18h] [bp-20Ch]@1
  char v22; // [sp+1Ch] [bp-208h]@8
  char v23; // [sp+1Dh] [bp-207h]@8
  char v24; // [sp+1Eh] [bp-206h]@8
  char v25; // [sp+1Fh] [bp-205h]@8
  char v26; // [sp+20h] [bp-204h]@8
  char v27; // [sp+21h] [bp-203h]@8
  char v28; // [sp+22h] [bp-202h]@8
  char v29; // [sp+23h] [bp-201h]@8
  int v30; // [sp+24h] [bp-200h]@8
  int v31; // [sp+28h] [bp-1FCh]@8
  char v32; // [sp+34h] [bp-1F0h]@17
  char v33; // [sp+44h] [bp-1E0h]@17
  char v34; // [sp+120h] [bp-104h]@19

  v18 = 0;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  if ( a1 & 0x80000 )
  {
    if ( *(_DWORD *)(a2 + 2272) )
    {
      sub_10014930((int)&v33, (const void *)(a2 + 3356), 0x10u);
      sub_10014A10(&v33, a2 + 2912, 16);
      sub_10014A20((int)&v33, (int)&v18);
      goto LABEL_19;
    }
    if ( *(_DWORD *)(a2 + 2608) )
      goto LABEL_22;
    v14 = 4;
    v15 = &v18;
    v16 = a2 + 2856;
    v13 = 1;
    do
    {
      if ( !v14 )
        break;
      v13 = *(_DWORD *)v16 == *v15;
      v16 += 4;
      ++v15;
      --v14;
    }
    while ( v13 );
    if ( !v13 )
    {
LABEL_22:
      sub_10013770((int)&v32, a2 + 2856, 16);
      sub_10014930((int)&v33, &v32, 0x10u);
      sub_10014A10(&v33, a2 + 2824, 8);
      sub_10014A10(&v33, a2 + 2832, 8);
      sub_10014A20((int)&v33, (int)&v18);
      goto LABEL_19;
    }
    goto LABEL_16;
  }
  if ( *(_DWORD *)(a2 + 2608) <= 0 )
  {
    v3 = 4;
    v4 = &v18;
    v5 = a2 + 2840;
    v2 = 1;
    do
    {
      if ( !v3 )
        break;
      v2 = *(_DWORD *)v5 == *v4;
      v5 += 4;
      ++v4;
      --v3;
    }
    while ( v2 );
    if ( v2 )
    {
LABEL_16:
      v18 = dword_100170F8;
      v19 = dword_100170FC;
      v20 = dword_10017100;
      v21 = dword_10017104;
      goto LABEL_19;
    }
  }
  v6 = *(_BYTE *)(a2 + 2841);
  v7 = *(_BYTE *)(a2 + 2842);
  v22 = *(_BYTE *)(a2 + 2840);
  v8 = *(_BYTE *)(a2 + 2843);
  v23 = v6;
  v9 = *(_BYTE *)(a2 + 2844);
  v25 = v8;
  v10 = *(_BYTE *)(a2 + 2846);
  v24 = v7;
  v11 = *(_BYTE *)(a2 + 2845);
  v26 = v9;
  v12 = *(_BYTE *)(a2 + 2847);
  v28 = v10;
  v27 = v11;
  v29 = v12;
  v30 = -1111638595;
  v31 = -1111638595;
  sub_10012C50((int)&v18, a2 + 2888, (int)&v22);
  sub_10012C50((int)&v20, a2 + 2888, (int)&v29);
LABEL_19:
  sub_10014770((int)&v18, 16, (int)&v34);
  *(_DWORD *)(a2 + 2728) = *(_DWORD *)(a2 + 2712);
  *(_DWORD *)(a2 + 2732) = *(_DWORD *)(a2 + 2716);
  *(_DWORD *)(a2 + 2736) = *(_DWORD *)(a2 + 2720);
  *(_DWORD *)(a2 + 2740) = *(_DWORD *)(a2 + 2724);
  return sub_100148A0((int)&v34, a2 + 2728, 16);
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);
// 100170F8: using guessed type int dword_100170F8;
// 100170FC: using guessed type int dword_100170FC;
// 10017100: using guessed type int dword_10017100;
// 10017104: using guessed type int dword_10017104;

//----- (1000F6A0) --------------------------------------------------------
signed int __cdecl sub_1000F6A0(int a1, int a2)
{
  int v2; // ebp@1
  unsigned __int8 v3; // zf@1
  unsigned __int8 v4; // sf@1
  unsigned int v5; // ecx@7
  unsigned int v6; // ST10_4@7
  int v7; // ecx@7
  unsigned int v8; // ecx@10
  unsigned int v9; // ST10_4@10
  int v10; // ecx@10
  unsigned int v11; // ecx@13
  unsigned int v12; // ST10_4@16
  int v13; // edx@16
  unsigned int v14; // eax@19
  signed int result; // eax@23
  int v16; // eax@25
  unsigned __int8 v17; // sf@25
  unsigned __int8 v18; // of@25
  int v19; // [sp-8h] [bp-28h]@9
  int v20; // [sp-4h] [bp-24h]@9
  int v21; // [sp+10h] [bp-10h]@1
  int v22; // [sp+14h] [bp-Ch]@1
  int v23; // [sp+18h] [bp-8h]@1
  int v24; // [sp+1Ch] [bp-4h]@1

  v2 = 0;
  v3 = *(_DWORD *)a2 == 0;
  v4 = *(_DWORD *)a2 < 0;
  v21 = 0;
  v23 = 0;
  v24 = 0;
  v22 = 0;
  if ( v4 | v3 )
  {
LABEL_26:
    result = 1;
  }
  else
  {
    while ( sub_10002660(a1, a2, &v24, &v21, 2u) && sub_10002660(a1, a2, &v22, &v21, 2u) )
    {
      switch ( (unsigned __int16)v24 )
      {
        case 1u:
          v5 = (unsigned __int16)v22;
          *(_DWORD *)(a1 + 2512) = v2;
          v6 = v5;
          v7 = v21;
          *(_DWORD *)(a1 + 2488) = 0;
          if ( !sub_100025E0(a1, a1 + 2512, (const void *)(v7 + *(_DWORD *)(a2 + 8)), v6)
            || !sub_100025E0(a1, a1 + 2512, &v23, 2u) )
            goto LABEL_23;
          v20 = a1 + 2512;
          v19 = a1 + 2488;
          goto LABEL_22;
        case 2u:
          v8 = (unsigned __int16)v22;
          *(_DWORD *)(a1 + 2368) = v2;
          v9 = v8;
          v10 = v21;
          *(_DWORD *)(a1 + 2344) = 0;
          if ( !sub_100025E0(a1, a1 + 2368, (const void *)(v10 + *(_DWORD *)(a2 + 8)), v9)
            || !sub_100025E0(a1, a1 + 2368, &v23, 2u) )
            goto LABEL_23;
          v20 = a1 + 2368;
          v19 = a1 + 2344;
          goto LABEL_22;
        case 3u:
          v11 = (unsigned __int16)v22;
          *(_DWORD *)(a1 + 2560) = v2;
          if ( !sub_100025E0(a1, a1 + 2560, (const void *)(v21 + *(_DWORD *)(a2 + 8)), v11)
            || !sub_100025E0(a1, a1 + 2560, &v23, 2u) )
            goto LABEL_23;
          v20 = a1 + 2560;
          v19 = a1 + 2536;
          goto LABEL_22;
        case 4u:
          v12 = (unsigned __int16)v22;
          v13 = v21;
          *(_DWORD *)(a1 + 2416) = v2;
          if ( !sub_100025E0(a1, a1 + 2416, (const void *)(v13 + *(_DWORD *)(a2 + 8)), v12)
            || !sub_100025E0(a1, a1 + 2416, &v23, 2u) )
            goto LABEL_23;
          v20 = a1 + 2416;
          v19 = a1 + 2392;
          goto LABEL_22;
        case 5u:
          v14 = (unsigned __int16)v22;
          *(_DWORD *)(a1 + 2464) = v2;
          if ( !sub_100025E0(a1, a1 + 2464, (const void *)(v21 + *(_DWORD *)(a2 + 8)), v14)
            || !sub_100025E0(a1, a1 + 2464, &v23, 2u) )
            goto LABEL_23;
          v20 = a1 + 2464;
          v19 = a1 + 2440;
LABEL_22:
          if ( !sub_100085A0(a1, v19, v20) )
            goto LABEL_23;
          break;
        case 6u:
          *(_DWORD *)(a1 + 2284) = 1;
          break;
        default:
          break;
      }
      v16 = (unsigned __int16)v22 + v21;
      v18 = __SETO__(v16, *(_DWORD *)a2);
      v17 = v16 - *(_DWORD *)a2 < 0;
      v21 += (unsigned __int16)v22;
      if ( !(v17 ^ v18) )
        goto LABEL_26;
      v2 = 0;
    }
LABEL_23:
    result = 0;
  }
  return result;
}

//----- (1000F910) --------------------------------------------------------
signed int __cdecl sub_1000F910(int a1, int a2, int a3, int a4)
{
  int v4; // ecx@10
  int v5; // edx@11
  int v6; // eax@11
  int v7; // eax@17
  int v8; // ebp@18
  unsigned int v9; // ST14_4@18
  int v11; // [sp+10h] [bp-10h]@1
  int v12; // [sp+14h] [bp-Ch]@1
  int v13; // [sp+18h] [bp-8h]@1
  int v14; // [sp+1Ch] [bp-4h]@1

  v11 = 0;
  *(_DWORD *)(a4 + 60) = 0;
  *(_DWORD *)(a4 + 40) = 0;
  *(_WORD *)(a4 + 42) = 0;
  *(_BYTE *)(a4 + 48) = 0;
  *(_BYTE *)(a4 + 49) = 0;
  *(_WORD *)(a4 + 50) = 0;
  *(_BYTE *)(a4 + 55) = 0;
  *(_BYTE *)(a4 + 52) = 0;
  *(_BYTE *)(a4 + 53) = 0;
  *(_BYTE *)(a4 + 54) = 0;
  v14 = a2;
  v12 = a3;
  v13 = a3;
  if ( sub_100026B0(a1, (int)&v12, (void *)a4, (int)&v11, 8u) )
  {
    if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 8), &v11, 4u) )
    {
      if ( *(_DWORD *)(a4 + 8) == 2 )
      {
        if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 12), &v11, 2u) )
        {
          if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 14), &v11, 2u) )
          {
            if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 16), &v11, 4u) )
            {
              if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 20), &v11, 4u) )
              {
                if ( sub_100026B0(a1, (int)&v12, (void *)(a4 + 24), (int)&v11, 8u) )
                {
                  if ( sub_100026B0(a1, (int)&v12, (void *)(a4 + 32), (int)&v11, 8u) )
                  {
                    v4 = v11;
                    if ( v11 <= *(_DWORD *)(a4 + 16) )
                    {
                      *(_DWORD *)(a1 + 2824) = *(_DWORD *)(a4 + 24);
                      v5 = v14;
                      *(_DWORD *)(a1 + 2828) = *(_DWORD *)(a4 + 28);
                      v6 = *(_DWORD *)(a4 + 16);
                      *(_DWORD *)(a4 + 56) = v6 + v5;
                      if ( v6 + *(_WORD *)(a4 + 14) <= a3 )
                      {
                        if ( v4 <= a3 )
                        {
                          if ( !(*(_BYTE *)(a4 + 20) & 4)
                            || sub_10002660(a1, (int)&v12, (void *)(a4 + 40), &v11, 2u)
                            && sub_10002660(a1, (int)&v12, (void *)(a4 + 42), &v11, 2u)
                            && sub_10002660(a1, (int)&v12, (void *)(a4 + 44), &v11, 4u)
                            && (v7 = *(_DWORD *)(a4 + 44), v11 <= v7)
                            && (v8 = v7 + *(_WORD *)(a4 + 42),
                                v9 = *(_WORD *)(a4 + 40),
                                *(_DWORD *)(a4 + 60) = v7 + v14,
                                *(_DWORD *)(a1 + 2632) = 0,
                                sub_100025E0(a1, a1 + 2632, *(const void **)(a4 + 60), v9),
                                sub_1000F6A0(a1, a1 + 2632),
                                v8 <= a3)
                            && v11 <= a3 )
                          {
                            if ( !(*(_DWORD *)(a4 + 20) & 0x2000000) )
                              return 1;
                            if ( sub_10002660(a1, (int)&v12, (void *)(a4 + 48), &v11, 1u)
                              && sub_10002660(a1, (int)&v12, (void *)(a4 + 49), &v11, 1u)
                              && sub_10002660(a1, (int)&v12, (void *)(a4 + 50), &v11, 2u)
                              && sub_100026B0(a1, (int)&v12, (void *)(a4 + 52), (int)&v11, 3u)
                              && sub_100026B0(a1, (int)&v12, (void *)(a4 + 55), (int)&v11, 1u) )
                            {
                              *(_BYTE *)(a1 + 2664) = *(_BYTE *)(a4 + 48);
                              *(_BYTE *)(a1 + 2665) = *(_BYTE *)(a4 + 49);
                              *(_WORD *)(a1 + 2666) = *(_WORD *)(a4 + 50);
                              *(_BYTE *)(a1 + 2671) = *(_BYTE *)(a4 + 55);
                              *(_BYTE *)(a1 + 2668) = *(_BYTE *)(a4 + 52);
                              *(_BYTE *)(a1 + 2669) = *(_BYTE *)(a4 + 53);
                              *(_BYTE *)(a1 + 2670) = *(_BYTE *)(a4 + 54);
                              return 1;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;
}

//----- (1000FC80) --------------------------------------------------------
bool __cdecl sub_1000FC80(int a1, int a2, int a3)
{
  __int16 v3; // ax@18

  return sub_100025E0(a1, a2, (const void *)a3, 8u)
      && sub_10002470(a1, a2, (const void *)(a3 + 8), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 12), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 16), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 18), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 20), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 24), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 26), 2u)
      && sub_10002470(a1, a2, (const void *)(a3 + 28), 4u)
      && (!(*(_DWORD *)(a3 + 12) & 0x2000000)
       || sub_10002470(a1, a2, (const void *)(a3 + 32), 1u)
       && sub_10002470(a1, a2, (const void *)(a3 + 33), 1u)
       && sub_10002470(a1, a2, (const void *)(a3 + 34), 2u)
       && sub_100025E0(a1, a2, (const void *)(a3 + 36), 3u)
       && sub_10002470(a1, a2, (const void *)(a3 + 39), 1u))
      && (*(_WORD *)(a3 + 26) <= 0 || sub_100025E0(a1, a2, *(const void **)(a3 + 44), *(_WORD *)(a3 + 26)))
      && ((v3 = *(_WORD *)(a3 + 18), v3 <= 0) || sub_100025E0(a1, a2, *(const void **)(a3 + 40), v3));
}

//----- (1000FE30) --------------------------------------------------------
signed int __cdecl sub_1000FE30(int a1, int a2, int a3)
{
  __int16 v3; // ax@28
  __int16 v4; // ax@30
  __int16 v5; // ax@32
  __int16 v6; // ax@34
  __int16 v8; // ax@41
  __int16 v9; // ax@43
  char v10; // [sp+13h] [bp-1h]@1

  v10 = 0;
  if ( !sub_100025E0(a1, a2, (const void *)a3, 8u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 8), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 12), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 14), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 16), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 20), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 22), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 24), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 28), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 30), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 32), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 36), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 38), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 40), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 44), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 46), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 48), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 52), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 54), 2u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 56), 4u)
    || !sub_10002470(a1, a2, (const void *)(a3 + 60), 4u)
    || *(_DWORD *)(a3 + 60) & 0x2000000
    && (!sub_10002470(a1, a2, (const void *)(a3 + 64), 1u)
     || !sub_10002470(a1, a2, (const void *)(a3 + 65), 1u)
     || !sub_10002470(a1, a2, (const void *)(a3 + 66), 2u)
     || !sub_100025E0(a1, a2, (const void *)(a3 + 68), 3u)
     || !sub_10002470(a1, a2, (const void *)(a3 + 71), 1u))
    || (v3 = *(_WORD *)(a3 + 30), v3 > 0) && !sub_100025E0(a1, a2, *(const void **)(a3 + 72), v3)
    || (v4 = *(_WORD *)(a3 + 38), v4 > 0) && !sub_100025E0(a1, a2, *(const void **)(a3 + 76), v4)
    || (v5 = *(_WORD *)(a3 + 46), v5 > 0) && !sub_100025E0(a1, a2, *(const void **)(a3 + 80), v5) )
    return 0;
  v6 = *(_WORD *)(a3 + 14);
  if ( v6 > 1 || v6 == 1 && *(_DWORD *)(a3 + 84) )
  {
    if ( !sub_100025E0(a1, a2, *(const void **)(a3 + 84), v6) )
      return 0;
  }
  else
  {
    if ( v6 == 1 && !sub_100025E0(a1, a2, &v10, 1u) )
      return 0;
  }
  v8 = *(_WORD *)(a3 + 22);
  if ( v8 > 0 && !sub_100025E0(a1, a2, *(const void **)(a3 + 88), v8)
    || (v9 = *(_WORD *)(a3 + 54), v9 > 0) && !sub_100025E0(a1, a2, *(const void **)(a3 + 92), v9) )
    return 0;
  return 1;
}

//----- (10010340) --------------------------------------------------------
int __cdecl sub_10010340(int a1)
{
  int result; // eax@1
  int v2; // edx@1

  v2 = *(_WORD *)(a1 + 18);
  result = *(_WORD *)(a1 + 26) + v2 + 32;
  if ( *(_DWORD *)(a1 + 12) & 0x2000000 )
    result = *(_WORD *)(a1 + 26) + v2 + 40;
  return result;
}

//----- (10010360) --------------------------------------------------------
int __cdecl sub_10010360(int a1)
{
  int result; // eax@1
  int v2; // edx@1

  v2 = *(_WORD *)(a1 + 14);
  result = *(_WORD *)(a1 + 22)
         + *(_WORD *)(a1 + 30)
         + *(_WORD *)(a1 + 38)
         + *(_WORD *)(a1 + 46)
         + *(_WORD *)(a1 + 54)
         + v2
         + 64;
  if ( *(_DWORD *)(a1 + 60) & 0x2000000 )
    result = *(_WORD *)(a1 + 22)
           + *(_WORD *)(a1 + 30)
           + *(_WORD *)(a1 + 38)
           + *(_WORD *)(a1 + 46)
           + *(_WORD *)(a1 + 54)
           + v2
           + 72;
  return result;
}

//----- (100103A0) --------------------------------------------------------
bool __cdecl sub_100103A0(int a1, int a2, int a3)
{
  return sub_10002470(a1, a2, (const void *)a3, 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 4), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 8), 4u)
      && sub_10002470(a1, a2, (const void *)(a3 + 12), 4u);
}

//----- (10010410) --------------------------------------------------------
bool __cdecl sub_10010410(int a1, int a2, int a3, int *a4)
{
  return sub_10002660(a1, a2, (void *)a3, a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 4), a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 8), a4, 4u)
      && sub_10002660(a1, a2, (void *)(a3 + 12), a4, 4u);
}

//----- (100104A0) --------------------------------------------------------
int __cdecl sub_100104A0(unsigned int a1, int a2)
{
  unsigned int v2; // ebp@1
  char v3; // zf@4
  signed int v4; // ecx@4
  int *v5; // edi@4
  int v6; // esi@4
  int v7; // edx@10
  int v8; // ecx@10
  int v9; // edx@11
  int v11; // eax@19
  int v12; // edx@19
  int v13; // eax@19
  int v14; // esi@24
  char v15; // zf@27
  signed int v16; // ecx@27
  int *v17; // edi@27
  int v18; // esi@27
  int v19; // eax@33
  int v20; // [sp+10h] [bp-19Ch]@9
  int v21; // [sp+14h] [bp-198h]@9
  int v22; // [sp+18h] [bp-194h]@9
  int v23; // [sp+1Ch] [bp-190h]@9
  int v24; // [sp+20h] [bp-18Ch]@26
  unsigned int v25; // [sp+24h] [bp-188h]@18
  int v26; // [sp+28h] [bp-184h]@1
  int v27; // [sp+2Ch] [bp-180h]@1
  int v28; // [sp+30h] [bp-17Ch]@1
  int v29; // [sp+34h] [bp-178h]@1
  int v30; // [sp+38h] [bp-174h]@10
  int v31; // [sp+3Ch] [bp-170h]@10
  int v32; // [sp+40h] [bp-16Ch]@10
  int v33; // [sp+44h] [bp-168h]@10
  char v34; // [sp+50h] [bp-15Ch]@26
  char v35; // [sp+A8h] [bp-104h]@21
  char v36; // [sp+B8h] [bp-F4h]@10
  char v37; // [sp+D0h] [bp-DCh]@21

  v26 = 0;
  v2 = a1;
  v27 = 0;
  v28 = 0;
  v29 = 0;
  if ( !(v2 & 0x80000) )
  {
    if ( a1 & 0x40000000 )
    {
      v9 = *(_DWORD *)(a2 + 2716);
      v20 = *(_DWORD *)(a2 + 2712);
      v8 = *(_DWORD *)(a2 + 2720);
      v21 = v9;
      v7 = *(_DWORD *)(a2 + 2724);
    }
    else
    {
      if ( *(_DWORD *)(a2 + 2608) <= 0 )
      {
        v4 = 4;
        v5 = &v26;
        v6 = a2 + 2840;
        v3 = 1;
        do
        {
          if ( !v4 )
            break;
          v3 = *(_DWORD *)v6 == *v5;
          v6 += 4;
          ++v5;
          --v4;
        }
        while ( v3 );
        if ( v3 )
        {
          v20 = dword_100170F8;
          v21 = dword_100170FC;
          v22 = dword_10017100;
          v23 = dword_10017104;
LABEL_13:
          if ( (signed int)a1 >= 0 )
          {
            if ( !(a1 & 0x20000000) )
            {
              *(_WORD *)((char *)&v21 + 1) = 14565;
              BYTE3(v21) = -80;
            }
          }
          else
          {
            BYTE3(v21) = -96;
          }
          return sub_10014770((int)&v20, 8, a2 + 3372);
        }
      }
      sub_1000B5B0(a2 + 2840, a2 + 2824, (int)&v36);
      sub_1000B610(a2 + 2840, (int)&v36, (int)&v30);
      v8 = v32;
      v20 = v30;
      v7 = v33;
      v21 = v31;
    }
    v22 = v8;
    v23 = v7;
    goto LABEL_13;
  }
  v25 = a1 & 0x40000000;
  if ( a1 & 0x40000000 )
  {
    v11 = *(_DWORD *)(a2 + 2716);
    v20 = *(_DWORD *)(a2 + 2712);
    v12 = *(_DWORD *)(a2 + 2720);
    v21 = v11;
    v13 = *(_DWORD *)(a2 + 2724);
    v22 = v12;
    v23 = v13;
  }
  else
  {
    if ( *(_DWORD *)(a2 + 2272) )
    {
      sub_10014930((int)&v37, (const void *)(a2 + 3356), 0x10u);
      sub_10014A10(&v37, a2 + 2912, 16);
      sub_10014A20((int)&v37, (int)&v20);
    }
    else
    {
      sub_10013770((int)&v35, a2 + 2856, 16);
      sub_10014930((int)&v37, &v35, 0x10u);
      sub_10014A10(&v37, a2 + 2824, 8);
      sub_10014A10(&v37, a2 + 2832, 8);
      sub_10014A20((int)&v37, (int)&v20);
    }
  }
  if ( a1 & 0x20000000 )
    v14 = 16;
  else
    v14 = (a1 >> 30) | 5;
  sub_10013990((int)&v34);
  sub_100145B0((int)&v34, &v20, v14);
  sub_100145B0((int)&v34, "session key to client-to-server sealing key magic constant", 0x3Bu);
  sub_10014670((int)&v34, a2 + 2792);
  sub_10013990((int)&v34);
  sub_100145B0((int)&v34, &v20, v14);
  sub_100145B0((int)&v34, "session key to server-to-client sealing key magic constant", 0x3Bu);
  v24 = a2 + 2776;
  sub_10014670((int)&v34, a2 + 2776);
  sub_10013990((int)&v34);
  sub_100145B0((int)&v34, &v20, 0x10u);
  sub_100145B0((int)&v34, "session key to client-to-server signing key magic constant", 0x3Bu);
  sub_10014670((int)&v34, a2 + 2760);
  sub_10013990((int)&v34);
  sub_100145B0((int)&v34, &v20, 0x10u);
  sub_100145B0((int)&v34, "session key to server-to-client signing key magic constant", 0x3Bu);
  sub_10014670((int)&v34, a2 + 2744);
  if ( !*(_DWORD *)(a2 + 2608) )
  {
    v16 = 4;
    v17 = &v26;
    v18 = a2 + 2856;
    v15 = 1;
    do
    {
      if ( !v16 )
        break;
      v15 = *(_DWORD *)v18 == *v17;
      v18 += 4;
      ++v17;
      --v16;
    }
    while ( v15 );
    if ( v15 )
    {
      if ( !v25 )
      {
        *(_DWORD *)(a2 + 2792) = dword_10017138;
        *(_DWORD *)(a2 + 2796) = dword_1001713C;
        *(_DWORD *)(a2 + 2800) = dword_10017140;
        *(_DWORD *)(a2 + 2804) = dword_10017144;
        v19 = v24;
        *(_DWORD *)v24 = dword_10017128;
        *(_DWORD *)(v19 + 4) = dword_1001712C;
        *(_DWORD *)(v19 + 8) = dword_10017130;
        *(_DWORD *)(v19 + 12) = dword_10017134;
        *(_DWORD *)(a2 + 2760) = dword_10017118;
        *(_DWORD *)(a2 + 2764) = dword_1001711C;
        *(_DWORD *)(a2 + 2768) = dword_10017120;
        *(_DWORD *)(a2 + 2772) = dword_10017124;
        *(_DWORD *)(a2 + 2744) = dword_10017108;
        *(_DWORD *)(a2 + 2748) = dword_1001710C;
        *(_DWORD *)(a2 + 2752) = dword_10017110;
        *(_DWORD *)(a2 + 2756) = dword_10017114;
      }
    }
  }
  sub_10014770(a2 + 2792, 16, a2 + 3372);
  return sub_10014770(v24, 16, a2 + 3630);
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);
// 100170F8: using guessed type int dword_100170F8;
// 100170FC: using guessed type int dword_100170FC;
// 10017100: using guessed type int dword_10017100;
// 10017104: using guessed type int dword_10017104;
// 10017108: using guessed type int dword_10017108;
// 1001710C: using guessed type int dword_1001710C;
// 10017110: using guessed type int dword_10017110;
// 10017114: using guessed type int dword_10017114;
// 10017118: using guessed type int dword_10017118;
// 1001711C: using guessed type int dword_1001711C;
// 10017120: using guessed type int dword_10017120;
// 10017124: using guessed type int dword_10017124;
// 10017128: using guessed type int dword_10017128;
// 1001712C: using guessed type int dword_1001712C;
// 10017130: using guessed type int dword_10017130;
// 10017134: using guessed type int dword_10017134;
// 10017138: using guessed type int dword_10017138;
// 1001713C: using guessed type int dword_1001713C;
// 10017140: using guessed type int dword_10017140;
// 10017144: using guessed type int dword_10017144;

//----- (100108F0) --------------------------------------------------------
int __cdecl sub_100108F0(int a1, void *a2, int a3)
{
  int v3; // eax@1
  int v4; // ecx@1
  void *v5; // ebp@1
  int v6; // edi@1
  void *v7; // edi@1
  int v8; // eax@1
  signed int v9; // esi@4
  int v10; // eax@14
  int v11; // eax@16
  int v12; // eax@20
  int v13; // eax@23
  int v14; // eax@24
  int v15; // eax@31
  int v16; // eax@34
  int v17; // eax@35
  __int16 v18; // ax@39
  __int16 v19; // dx@39
  __int16 v20; // cx@39
  char v21; // zf@42
  signed int v22; // ecx@42
  int *v23; // edi@42
  int v24; // esi@42
  char v25; // zf@47
  int v26; // eax@50
  int v27; // eax@55
  int v28; // eax@58
  __int16 v29; // ax@60
  __int16 v30; // ax@61
  int v31; // eax@61
  unsigned int v32; // eax@63
  signed int v33; // eax@65
  int result; // eax@67
  int v35; // ecx@67
  int v36; // edx@67
  int v37; // eax@67
  int v38; // ecx@67
  int v39; // eax@67
  int v40; // edx@67
  int v41; // eax@67
  int v42; // ecx@67
  int v43; // [sp+10h] [bp-10h]@1
  int v44; // [sp+14h] [bp-Ch]@1
  int v45; // [sp+18h] [bp-8h]@1
  int v46; // [sp+1Ch] [bp-4h]@1

  v43 = 0;
  v5 = a2;
  v44 = 0;
  v45 = 0;
  v7 = a2;
  memset(a2, 0, 0x60u);
  v6 = (int)((char *)v7 + 96);
  *(_DWORD *)v5 = dword_100162B8;
  v46 = 0;
  v8 = a3;
  *((_DWORD *)v5 + 1) = dword_100162BC;
  *((_DWORD *)v5 + 2) = 3;
  v3 = *(_DWORD *)(a1 + 2688) & *(_DWORD *)(v8 + 20);
  *((_DWORD *)v5 + 15) = v3;
  v4 = *(_DWORD *)(a1 + 92);
  if ( v4 == 1 || v4 == 4 )
    *((_DWORD *)v5 + 15) = v3 | 0x40000040;
  v9 = 0;
  if ( *((_BYTE *)v5 + 60) & 1 )
  {
    if ( *(_DWORD *)(a1 + 2356) > 0 )
    {
      if ( !*(_DWORD *)(a1 + 2380) )
        sub_10008450(v6, a1, a1 + 2380, a1 + 2356);
    }
    if ( *(_DWORD *)(a1 + 2500) > 0 )
    {
      if ( !*(_DWORD *)(a1 + 2512) )
        sub_10008450(v6, a1, a1 + 2524, a1 + 2500);
    }
    if ( *(_DWORD *)(a1 + 2584) > 0 )
    {
      if ( !*(_DWORD *)(a1 + 2596) )
        sub_10008450(v6, a1, a1 + 2596, a1 + 2584);
    }
  }
  v10 = *(_DWORD *)(a1 + 2688);
  if ( *((_BYTE *)v5 + 60) & 1 )
  {
    if ( BYTE1(v10) & 0x10 )
    {
      *((_DWORD *)v5 + 18) = *(_DWORD *)(a1 + 2388);
      v11 = *(_DWORD *)(a1 + 2380);
      if ( v11 > 0 )
      {
        *((_WORD *)v5 + 14) = v11 - 2;
        goto LABEL_20;
      }
    }
    else
    {
      *((_DWORD *)v5 + 18) = 0;
    }
    *((_WORD *)v5 + 14) = 0;
LABEL_20:
    *((_DWORD *)v5 + 19) = *(_DWORD *)(a1 + 2604);
    v12 = *(_DWORD *)(a1 + 2596);
    if ( v12 <= 0 )
      *((_WORD *)v5 + 18) = 0;
    else
      *((_WORD *)v5 + 18) = v12 - 2;
    v13 = *(_DWORD *)(a1 + 2688);
    if ( BYTE1(v13) & 0x20 )
    {
      *((_DWORD *)v5 + 20) = *(_DWORD *)(a1 + 2532);
      v14 = *(_DWORD *)(a1 + 2524);
      if ( v14 > 0 )
      {
        *((_WORD *)v5 + 22) = v14 - 2;
        goto LABEL_39;
      }
      goto LABEL_38;
    }
    goto LABEL_37;
  }
  if ( BYTE1(v10) & 0x10 )
  {
    *((_DWORD *)v5 + 18) = *(_DWORD *)(a1 + 2364);
    if ( *(_DWORD *)(a1 + 2584) > 0 )
    {
      *((_WORD *)v5 + 14) = *(_WORD *)(a1 + 2356) - 1;
      goto LABEL_31;
    }
  }
  else
  {
    *((_DWORD *)v5 + 18) = 0;
  }
  *((_WORD *)v5 + 14) = 0;
LABEL_31:
  *((_DWORD *)v5 + 19) = *(_DWORD *)(a1 + 2592);
  v15 = *(_DWORD *)(a1 + 2584);
  if ( v15 <= 0 )
    *((_WORD *)v5 + 18) = 0;
  else
    *((_WORD *)v5 + 18) = v15 - 1;
  v16 = *(_DWORD *)(a1 + 2688);
  if ( !(BYTE1(v16) & 0x20) )
  {
LABEL_37:
    *((_DWORD *)v5 + 20) = 0;
    goto LABEL_38;
  }
  *((_DWORD *)v5 + 20) = *(_DWORD *)(a1 + 2508);
  v17 = *(_DWORD *)(a1 + 2500);
  if ( v17 > 0 )
  {
    *((_WORD *)v5 + 22) = v17 - 1;
    goto LABEL_39;
  }
LABEL_38:
  *((_WORD *)v5 + 22) = 0;
LABEL_39:
  v18 = *((_WORD *)v5 + 18);
  v19 = *((_WORD *)v5 + 14);
  *((_DWORD *)v5 + 15) &= 0xFFFFCFFFu;
  v20 = *((_WORD *)v5 + 22);
  *((_WORD *)v5 + 15) = v19;
  *((_WORD *)v5 + 19) = v18;
  *((_WORD *)v5 + 23) = v20;
  if ( *(_DWORD *)(a1 + 2688) & 0x2000000 )
  {
    *((_BYTE *)v5 + 64) = *(_BYTE *)(a1 + 2656);
    *((_BYTE *)v5 + 65) = *(_BYTE *)(a1 + 2657);
    *((_WORD *)v5 + 33) = *(_WORD *)(a1 + 2658);
    *((_BYTE *)v5 + 68) = *(_BYTE *)(a1 + 2660);
    *((_BYTE *)v5 + 69) = *(_BYTE *)(a1 + 2661);
    *((_BYTE *)v5 + 70) = *(_BYTE *)(a1 + 2662);
    *((_BYTE *)v5 + 71) = *(_BYTE *)(a1 + 2663);
  }
  *(_DWORD *)(a1 + 2692) = *((_DWORD *)v5 + 15);
  if ( *(_DWORD *)(a1 + 2608) <= 0 )
  {
    v22 = 4;
    v23 = &v43;
    v24 = a1 + 2856;
    v21 = 1;
    do
    {
      if ( !v22 )
        break;
      v21 = *(_DWORD *)v24 == *v23;
      v24 += 4;
      ++v23;
      --v22;
    }
    while ( v21 );
    if ( v21 )
    {
      v25 = *((_WORD *)v5 + 19) == 0;
      *((_DWORD *)v5 + 21) = 0;
      *((_DWORD *)v5 + 22) = 0;
      *((_WORD *)v5 + 10) = 0;
      *((_WORD *)v5 + 11) = 0;
      *((_WORD *)v5 + 6) = 1;
      *((_WORD *)v5 + 7) = 1;
      if ( v25 )
        *((_DWORD *)v5 + 15) |= 0x800u;
      v9 = 0;
      goto LABEL_50;
    }
    v9 = 0;
  }
  sub_1000EED0(a1, a3, (int)&a3, (int)&a2);
  v28 = *((_DWORD *)v5 + 15);
  if ( BYTE1(v28) & 4 )
  {
    *((_DWORD *)v5 + 21) = v9;
    *((_WORD *)v5 + 6) = v9;
    *((_WORD *)v5 + 7) = v9;
  }
  else
  {
    *((_DWORD *)v5 + 21) = a1 + 2888;
    v29 = a3;
    *((_WORD *)v5 + 6) = a3;
    *((_WORD *)v5 + 7) = v29;
  }
  v30 = (signed __int16)a2;
  *((_WORD *)v5 + 10) = (_WORD)a2;
  *((_WORD *)v5 + 11) = v30;
  v31 = *((_DWORD *)v5 + 15) & 0xFFFFF7FF;
  *((_DWORD *)v5 + 22) = a1 + 2912;
  *((_DWORD *)v5 + 15) = v31;
LABEL_50:
  v26 = *(_DWORD *)(a1 + 92);
  if ( v26 != 1 )
  {
    if ( v26 != 4 )
    {
      if ( *(_DWORD *)(a1 + 2276) == v9 )
      {
        do
          *(_BYTE *)(a1 + v9++ + 2712) = rand();
        while ( v9 < 16 );
        v9 = 0;
      }
    }
  }
  v27 = *((_DWORD *)v5 + 15);
  if ( v27 & 0x40000000 )
  {
    sub_1000F470(v27, a1);
    *((_DWORD *)v5 + 23) = a1 + 2728;
    *((_WORD *)v5 + 26) = 16;
    *((_WORD *)v5 + 27) = 16;
  }
  else
  {
    *((_DWORD *)v5 + 23) = v9;
    *((_WORD *)v5 + 26) = v9;
    *((_WORD *)v5 + 27) = v9;
  }
  v32 = *((_DWORD *)v5 + 15);
  if ( v32 & 0x30 )
    sub_100104A0(v32, a1);
  *(_DWORD *)(a1 + 2692) = *((_DWORD *)v5 + 15);
  v33 = 64;
  if ( *((_DWORD *)v5 + 15) & 0x2000000 )
    v33 = 72;
  v35 = *((_WORD *)v5 + 15);
  v36 = *((_WORD *)v5 + 19);
  *((_DWORD *)v5 + 8) = v33;
  v37 = v35 + v33;
  v38 = *((_WORD *)v5 + 23);
  *((_DWORD *)v5 + 10) = v37;
  v39 = v36 + v37;
  v40 = *((_WORD *)v5 + 7);
  *((_DWORD *)v5 + 12) = v39;
  v41 = v38 + v39;
  v42 = *((_WORD *)v5 + 11);
  *((_DWORD *)v5 + 4) = v41;
  result = v40 + v41;
  *((_DWORD *)v5 + 6) = result;
  *((_DWORD *)v5 + 14) = result + v42;
  return result;
}
// 100162B8: using guessed type int dword_100162B8;
// 100162BC: using guessed type int dword_100162BC;

//----- (10010CF0) --------------------------------------------------------
signed int __cdecl sub_10010CF0(int a1, int a2, int a3, unsigned int a4)
{
  unsigned int v4; // ebx@1
  signed int v5; // edi@4
  signed int v6; // edi@7
  int v7; // ecx@13
  int v8; // eax@19
  signed int result; // eax@22
  char v10; // zf@22
  int v11; // [sp+Ch] [bp-FCh]@11
  int v12; // [sp+10h] [bp-F8h]@13
  int v13; // [sp+14h] [bp-F4h]@13
  int v14; // [sp+18h] [bp-F0h]@14
  int v15; // [sp+1Ch] [bp-ECh]@19
  int v16; // [sp+20h] [bp-E8h]@19
  char v17; // [sp+2Ch] [bp-DCh]@19

  v4 = *(_DWORD *)(a1 + 2692);
  if ( *(_DWORD *)(a1 + 92) == 1 )
  {
    v4 |= 0x40000000u;
    if ( !*(_DWORD *)(a1 + 2108) )
    {
      if ( !*(_DWORD *)(a1 + 2280) )
      {
        v5 = 0;
        do
          *(_BYTE *)(a1 + v5++ + 2832) = rand();
        while ( v5 < 8 );
      }
      if ( !*(_DWORD *)(a1 + 2276) )
      {
        v6 = 0;
        do
          *(_BYTE *)(a1 + v6++ + 2712) = rand();
        while ( v6 < 16 );
      }
      *(_DWORD *)(a1 + 2108) = 1;
    }
    sub_100104A0(v4, a1);
  }
  v11 = 1;
  if ( !(v4 & 0x10) )
  {
    v8 = 0;
    v12 = 0;
    v14 = 0;
LABEL_21:
    v13 = v8;
    goto LABEL_22;
  }
  if ( v4 & 0x80000 )
  {
    if ( *(_DWORD *)(a1 + 92) == 1 )
      v14 = *(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1768);
    else
      v14 = *(_DWORD *)(a1 + 1224);
    sub_10014930((int)&v17, (const void *)(a1 + 2760), 0x10u);
    sub_10014A10(&v17, &v14, 4);
    sub_10014A10(&v17, *(_DWORD *)(a2 + 8), *(_DWORD *)a2);
    sub_10014A20((int)&v17, (int)&v15);
    v8 = v16;
    v12 = v15;
    goto LABEL_21;
  }
  v7 = *(_DWORD *)(a2 + 8);
  v12 = 0;
  v13 = sub_10014A60(a3 + v7, a4);
  if ( *(_DWORD *)(a1 + 92) == 1 )
    v14 = *(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1768);
  else
    v14 = *(_DWORD *)(a1 + 1224) + *(_DWORD *)(a1 + 1228);
LABEL_22:
  v10 = sub_100103A0(a1, a2, (int)&v11) == 0;
  result = -17;
  if ( !v10 )
    result = 1;
  return result;
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);

//----- (10010EA0) --------------------------------------------------------
int __cdecl sub_10010EA0(int a1, int a2, char a3)
{
  int result; // eax@5
  int v4; // [sp-Ch] [bp-7Ch]@2
  int v5; // [sp-8h] [bp-78h]@2
  char v6; // [sp+8h] [bp-68h]@4
  char v7; // [sp+18h] [bp-58h]@1

  sub_100104A0(*(_DWORD *)(a1 + 2692) | 0x40000000, a1);
  sub_10013990((int)&v7);
  if ( a2 )
  {
    v5 = a1 + 2776;
    v4 = (int)&v7;
  }
  else
  {
    v5 = a1 + 2792;
    v4 = (int)&v7;
  }
  sub_100145B0(v4, (const void *)v5, 0x10u);
  sub_100145B0((int)&v7, &a3, 4u);
  sub_10014670((int)&v7, (int)&v6);
  if ( a2 )
    result = sub_10014770((int)&v6, 16, a1 + 3630);
  else
    result = sub_10014770((int)&v6, 16, a1 + 3372);
  return result;
}

//----- (10010F60) --------------------------------------------------------
signed int __cdecl sub_10010F60(int a1, int a2, int a3, int a4, int a5)
{
  int v5; // eax@1
  unsigned int v6; // edi@1
  int v7; // ebx@10
  int v9; // [sp-8h] [bp-18h]@14
  int v10; // [sp-4h] [bp-14h]@14

  v5 = *(_DWORD *)(a1 + 92);
  v6 = *(_DWORD *)(a1 + 2692);
  if ( v5 == 1 )
    v6 |= 0x40000000u;
  if ( *(_BYTE *)(a1 + 2292) == 6 )
  {
    if ( a4 > 0 )
    {
      if ( v5 == 1 )
      {
        if ( v6 & 0x80000 )
          sub_10010EA0(a1, 0, *(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1768));
        else
          sub_100104A0(v6, a1);
      }
      sub_100148A0(a1 + 3372, a3 + *(_DWORD *)(a2 + 8), a4);
    }
  }
  v7 = a5 + 4;
  if ( *(_BYTE *)(a1 + 2292) >= 5 )
  {
    if ( !(v6 & 0x80000) )
    {
      if ( *(_DWORD *)(a1 + 92) == 1 )
        sub_100104A0(v6, a1);
      v10 = 12;
      v9 = v7 + *(_DWORD *)(a2 + 8);
      goto LABEL_17;
    }
    if ( v6 & 0x40000000 )
    {
      v10 = 8;
      v9 = v7 + *(_DWORD *)(a2 + 8);
LABEL_17:
      sub_100148A0(a1 + 3372, v9, v10);
      return 1;
    }
  }
  return 1;
}

//----- (10011040) --------------------------------------------------------
signed int __cdecl sub_10011040(int a1, int a2, int a3, unsigned int a4, int a5)
{
  unsigned int v5; // ebp@1
  signed int result; // eax@4
  char v7; // zf@5
  int v8; // eax@7
  int v9; // [sp-Ch] [bp-124h]@10
  int v10; // [sp-Ch] [bp-124h]@19
  int v11; // [sp-8h] [bp-120h]@10
  int v12; // [sp-8h] [bp-120h]@19
  int v13; // [sp-4h] [bp-11Ch]@10
  int v14; // [sp-4h] [bp-11Ch]@19
  int v15; // [sp+10h] [bp-108h]@3
  int v16; // [sp+14h] [bp-104h]@3
  int v17; // [sp+18h] [bp-100h]@1
  char v18; // [sp+1Ch] [bp-FCh]@3
  int v19; // [sp+28h] [bp-F0h]@9
  char v20; // [sp+2Ch] [bp-ECh]@25
  char v21; // [sp+3Ch] [bp-DCh]@25

  v5 = *(_DWORD *)(a1 + 2692);
  v17 = sub_100089C0(a1);
  if ( *(_DWORD *)(a1 + 92) == 1 )
    v5 |= 0x40000000u;
  v16 = a5 + *(_DWORD *)(a2 + 8);
  v15 = a5;
  if ( !sub_10010410(a1, a2, (int)&v18, &v15) )
    return -12;
  v7 = *(_BYTE *)(a1 + 2292) == 6;
  v15 = a5;
  if ( v7 )
  {
    if ( (signed int)a4 > 0 )
    {
      v8 = *(_DWORD *)(a1 + 92);
      if ( v5 & 0x80000 )
      {
        if ( v8 == 1 )
          sub_10010EA0(a1, 1, v19);
        v13 = a4;
        v11 = a3 + *(_DWORD *)(a2 + 8);
        v9 = a1 + 3630;
      }
      else
      {
        if ( v8 == 1 )
          sub_100104A0(v5, a1);
        v13 = a4;
        v11 = a3 + *(_DWORD *)(a2 + 8);
        v9 = a1 + 3372;
      }
      sub_100148A0(v9, v11, v13);
    }
  }
  if ( *(_BYTE *)(a1 + 2292) < 5 || v5 & 0x80000 )
  {
    if ( !(v5 & 0x40000000) )
      goto LABEL_23;
    v14 = 8;
    v12 = v16 + 4;
    v10 = a1 + 3630;
  }
  else
  {
    if ( *(_DWORD *)(a1 + 92) == 1 )
      sub_100104A0(v5, a1);
    v14 = 12;
    v12 = v16 + 4;
    v10 = a1 + 3372;
  }
  sub_100148A0(v10, v12, v14);
LABEL_23:
  if ( v5 & 0x80000 )
  {
    sub_10014930((int)&v21, (const void *)(a1 + 2744), 0x10u);
    sub_10014A10(&v21, &v19, 4);
    sub_10014A10(&v21, *(_DWORD *)(a2 + 8), *(_DWORD *)a2 - v17);
    sub_10014A20((int)&v21, (int)&v20);
    result = 1;
  }
  else
  {
    sub_10014A60(a3 + *(_DWORD *)(a2 + 8), a4);
    result = 1;
  }
  return result;
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);

//----- (10011280) --------------------------------------------------------
bool __cdecl sub_10011280(int a1, int a2, int a3)
{
  char v3; // al@1
  char v5; // [sp+10h] [bp-38h]@1
  char v6; // [sp+11h] [bp-37h]@1
  char v7; // [sp+12h] [bp-36h]@1
  char v8; // [sp+13h] [bp-35h]@1
  char v9; // [sp+14h] [bp-34h]@1
  char v10; // [sp+15h] [bp-33h]@1
  char v11; // [sp+16h] [bp-32h]@1
  char v12; // [sp+17h] [bp-31h]@1
  char v13; // [sp+18h] [bp-30h]@1
  char v14; // [sp+19h] [bp-2Fh]@1
  char v15; // [sp+1Ah] [bp-2Eh]@1
  char v16; // [sp+1Bh] [bp-2Dh]@1
  char v17; // [sp+1Ch] [bp-2Ch]@1
  char v18; // [sp+1Dh] [bp-2Bh]@1
  char v19; // [sp+1Eh] [bp-2Ah]@1
  char v20; // [sp+1Fh] [bp-29h]@1
  char v21; // [sp+20h] [bp-28h]@1
  char v22; // [sp+21h] [bp-27h]@1
  char v23; // [sp+22h] [bp-26h]@1
  char v24; // [sp+23h] [bp-25h]@1
  char v25; // [sp+24h] [bp-24h]@1
  char v26; // [sp+25h] [bp-23h]@1
  char v27; // [sp+26h] [bp-22h]@1
  char v28; // [sp+27h] [bp-21h]@1
  char v29; // [sp+28h] [bp-20h]@1
  char v30; // [sp+29h] [bp-1Fh]@1
  char v31; // [sp+2Ah] [bp-1Eh]@1
  char v32; // [sp+2Bh] [bp-1Dh]@1
  char v33; // [sp+2Ch] [bp-1Ch]@1
  char v34; // [sp+2Dh] [bp-1Bh]@1
  char v35; // [sp+2Eh] [bp-1Ah]@1
  char v36; // [sp+2Fh] [bp-19h]@1
  char v37; // [sp+30h] [bp-18h]@1
  char v38; // [sp+31h] [bp-17h]@1
  char v39; // [sp+32h] [bp-16h]@1
  char v40; // [sp+33h] [bp-15h]@1
  char v41; // [sp+34h] [bp-14h]@1
  char v42; // [sp+35h] [bp-13h]@1
  char v43; // [sp+36h] [bp-12h]@1
  char v44; // [sp+37h] [bp-11h]@1
  char v45; // [sp+38h] [bp-10h]@1
  char v46; // [sp+39h] [bp-Fh]@1
  char v47; // [sp+3Ah] [bp-Eh]@1
  char v48; // [sp+3Bh] [bp-Dh]@1
  char v49; // [sp+3Ch] [bp-Ch]@1
  char v50; // [sp+3Dh] [bp-Bh]@1
  char v51; // [sp+3Eh] [bp-Ah]@1
  char v52; // [sp+3Fh] [bp-9h]@1
  char v53; // [sp+40h] [bp-8h]@1
  char v54; // [sp+41h] [bp-7h]@1
  char v55; // [sp+42h] [bp-6h]@1
  char v56; // [sp+43h] [bp-5h]@1
  char v57; // [sp+44h] [bp-4h]@1
  char v58; // [sp+45h] [bp-3h]@1
  char v59; // [sp+46h] [bp-2h]@1
  char v60; // [sp+47h] [bp-1h]@1

  v17 = 48;
  v21 = 48;
  v12 = 5;
  v13 = 5;
  v24 = 10;
  v34 = 10;
  v5 = 96;
  v7 = 6;
  v8 = 6;
  v9 = 43;
  v10 = 6;
  v11 = 1;
  v14 = 2;
  v15 = -96;
  v19 = -96;
  v20 = 36;
  v22 = 34;
  v23 = 6;
  v25 = 43;
  v26 = 6;
  v27 = 1;
  v28 = 4;
  v29 = 1;
  v30 = -126;
  v31 = 55;
  v32 = 2;
  v33 = 2;
  v35 = 6;
  v36 = 9;
  v37 = 42;
  v38 = -122;
  v39 = 72;
  v40 = -126;
  v41 = -9;
  v42 = 18;
  v43 = 1;
  v44 = 2;
  v45 = 2;
  v46 = 6;
  v47 = 9;
  v48 = 42;
  v49 = -122;
  v50 = 72;
  v51 = -122;
  v52 = -9;
  v53 = 18;
  v54 = 1;
  v55 = 2;
  v56 = 2;
  v57 = -94;
  v59 = 4;
  v3 = sub_10010340(a3);
  v6 = v3 - 55 + 109;
  v16 = v3 - 55 + 99;
  v18 = v3 - 55 + 97;
  v58 = v3 - 55 + 57;
  v60 = v3;
  return sub_100025E0(a1, a2, &v5, 0x38u) && sub_1000FC80(a1, a2, a3);
}

//----- (10011430) --------------------------------------------------------
bool __cdecl sub_10011430(int a1, int a2, int a3)
{
  int v3; // eax@1
  unsigned int v4; // ecx@2
  char v6; // [sp+10h] [bp-10h]@1
  int v7; // [sp+11h] [bp-Fh]@1
  int v8; // [sp+15h] [bp-Bh]@1
  int v9; // [sp+19h] [bp-7h]@1
  __int16 v10; // [sp+1Dh] [bp-3h]@1
  char v11; // [sp+1Fh] [bp-1h]@1

  v7 = 0;
  v8 = 0;
  v9 = 0;
  v10 = 0;
  v11 = 0;
  v3 = sub_10010360(a3);
  v6 = -95;
  if ( v3 < 244 )
  {
    if ( v3 < 118 )
    {
      LOBYTE(v7) = v3 + 6;
      BYTE2(v7) = v3 + 4;
      v4 = 8;
      BYTE1(v7) = 48;
      BYTE3(v7) = -94;
      LOBYTE(v8) = v3 + 2;
      BYTE1(v8) = 4;
      BYTE2(v8) = v3;
    }
    else
    {
      BYTE1(v7) = v3 + 9;
      LOBYTE(v8) = v3 + 6;
      v4 = 12;
      LOBYTE(v7) = -127;
      HIWORD(v7) = -32464;
      *(_WORD *)((char *)&v8 + 1) = -32350;
      BYTE3(v8) = v3 + 3;
      LOWORD(v9) = -32508;
      BYTE2(v9) = v3;
    }
  }
  else
  {
    BYTE1(v7) = (unsigned __int16)(v3 + 12) >> 8;
    BYTE2(v7) = v3 + 12;
    BYTE1(v8) = (unsigned __int16)(v3 + 8) >> 8;
    BYTE2(v8) = v3 + 8;
    BYTE1(v9) = (unsigned __int16)(v3 + 4) >> 8;
    LOBYTE(v7) = -126;
    LOBYTE(v8) = -126;
    LOBYTE(v9) = -126;
    LOBYTE(v10) = -126;
    v4 = 16;
    BYTE3(v7) = 48;
    BYTE3(v8) = -94;
    BYTE2(v9) = v3 + 4;
    BYTE3(v9) = 4;
    HIBYTE(v10) = BYTE1(v3);
    v11 = v3;
  }
  return sub_100025E0(a1, a2, &v6, v4) && sub_1000FE30(a1, a2, a3);
}

//----- (100115A0) --------------------------------------------------------
int __cdecl sub_100115A0(int a1)
{
  return sub_10010340(a1) + 56;
}

//----- (100115C0) --------------------------------------------------------
int __cdecl sub_100115C0(int a1)
{
  int v1; // eax@1
  int result; // eax@2

  v1 = sub_10010360(a1);
  if ( v1 < 244 )
  {
    if ( v1 < 118 )
      result = v1 + 8;
    else
      result = v1 + 12;
  }
  else
  {
    result = v1 + 16;
  }
  return result;
}

//----- (10011690) --------------------------------------------------------
int __cdecl sub_10011690(int a1)
{
  int result; // eax@1
  int v2; // ebx@1
  int v3; // eax@2
  int v4; // edx@2
  char v5; // cl@3
  int v6; // ecx@6
  int v7; // esi@6
  char v8; // dl@7
  int v9; // ecx@10
  int v10; // esi@10
  char v11; // dl@11
  int v12; // ecx@14
  int v13; // esi@14
  char v14; // dl@15
  int v15; // ecx@18
  int v16; // esi@18
  char v17; // dl@19

  v2 = *(_DWORD *)(a1 + 4);
  result = 8;
  if ( v2 & 1 )
  {
    v3 = *(_DWORD *)(a1 + 8);
    v4 = v3 + 1;
    do
      v5 = *(_BYTE *)v3++;
    while ( v5 );
    result = v3 - v4 + 9;
  }
  if ( v2 & 2 )
  {
    v6 = *(_DWORD *)(a1 + 12);
    v7 = v6 + 1;
    do
      v8 = *(_BYTE *)v6++;
    while ( v8 );
    result += v6 - v7 + 1;
  }
  if ( v2 & 4 )
  {
    v9 = *(_DWORD *)(a1 + 16);
    v10 = v9 + 1;
    do
      v11 = *(_BYTE *)v9++;
    while ( v11 );
    result += v9 - v10 + 1;
  }
  if ( v2 & 8 )
  {
    v12 = *(_DWORD *)(a1 + 20);
    v13 = v12 + 1;
    do
      v14 = *(_BYTE *)v12++;
    while ( v14 );
    result += v12 - v13 + 1;
  }
  if ( v2 & 0x10 )
  {
    v15 = *(_DWORD *)(a1 + 24);
    v16 = v15 + 1;
    do
      v17 = *(_BYTE *)v15++;
    while ( v17 );
    result += v15 - v16 + 1;
  }
  return result;
}

//----- (10011730) --------------------------------------------------------
signed int __cdecl sub_10011730(int a1, int a2, int a3)
{
  const void *v3; // edx@4
  int v4; // eax@5
  char v5; // cl@6
  const void *v6; // edx@9
  int v7; // eax@10
  char v8; // cl@11
  const void *v9; // edx@14
  int v10; // eax@15
  char v11; // cl@16
  const void *v12; // edx@19
  int v13; // eax@20
  char v14; // cl@21
  const void *v15; // edx@24
  int v16; // eax@25
  char v17; // cl@26
  signed int result; // eax@28

  if ( !sub_10002470(a1, a2, (const void *)a3, 4u) )
    goto LABEL_32;
  if ( !sub_10002470(a1, a2, (const void *)(a3 + 4), 4u) )
    goto LABEL_32;
  if ( *(_BYTE *)(a3 + 4) & 1 )
  {
    v3 = *(const void **)(a3 + 8);
    if ( !v3 )
      goto LABEL_32;
    v4 = *(_DWORD *)(a3 + 8);
    do
      v5 = *(_BYTE *)v4++;
    while ( v5 );
    if ( !sub_100025E0(a1, a2, v3, v4 - (_DWORD)((char *)v3 + 1) + 1) )
      goto LABEL_32;
  }
  if ( *(_BYTE *)(a3 + 4) & 2 )
  {
    v6 = *(const void **)(a3 + 12);
    if ( !v6 )
      goto LABEL_32;
    v7 = *(_DWORD *)(a3 + 12);
    do
      v8 = *(_BYTE *)v7++;
    while ( v8 );
    if ( !sub_100025E0(a1, a2, v6, v7 - (_DWORD)((char *)v6 + 1) + 1) )
      goto LABEL_32;
  }
  if ( *(_BYTE *)(a3 + 4) & 4 )
  {
    v9 = *(const void **)(a3 + 16);
    if ( !v9 )
      goto LABEL_32;
    v10 = *(_DWORD *)(a3 + 16);
    do
      v11 = *(_BYTE *)v10++;
    while ( v11 );
    if ( !sub_100025E0(a1, a2, v9, v10 - (_DWORD)((char *)v9 + 1) + 1) )
      goto LABEL_32;
  }
  if ( *(_BYTE *)(a3 + 4) & 8 )
  {
    v12 = *(const void **)(a3 + 20);
    if ( !v12 )
      goto LABEL_32;
    v13 = *(_DWORD *)(a3 + 20);
    do
      v14 = *(_BYTE *)v13++;
    while ( v14 );
    if ( !sub_100025E0(a1, a2, v12, v13 - (_DWORD)((char *)v12 + 1) + 1) )
      goto LABEL_32;
  }
  if ( !(*(_BYTE *)(a3 + 4) & 0x10) )
    goto LABEL_33;
  v15 = *(const void **)(a3 + 24);
  if ( !v15 )
    goto LABEL_32;
  v16 = *(_DWORD *)(a3 + 24);
  do
    v17 = *(_BYTE *)v16++;
  while ( v17 );
  if ( sub_100025E0(a1, a2, v15, v16 - (_DWORD)((char *)v15 + 1) + 1) )
LABEL_33:
    result = 1;
  else
LABEL_32:
    result = 0;
  return result;
}

//----- (10011880) --------------------------------------------------------
int __cdecl sub_10011880()
{
  return 0;
}

//----- (10011890) --------------------------------------------------------
bool __cdecl sub_10011890(int a1, int a2, int a3)
{
  return sub_10003750(a1, a2, *(_BYTE *)a3)
      && sub_10003750(a1, a2, *(_BYTE *)(a3 + 1))
      && sub_10003750(a1, a2, *(_BYTE *)(a3 + 2))
      && sub_10003750(a1, a2, *(_BYTE *)(a3 + 3))
      && sub_100036C0(a1, a2, *(_WORD *)(a3 + 4))
      && sub_100036C0(a1, a2, *(_WORD *)(a3 + 6))
      && sub_10003620(a1, a2, *(_DWORD *)(a3 + 8))
      && sub_100025E0(a1, a2, (const void *)(a3 + 12), 4u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 16), 8u)
      && sub_100025E0(a1, a2, (const void *)(a3 + 24), 8u);
}

//----- (100119A0) --------------------------------------------------------
int __cdecl sub_100119A0(const void *a1, int a2, int a3)
{
  int v4; // [sp+4h] [bp-20Ch]@1
  char v5; // [sp+8h] [bp-208h]@1
  char v6; // [sp+18h] [bp-1F8h]@1
  char v7; // [sp+28h] [bp-1E8h]@1
  char v8; // [sp+108h] [bp-108h]@1
  char v9; // [sp+109h] [bp-107h]@1
  char v10; // [sp+209h] [bp-7h]@1

  v8 = 0;
  memset(&v9, 0, 0x100u);
  v10 = 0;
  v4 = 0;
  sub_10014930((int)&v7, a1, 0x10u);
  sub_10014A10(&v7, &v4, 4);
  sub_10014A20((int)&v7, (int)&v6);
  sub_10014930((int)&v7, &v6, 0x10u);
  sub_10014A10(&v7, a2, 8);
  sub_10014A20((int)&v7, (int)&v5);
  sub_10014770((int)&v5, 16, (int)&v8);
  return sub_100148A0((int)&v8, a3, 8);
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);

//----- (10011A60) --------------------------------------------------------
int __cdecl sub_10011A60(int a1, int a2, int a3)
{
  char v4; // [sp+4h] [bp-104h]@1
  char v5; // [sp+5h] [bp-103h]@1
  char v6; // [sp+105h] [bp-3h]@1

  v4 = 0;
  memset(&v5, 0, 0x100u);
  v6 = 0;
  sub_10014770(a2, 16, (int)&v4);
  return sub_100148A0((int)&v4, a1, a3);
}

//----- (10011AC0) --------------------------------------------------------
int __cdecl sub_10011AC0(const void *a1, const void *a2, const void *a3, const void *a4, unsigned int a5, int a6)
{
  char v6; // zf@1
  signed int v7; // ecx@1
  int *v8; // edi@1
  const void *v9; // esi@1
  int result; // eax@7
  int v11; // edx@7
  int v12; // [sp+8h] [bp-15Ch]@1
  int v13; // [sp+Ch] [bp-158h]@1
  int v14; // [sp+10h] [bp-154h]@7
  int v15; // [sp+14h] [bp-150h]@7
  char v16; // [sp+20h] [bp-144h]@7
  char v17; // [sp+30h] [bp-134h]@1
  char v18; // [sp+88h] [bp-DCh]@7

  v12 = 0;
  v13 = 0;
  sub_10013990((int)&v17);
  sub_100145B0((int)&v17, &v12, 4u);
  sub_100145B0((int)&v17, a2, 8u);
  v7 = 2;
  v8 = &v12;
  v9 = a3;
  v6 = 1;
  do
  {
    if ( !v7 )
      break;
    v6 = *(_DWORD *)v9 == *v8;
    v9 = (char *)v9 + 4;
    ++v8;
    --v7;
  }
  while ( v6 );
  if ( !v6 )
    sub_100145B0((int)&v17, a3, 8u);
  sub_100145B0((int)&v17, a4, a5);
  sub_10014670((int)&v17, (int)&v16);
  sub_10014930((int)&v18, a1, 0x10u);
  sub_10014A10(&v18, &v16, 16);
  sub_10014A20((int)&v18, (int)&v14);
  result = a6;
  v11 = v15;
  *(_DWORD *)a6 = v14;
  *(_DWORD *)(a6 + 4) = v11;
  return result;
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);

//----- (10011BB0) --------------------------------------------------------
u_long __cdecl sub_10011BB0(int a1, int a2, int a3)
{
  signed int v3; // eax@1
  char *v4; // ecx@2
  char v5; // dl@2
  int v7; // [sp+4h] [bp-100h]@1
  char v8[16]; // [sp+8h] [bp-FCh]@2
  char v9; // [sp+18h] [bp-ECh]@3
  char v10; // [sp+28h] [bp-DCh]@3

  v3 = 0;
  v7 = 0;
  do
  {
    v4 = &v8[v3];
    v5 = *(&v8[v3++] + a1 - (_DWORD)v8) ^ 0xF0;
    *v4 = v5;
  }
  while ( v3 < 16 );
  sub_10014930((int)&v10, v8, 0x10u);
  sub_10014A10(&v10, &v7, 4);
  sub_10014A20((int)&v10, (int)&v9);
  sub_10014930((int)&v10, &v9, 0x10u);
  sub_10014A10(&v10, a2, 8);
  return sub_10014A20((int)&v10, a3);
}
// 10014A10: using guessed type _DWORD __cdecl sub_10014A10(_DWORD, _DWORD, _DWORD);
// 10011BB0: using guessed type char var_FC[16];

//----- (10011C60) --------------------------------------------------------
unsigned int __cdecl sub_10011C60(int a1, int a2, int a3, unsigned int a4)
{
  unsigned __int8 v4; // sf@1
  unsigned __int8 v5; // of@1
  signed int v6; // edi@2
  int v7; // eax@6
  int v9; // [sp+10h] [bp-138h]@1
  int v10; // [sp+14h] [bp-134h]@1
  u_long v11; // [sp+18h] [bp-130h]@1
  int v12; // [sp+1Ch] [bp-12Ch]@1
  int v13; // [sp+20h] [bp-128h]@1
  int v14; // [sp+24h] [bp-124h]@1
  int v15; // [sp+28h] [bp-120h]@1
  int v16; // [sp+2Ch] [bp-11Ch]@1
  char v17; // [sp+30h] [bp-118h]@7
  char v18; // [sp+40h] [bp-108h]@7
  char v19; // [sp+41h] [bp-107h]@7
  char v20; // [sp+141h] [bp-7h]@7

  v9 = 0;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v16 = 0;
  v5 = __SETO__(*(_BYTE *)(a1 + 2292), 6);
  v4 = (char)(*(_BYTE *)(a1 + 2292) - 6) < 0;
  LOBYTE(v9) = 119;
  LOWORD(v10) = -1;
  if ( v4 ^ v5 )
  {
    v15 = 0;
    HIWORD(v9) = -1;
    v16 = 0;
  }
  else
  {
    HIWORD(v9) = 122;
    v6 = 0;
    do
      *((_BYTE *)&v15 + v6++) = rand();
    while ( v6 < 8 );
  }
  v11 = htonl(*(_DWORD *)(a1 + 1224) + *(_DWORD *)(a1 + 1228));
  v7 = *(_DWORD *)(a2 + 8);
  v12 = 128;
  sub_10011AC0((const void *)(a1 + 2712), &v9, &v15, (const void *)(a3 + v7), a4, (int)&v13);
  if ( *(_BYTE *)(a1 + 2292) >= 6 )
  {
    sub_10011BB0(a1 + 2712, (int)&v11, (int)&v17);
    v18 = 0;
    memset(&v19, 0, 0x100u);
    v20 = 0;
    sub_10014770((int)&v17, 16, (int)&v18);
    sub_100148A0((int)&v18, (int)&v15, 8);
  }
  sub_100119A0((const void *)(a1 + 2712), (int)&v13, (int)&v11);
  return (sub_10011890(a1, a2, (int)&v9) != 0 ? 0x12 : 0) - 17;
}

//----- (10011EE0) --------------------------------------------------------
signed int __cdecl sub_10011EE0(int a1, int a2, int a3)
{
  signed int result; // eax@2
  char v4; // zf@2
  int v5; // [sp+8h] [bp-8h]@1
  int v6; // [sp+Ch] [bp-4h]@1

  v5 = *(_DWORD *)(a1 + 4 * *(_DWORD *)(a1 + 1248) + 1900);
  v6 = 0;
  if ( !sub_10002470(a1, a3, &v5, 4u) || (v4 = sub_10002470(a1, a3, &v6, 4u) == 0, result = 1, v4) )
    result = -17;
  return result;
}

//----- (10011F40) --------------------------------------------------------
signed int __cdecl sub_10011F40(int a1, int a2, int a3)
{
  char v3; // zf@4
  int v4; // ebx@4
  signed int result; // eax@15
  int v6; // eax@16
  int v7; // ecx@16
  int v8; // edx@16
  int v9; // edx@16
  int v10; // ecx@16
  int v11; // [sp+8h] [bp-FCh]@1
  int v12; // [sp+Ch] [bp-F8h]@3
  int v13; // [sp+10h] [bp-F4h]@16
  int v14; // [sp+14h] [bp-F0h]@16
  int v15; // [sp+18h] [bp-ECh]@16
  int v16; // [sp+1Ch] [bp-E8h]@16
  int v17; // [sp+20h] [bp-E4h]@16
  int v18; // [sp+24h] [bp-E0h]@16
  int v19; // [sp+28h] [bp-DCh]@16
  int v20; // [sp+2Ch] [bp-D8h]@16
  int v21; // [sp+30h] [bp-D4h]@16
  int v22; // [sp+34h] [bp-D0h]@16
  int v23; // [sp+38h] [bp-CCh]@16
  int v24; // [sp+3Ch] [bp-C8h]@16
  int v25; // [sp+40h] [bp-C4h]@16
  char v26; // [sp+44h] [bp-C0h]@1
  int v27; // [sp+54h] [bp-B0h]@2
  int v28; // [sp+5Ch] [bp-A8h]@8
  int v29; // [sp+60h] [bp-A4h]@10
  char v30; // [sp+64h] [bp-A0h]@14
  char v31; // [sp+A4h] [bp-60h]@16

  v11 = 80;
  if ( sub_10002EF0(a1, a2, (int)&v26, (int)&v11)
    && sub_10002660(a1, a2, &v27, &v11, 4u)
    && sub_10002660(a1, a2, &v12, &v11, 4u) )
  {
    v4 = v11 + *(_DWORD *)(a2 + 8);
    v11 += v12;
    v3 = (v12 & 0x80000003) == 0;
    if ( (v12 & 0x80000003) < 0 )
      v3 = (((v12 & 0x80000003) - 1) | 0xFFFFFFFC) == -1;
    if ( !v3 )
      v11 += 4 - (v12 & 3);
    if ( !sub_10002660(a1, a2, &v28, &v11, 4u) )
      goto LABEL_28;
    if ( v12 != v28 )
      goto LABEL_28;
    if ( !sub_10002660(a1, a2, &v29, &v11, 4u) )
      goto LABEL_28;
    if ( v27 )
    {
      if ( *(_DWORD *)(a1 + 1896) != v27 )
        *(_DWORD *)(a1 + 1896) = v27;
    }
    if ( sub_10008800(a1, v4, v12, (int)&v30) )
    {
      sub_100087C0(a1, &v31, (int)&v30);
      v6 = sub_10008900(a1, (int)&v31);
      v7 = *(_DWORD *)(a1 + 1248);
      v12 = v6;
      v13 = *(_DWORD *)(a1 + 4 * v7 + 1900);
      v14 = *(_DWORD *)(a1 + 2164);
      v8 = *(_DWORD *)(a1 + 2168);
      v24 = v6;
      v23 = v6;
      v15 = v8;
      v9 = *(_DWORD *)(a1 + 2172);
      v10 = *(_DWORD *)(a1 + 2176);
      v22 = 0;
      v25 = 0;
      v16 = v9;
      v17 = v10;
      v18 = 1;
      v19 = -1;
      v20 = 3;
      v21 = v29;
      if ( sub_10002470(a1, a3, &v13, 4u)
        && sub_10002D20(a1, a3, (int)&v14)
        && sub_10002730(a1, a3, (int)&v18, (int)&v21)
        && sub_10008880(a1, a3, (int)&v31)
        && sub_100023F0(a1, a3, (4 - *(_DWORD *)a3 % 4) % 4)
        && sub_10002470(a1, a3, &v24, 4u)
        && sub_10002470(a1, a3, &v25, 4u) )
        result = 1;
      else
        result = -17;
    }
    else
    {
LABEL_28:
      result = -12;
    }
  }
  else
  {
    result = -11;
  }
  return result;
}

//----- (100121E0) --------------------------------------------------------
signed int __cdecl sub_100121E0(int a1, int a2, int a3)
{
  signed int result; // eax@4
  char v4; // zf@4
  char v5; // [sp+8h] [bp-88h]@1
  char v6; // [sp+9h] [bp-87h]@1
  char v7; // [sp+Ah] [bp-86h]@1
  char v8; // [sp+Bh] [bp-85h]@1
  int v9; // [sp+Ch] [bp-84h]@1
  int v10; // [sp+10h] [bp-80h]@1
  unsigned int v11; // [sp+14h] [bp-7Ch]@1
  int v12; // [sp+18h] [bp-78h]@1
  int v13; // [sp+1Ch] [bp-74h]@1
  int v14; // [sp+20h] [bp-70h]@1
  int v15; // [sp+24h] [bp-6Ch]@1
  int v16; // [sp+28h] [bp-68h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  v16 = 0;
  v10 = 0;
  v15 = 1;
  v9 = 4;
  v11 = 4;
  v13 = -1;
  v12 = 4;
  v14 = 3;
  if ( !sub_10002730(a1, a3, (int)&v12, (int)&v9)
    || !sub_100025E0(a1, a3, &v5, v11)
    || !sub_10002470(a1, a3, &v15, 4u)
    || (v4 = sub_10002470(a1, a3, &v16, 4u) == 0, result = 1, v4) )
    result = -17;
  return result;
}

//----- (100122B0) --------------------------------------------------------
signed int __cdecl sub_100122B0(int a1, int a2, int a3)
{
  int v3; // edx@1
  int v4; // ecx@1
  int v5; // eax@1
  signed int result; // eax@3
  char v7; // zf@3
  int v8; // [sp+8h] [bp-18h]@1
  int v9; // [sp+Ch] [bp-14h]@1
  int v10; // [sp+10h] [bp-10h]@1
  int v11; // [sp+14h] [bp-Ch]@1
  int v12; // [sp+18h] [bp-8h]@1
  int v13; // [sp+1Ch] [bp-4h]@1

  v3 = *(_DWORD *)(a1 + 2168);
  v9 = *(_DWORD *)(a1 + 2164);
  v4 = *(_DWORD *)(a1 + 2172);
  v10 = v3;
  v5 = *(_DWORD *)(a1 + 1248);
  v12 = *(_DWORD *)(a1 + 2176);
  v11 = v4;
  v8 = *(_DWORD *)(a1 + 4 * v5 + 1900);
  v13 = 0;
  if ( !sub_10002470(a1, a3, &v8, 4u)
    || !sub_10002D20(a1, a3, (int)&v9)
    || (v7 = sub_10002470(a1, a3, &v13, 4u) == 0, result = 1, v7) )
    result = -17;
  return result;
}

//----- (10012350) --------------------------------------------------------
int __cdecl sub_10012350(int a1, int a2, int a3)
{
  int v4; // [sp+0h] [bp-4h]@1

  v4 = 0;
  return (sub_10002470(a1, a3, &v4, 4u) != 0 ? 0x12 : 0) - 17;
}

//----- (10012380) --------------------------------------------------------
signed int __cdecl sub_10012380(int a1, int a2)
{
  signed int result; // eax@6
  int v3; // [sp+8h] [bp-18h]@1
  char v4; // [sp+Ch] [bp-14h]@1
  int v5; // [sp+1Ch] [bp-4h]@2

  v3 = 0;
  if ( sub_10002EF0(a1, a2, (int)&v4, (int)&v3) && sub_10002660(a1, a2, &v5, &v3, 4u) )
  {
    if ( v5 )
    {
      if ( *(_DWORD *)(a1 + 1896) != v5 )
        *(_DWORD *)(a1 + 1896) = v5;
    }
    result = 1;
  }
  else
  {
    result = -11;
  }
  return result;
}

//----- (10012400) --------------------------------------------------------
int __thiscall sub_10012400(void *this, int a2, int a3, int a4)
{
  signed int v4; // eax@1
  int v5; // eax@3
  int v6; // ebx@3
  signed int v7; // ecx@4
  int v8; // edi@4
  char *v9; // esi@5
  signed int v10; // ecx@6
  int v11; // edi@6
  char *v12; // esi@7
  signed int v13; // eax@8
  int v14; // ecx@9
  char v15; // dl@9
  int v16; // ecx@9
  char v17; // dl@9
  int v18; // ecx@9
  char v19; // dl@9
  int v20; // ecx@9
  char v21; // dl@9
  int v22; // ecx@9
  unsigned __int8 v23; // sf@10
  unsigned __int8 v24; // of@10
  signed int v25; // eax@11
  signed int v26; // ebx@13
  signed int v27; // ebp@13
  signed int v28; // eax@14
  int v29; // ecx@15
  char v30; // dl@15
  int v31; // ecx@15
  char v32; // dl@15
  int v33; // ecx@15
  char v34; // dl@15
  int v35; // ecx@15
  char v36; // dl@15
  int v37; // ecx@15
  signed int v38; // ecx@16
  signed int v39; // eax@18
  char *v40; // ecx@18
  char v41; // dl@19
  char *v42; // eax@20
  signed int v43; // esi@20
  int v44; // edi@21
  unsigned int v45; // ecx@21
  signed int v46; // eax@22
  char *v47; // ecx@22
  signed int v48; // eax@24
  int v49; // ecx@25
  char v50; // dl@25
  int v51; // ecx@25
  char v52; // dl@25
  int v53; // ecx@25
  signed int v54; // eax@26
  char v55; // dl@27
  char v56; // cl@27
  char v57; // dl@27
  int result; // eax@29
  signed int v59; // edx@29
  int v60; // [sp+0h] [bp-468h]@3
  int v61; // [sp+4h] [bp-464h]@4
  char v62; // [sp+8h] [bp-460h]@2
  char v63; // [sp+9h] [bp-45Fh]@2
  char v64; // [sp+Ah] [bp-45Eh]@2
  char v65[25]; // [sp+Bh] [bp-45Dh]@2
  char v66; // [sp+24h] [bp-444h]@3
  char v67; // [sp+28h] [bp-440h]@13
  char v68; // [sp+47h] [bp-421h]@15
  char v69; // [sp+48h] [bp-420h]@3
  char v70; // [sp+67h] [bp-401h]@25
  char v71; // [sp+68h] [bp-400h]@3
  char v72; // [sp+69h] [bp-3FFh]@23
  char v73; // [sp+6Ah] [bp-3FEh]@23
  char v74[29]; // [sp+6Bh] [bp-3FDh]@23
  char v75; // [sp+88h] [bp-3E0h]@25
  char v76; // [sp+89h] [bp-3DFh]@25
  char v77; // [sp+8Ah] [bp-3DEh]@25
  char v78[24]; // [sp+8Bh] [bp-3DDh]@25
  char v79; // [sp+A3h] [bp-3C5h]@19
  char v80; // [sp+A4h] [bp-3C4h]@19
  char v81; // [sp+A5h] [bp-3C3h]@19
  char v82; // [sp+A6h] [bp-3C2h]@19
  char v83; // [sp+A7h] [bp-3C1h]@19
  char v84; // [sp+A8h] [bp-3C0h]@6
  char v85; // [sp+A9h] [bp-3BFh]@15
  char v86; // [sp+AAh] [bp-3BEh]@15
  char v87; // [sp+ABh] [bp-3BDh]@15
  char v88; // [sp+ACh] [bp-3BCh]@15
  char v89[59]; // [sp+ADh] [bp-3BBh]@15
  char v90; // [sp+E8h] [bp-380h]@13
  char v91; // [sp+E9h] [bp-37Fh]@27
  char v92; // [sp+EAh] [bp-37Eh]@27
  char v93[29]; // [sp+EBh] [bp-37Dh]@27
  char v94; // [sp+108h] [bp-360h]@27
  char v95; // [sp+109h] [bp-35Fh]@27
  char v96; // [sp+10Ah] [bp-35Eh]@27
  char v97[23]; // [sp+10Bh] [bp-35Dh]@27
  char v98; // [sp+122h] [bp-346h]@19
  char v99; // [sp+123h] [bp-345h]@19
  char v100; // [sp+124h] [bp-344h]@19
  char v101; // [sp+125h] [bp-343h]@19
  char v102; // [sp+126h] [bp-342h]@19
  char v103; // [sp+127h] [bp-341h]@19
  char v104[65]; // [sp+128h] [bp-340h]@4
  char v105[767]; // [sp+169h] [bp-2FFh]@3

  v4 = 0;
  do
  {
    *(&v62 + v4) = *((_BYTE *)this + (unsigned __int8)byte_10017148[v4] - 1);
    *(&v63 + v4) = *((_BYTE *)this + (unsigned __int8)byte_10017149[v4] - 1);
    *(&v64 + v4) = *((_BYTE *)this + (unsigned __int8)byte_1001714A[v4] - 1);
    v65[v4] = *((_BYTE *)this + (unsigned __int8)byte_1001714B[v4] - 1);
    v4 += 4;
  }
  while ( v4 < 56 );
  memcpy(&v71, &v62, 0x1Cu);
  v5 = 0;
  memcpy(&v69, &v66, 0x1Cu);
  v60 = 0;
  v6 = (int)v105;
  do
  {
    v61 = (unsigned __int8)byte_10017280[v5];
    v7 = 0;
    v8 = v61 - (_DWORD)v104;
    do
    {
      v9 = &v104[v7++];
      *v9 = *(&v71 + (signed int)&v9[v8] % 28);
    }
    while ( v7 < 28 );
    memcpy(&v71, v104, 0x1Cu);
    v10 = 0;
    v11 = v61 - (_DWORD)&v84;
    do
    {
      v12 = &v84 + v10++;
      *v12 = *(&v69 + (signed int)&v12[v11] % 28);
    }
    while ( v10 < 28 );
    memcpy(&v69, &v84, 0x1Cu);
    memcpy(&v62, &v71, 0x1Cu);
    memcpy(&v66, &v69, 0x1Cu);
    v13 = 0;
    do
    {
      v14 = (unsigned __int8)byte_10017181[v13];
      *(_BYTE *)(v13 + v6 - 1) = *((_BYTE *)&v61 + (unsigned __int8)byte_10017180[v13] + 3);
      v15 = *((_BYTE *)&v61 + v14 + 3);
      v16 = (unsigned __int8)byte_10017182[v13];
      *(_BYTE *)(v13 + v6) = v15;
      v17 = *((_BYTE *)&v61 + v16 + 3);
      v18 = (unsigned __int8)byte_10017183[v13];
      *(_BYTE *)(v13 + v6 + 1) = v17;
      v19 = *((_BYTE *)&v61 + v18 + 3);
      v20 = (unsigned __int8)byte_10017184[v13];
      *(_BYTE *)(v13 + v6 + 2) = v19;
      v21 = *((_BYTE *)&v61 + v20 + 3);
      v22 = (unsigned __int8)byte_10017185[v13];
      *(_BYTE *)(v13 + v6 + 3) = v21;
      *(_BYTE *)(v13 + v6 + 4) = *((_BYTE *)&v61 + v22 + 3);
      v13 += 6;
    }
    while ( v13 < 48 );
    v5 = v60 + 1;
    v6 += 48;
    v24 = __SETO__(v60 + 1, 16);
    v23 = v60++ - 15 < 0;
  }
  while ( v23 ^ v24 );
  v25 = 0;
  do
  {
    *(&v62 + v25) = *(_BYTE *)((unsigned __int8)byte_100171B0[v25] + a3 - 1);
    *(&v63 + v25) = *(_BYTE *)((unsigned __int8)byte_100171B1[v25] + a3 - 1);
    *(&v64 + v25) = *(_BYTE *)((unsigned __int8)byte_100171B2[v25] + a3 - 1);
    v65[v25] = *(_BYTE *)((unsigned __int8)byte_100171B3[v25] + a3 - 1);
    v25 += 4;
  }
  while ( v25 < 64 );
  memcpy(&v69, &v67, 0x20u);
  memcpy(&v90, &v62, 0x20u);
  v26 = 0;
  v27 = 720;
  do
  {
    v28 = 0;
    do
    {
      v29 = (unsigned __int8)byte_100171F1[v28];
      *(&v84 + v28) = *(&v68 + (unsigned __int8)byte_100171F0[v28]);
      v30 = *(&v68 + v29);
      v31 = (unsigned __int8)byte_100171F2[v28];
      *(&v85 + v28) = v30;
      v32 = *(&v68 + v31);
      v33 = (unsigned __int8)byte_100171F3[v28];
      *(&v86 + v28) = v32;
      v34 = *(&v68 + v33);
      v35 = (unsigned __int8)byte_100171F4[v28];
      *(&v87 + v28) = v34;
      v36 = *(&v68 + v35);
      v37 = (unsigned __int8)byte_100171F5[v28];
      *(&v88 + v28) = v36;
      v89[v28] = *(&v68 + v37);
      v28 += 6;
    }
    while ( v28 < 48 );
    v38 = v26;
    if ( !a4 )
      v38 = v27;
    v39 = 0;
    v40 = &v105[v38];
    do
    {
      v41 = *(&v84 + v39) ^ v40[v39 - 1];
      v39 += 6;
      *(&v98 + v39) = v41;
      *(&v99 + v39) = *(&v79 + v39) ^ v40[v39 - 6];
      *(&v100 + v39) = *(&v80 + v39) ^ v40[v39 - 5];
      *(&v101 + v39) = *(&v81 + v39) ^ v40[v39 - 4];
      *(&v102 + v39) = *(&v82 + v39) ^ v40[v39 - 3];
      *(&v103 + v39) = *(&v83 + v39) ^ v40[v39 - 2];
    }
    while ( v39 < 48 );
    memcpy(&v62, v104, 0x30u);
    v43 = 0;
    v42 = &v62;
    do
    {
      v44 = v42[4];
      v45 = (unsigned __int8)*(&byte_10017290[16 * (v43 + (v42[5] | 2 * *v42))]
                             + (v44 | 2 * (v42[3] | 2 * (v42[2] | 2 * v42[1]))));
      *v42 = ((unsigned int)(unsigned __int8)*(&byte_10017290[16 * (v43 + (v42[5] | 2 * *v42))]
                                             + (v44 | 2 * (v42[3] | 2 * (v42[2] | 2 * v42[1])))) >> 3) & 1;
      v42[1] = (v45 >> 2) & 1;
      v42[2] = (v45 >> 1) & 1;
      v42[3] = v45 & 1;
      v43 += 4;
      v42 += 6;
    }
    while ( v43 < 32 );
    v46 = 0;
    v47 = &v63;
    do
    {
      *(&v71 + 4 * v46) = *(v47 - 1);
      *(&v72 + 4 * v46) = *v47;
      *(&v73 + 4 * v46) = v47[1];
      v74[4 * v46++] = v47[2];
      v47 += 6;
    }
    while ( v46 < 8 );
    v48 = 0;
    do
    {
      v49 = (unsigned __int8)byte_10017221[v48];
      *(&v75 + v48) = *(&v70 + (unsigned __int8)byte_10017220[v48]);
      v50 = *(&v70 + v49);
      v51 = (unsigned __int8)byte_10017222[v48];
      *(&v76 + v48) = v50;
      v52 = *(&v70 + v51);
      v53 = (unsigned __int8)byte_10017223[v48];
      *(&v77 + v48) = v52;
      v78[v48] = *(&v70 + v53);
      v48 += 4;
    }
    while ( v48 < 32 );
    v54 = 0;
    do
    {
      v55 = *(&v91 + v54);
      *(&v94 + v54) = *(&v90 + v54) ^ *(&v75 + v54);
      v56 = *(&v92 + v54);
      *(&v95 + v54) = *(&v76 + v54) ^ v55;
      v57 = v93[v54];
      *(&v96 + v54) = *(&v77 + v54) ^ v56;
      v97[v54] = v78[v54] ^ v57;
      v54 += 4;
    }
    while ( v54 < 32 );
    memcpy(&v90, &v69, 0x20u);
    v27 -= 48;
    v26 += 48;
    memcpy(&v69, &v94, 0x20u);
  }
  while ( v27 > -48 );
  result = a2;
  memcpy(&v62, &v69, 0x20u);
  memcpy(&v67, &v90, 0x20u);
  v59 = 16;
  do
  {
    *(_BYTE *)result = *((_BYTE *)&v61 + *((_BYTE *)&unk_10017240 + result - a2) + 3);
    *(_BYTE *)(result + 1) = *((_BYTE *)&v61 + *((_BYTE *)&unk_10017241 + result - a2) + 3);
    *(_BYTE *)(result + 2) = *((_BYTE *)&v61 + *((_BYTE *)&unk_10017242 + result - a2) + 3);
    *(_BYTE *)(result + 3) = *((_BYTE *)&v61 + *(&byte_10017243[result] - a2) + 3);
    result += 4;
    --v59;
  }
  while ( v59 );
  return result;
}
// 10012400: using guessed type char var_45D[25];
// 10012400: using guessed type char var_420[31];
// 10012400: using guessed type char var_2FF[767];
// 10012400: using guessed type char var_340[65];
// 10012400: using guessed type char var_3BB[59];
// 10012400: using guessed type char var_3FD[29];
// 10012400: using guessed type char var_3DD[24];
// 10012400: using guessed type char var_37D[29];
// 10012400: using guessed type char var_35D[23];

//----- (10012970) --------------------------------------------------------
int __usercall sub_10012970<eax>(int result<eax>, int a2<esi>)
{
  char v2; // cl@1
  char v3; // dl@1
  char v4; // cl@1
  char v5; // dl@1
  char v6; // cl@1
  char v7; // dl@1
  char v8; // cl@1

  *(_BYTE *)result = *(_BYTE *)a2 >> 1;
  *(_BYTE *)(result + 1) = (*(_BYTE *)(a2 + 1) >> 2) | ((*(_BYTE *)a2 & 1) << 6);
  *(_BYTE *)(result + 2) = (*(_BYTE *)(a2 + 2) >> 3) | 32 * (*(_BYTE *)(a2 + 1) & 3);
  *(_BYTE *)(result + 3) = (*(_BYTE *)(a2 + 3) >> 4) | 16 * (*(_BYTE *)(a2 + 2) & 7);
  *(_BYTE *)(result + 4) = (*(_BYTE *)(a2 + 4) >> 5) | 8 * (*(_BYTE *)(a2 + 3) & 0xF);
  *(_BYTE *)(result + 5) = (*(_BYTE *)(a2 + 5) >> 6) | 4 * (*(_BYTE *)(a2 + 4) & 0x1F);
  *(_BYTE *)(result + 6) = (*(_BYTE *)(a2 + 6) >> 7) | 2 * (*(_BYTE *)(a2 + 5) & 0x3F);
  *(_BYTE *)(result + 7) = *(_BYTE *)(a2 + 6) & 0x7F;
  v2 = 2 * *(_BYTE *)(result + 1);
  *(_BYTE *)result *= 2;
  v3 = *(_BYTE *)(result + 2);
  *(_BYTE *)(result + 1) = v2;
  v4 = 2 * *(_BYTE *)(result + 3);
  *(_BYTE *)(result + 2) = 2 * v3;
  v5 = *(_BYTE *)(result + 4);
  *(_BYTE *)(result + 3) = v4;
  v6 = 2 * *(_BYTE *)(result + 5);
  *(_BYTE *)(result + 4) = 2 * v5;
  v7 = *(_BYTE *)(result + 6);
  *(_BYTE *)(result + 5) = v6;
  v8 = 2 * *(_BYTE *)(result + 7);
  *(_BYTE *)(result + 6) = 2 * v7;
  *(_BYTE *)(result + 7) = v8;
  return result;
}

//----- (10012A40) --------------------------------------------------------
signed __int64 __usercall sub_10012A40<edx:eax>(int a1<eax>, int a2<ecx>, int a3, int a4)
{
  unsigned int v4; // edx@1
  int v5; // ebx@1
  int v6; // ecx@2
  signed __int64 result; // qax@3
  unsigned int v8; // ecx@3
  unsigned int v9; // edi@3
  int v10; // [sp+10h] [bp-C8h]@1
  char v11; // [sp+17h] [bp-C1h]@4
  char v12[64]; // [sp+18h] [bp-C0h]@1
  char v13[64]; // [sp+58h] [bp-80h]@2
  char v14[64]; // [sp+98h] [bp-40h]@2

  v5 = a1;
  sub_10012970((int)&v10, a2);
  v4 = 0;
  memset(v12, 0, sizeof(v12));
  do
  {
    v6 = 7 - (v4 & 7);
    v13[v4] = ((unsigned __int8)(1 << v6) & *(_BYTE *)((v4 >> 3) + v5)) != 0;
    v14[v4] = ((unsigned __int8)(1 << v6) & *((_BYTE *)&v10 + (v4 >> 3))) != 0;
    ++v4;
  }
  while ( (signed int)v4 < 64 );
  sub_10012400(v14, (int)v12, (int)v13, a4);
  v8 = 0;
  *(_DWORD *)a3 = 0;
  *(_DWORD *)(a3 + 4) = 0;
  v10 = 0;
  v9 = 2;
  result = 12884901889i64;
  do
  {
    if ( *(&v11 + result) )
      *(_BYTE *)(a3 + (v8 >> 3)) |= 1 << (7 - (v8 & 7));
    if ( v12[(_DWORD)result] )
      *(_BYTE *)(((_DWORD)result >> 3) + a3) |= 1 << (7 - (result & 7));
    if ( v12[v9] )
      *(_BYTE *)((v9 >> 3) + a3) |= 1 << (7 - (v9 & 7));
    if ( v12[HIDWORD(result)] )
      *(_BYTE *)((HIDWORD(result) >> 3) + a3) |= 1 << (7 - (BYTE4(result) & 7));
    v8 = v10 + 4;
    LODWORD(result) = result + 4;
    v9 += 4;
    result += 17179869184i64;
    v10 += 4;
  }
  while ( (_DWORD)result < 65 );
  return result;
}
// 10012A40: using guessed type char var_C0[64];
// 10012A40: using guessed type char var_80[64];
// 10012A40: using guessed type char var_40[64];

//----- (10012BA0) --------------------------------------------------------
signed __int64 __cdecl sub_10012BA0(int a1, int a2)
{
  char v3; // [sp+8h] [bp-8h]@1
  char v4; // [sp+9h] [bp-7h]@1
  char v5; // [sp+Ah] [bp-6h]@1
  char v6; // [sp+Bh] [bp-5h]@1
  char v7; // [sp+Ch] [bp-4h]@1
  char v8; // [sp+Dh] [bp-3h]@1
  char v9; // [sp+Eh] [bp-2h]@1
  char v10; // [sp+Fh] [bp-1h]@1

  v3 = 75;
  v4 = 71;
  v5 = 83;
  v6 = 33;
  v7 = 64;
  v8 = 35;
  v9 = 36;
  v10 = 37;
  sub_10012A40((int)&v3, a1, a2, 1);
  return sub_10012A40((int)&v3, a1 + 7, a2 + 8, 1);
}

//----- (10012C00) --------------------------------------------------------
signed __int64 __cdecl sub_10012C00(int a1, int a2, int a3)
{
  sub_10012A40(a2, a1, a3, 1);
  sub_10012A40(a2, a1 + 7, a3 + 8, 1);
  return sub_10012A40(a2, a1 + 14, a3 + 16, 1);
}

//----- (10012C50) --------------------------------------------------------
signed __int64 __cdecl sub_10012C50(int a1, int a2, int a3)
{
  return sub_10012A40(a2, a3, a1, 1);
}

//----- (10012C70) --------------------------------------------------------
int __usercall sub_10012C70<eax>(int a1<eax>, int a2<ecx>, int a3<ebx>, int a4<edi>, int a5)
{
  int result; // eax@1
  int v6; // ST2C_4@1
  int v7; // ST34_4@1
  int v8; // ST3C_4@1
  int v9; // ebp@1
  int v10; // ST44_4@1
  int v11; // esi@1
  int v12; // ST28_4@1
  int v13; // ST30_4@1
  int v14; // ST38_4@1
  int v15; // ST40_4@1
  int v16; // ST48_4@1
  int v17; // ST4C_4@1
  int v18; // ST50_4@1
  int v19; // ST54_4@1
  int v20; // ST58_4@1
  int v21; // ST5C_4@1
  int v22; // ST60_4@1
  int v23; // ST64_4@1
  int v24; // ST0C_4@1
  int v25; // ST24_4@1
  int v26; // ST20_4@1
  unsigned int v27; // edx@1
  unsigned int v28; // ecx@1
  int v29; // edx@1
  unsigned int v30; // eax@1
  int v31; // ecx@1
  unsigned int v32; // eax@1
  int v33; // ecx@1
  unsigned int v34; // eax@1
  int v35; // ecx@1
  unsigned int v36; // eax@1
  int v37; // ecx@1
  unsigned int v38; // eax@1
  int v39; // ecx@1
  unsigned int v40; // eax@1
  int v41; // ecx@1
  unsigned int v42; // eax@1
  int v43; // ecx@1
  unsigned int v44; // eax@1
  int v45; // ecx@1
  unsigned int v46; // eax@1
  int v47; // ecx@1
  unsigned int v48; // eax@1
  int v49; // ecx@1
  unsigned int v50; // eax@1
  int v51; // ecx@1
  unsigned int v52; // eax@1
  int v53; // ecx@1
  unsigned int v54; // eax@1
  int v55; // ecx@1
  unsigned int v56; // eax@1
  unsigned int v57; // eax@1
  int v58; // ST14_4@1
  int v59; // ST18_4@1
  int v60; // ST1C_4@1
  u_long v61; // eax@1
  unsigned int v62; // ecx@1
  unsigned int v63; // ST14_4@1
  int v64; // ST18_4@1
  int v65; // ST1C_4@1
  u_long v66; // eax@1
  unsigned int v67; // ecx@1
  unsigned int v68; // ST14_4@1
  int v69; // ST18_4@1
  int v70; // ST1C_4@1
  u_long v71; // eax@1
  unsigned int v72; // ecx@1
  unsigned int v73; // eax@1
  int v74; // ST14_4@1
  int v75; // ST18_4@1
  int v76; // ST1C_4@1
  u_long v77; // eax@1
  unsigned int v78; // ecx@1
  unsigned int v79; // ST14_4@1
  int v80; // ST18_4@1
  int v81; // ST1C_4@1
  u_long v82; // eax@1
  unsigned int v83; // ecx@1
  unsigned int v84; // ST14_4@1
  int v85; // ST18_4@1
  int v86; // ST1C_4@1
  u_long v87; // eax@1
  unsigned int v88; // ecx@1
  unsigned int v89; // eax@1
  int v90; // ST14_4@1
  int v91; // ST18_4@1
  int v92; // ST1C_4@1
  u_long v93; // eax@1
  unsigned int v94; // ecx@1
  unsigned int v95; // ST14_4@1
  int v96; // ST18_4@1
  int v97; // ST1C_4@1
  u_long v98; // eax@1
  unsigned int v99; // ecx@1
  unsigned int v100; // ST14_4@1
  int v101; // ST18_4@1
  int v102; // ST1C_4@1
  u_long v103; // eax@1
  unsigned int v104; // ecx@1
  unsigned int v105; // eax@1
  int v106; // ST14_4@1
  int v107; // ST18_4@1
  int v108; // ST1C_4@1
  u_long v109; // eax@1
  unsigned int v110; // ecx@1
  unsigned int v111; // ST14_4@1
  int v112; // ST18_4@1
  int v113; // ST1C_4@1
  u_long v114; // eax@1
  unsigned int v115; // ecx@1
  unsigned int v116; // eax@1
  unsigned int v117; // eax@1
  unsigned int v118; // eax@1
  unsigned int v119; // eax@1
  unsigned int v120; // eax@1
  unsigned int v121; // eax@1
  unsigned int v122; // eax@1
  unsigned int v123; // eax@1
  unsigned int v124; // eax@1
  unsigned int v125; // eax@1
  unsigned int v126; // eax@1
  unsigned int v127; // eax@1
  unsigned int v128; // eax@1
  unsigned int v129; // eax@1
  unsigned int v130; // eax@1
  unsigned int v131; // eax@1
  unsigned int v132; // eax@1
  int v133; // [sp+68h] [bp+4h]@1

  v6 = *(_DWORD *)(a1 + 4);
  v7 = *(_DWORD *)(a1 + 12);
  v8 = *(_DWORD *)(a1 + 20);
  v9 = a5;
  v10 = *(_DWORD *)(a1 + 28);
  v11 = a2;
  v12 = *(_DWORD *)a1;
  v13 = *(_DWORD *)(a1 + 8);
  v14 = *(_DWORD *)(a1 + 16);
  v15 = *(_DWORD *)(a1 + 24);
  v16 = *(_DWORD *)(a1 + 32);
  v17 = *(_DWORD *)(a1 + 36);
  v18 = *(_DWORD *)(a1 + 40);
  v19 = *(_DWORD *)(a1 + 44);
  v20 = *(_DWORD *)(a1 + 48);
  v21 = *(_DWORD *)(a1 + 52);
  v133 = *(_DWORD *)a5;
  v22 = *(_DWORD *)(a1 + 56);
  v23 = *(_DWORD *)(a1 + 60);
  v24 = *(_DWORD *)a3;
  v25 = *(_DWORD *)a4;
  v26 = *(_DWORD *)a2;
  v27 = 8 * (v12 + v133 + (v26 & v24 | *(_DWORD *)a4 & ~v26)) | ((v12
                                                                + v133
                                                                + (v26 & v24 | *(_DWORD *)a4 & (unsigned int)~v26)) >> 29);
  *(_DWORD *)v9 = v27;
  v28 = v6 + *(_DWORD *)a4 + (v27 & *(_DWORD *)a2 | *(_DWORD *)a3 & ~v27);
  v29 = (v28 << 7) | (v28 >> 25);
  *(_DWORD *)a4 = v29;
  v30 = v13 + *(_DWORD *)a3 + (v29 & *(_DWORD *)v9 | *(_DWORD *)v11 & ~v29);
  v31 = (v30 << 11) | (v30 >> 21);
  *(_DWORD *)a3 = v31;
  v32 = v7 + *(_DWORD *)v11 + (*(_DWORD *)a4 & v31 | *(_DWORD *)v9 & ~((v30 << 11) | (v30 >> 21)));
  v33 = (v32 >> 13) | (v32 << 19);
  *(_DWORD *)v11 = v33;
  v34 = v14 + *(_DWORD *)v9 + (*(_DWORD *)a3 & v33 | *(_DWORD *)a4 & ~((v32 >> 13) | (v32 << 19)));
  v35 = 8 * v34 | (v34 >> 29);
  *(_DWORD *)v9 = v35;
  v36 = v8 + *(_DWORD *)a4 + (v35 & *(_DWORD *)v11 | *(_DWORD *)a3 & ~(8 * v34 | (v34 >> 29)));
  v37 = (v36 << 7) | (v36 >> 25);
  *(_DWORD *)a4 = v37;
  v38 = v15 + *(_DWORD *)a3 + (v37 & *(_DWORD *)v9 | *(_DWORD *)v11 & ~((v36 << 7) | (v36 >> 25)));
  v39 = (v38 << 11) | (v38 >> 21);
  *(_DWORD *)a3 = v39;
  v40 = v10 + *(_DWORD *)v11 + (*(_DWORD *)a4 & v39 | *(_DWORD *)v9 & ~((v38 << 11) | (v38 >> 21)));
  v41 = (v40 >> 13) | (v40 << 19);
  *(_DWORD *)v11 = v41;
  v42 = v16 + *(_DWORD *)v9 + (*(_DWORD *)a3 & v41 | *(_DWORD *)a4 & ~((v40 >> 13) | (v40 << 19)));
  v43 = 8 * v42 | (v42 >> 29);
  *(_DWORD *)v9 = v43;
  v44 = v17 + *(_DWORD *)a4 + (v43 & *(_DWORD *)v11 | *(_DWORD *)a3 & ~(8 * v42 | (v42 >> 29)));
  v45 = (v44 << 7) | (v44 >> 25);
  *(_DWORD *)a4 = v45;
  v46 = v18 + *(_DWORD *)a3 + (v45 & *(_DWORD *)v9 | *(_DWORD *)v11 & ~((v44 << 7) | (v44 >> 25)));
  v47 = (v46 << 11) | (v46 >> 21);
  *(_DWORD *)a3 = v47;
  v48 = v19 + *(_DWORD *)v11 + (*(_DWORD *)a4 & v47 | *(_DWORD *)v9 & ~((v46 << 11) | (v46 >> 21)));
  v49 = (v48 >> 13) | (v48 << 19);
  *(_DWORD *)v11 = v49;
  v50 = v20 + *(_DWORD *)v9 + (*(_DWORD *)a3 & v49 | *(_DWORD *)a4 & ~((v48 >> 13) | (v48 << 19)));
  v51 = 8 * v50 | (v50 >> 29);
  *(_DWORD *)v9 = v51;
  v52 = v21 + *(_DWORD *)a4 + (*(_DWORD *)v11 & v51 | *(_DWORD *)a3 & ~(8 * v50 | (v50 >> 29)));
  v53 = (v52 << 7) | (v52 >> 25);
  *(_DWORD *)a4 = v53;
  v54 = v22 + *(_DWORD *)a3 + (v53 & *(_DWORD *)v9 | *(_DWORD *)v11 & ~((v52 << 7) | (v52 >> 25)));
  v55 = (v54 << 11) | (v54 >> 21);
  *(_DWORD *)a3 = v55;
  v56 = v23 + *(_DWORD *)v11 + (*(_DWORD *)a4 & v55 | *(_DWORD *)v9 & ~((v54 << 11) | (v54 >> 21)));
  *(_DWORD *)v11 = (v56 >> 13) | (v56 << 19);
  v57 = v12
      + *(_DWORD *)v9
      + (*(_DWORD *)a4 & *(_DWORD *)a3 | ((v56 >> 13) | (v56 << 19)) & (*(_DWORD *)a4 | *(_DWORD *)a3))
      + htonl(0x9979825Au);
  *(_DWORD *)v9 = 8 * v57 | (v57 >> 29);
  v58 = 8 * v57 | (v57 >> 29);
  v59 = *(_DWORD *)a3;
  v60 = *(_DWORD *)v11;
  v61 = htonl(0x9979825Au);
  v62 = 32 * (v14 + *(_DWORD *)a4 + (v59 & v60 | v58 & (v59 | v60)) + v61) | ((v14
                                                                             + *(_DWORD *)a4
                                                                             + (v59 & v60 | v58 & (v59 | v60))
                                                                             + v61) >> 27);
  *(_DWORD *)a4 = v62;
  v63 = v62;
  v64 = *(_DWORD *)v11;
  v65 = *(_DWORD *)v9;
  v66 = htonl(0x9979825Au);
  v67 = ((v16 + *(_DWORD *)a3 + (v64 & v65 | v63 & (v64 | v65)) + v66) << 9) | ((v16
                                                                               + *(_DWORD *)a3
                                                                               + (v64 & v65 | v63 & (v64 | v65))
                                                                               + v66) >> 23);
  *(_DWORD *)a3 = v67;
  v68 = v67;
  v69 = *(_DWORD *)v9;
  v70 = *(_DWORD *)a4;
  v71 = htonl(0x9979825Au);
  v72 = ((v20 + *(_DWORD *)v11 + (v69 & v70 | v68 & (v69 | v70)) + v71) << 13) | ((v20
                                                                                 + *(_DWORD *)v11
                                                                                 + (v69 & v70 | v68 & (v69 | v70))
                                                                                 + v71) >> 19);
  *(_DWORD *)v11 = v72;
  v73 = v6
      + *(_DWORD *)v9
      + (*(_DWORD *)a4 & *(_DWORD *)a3 | v72 & (*(_DWORD *)a4 | *(_DWORD *)a3))
      + htonl(0x9979825Au);
  *(_DWORD *)v9 = 8 * v73 | (v73 >> 29);
  v74 = 8 * v73 | (v73 >> 29);
  v75 = *(_DWORD *)a3;
  v76 = *(_DWORD *)v11;
  v77 = htonl(0x9979825Au);
  v78 = 32 * (v8 + *(_DWORD *)a4 + (v75 & v76 | v74 & (v75 | v76)) + v77) | ((v8
                                                                            + *(_DWORD *)a4
                                                                            + (v75 & v76 | v74 & (v75 | v76))
                                                                            + v77) >> 27);
  *(_DWORD *)a4 = v78;
  v79 = v78;
  v80 = *(_DWORD *)v11;
  v81 = *(_DWORD *)v9;
  v82 = htonl(0x9979825Au);
  v83 = ((v17 + *(_DWORD *)a3 + (v80 & v81 | v79 & (v80 | v81)) + v82) << 9) | ((v17
                                                                               + *(_DWORD *)a3
                                                                               + (v80 & v81 | v79 & (v80 | v81))
                                                                               + v82) >> 23);
  *(_DWORD *)a3 = v83;
  v84 = v83;
  v85 = *(_DWORD *)v9;
  v86 = *(_DWORD *)a4;
  v87 = htonl(0x9979825Au);
  v88 = ((v21 + *(_DWORD *)v11 + (v85 & v86 | v84 & (v85 | v86)) + v87) << 13) | ((v21
                                                                                 + *(_DWORD *)v11
                                                                                 + (v85 & v86 | v84 & (v85 | v86))
                                                                                 + v87) >> 19);
  *(_DWORD *)v11 = v88;
  v89 = v13
      + *(_DWORD *)v9
      + (*(_DWORD *)a4 & *(_DWORD *)a3 | v88 & (*(_DWORD *)a4 | *(_DWORD *)a3))
      + htonl(0x9979825Au);
  *(_DWORD *)v9 = 8 * v89 | (v89 >> 29);
  v90 = 8 * v89 | (v89 >> 29);
  v91 = *(_DWORD *)a3;
  v92 = *(_DWORD *)v11;
  v93 = htonl(0x9979825Au);
  v94 = 32 * (v15 + *(_DWORD *)a4 + (v91 & v92 | v90 & (v91 | v92)) + v93) | ((v15
                                                                             + *(_DWORD *)a4
                                                                             + (v91 & v92 | v90 & (v91 | v92))
                                                                             + v93) >> 27);
  *(_DWORD *)a4 = v94;
  v95 = v94;
  v96 = *(_DWORD *)v11;
  v97 = *(_DWORD *)v9;
  v98 = htonl(0x9979825Au);
  v99 = ((v18 + *(_DWORD *)a3 + (v96 & v97 | v95 & (v96 | v97)) + v98) << 9) | ((v18
                                                                               + *(_DWORD *)a3
                                                                               + (v96 & v97 | v95 & (v96 | v97))
                                                                               + v98) >> 23);
  *(_DWORD *)a3 = v99;
  v100 = v99;
  v101 = *(_DWORD *)v9;
  v102 = *(_DWORD *)a4;
  v103 = htonl(0x9979825Au);
  v104 = ((v22 + *(_DWORD *)v11 + (v101 & v102 | v100 & (v101 | v102)) + v103) << 13) | ((v22
                                                                                        + *(_DWORD *)v11
                                                                                        + (v101 & v102 | v100 & (v101 | v102))
                                                                                        + v103) >> 19);
  *(_DWORD *)v11 = v104;
  v105 = v7
       + *(_DWORD *)v9
       + (*(_DWORD *)a4 & *(_DWORD *)a3 | v104 & (*(_DWORD *)a4 | *(_DWORD *)a3))
       + htonl(0x9979825Au);
  *(_DWORD *)v9 = 8 * v105 | (v105 >> 29);
  v106 = 8 * v105 | (v105 >> 29);
  v107 = *(_DWORD *)a3;
  v108 = *(_DWORD *)v11;
  v109 = htonl(0x9979825Au);
  v110 = 32 * (v10 + *(_DWORD *)a4 + (v107 & v108 | v106 & (v107 | v108)) + v109) | ((v10
                                                                                    + *(_DWORD *)a4
                                                                                    + (v107 & v108 | v106 & (v107 | v108))
                                                                                    + v109) >> 27);
  *(_DWORD *)a4 = v110;
  v111 = v110;
  v112 = *(_DWORD *)v11;
  v113 = *(_DWORD *)v9;
  v114 = htonl(0x9979825Au);
  v115 = ((v19 + *(_DWORD *)a3 + (v112 & v113 | v111 & (v112 | v113)) + v114) << 9) | ((v19
                                                                                      + *(_DWORD *)a3
                                                                                      + (v112 & v113 | v111 & (v112 | v113))
                                                                                      + v114) >> 23);
  *(_DWORD *)a3 = v115;
  v116 = v23
       + *(_DWORD *)v11
       + (*(_DWORD *)v9 & *(_DWORD *)a4 | v115 & (*(_DWORD *)v9 | *(_DWORD *)a4))
       + htonl(0x9979825Au);
  *(_DWORD *)v11 = (v116 << 13) | (v116 >> 19);
  v117 = v12 + *(_DWORD *)v9 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v11) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v9 = 8 * v117 | (v117 >> 29);
  v118 = v16 + *(_DWORD *)a4 + (*(_DWORD *)a3 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a4 = (v118 << 9) | (v118 >> 23);
  v119 = v14 + *(_DWORD *)a3 + (*(_DWORD *)a4 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a3 = (v119 << 11) | (v119 >> 21);
  v120 = v20 + *(_DWORD *)v11 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v11 = (v120 << 15) | (v120 >> 17);
  v121 = v13 + *(_DWORD *)v9 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v11) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v9 = 8 * v121 | (v121 >> 29);
  v122 = v18 + *(_DWORD *)a4 + (*(_DWORD *)a3 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a4 = (v122 << 9) | (v122 >> 23);
  v123 = v15 + *(_DWORD *)a3 + (*(_DWORD *)a4 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a3 = (v123 << 11) | (v123 >> 21);
  v124 = v22 + *(_DWORD *)v11 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v11 = (v124 << 15) | (v124 >> 17);
  v125 = v6 + *(_DWORD *)v9 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v11) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v9 = 8 * v125 | (v125 >> 29);
  v126 = v17 + *(_DWORD *)a4 + (*(_DWORD *)a3 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a4 = (v126 << 9) | (v126 >> 23);
  v127 = v8 + *(_DWORD *)a3 + (*(_DWORD *)a4 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a3 = (v127 << 11) | (v127 >> 21);
  v128 = v21 + *(_DWORD *)v11 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v11 = (v128 << 15) | (v128 >> 17);
  v129 = v7 + *(_DWORD *)v9 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v11) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v9 = 8 * v129 | (v129 >> 29);
  v130 = v19 + *(_DWORD *)a4 + (*(_DWORD *)a3 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a4 = (v130 << 9) | (v130 >> 23);
  v131 = v10 + *(_DWORD *)a3 + (*(_DWORD *)a4 ^ *(_DWORD *)v11 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)a3 = (v131 << 11) | (v131 >> 21);
  v132 = v23 + *(_DWORD *)v11 + (*(_DWORD *)a4 ^ *(_DWORD *)a3 ^ *(_DWORD *)v9) + htonl(0xA1EBD96Eu);
  *(_DWORD *)v11 = (v132 << 15) | (v132 >> 17);
  result = v25;
  *(_DWORD *)v9 += v133;
  *(_DWORD *)v11 += v26;
  *(_DWORD *)a3 += v24;
  *(_DWORD *)a4 += v25;
  return result;
}

//----- (100136E0) --------------------------------------------------------
int __usercall sub_100136E0<eax>(int a1<eax>, int a2<ecx>)
{
  int result; // eax@1
  int v3; // ecx@1
  signed int v4; // esi@1
  int v5; // edx@2
  int v6; // edi@2

  v3 = a2 + 8;
  result = a1 + 2;
  v4 = 4;
  do
  {
    BYTE3(v5) = 0;
    *(_WORD *)((char *)&v5 + 1) = *(_BYTE *)(result + 1);
    v6 = *(_BYTE *)(result - 1);
    v3 += 16;
    result += 16;
    LOBYTE(v5) = *(_BYTE *)(result - 16);
    *(_DWORD *)(v3 - 24) = *(_BYTE *)(result - 18) | ((v6 | (v5 << 8)) << 8);
    BYTE3(v5) = 0;
    *(_WORD *)((char *)&v5 + 1) = *(_BYTE *)(result - 11);
    LOBYTE(v5) = *(_BYTE *)(result - 12);
    *(_DWORD *)(v3 - 20) = *(_BYTE *)(result - 14) | ((*(_BYTE *)(result - 13) | (v5 << 8)) << 8);
    BYTE3(v5) = 0;
    *(_WORD *)((char *)&v5 + 1) = *(_BYTE *)(result - 7);
    LOBYTE(v5) = *(_BYTE *)(result - 8);
    *(_DWORD *)(v3 - 16) = *(_BYTE *)(result - 10) | ((*(_BYTE *)(result - 9) | (v5 << 8)) << 8);
    BYTE3(v5) = 0;
    *(_WORD *)((char *)&v5 + 1) = *(_BYTE *)(result - 3);
    LOBYTE(v5) = *(_BYTE *)(result - 4);
    --v4;
    *(_DWORD *)(v3 - 12) = *(_BYTE *)(result - 6) | ((*(_BYTE *)(result - 5) | (v5 << 8)) << 8);
  }
  while ( v4 );
  return result;
}

//----- (10013770) --------------------------------------------------------
int __cdecl sub_10013770(int a1, int a2, signed int a3)
{
  unsigned int v3; // ebx@1
  unsigned int v4; // esi@2
  unsigned int v5; // eax@5
  unsigned int v6; // edx@5
  unsigned int v7; // ecx@5
  int v8; // esi@5
  int result; // eax@8
  unsigned int v10; // ecx@8
  unsigned int v11; // ecx@8
  unsigned int v12; // ecx@8
  unsigned int v13; // ecx@8
  u_long v14; // [sp+Ch] [bp-D4h]@1
  u_long v15; // [sp+10h] [bp-D0h]@1
  u_long v16; // [sp+14h] [bp-CCh]@1
  u_long v17; // [sp+18h] [bp-C8h]@1
  unsigned int v18; // [sp+1Ch] [bp-C4h]@1
  char v19; // [sp+20h] [bp-C0h]@3
  char v20[56]; // [sp+60h] [bp-80h]@5
  char v21; // [sp+98h] [bp-48h]@6
  char v22; // [sp+99h] [bp-47h]@6
  char v23; // [sp+9Ah] [bp-46h]@6
  char v24; // [sp+9Bh] [bp-45h]@6
  char v25; // [sp+A0h] [bp-40h]@7
  char v26; // [sp+D8h] [bp-8h]@7
  char v27; // [sp+D9h] [bp-7h]@7
  char v28; // [sp+DAh] [bp-6h]@7
  char v29; // [sp+DBh] [bp-5h]@7
  unsigned int v30; // [sp+F0h] [bp+10h]@2

  v3 = a3;
  v18 = 8 * a3;
  v15 = htonl(19088743u);
  v17 = htonl(0x89ABCDEFu);
  v16 = htonl(0xFEDCBA98u);
  v14 = htonl(0x76543210u);
  if ( a3 > 64 )
  {
    v4 = ((unsigned int)(a3 - 65) >> 6) + 1;
    v30 = -64 * (((unsigned int)(a3 - 65) >> 6) + 1) + a3;
    do
    {
      sub_100136E0(a2, (int)&v19);
      sub_10012C70((int)&v19, (int)&v17, (int)&v16, (int)&v14, (int)&v15);
      --v4;
      a2 += 64;
    }
    while ( v4 );
    v3 = v30;
  }
  v8 = a2;
  memset(v20, 0, 0x80u);
  memcpy(v20, (const void *)a2, 4 * (v3 >> 2));
  v5 = v18;
  memcpy(&v20[4 * (v3 >> 2)], (const void *)(v8 + 4 * (v3 >> 2)), v3 & 3);
  v6 = v5 >> 16;
  v7 = v5 >> 8;
  v20[v3] = -128;
  if ( (signed int)v3 > 55 )
  {
    v26 = v5;
    v27 = v7;
    v29 = v5 >> 24;
    v28 = v6;
    sub_100136E0((int)v20, (int)&v19);
    sub_10012C70((int)&v19, (int)&v17, (int)&v16, (int)&v14, (int)&v15);
    sub_100136E0((int)&v25, (int)&v19);
    sub_10012C70((int)&v19, (int)&v17, (int)&v16, (int)&v14, (int)&v15);
  }
  else
  {
    v21 = v5;
    v22 = v7;
    v24 = v5 >> 24;
    v23 = v6;
    sub_100136E0((int)v20, (int)&v19);
    sub_10012C70((int)&v19, (int)&v17, (int)&v16, (int)&v14, (int)&v15);
  }
  result = a1;
  v10 = v15;
  *(_BYTE *)a1 = v15;
  *(_BYTE *)(a1 + 1) = BYTE1(v10);
  *(_BYTE *)(a1 + 2) = v10 >> 16;
  *(_BYTE *)(a1 + 3) = v10 >> 24;
  v11 = v17;
  *(_BYTE *)(a1 + 4) = v17;
  *(_BYTE *)(a1 + 5) = BYTE1(v11);
  *(_BYTE *)(a1 + 6) = v11 >> 16;
  *(_BYTE *)(a1 + 7) = v11 >> 24;
  v12 = v16;
  *(_BYTE *)(a1 + 9) = BYTE1(v16);
  *(_BYTE *)(a1 + 8) = v12;
  *(_BYTE *)(a1 + 10) = v12 >> 16;
  *(_BYTE *)(a1 + 11) = v12 >> 24;
  v13 = v14;
  *(_BYTE *)(a1 + 13) = BYTE1(v14);
  *(_BYTE *)(a1 + 12) = v13;
  *(_BYTE *)(a1 + 14) = v13 >> 16;
  *(_BYTE *)(a1 + 15) = v13 >> 24;
  return result;
}
// 10013770: using guessed type char var_80[56];

//----- (10013990) --------------------------------------------------------
u_long __cdecl sub_10013990(int a1)
{
  u_long result; // eax@1

  *(_DWORD *)(a1 + 20) = 0;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)a1 = htonl(19088743u);
  *(_DWORD *)(a1 + 4) = htonl(0x89ABCDEFu);
  *(_DWORD *)(a1 + 8) = htonl(0xFEDCBA98u);
  result = htonl(0x76543210u);
  *(_DWORD *)(a1 + 12) = result;
  return result;
}

//----- (100139D0) --------------------------------------------------------
int __cdecl sub_100139D0(int a1, int a2)
{
  int v2; // eax@1
  int v3; // ebx@1
  int v4; // ebp@1
  int v5; // edi@1
  int *v6; // esi@1
  int v7; // ecx@2
  int v8; // edx@2
  int result; // eax@3
  u_long v10; // eax@3
  unsigned int v11; // ST1C_4@3
  int v12; // edi@3
  u_long v13; // eax@3
  unsigned int v14; // ebp@3
  int v15; // ebx@3
  u_long v16; // eax@3
  int v17; // ecx@3
  unsigned int v18; // ST18_4@3
  u_long v19; // eax@3
  unsigned int v20; // eax@3
  int v21; // ebp@3
  u_long v22; // eax@3
  unsigned int v23; // edi@3
  int v24; // ST1C_4@3
  u_long v25; // eax@3
  unsigned int v26; // ebx@3
  int v27; // edi@3
  u_long v28; // eax@3
  int v29; // ecx@3
  unsigned int v30; // ebx@3
  u_long v31; // eax@3
  unsigned int v32; // ebp@3
  int v33; // ST14_4@3
  u_long v34; // eax@3
  int v35; // edx@3
  unsigned int v36; // ebp@3
  u_long v37; // eax@3
  unsigned int v38; // edi@3
  int v39; // ST20_4@3
  u_long v40; // eax@3
  unsigned int v41; // ebx@3
  int v42; // edi@3
  u_long v43; // eax@3
  int v44; // ecx@3
  unsigned int v45; // ST14_4@3
  u_long v46; // eax@3
  unsigned int v47; // ebp@3
  int v48; // ebx@3
  u_long v49; // eax@3
  int v50; // edx@3
  unsigned int v51; // ebp@3
  u_long v52; // eax@3
  int v53; // ecx@3
  unsigned int v54; // eax@3
  unsigned int v55; // edi@3
  unsigned int v56; // ST18_4@3
  unsigned int v57; // ST24_4@3
  u_long v58; // eax@3
  unsigned int v59; // eax@3
  int v60; // edi@3
  u_long v61; // eax@3
  unsigned int v62; // ebx@3
  int v63; // ST1C_4@3
  u_long v64; // eax@3
  unsigned int v65; // ebp@3
  int v66; // ebx@3
  u_long v67; // eax@3
  int v68; // ecx@3
  unsigned int v69; // ebp@3
  u_long v70; // eax@3
  unsigned int v71; // edi@3
  int v72; // ST14_4@3
  u_long v73; // eax@3
  int v74; // edx@3
  unsigned int v75; // edi@3
  u_long v76; // eax@3
  unsigned int v77; // ebx@3
  int v78; // ST20_4@3
  u_long v79; // eax@3
  int v80; // edx@3
  unsigned int v81; // ebx@3
  u_long v82; // eax@3
  unsigned int v83; // eax@3
  int v84; // ST14_4@3
  u_long v85; // eax@3
  int v86; // ecx@3
  unsigned int v87; // ebp@3
  u_long v88; // eax@3
  int v89; // edx@3
  unsigned int v90; // edi@3
  u_long v91; // eax@3
  unsigned int v92; // ebx@3
  int v93; // ST18_4@3
  u_long v94; // eax@3
  int v95; // edx@3
  unsigned int v96; // ebx@3
  u_long v97; // eax@3
  unsigned int v98; // ebp@3
  int v99; // ST1C_4@3
  u_long v100; // eax@3
  unsigned int v101; // edi@3
  int v102; // ebp@3
  u_long v103; // eax@3
  int v104; // ecx@3
  unsigned int v105; // edi@3
  u_long v106; // eax@3
  unsigned int v107; // ebx@3
  int v108; // ST14_4@3
  u_long v109; // eax@3
  unsigned int v110; // ebx@3
  u_long v111; // eax@3
  unsigned int v112; // ebp@3
  int v113; // ST20_4@3
  u_long v114; // eax@3
  unsigned int v115; // ST18_4@3
  u_long v116; // eax@3
  unsigned int v117; // edi@3
  u_long v118; // eax@3
  unsigned int v119; // ebp@3
  u_long v120; // eax@3
  unsigned int v121; // ST20_4@3
  u_long v122; // eax@3
  unsigned int v123; // eax@3
  int v124; // ebx@3
  unsigned int v125; // ST18_4@3
  int v126; // ST1C_4@3
  u_long v127; // eax@3
  unsigned int v128; // ebx@3
  u_long v129; // eax@3
  unsigned int v130; // edi@3
  u_long v131; // eax@3
  unsigned int v132; // ST20_4@3
  u_long v133; // eax@3
  unsigned int v134; // eax@3
  int v135; // ebp@3
  unsigned int v136; // ST18_4@3
  int v137; // ST1C_4@3
  u_long v138; // eax@3
  unsigned int v139; // ebp@3
  u_long v140; // eax@3
  unsigned int v141; // ebx@3
  u_long v142; // eax@3
  unsigned int v143; // edi@3
  u_long v144; // eax@3
  unsigned int v145; // eax@3
  int v146; // ST18_4@3
  u_long v147; // eax@3
  unsigned int v148; // ST14_4@3
  u_long v149; // eax@3
  unsigned int v150; // ebx@3
  int v151; // ebp@3
  u_long v152; // eax@3
  unsigned int v153; // edi@3
  int v154; // ebx@3
  u_long v155; // eax@3
  int v156; // edx@3
  unsigned int v157; // edi@3
  u_long v158; // eax@3
  unsigned int v159; // eax@3
  int v160; // ST14_4@3
  u_long v161; // eax@3
  unsigned int v162; // ebp@3
  int v163; // ST1C_4@3
  u_long v164; // eax@3
  unsigned int v165; // ebx@3
  int v166; // ebp@3
  u_long v167; // eax@3
  unsigned int v168; // edi@3
  int v169; // ebx@3
  u_long v170; // eax@3
  int v171; // edx@3
  unsigned int v172; // edi@3
  u_long v173; // eax@3
  unsigned int v174; // eax@3
  int v175; // ST1C_4@3
  u_long v176; // eax@3
  unsigned int v177; // ebp@3
  int v178; // ST20_4@3
  u_long v179; // eax@3
  unsigned int v180; // ebx@3
  int v181; // ebp@3
  u_long v182; // eax@3
  unsigned int v183; // edi@3
  int v184; // ebx@3
  u_long v185; // eax@3
  int v186; // edx@3
  unsigned int v187; // edi@3
  u_long v188; // eax@3
  unsigned int v189; // eax@3
  int v190; // ST20_4@3
  u_long v191; // eax@3
  unsigned int v192; // ebp@3
  int v193; // ST18_4@3
  u_long v194; // eax@3
  int v195; // esi@3
  unsigned int v196; // ebx@3
  int v197; // esi@3
  int v198; // edi@3
  int v199; // esi@3
  int v200; // ecx@3
  int v201; // [sp+10h] [bp-54h]@1
  int v202; // [sp+14h] [bp-50h]@1
  signed int v203; // [sp+1Ch] [bp-48h]@1
  int v204; // [sp+24h] [bp-40h]@1
  int v205; // [sp+28h] [bp-3Ch]@3
  int v206; // [sp+2Ch] [bp-38h]@3
  int v207; // [sp+30h] [bp-34h]@3
  int v208; // [sp+34h] [bp-30h]@3
  int v209; // [sp+38h] [bp-2Ch]@3
  int v210; // [sp+3Ch] [bp-28h]@3
  int v211; // [sp+40h] [bp-24h]@3
  int v212; // [sp+44h] [bp-20h]@3
  int v213; // [sp+48h] [bp-1Ch]@3
  int v214; // [sp+4Ch] [bp-18h]@3
  int v215; // [sp+50h] [bp-14h]@3
  int v216; // [sp+54h] [bp-10h]@3
  int v217; // [sp+58h] [bp-Ch]@3
  int v218; // [sp+5Ch] [bp-8h]@3
  int v219; // [sp+60h] [bp-4h]@3

  v3 = *(_DWORD *)(a1 + 4);
  v4 = *(_DWORD *)(a1 + 12);
  v5 = *(_DWORD *)a1;
  v201 = *(_DWORD *)(a1 + 4);
  v202 = *(_DWORD *)(a1 + 8);
  v2 = a2 + 2;
  v6 = &v204;
  v203 = 16;
  do
  {
    v7 = *(_BYTE *)(v2 - 1);
    BYTE3(v8) = 0;
    *(_WORD *)((char *)&v8 + 1) = *(_BYTE *)(v2 + 1);
    ++v6;
    v2 += 4;
    LOBYTE(v8) = *(_BYTE *)(v2 - 4);
    *(v6 - 1) = *(_BYTE *)(v2 - 6) | ((v7 | (v8 << 8)) << 8);
    --v203;
  }
  while ( v203 );
  v10 = htonl(2024041175u);
  v11 = v204 + v10 + (v3 & v202 | v4 & ~v3) + v5;
  v12 = v3 + ((v11 << 7) | (v11 >> 25));
  v13 = htonl(0x56B7C7E8u);
  v14 = v205 + v13 + (v12 & v3 | v202 & ~v12) + v4;
  v15 = v12 + ((v14 << 12) | (v14 >> 20));
  v16 = htonl(0xDB702024u);
  v17 = v206 + v16 + (v12 & v15 | v201 & ~v15);
  v18 = v15 + (((v17 + v202) << 17) | ((unsigned int)(v17 + v202) >> 15));
  v19 = htonl(0xEECEBDC1u);
  v20 = v207 + v19 + (v18 & v15 | v12 & ~v18) + v201;
  v21 = v18 + ((v20 >> 10) | (v20 << 22));
  v22 = htonl(0xAF0F7CF5u);
  v23 = v208 + v22 + (v21 & v18 | v15 & ~v21) + v12;
  v24 = v21 + ((v23 << 7) | (v23 >> 25));
  v25 = htonl(0x2AC68747u);
  v26 = v209 + v25 + (v24 & v21 | v18 & ~v24) + v15;
  v27 = v24 + ((v26 << 12) | (v26 >> 20));
  v28 = htonl(0x134630A8u);
  v29 = v210 + v28 + (v24 & v27 | v21 & ~v27);
  v30 = v27 + (((v29 + v18) << 17) | ((v29 + v18) >> 15));
  v31 = htonl(0x19546FDu);
  v32 = v211 + v31 + (v30 & v27 | v24 & ~v30) + v21;
  v33 = v30 + ((v32 >> 10) | (v32 << 22));
  v34 = htonl(0xD8988069u);
  v35 = v212 + v34 + (v33 & v30 | v27 & ~v33);
  v36 = v33 + (((v35 + v24) << 7) | ((unsigned int)(v35 + v24) >> 25));
  v37 = htonl(0xAFF7448Bu);
  v38 = v213 + v37 + (v36 & v33 | v30 & ~v36) + v27;
  v39 = v36 + ((v38 << 12) | (v38 >> 20));
  v40 = htonl(0xB15BFFFFu);
  v41 = v214 + v40 + (v36 & v39 | v33 & ~v39) + v30;
  v42 = v39 + ((v41 << 17) | (v41 >> 15));
  v43 = htonl(0xBED75C89u);
  v44 = v215 + v43 + (v42 & v39 | v36 & ~v42);
  v45 = v42 + (((unsigned int)(v44 + v33) >> 10) | ((v44 + v33) << 22));
  v46 = htonl(0x2211906Bu);
  v47 = v216 + v46 + (v45 & v42 | v39 & ~v45) + v36;
  v48 = v45 + ((v47 << 7) | (v47 >> 25));
  v49 = htonl(0x937198FDu);
  v50 = v217 + v49 + (v48 & v45 | v42 & ~v48);
  v51 = v48 + (((v50 + v39) << 12) | ((unsigned int)(v50 + v39) >> 20));
  v52 = htonl(0x8E4379A6u);
  v53 = v218 + v52 + (v48 & v51 | v45 & ~v51);
  v54 = v51 + (((v53 + v42) << 17) | ((unsigned int)(v53 + v42) >> 15));
  v55 = ~v54;
  v56 = v54;
  v57 = ~v54;
  v58 = htonl(0x2108B449u);
  v59 = v219 + v58 + (v56 & v51 | v48 & v55) + v45;
  v60 = v56 + ((v59 >> 10) | (v59 << 22));
  v61 = htonl(0x62251EF6u);
  v62 = v205 + v61 + (v60 & v51 | v56 & ~v51) + v48;
  v63 = v60 + (32 * v62 | (v62 >> 27));
  v64 = htonl(0x40B340C0u);
  v65 = v210 + v64 + (v63 & v56 | v60 & v57) + v51;
  v66 = v63 + ((v65 << 9) | (v65 >> 23));
  v67 = htonl(0x515A5E26u);
  v68 = v215 + v67 + (v60 & v66 | v63 & ~v60);
  v69 = v66 + (((v68 + v56) << 14) | ((v68 + v56) >> 18));
  v70 = htonl(0xAAC7B6E9u);
  v71 = v204 + v70 + (v63 & v69 | v66 & ~v63) + v60;
  v72 = v69 + ((v71 >> 12) | (v71 << 20));
  v73 = htonl(0x5D102FD6u);
  v74 = v209 + v73 + (v72 & v66 | v69 & ~v66);
  v75 = v72 + (32 * (v74 + v63) | ((unsigned int)(v74 + v63) >> 27));
  v76 = htonl(0x53144402u);
  v77 = v214 + v76 + (v75 & v69 | v72 & ~v69) + v66;
  v78 = v75 + ((v77 << 9) | (v77 >> 23));
  v79 = htonl(0x81E6A1D8u);
  v80 = v219 + v79 + (v72 & v78 | v75 & ~v72);
  v81 = v78 + (((v80 + v69) << 14) | ((v80 + v69) >> 18));
  v82 = htonl(0xC8FBD3E7u);
  v83 = v208 + v82 + (v75 & v81 | v78 & ~v75) + v72;
  v84 = v81 + ((v83 >> 12) | (v83 << 20));
  v85 = htonl(0xE6CDE121u);
  v86 = v213 + v85 + (v84 & v78 | v81 & ~v78);
  v87 = v84 + (32 * (v86 + v75) | ((v86 + v75) >> 27));
  v88 = htonl(0xD60737C3u);
  v89 = v218 + v88 + (v87 & v81 | v84 & ~v81);
  v90 = v87 + (((v89 + v78) << 9) | ((unsigned int)(v89 + v78) >> 23));
  v91 = htonl(0x870DD5F4u);
  v92 = v207 + v91 + (v84 & v90 | v87 & ~v84) + v81;
  v93 = v90 + ((v92 << 14) | (v92 >> 18));
  v94 = htonl(0xED145A45u);
  v95 = v212 + v94 + (v87 & v93 | v90 & ~v87);
  v96 = v93 + (((unsigned int)(v95 + v84) >> 12) | ((v95 + v84) << 20));
  v97 = htonl(0x5E9E3A9u);
  v98 = v217 + v97 + (v96 & v90 | v93 & ~v90) + v87;
  v99 = v96 + (32 * v98 | (v98 >> 27));
  v100 = htonl(0xF8A3EFFCu);
  v101 = v206 + v100 + (v99 & v93 | v96 & ~v93) + v90;
  v102 = v99 + ((v101 << 9) | (v101 >> 23));
  v103 = htonl(0xD9026F67u);
  v104 = v211 + v103 + (v96 & v102 | v99 & ~v96);
  v105 = v102 + (((v104 + v93) << 14) | ((unsigned int)(v104 + v93) >> 18));
  v106 = htonl(0x8A4C2A8Du);
  v107 = v216 + v106 + (v99 & v105 | v102 & ~v99) + v96;
  v108 = v105 + ((v107 >> 12) | (v107 << 20));
  v109 = htonl(0x4239FAFFu);
  v110 = v108 + (16 * (v209 + v109 + (v108 ^ v105 ^ v102) + v99) | ((v209 + v109 + (v108 ^ v105 ^ v102) + v99) >> 28));
  v111 = htonl(0x81F67187u);
  v112 = v212 + v111 + (v110 ^ v108 ^ v105) + v102;
  v113 = v110 + ((v112 << 11) | (v112 >> 21));
  v114 = htonl(0x22619D6Du);
  v115 = v113
       + (((v215 + v114 + (v110 ^ v108 ^ v113) + v105) << 16) | ((v215 + v114 + (v110 ^ v108 ^ v113) + v105) >> 16));
  v116 = htonl(0xC38E5FDu);
  v117 = v115
       + (((v218 + v116 + (v110 ^ v115 ^ v113) + v108) >> 9) | ((v218 + v116 + (v110 ^ v115 ^ v113) + v108) << 23));
  v118 = htonl(0x44EABEA4u);
  v119 = v117 + (16 * (v205 + v118 + (v117 ^ v115 ^ v113) + v110) | ((v205 + v118 + (v117 ^ v115 ^ v113) + v110) >> 28));
  v120 = htonl(0xA9CFDE4Bu);
  v121 = v119
       + (((v208 + v120 + (v119 ^ v117 ^ v115) + v113) << 11) | ((v208 + v120 + (v119 ^ v117 ^ v115) + v113) >> 21));
  v122 = htonl(0x604BBBF6u);
  v123 = v121
       + (((v211 + v122 + (v119 ^ v117 ^ v121) + v115) << 16) | ((v211 + v122 + (v119 ^ v117 ^ v121) + v115) >> 16));
  v124 = v123 ^ v121;
  v125 = v123;
  v126 = v124;
  v127 = htonl(0x70BCBFBEu);
  v128 = v125 + (((v214 + v127 + (v119 ^ v124) + v117) >> 9) | ((v214 + v127 + (v119 ^ v124) + v117) << 23));
  v129 = htonl(0xC67E9B28u);
  v130 = v128 + (16 * (v217 + v129 + (v128 ^ v126) + v119) | ((v217 + v129 + (v128 ^ v126) + v119) >> 28));
  v131 = htonl(0xFA27A1EAu);
  v132 = v130
       + (((v204 + v131 + (v130 ^ v128 ^ v125) + v121) << 11) | ((v204 + v131 + (v130 ^ v128 ^ v125) + v121) >> 21));
  v133 = htonl(0x8530EFD4u);
  v134 = v132
       + (((v207 + v133 + (v130 ^ v128 ^ v132) + v125) << 16) | ((v207 + v133 + (v130 ^ v128 ^ v132) + v125) >> 16));
  v135 = v134 ^ v132;
  v136 = v134;
  v137 = v135;
  v138 = htonl(0x51D8804u);
  v139 = v136 + (((v210 + v138 + (v130 ^ v135) + v128) >> 9) | ((v210 + v138 + (v130 ^ v135) + v128) << 23));
  v140 = htonl(0x39D0D4D9u);
  v141 = v139 + (16 * (v213 + v140 + (v139 ^ v137) + v130) | ((v213 + v140 + (v139 ^ v137) + v130) >> 28));
  v142 = htonl(0xE599DBE6u);
  v143 = v141
       + (((v216 + v142 + (v141 ^ v139 ^ v136) + v132) << 11) | ((v216 + v142 + (v141 ^ v139 ^ v136) + v132) >> 21));
  v144 = htonl(0xF87CA21Fu);
  v145 = v219 + v144 + (v141 ^ v139 ^ v143) + v136;
  v146 = v143 + ((v145 << 16) | (v145 >> 16));
  v147 = htonl(0x6556ACC4u);
  v148 = v146
       + (((v206 + v147 + (v141 ^ v146 ^ v143) + v139) >> 9) | ((v206 + v147 + (v141 ^ v146 ^ v143) + v139) << 23));
  v149 = htonl(0x442229F4u);
  v150 = v204 + v149 + (v146 ^ (v148 | ~v143)) + v141;
  v151 = v148 + ((v150 << 6) | (v150 >> 26));
  v152 = htonl(0x97FF2A43u);
  v153 = v211 + v152 + (v148 ^ (v151 | ~v146)) + v143;
  v154 = v151 + ((v153 << 10) | (v153 >> 22));
  v155 = htonl(0xA72394ABu);
  v156 = v218 + v155 + (v151 ^ (v154 | ~v148));
  v157 = v154 + (((v156 + v146) << 15) | ((unsigned int)(v156 + v146) >> 17));
  v158 = htonl(0x39A093FCu);
  v159 = v209 + v158 + (v154 ^ (v157 | ~v151)) + v148;
  v160 = v157 + ((v159 >> 11) | (v159 << 21));
  v161 = htonl(0xC3595B65u);
  v162 = v216 + v161 + (v157 ^ (v160 | ~v154)) + v151;
  v163 = v160 + ((v162 << 6) | (v162 >> 26));
  v164 = htonl(0x92CC0C8Fu);
  v165 = v207 + v164 + (v160 ^ (v163 | ~v157)) + v154;
  v166 = v163 + ((v165 << 10) | (v165 >> 22));
  v167 = htonl(0x7DF4EFFFu);
  v168 = v214 + v167 + (v163 ^ (v166 | ~v160)) + v157;
  v169 = v166 + ((v168 << 15) | (v168 >> 17));
  v170 = htonl(0xD15D8485u);
  v171 = v205 + v170 + (v166 ^ (v169 | ~v163));
  v172 = v169 + (((unsigned int)(v171 + v160) >> 11) | ((v171 + v160) << 21));
  v173 = htonl(0x4F7EA86Fu);
  v174 = v212 + v173 + (v169 ^ (v172 | ~v166)) + v163;
  v175 = v172 + ((v174 << 6) | (v174 >> 26));
  v176 = htonl(0xE0E62CFEu);
  v177 = v219 + v176 + (v172 ^ (v175 | ~v169)) + v166;
  v178 = v175 + ((v177 << 10) | (v177 >> 22));
  v179 = htonl(0x144301A3u);
  v180 = v210 + v179 + (v175 ^ (v178 | ~v172)) + v169;
  v181 = v178 + ((v180 << 15) | (v180 >> 17));
  v182 = htonl(0xA111084Eu);
  v183 = v217 + v182 + (v178 ^ (v181 | ~v175)) + v172;
  v184 = v181 + ((v183 >> 11) | (v183 << 21));
  v185 = htonl(0x827E53F7u);
  v186 = v208 + v185 + (v181 ^ (v184 | ~v178));
  v187 = v184 + (((v186 + v175) << 6) | ((unsigned int)(v186 + v175) >> 26));
  v188 = htonl(0x35F23ABDu);
  v189 = v215 + v188 + (v184 ^ (v187 | ~v181)) + v178;
  v190 = v187 + ((v189 << 10) | (v189 >> 22));
  v191 = htonl(0xBBD2D72Au);
  v192 = v206 + v191 + (v187 ^ (v190 | ~v184)) + v181;
  v193 = v190 + ((v192 << 15) | (v192 >> 17));
  v194 = htonl(0x91D386EBu);
  v195 = v213 + v194 + (v190 ^ (v193 | ~v187));
  result = a1;
  v196 = v195 + v184;
  v197 = v187 + *(_DWORD *)a1;
  v198 = *(_DWORD *)(a1 + 4);
  *(_DWORD *)a1 = v197;
  v199 = v193 + *(_DWORD *)(a1 + 8);
  v200 = *(_DWORD *)(a1 + 12);
  *(_DWORD *)(a1 + 4) = v193 + ((v196 >> 11) | (v196 << 21)) + v198;
  *(_DWORD *)(a1 + 8) = v199;
  *(_DWORD *)(a1 + 12) = v190 + v200;
  return result;
}

//----- (100145B0) --------------------------------------------------------
unsigned int __cdecl sub_100145B0(int a1, const void *a2, unsigned int a3)
{
  int v3; // eax@1
  unsigned int v4; // ecx@1
  int v5; // edx@1
  unsigned int v6; // ebp@3
  unsigned int i; // edi@4
  int v8; // esi@4
  unsigned int result; // eax@8
  unsigned int v10; // ecx@8
  const void *v11; // esi@8
  void *v12; // edi@8

  v4 = a3;
  v5 = *(_DWORD *)(a1 + 16) + 8 * a3;
  v3 = (*(_DWORD *)(a1 + 16) >> 3) & 0x3F;
  *(_DWORD *)(a1 + 16) = v5;
  if ( v5 < 8 * a3 )
    ++*(_DWORD *)(a1 + 20);
  v6 = 64 - v3;
  *(_DWORD *)(a1 + 20) += a3 >> 29;
  if ( a3 < 64 - v3 )
  {
    i = 0;
  }
  else
  {
    memcpy((void *)(v3 + a1 + 24), a2, v6);
    sub_100139D0(a1, a1 + 24);
    v8 = v6 + 63;
    for ( i = v6; v8 < a3; i += 64 )
    {
      sub_100139D0(a1, (int)(a2 + v8 - 63));
      v8 += 64;
    }
    v4 = a3;
    v3 = 0;
  }
  v10 = v4 - i;
  v11 = (char *)a2 + i;
  v12 = (void *)(v3 + a1 + 24);
  result = v10;
  memcpy(v12, v11, v10);
  return result;
}

//----- (10014670) --------------------------------------------------------
u_long __cdecl sub_10014670(int a1, int a2)
{
  int v2; // eax@1
  unsigned int v3; // ecx@1
  int v4; // esi@1
  int v5; // eax@3
  signed int v6; // edx@3
  int v7; // edx@5
  int i; // ecx@5
  char *v9; // edi@5
  int v10; // eax@8
  int v11; // ecx@8
  signed int v12; // edi@8
  u_long result; // eax@10
  char v14; // [sp+8h] [bp-48h]@2
  char v15; // [sp+9h] [bp-47h]@2
  char v16; // [sp+Ah] [bp-46h]@2
  char v17[5]; // [sp+Bh] [bp-45h]@2
  char v18[64]; // [sp+10h] [bp-40h]@5

  v4 = a1;
  v3 = 0;
  v2 = a1 + 18;
  do
  {
    *(&v14 + v3) = *(_BYTE *)(v2 - 2);
    *(&v15 + v3) = *(_BYTE *)(v2 - 1);
    *(&v16 + v3) = *(_BYTE *)v2;
    v17[v3] = *(_BYTE *)(v2 + 1);
    v3 += 4;
    v2 += 4;
  }
  while ( v3 < 8 );
  v5 = (*(_DWORD *)(a1 + 16) >> 3) & 0x3F;
  v6 = 56;
  if ( (unsigned int)v5 >= 0x38 )
    v6 = 120;
  v7 = v6 - v5;
  memset(v18, 0, 4 * ((unsigned int)v7 >> 2));
  v9 = &v18[4 * ((unsigned int)v7 >> 2)];
  for ( i = v7 & 3; i; --i )
    *v9++ = 0;
  v18[0] = -128;
  sub_100145B0(v4, v18, v7);
  sub_100145B0(v4, &v14, 8u);
  v11 = a2 + 1;
  v10 = v4 + 2;
  v12 = 4;
  do
  {
    *(_BYTE *)(v11 - 1) = *(_BYTE *)(v10 - 2);
    *(_BYTE *)v11 = *(_BYTE *)(v10 - 1);
    *(_BYTE *)(v11 + 1) = *(_BYTE *)v10;
    *(_BYTE *)(v11 + 2) = *(_BYTE *)(v10 + 1);
    v10 += 4;
    v11 += 4;
    --v12;
  }
  while ( v12 );
  *(_DWORD *)(v4 + 20) = 0;
  *(_DWORD *)(v4 + 16) = 0;
  *(_DWORD *)v4 = ((int (__thiscall *)(int, signed int))htonl)(v11, 19088743);
  *(_DWORD *)(v4 + 4) = htonl(0x89ABCDEFu);
  *(_DWORD *)(v4 + 8) = htonl(0xFEDCBA98u);
  result = htonl(0x76543210u);
  *(_DWORD *)(v4 + 12) = result;
  return result;
}
// 10014670: using guessed type char var_45[5];
// 10014670: using guessed type char var_40[64];

//----- (10014770) --------------------------------------------------------
int __cdecl sub_10014770(int a1, signed int a2, int a3)
{
  signed int v3; // eax@1
  unsigned __int8 v4; // bl@1
  int v5; // esi@1
  int v6; // ecx@3
  int result; // eax@4
  unsigned __int8 v8; // bl@4
  unsigned __int8 v9; // bl@4
  int v10; // eax@4
  unsigned __int8 v11; // bl@4
  int v12; // eax@4
  int v13; // edx@4
  int v14; // eax@4
  unsigned __int8 v15; // sf@4
  unsigned __int8 v16; // of@4
  signed int v17; // [sp+10h] [bp-10h]@3
  char v18; // [sp+2Ch] [bp+Ch]@4
  char v19; // [sp+2Ch] [bp+Ch]@4
  char v20; // [sp+2Ch] [bp+Ch]@4
  char v21; // [sp+2Ch] [bp+Ch]@4

  v5 = a3;
  v4 = 0;
  v3 = 0;
  do
  {
    *(_BYTE *)(v3 + a3) = v3;
    ++v3;
  }
  while ( v3 < 256 );
  v17 = 0;
  v6 = a3;
  do
  {
    v18 = *(_BYTE *)v6;
    v8 = *(_BYTE *)v6 + *(_BYTE *)(v17 % a2 + a1) + v4;
    *(_BYTE *)v6 = *(_BYTE *)(v8 + v5);
    *(_BYTE *)(v5 + v8) = v18;
    v19 = *(_BYTE *)(v6 + 1);
    v9 = v19 + *(_BYTE *)((1 - v5 + v6) % a2 + a1) + v8;
    v10 = v9 + v5;
    *(_BYTE *)(v6 + 1) = *(_BYTE *)v10;
    *(_BYTE *)v10 = v19;
    v20 = *(_BYTE *)(v6 + 2);
    v11 = v20 + *(_BYTE *)((2 - v5 + v6) % a2 + a1) + v9;
    v12 = v11 + v5;
    *(_BYTE *)(v6 + 2) = *(_BYTE *)v12;
    *(_BYTE *)v12 = v20;
    v21 = *(_BYTE *)(v6 + 3);
    v13 = (3 - v5 + v6) % a2;
    v6 += 4;
    v4 = v21 + *(_BYTE *)(v13 + a1) + v11;
    v14 = v4 + v5;
    *(_BYTE *)(v6 - 1) = *(_BYTE *)v14;
    *(_BYTE *)v14 = v21;
    result = v17 + 4;
    v16 = __SETO__(v17 + 4, 256);
    v15 = v17 - 252 < 0;
    v17 += 4;
  }
  while ( v15 ^ v16 );
  *(_BYTE *)(v5 + 256) = 0;
  *(_BYTE *)(v5 + 257) = 0;
  return result;
}

//----- (100148A0) --------------------------------------------------------
int __cdecl sub_100148A0(int a1, int a2, int a3)
{
  int result; // eax@1
  unsigned __int8 v4; // dl@1
  unsigned __int8 v5; // bl@1
  int v6; // esi@1
  int v7; // edi@4
  char v8; // cl@4
  int v9; // ebp@4
  unsigned __int8 v10; // [sp+Ch] [bp+4h]@4

  v6 = a1;
  v4 = *(_BYTE *)(a1 + 256);
  v5 = *(_BYTE *)(a1 + 257);
  result = 0;
  if ( a3 <= 0 )
  {
    *(_BYTE *)(a1 + 257) = v5;
    *(_BYTE *)(a1 + 256) = v4;
  }
  else
  {
    while ( 1 )
    {
      ++v4;
      v7 = v4 + v6;
      v8 = *(_BYTE *)v7;
      v10 = *(_BYTE *)v7 + v5;
      v9 = v10 + v6;
      *(_BYTE *)v7 = *(_BYTE *)v9;
      *(_BYTE *)v9 = v8;
      *(_BYTE *)(result++ + a2) ^= *(_BYTE *)((unsigned __int8)(v8 + *(_BYTE *)v7) + v6);
      if ( result >= a3 )
        break;
      v5 = v10;
    }
    *(_BYTE *)(v6 + 256) = v4;
    *(_BYTE *)(v6 + 257) = v10;
  }
  return result;
}

//----- (10014930) --------------------------------------------------------
unsigned int __cdecl sub_10014930(int a1, const void *a2, unsigned int a3)
{
  unsigned int v3; // ebx@1
  int v4; // eax@3
  signed int v5; // ecx@3
  char v7; // [sp+Ch] [bp-68h]@2
  char v8; // [sp+1Ch] [bp-58h]@2

  v3 = a3;
  if ( a3 > 0x40 )
  {
    sub_10013990((int)&v8);
    sub_100145B0((int)&v8, a2, a3);
    sub_10014670((int)&v8, (int)&v7);
    a2 = &v7;
    v3 = 16;
  }
  memset((void *)(a1 + 88), 0, 0x40u);
  *(_BYTE *)(a1 + 152) = 0;
  memset((void *)(a1 + 153), 0, 0x40u);
  *(_BYTE *)(a1 + 217) = 0;
  memcpy((void *)(a1 + 88), a2, v3);
  memcpy((void *)(a1 + 153), a2, v3);
  v4 = a1 + 153;
  v5 = 64;
  do
  {
    *(_BYTE *)(v4 - 65) ^= 0x36u;
    *(_BYTE *)v4++ ^= 0x5Cu;
    --v5;
  }
  while ( v5 );
  sub_10013990(a1);
  return sub_100145B0(a1, (const void *)(a1 + 88), 0x40u);
}

//----- (10014A20) --------------------------------------------------------
u_long __cdecl sub_10014A20(int a1, int a2)
{
  sub_10014670(a1, a2);
  sub_10013990(a1);
  sub_100145B0(a1, (const void *)(a1 + 153), 0x40u);
  sub_100145B0(a1, (const void *)a2, 0x10u);
  return sub_10014670(a1, a2);
}

//----- (10014A60) --------------------------------------------------------
signed int __cdecl sub_10014A60(int a1, unsigned int a2)
{
  return sub_10014A80(0, a1, a2);
}

//----- (10014A80) --------------------------------------------------------
signed int __cdecl sub_10014A80(int a1, int a2, unsigned int a3)
{
  int v3; // ecx@1
  signed int result; // eax@2
  unsigned int v5; // edi@3
  int i; // esi@3
  int v7; // eax@4
  int v8; // eax@4
  int v9; // eax@4
  int v10; // eax@4
  int v11; // eax@4
  int v12; // eax@4
  int v13; // eax@4
  int v14; // eax@4
  int v15; // eax@4
  int v16; // eax@4
  int v17; // eax@4
  char v18; // dl@4
  int v19; // eax@4
  int v20; // esi@4
  unsigned int v21; // eax@4
  int v22; // eax@4

  v3 = a2;
  if ( a2 )
  {
    v5 = a3;
    for ( i = ~a1; v5 >= 0x10; i = dword_100163B0[(unsigned __int8)(v22 ^ *(_BYTE *)(v3 - 1))] ^ ((unsigned int)v22 >> 8) )
    {
      v7 = dword_100163B0[(unsigned __int8)(i ^ *(_BYTE *)v3)] ^ ((unsigned int)i >> 8);
      v8 = dword_100163B0[(unsigned __int8)(v7 ^ *(_BYTE *)(v3 + 1))] ^ ((unsigned int)v7 >> 8);
      v9 = dword_100163B0[(unsigned __int8)(v8 ^ *(_BYTE *)(v3 + 2))] ^ ((unsigned int)v8 >> 8);
      v10 = dword_100163B0[(unsigned __int8)(v9 ^ *(_BYTE *)(v3 + 3))] ^ ((unsigned int)v9 >> 8);
      v11 = dword_100163B0[(unsigned __int8)(v10 ^ *(_BYTE *)(v3 + 4))] ^ ((unsigned int)v10 >> 8);
      v12 = dword_100163B0[(unsigned __int8)(v11 ^ *(_BYTE *)(v3 + 5))] ^ ((unsigned int)v11 >> 8);
      v13 = dword_100163B0[(unsigned __int8)(v12 ^ *(_BYTE *)(v3 + 6))] ^ ((unsigned int)v12 >> 8);
      v14 = dword_100163B0[(unsigned __int8)(v13 ^ *(_BYTE *)(v3 + 7))] ^ ((unsigned int)v13 >> 8);
      v15 = dword_100163B0[(unsigned __int8)(v14 ^ *(_BYTE *)(v3 + 8))] ^ ((unsigned int)v14 >> 8);
      v16 = dword_100163B0[(unsigned __int8)(v15 ^ *(_BYTE *)(v3 + 9))] ^ ((unsigned int)v15 >> 8);
      v17 = dword_100163B0[(unsigned __int8)(v16 ^ *(_BYTE *)(v3 + 10))] ^ ((unsigned int)v16 >> 8);
      v18 = *(_BYTE *)(v3 + 12);
      v19 = dword_100163B0[(unsigned __int8)(v17 ^ *(_BYTE *)(v3 + 11))] ^ ((unsigned int)v17 >> 8);
      v5 -= 16;
      v3 += 16;
      v20 = dword_100163B0[(unsigned __int8)(v19 ^ v18)];
      v21 = dword_100163B0[(unsigned __int8)(v20 ^ BYTE1(v19) ^ *(_BYTE *)(v3 - 3))] ^ ((v20 ^ ((unsigned int)v19 >> 8)) >> 8);
      v22 = dword_100163B0[(unsigned __int8)(v21 ^ *(_BYTE *)(v3 - 2))] ^ (v21 >> 8);
    }
    for ( ; v5; --v5 )
      i = dword_100163B0[(unsigned __int8)(i ^ *(_BYTE *)v3++)] ^ ((unsigned int)i >> 8);
    result = ~i;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 100163B0: using guessed type int dword_100163B0[];

//----- (10014C70) --------------------------------------------------------
BOOL __usercall sub_10014C70<eax>(char _CF<cf>, char _ZF<zf>, char _SF<sf>, char _OF<of>, int a5<eax>, int a6<edx>, int a7<ecx>, int a8<ebx>, int a9<edi>, int a10<esi>, char a11)
{
  if ( a7 == dword_10017490 )
    __asm { rep retn }
  return sub_1001540F(
           a7 < (unsigned int)dword_10017490,
           a7 == dword_10017490,
           a7 - dword_10017490 < 0,
           __SETO__(a7, dword_10017490),
           a5,
           a6,
           a7,
           a8,
           a9,
           a10,
           a11);
}
// 10017490: using guessed type int dword_10017490;

//----- (10014C80) --------------------------------------------------------
int __usercall sub_10014C80<eax>(unsigned int a1<eax>, int a2<ecx>)
{
  unsigned int i; // eax@1
  int v3; // ecx@1
  int v5; // [sp-4h] [bp-4h]@1
  void *v6; // [sp+0h] [bp+0h]@1
  int v7; // [sp+0h] [bp+0h]@3

  v5 = a2;
  v3 = (unsigned int)&v6 >= a1 ? (int)((char *)&v6 - a1) : 0;
  for ( i = (unsigned int)&v5 & 0xFFFFF000; v3 < i; i -= 4096 )
    ;
  return v7;
}

//----- (10014CAC) --------------------------------------------------------
int __usercall sub_10014CAC<eax>(int a1<ebp>, int a2, int a3, unsigned int a4)
{
  int result; // eax@2
  unsigned int v5; // esi@2
  int v6; // ebx@5
  char v7; // [sp-8h] [bp-28h]@1
  int (__cdecl *v8)(int, int, int, int); // [sp-4h] [bp-24h]@1
  unsigned int v9; // [sp+0h] [bp-20h]@1
  unsigned int v10; // [sp+4h] [bp-1Ch]@1
  int v11; // [sp+8h] [bp-18h]@1
  int v12; // [sp+Ch] [bp-14h]@1

  v12 = a2;
  v11 = a3;
  v10 = a4;
  v8 = loc_10014D3C;
  v9 = (unsigned int)&v7 ^ dword_10017490;
  while ( 1 )
  {
    result = a3;
    v5 = *(_DWORD *)(a3 + 12);
    if ( v5 == -2 )
      break;
    if ( a4 != -2 && v5 <= a4 )
      break;
    v6 = (*(_DWORD *)a2 ^ *(_DWORD *)(a3 + 8)) + 12 * v5 + 16;
    *(_DWORD *)(a3 + 12) = *(_DWORD *)((*(_DWORD *)a2 ^ *(_DWORD *)(a3 + 8)) + 12 * v5 + 0x10);
    if ( !*(_DWORD *)(v6 + 4) )
    {
      sub_100155AD(*(_DWORD *)(v6 + 8), a1, 257);
      sub_100155CC(*(int (**)(void))(v6 + 8));
    }
  }
  return result;
}
// 10014D3C: using guessed type int __cdecl loc_10014D3C(int, int, int, int);
// 10017490: using guessed type int dword_10017490;

//----- (10014D9E) --------------------------------------------------------
int __thiscall sub_10014D9E(void *this)
{
  return ((int (__fastcall *)(_DWORD, _DWORD))this)(this, 0);
}

//----- (10014DCE) --------------------------------------------------------
int __thiscall sub_10014DCE(void *this)
{
  return RtlUnwind(this, loc_10014DE3, 0, 0);
}
// 10014DE3: using guessed type int loc_10014DE3();
// 10015810: using guessed type int __stdcall RtlUnwind(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (10014DE8) --------------------------------------------------------
int __fastcall sub_10014DE8(int a1, unsigned int a2, int a3, int a4)
{
  return sub_10014CAC(a3, a4, a1, a2);
}

//----- (10014E00) --------------------------------------------------------
int __cdecl sub_10014E00(int a1, void (__thiscall *a2)(_DWORD), int a3, int a4, int a5)
{
  int v5; // eax@1
  int v6; // edi@1
  int v7; // esi@1
  char v8; // zf@1
  unsigned int v9; // ebx@4
  int v10; // eax@5
  void *v11; // ecx@5
  int v12; // eax@5
  int v13; // eax@6
  int v15; // eax@20
  unsigned int v16; // esi@24
  int v17; // [sp+Ch] [bp-18h]@4
  int v18; // [sp+10h] [bp-14h]@4
  int v19; // [sp+14h] [bp-10h]@5
  int v20; // [sp+18h] [bp-Ch]@1
  int v21; // [sp+1Ch] [bp-8h]@5
  char v22; // [sp+23h] [bp-1h]@1

  v7 = *(_DWORD *)a1 ^ *(_DWORD *)(a4 + 8);
  v5 = *(_DWORD *)v7;
  v8 = *(_DWORD *)v7 == -2;
  v22 = 0;
  v20 = 1;
  v6 = a4 + 16;
  if ( !v8 )
    a2(*(_DWORD *)(v5 + v6) ^ (v6 + *(_DWORD *)(v7 + 4)));
  a2(*(_DWORD *)(*(_DWORD *)(v7 + 8) + v6) ^ (v6 + *(_DWORD *)(v7 + 12)));
  if ( *(_BYTE *)(a3 + 4) & 0x66 )
  {
    if ( *(_DWORD *)(a4 + 12) == -2 )
      return v20;
    sub_10014DE8(a4, 0xFFFFFFFEu, v6, a1);
  }
  else
  {
    *(_DWORD *)(a4 - 4) = &v17;
    v9 = *(_DWORD *)(a4 + 12);
    v17 = a3;
    v18 = a5;
    if ( v9 == -2 )
      return v20;
    do
    {
      v11 = *(void **)(v7 + 12 * v9 + 20);
      v12 = v7 + 12 * v9 + 16;
      v19 = v12;
      v10 = *(_DWORD *)v12;
      v21 = v10;
      if ( v11 )
      {
        v13 = sub_10014D9E(v11);
        v22 = 1;
        if ( v13 < 0 )
        {
          v20 = 0;
          goto LABEL_11;
        }
        if ( v13 > 0 )
        {
          if ( *(_DWORD *)a3 == -529697949 )
          {
            if ( dword_10018550 )
            {
              if ( sub_10015646((int)&dword_10018550) )
                dword_10018550(a3, 1);
            }
          }
          sub_10014DCE((void *)a4);
          v15 = a4;
          if ( *(_DWORD *)(a4 + 12) != v9 )
          {
            sub_10014DE8(a4, v9, v6, a1);
            v15 = a4;
          }
          *(_DWORD *)(v15 + 12) = v21;
          if ( *(_DWORD *)v7 != -2 )
            a2(*(_DWORD *)(*(_DWORD *)v7 + v6) ^ (v6 + *(_DWORD *)(v7 + 4)));
          a2(*(_DWORD *)(*(_DWORD *)(v7 + 8) + v6) ^ (v6 + *(_DWORD *)(v7 + 12)));
          v16 = *(_DWORD *)(v19 + 8);
          sub_100155AD(*(_DWORD *)(v19 + 8), v6, 1);
          JUMPOUT(__CS__, v16);
        }
        v10 = v21;
      }
      v9 = v10;
    }
    while ( v10 != -2 );
    if ( !v22 )
      return v20;
  }
LABEL_11:
  if ( *(_DWORD *)v7 != -2 )
    a2(*(_DWORD *)(*(_DWORD *)v7 + v6) ^ (v6 + *(_DWORD *)(v7 + 4)));
  a2(*(_DWORD *)(*(_DWORD *)(v7 + 8) + v6) ^ (v6 + *(_DWORD *)(v7 + 12)));
  return v20;
}
// 10018550: using guessed type int (__cdecl *dword_10018550)(_DWORD, _DWORD);

//----- (10014F82) --------------------------------------------------------
int __cdecl sub_10014F82(int a1, int a2)
{
  int result; // eax@2

  if ( a1 == -529697949 )
    result = XcptFilter(-529697949, a2);
  else
    result = 0;
  return result;
}
// 100156F4: using guessed type int __cdecl XcptFilter(_DWORD, _DWORD);

//----- (10014FA2) --------------------------------------------------------
int __cdecl sub_10014FA2(unsigned int a1, unsigned int a2)
{
  int result; // eax@1
  unsigned int v3; // esi@1

  v3 = a1;
  result = 0;
  while ( v3 < a2 && !result )
  {
    if ( *(_DWORD *)v3 )
      result = (*(int (**)(void))v3)();
    v3 += 4;
  }
  return result;
}

//----- (10014FC6) --------------------------------------------------------
signed int __cdecl sub_10014FC6()
{
  void *v0; // eax@1
  signed int result; // eax@2

  v0 = malloc(0x80u);
  Memory = v0;
  dword_10018540 = (int)v0;
  if ( v0 )
  {
    *(_DWORD *)v0 = 0;
    result = 0;
  }
  else
  {
    result = 1;
  }
  return result;
}
// 10018540: using guessed type int dword_10018540;

//----- (10014FE8) --------------------------------------------------------
signed int __stdcall sub_10014FE8(int a1, int a2, int a3)
{
  LONG v3; // ebx@5
  LONG v5; // eax@9
  void *v6; // ebx@29
  int k; // edi@30
  LONG i; // [sp-10h] [bp-10h]@5
  int v9; // [sp-10h] [bp-10h]@20
  LONG j; // [sp-10h] [bp-10h]@24
  signed int v11; // [sp+Ch] [bp+Ch]@5

  if ( !a2 )
  {
    if ( dword_10018210 <= 0 )
      return 0;
    --dword_10018210;
  }
  dword_10018534 = (int)adjust_fdiv;
  if ( a2 == 1 )
  {
    v3 = *(_DWORD *)(*MK_FP(__FS__, 24) + 4);
    v11 = 0;
    for ( i = 0; ; i = 0 )
    {
      v5 = InterlockedCompareExchange(&Destination, v3, i);
      if ( !v5 )
        break;
      if ( v5 == v3 )
      {
        v11 = 1;
        break;
      }
      Sleep(0x3E8u);
    }
    if ( dword_10018538 )
    {
      amsg_exit(31);
    }
    else
    {
      dword_10018538 = 1;
      if ( sub_10014FA2((unsigned int)&unk_100160F0, (unsigned int)&unk_100160F8) )
        return 0;
      initterm(&unk_100160E8);
      dword_10018538 = 2;
    }
    if ( !v11 )
      InterlockedExchange(&Destination, 0);
    if ( dword_1001854C )
    {
      if ( sub_10015646((int)&dword_1001854C) )
        dword_1001854C(v9, a1, 2, a3);
    }
    ++dword_10018210;
  }
  else
  {
    if ( !a2 )
    {
      for ( j = 0; InterlockedCompareExchange(&Destination, 1, j); j = 0 )
        Sleep(0x3E8u);
      if ( dword_10018538 == 2 )
      {
        v6 = Memory;
        if ( Memory )
        {
          for ( k = dword_10018540 - 4; k >= (unsigned int)v6; k -= 4 )
          {
            if ( *(_DWORD *)k )
              (*(void (**)(void))k)();
          }
          free(v6);
          dword_10018540 = 0;
          Memory = 0;
        }
        dword_10018538 = 0;
        InterlockedExchange(&Destination, 0);
      }
      else
      {
        amsg_exit(31);
      }
    }
  }
  return 1;
}
// 100156FA: using guessed type int __cdecl initterm(_DWORD);
// 10015700: using guessed type int __cdecl amsg_exit(_DWORD);
// 100160C0: using guessed type void *adjust_fdiv;
// 10018210: using guessed type int dword_10018210;
// 10018534: using guessed type int dword_10018534;
// 10018538: using guessed type int dword_10018538;
// 10018540: using guessed type int dword_10018540;
// 1001854C: using guessed type int (__thiscall *dword_1001854C)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (100151E4) --------------------------------------------------------
int __usercall sub_100151E4<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 32) = v3;
  return sub_10014F82(v3, v1);
}

//----- (100151F8) --------------------------------------------------------
void __usercall sub_100151F8(int a1<ebp>)
{
  *(_DWORD *)(a1 - 28) = 0;
  JUMPOUT(*(int *)loc_10015200);
}
// 10015200: using guessed type int __stdcall loc_10015200(int hinstDLL, int fdwReason, int lpReserved);

//----- (10015226) --------------------------------------------------------
int __usercall sub_10015226<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 36) = v3;
  return sub_10014F82(v3, v1);
}

//----- (1001523A) --------------------------------------------------------
void __usercall sub_1001523A(int a1<ebp>)
{
  *(_DWORD *)(a1 - 28) = 0;
  JUMPOUT(*(int *)loc_10015242);
}
// 10015242: using guessed type int __stdcall loc_10015242(int hinstDLL, int fdwReason, int lpReserved);

//----- (10015269) --------------------------------------------------------
int __usercall sub_10015269<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 40) = v3;
  return sub_10014F82(v3, v1);
}

//----- (1001527D) --------------------------------------------------------
void __usercall sub_1001527D(int a1<ebp>)
{
  *(_DWORD *)(a1 - 28) = 0;
  JUMPOUT(*(int *)loc_10015285);
}
// 10015285: using guessed type int __stdcall loc_10015285(int hinstDLL, int fdwReason, int lpReserved);

//----- (100152AE) --------------------------------------------------------
int __usercall sub_100152AE<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 44) = v3;
  return sub_10014F82(v3, v1);
}

//----- (100152C2) --------------------------------------------------------
void __cdecl sub_100152C2()
{
  JUMPOUT(*(int *)loc_100152C7);
}
// 100152C7: using guessed type int __stdcall loc_100152C7(int hinstDLL, int fdwReason, int lpReserved);

//----- (100152DD) --------------------------------------------------------
int __usercall sub_100152DD<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 48) = v3;
  return sub_10014F82(v3, v1);
}

//----- (100152F1) --------------------------------------------------------
void __cdecl sub_100152F1()
{
  JUMPOUT(*(int *)loc_100152F6);
}
// 100152F6: using guessed type int __stdcall loc_100152F6(int hinstDLL, int fdwReason, int lpReserved);

//----- (10015312) --------------------------------------------------------
int __usercall sub_10015312<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 52) = v3;
  return sub_10014F82(v3, v1);
}

//----- (10015326) --------------------------------------------------------
void __cdecl sub_10015326()
{
  JUMPOUT(*(int *)loc_1001532B);
}
// 1001532B: using guessed type int __stdcall loc_1001532B(int hinstDLL, int fdwReason, int lpReserved);

//----- (10015353) --------------------------------------------------------
int __usercall sub_10015353<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 56) = v3;
  return sub_10014F82(v3, v1);
}

//----- (10015367) --------------------------------------------------------
void __usercall sub_10015367(int a1<ebp>)
{
  *(_DWORD *)(a1 - 28) = 0;
  JUMPOUT(*(int *)loc_1001536F);
}
// 1001536F: using guessed type int __stdcall loc_1001536F(int hinstDLL, int fdwReason, int lpReserved);

//----- (10015397) --------------------------------------------------------
int __usercall sub_10015397<eax>(int a1<ebp>)
{
  int v1; // eax@1
  int v3; // ecx@1

  v1 = *(_DWORD *)(a1 - 20);
  v3 = **(_DWORD **)v1;
  *(_DWORD *)(a1 - 60) = v3;
  return sub_10014F82(v3, v1);
}

//----- (100153AB) --------------------------------------------------------
void __usercall sub_100153AB(int a1<ebp>)
{
  *(_DWORD *)(a1 - 28) = 0;
  JUMPOUT(*(int *)loc_100153B3);
}
// 100153B3: using guessed type int __stdcall loc_100153B3(int hinstDLL, int fdwReason, int lpReserved);

//----- (100153CD) --------------------------------------------------------
void __cdecl sub_100153CD()
{
  dword_100174B0 = -1;
}
// 100174B0: using guessed type int dword_100174B0;

//----- (100153D8) --------------------------------------------------------
BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
  int v4; // ST0C_4@22
  int v5; // ST10_4@22
  int v6; // ST14_4@22
  int v7; // ST18_4@22
  int v8; // ST1C_4@22
  int v9; // ST20_4@22
  int v10; // ST24_4@22
  int v11; // ST28_4@22
  int v12; // ST2C_4@22
  int v13; // ST30_4@22
  int v14; // ST34_4@22
  int v15; // ST38_4@22
  int v16; // ST40_4@22
  int v17; // ST44_4@22
  int v18; // ST48_4@22
  int v19; // ST4C_4@22
  int v20; // ST50_4@22
  int v21; // ecx@3
  signed int v22; // [sp+0h] [bp-1Ch]@3
  int v23; // [sp+1Ch] [bp+0h]@3

  if ( fdwReason == 1 )
    sub_1001578A();
  _SEH_prolog4(&unk_10016A10, 44);
  v21 = fdwReason;
  v22 = 1;
  dword_100174B0 = fdwReason;
  if ( !fdwReason && !dword_10018210 )
  {
    v22 = 0;
    goto LABEL_22;
  }
  if ( fdwReason != 1 && fdwReason != 2 )
    goto LABEL_13;
  if ( dword_10018548 )
    v22 = dword_10018548(hinstDLL, fdwReason, lpReserved);
  if ( v22 )
  {
    v22 = sub_10014FE8((int)hinstDLL, fdwReason, (int)lpReserved);
    if ( v22 )
    {
      v21 = fdwReason;
LABEL_13:
      v22 = sub_10015706((int)hinstDLL, v21, (int)lpReserved);
      if ( fdwReason == 1 )
      {
        if ( !v22 )
        {
          sub_10015706((int)hinstDLL, 0, 0);
          sub_10014FE8((int)hinstDLL, 0, 0);
          if ( dword_10018548 )
            dword_10018548(hinstDLL, 0, 0);
        }
      }
      if ( !fdwReason || fdwReason == 3 )
      {
        v22 = sub_10014FE8((int)hinstDLL, fdwReason, (int)lpReserved);
        if ( v22 )
        {
          if ( dword_10018548 )
            v22 = dword_10018548(hinstDLL, fdwReason, lpReserved);
        }
      }
      goto LABEL_22;
    }
  }
LABEL_22:
  sub_100153CD();
  return _SEH_epilog4(v4, v5, v6, v7, v8, v9, v10, v11, v12, v13, v14, v15, v22, v16, v17, v18, v19, v20, -2, v23);
}
// 1001570C: using guessed type _DWORD __cdecl _SEH_prolog4(_DWORD, _DWORD);
// 10015751: using guessed type int __stdcall _SEH_epilog4(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 100174B0: using guessed type int dword_100174B0;
// 10018210: using guessed type int dword_10018210;
// 10018548: using guessed type int (__cdecl *dword_10018548)(_DWORD, _DWORD, _DWORD);

//----- (100153F0) --------------------------------------------------------
int __usercall sub_100153F0<eax>(__int64 a1<edx:eax>, unsigned __int8 a2<cl>)
{
  __int64 v2; // qax@3

  if ( a2 >= 0x40u )
  {
    LODWORD(v2) = 0;
  }
  else
  {
    if ( a2 >= 0x20u )
      LODWORD(v2) = 0;
    else
      v2 = a1 << (a2 & 0x1F);
  }
  return v2;
}

//----- (1001540F) --------------------------------------------------------
BOOL __usercall sub_1001540F<eax>(char _CF<cf>, char _ZF<zf>, char _SF<sf>, char _OF<of>, int a5<eax>, int a6<edx>, int a7<ecx>, int a8<ebx>, int a9<edi>, int a10<esi>, char a11)
{
  int v12; // ST04_4@1
  int v13; // ST330_4@1
  HANDLE v14; // eax@1
  int v15; // [sp+32Ch] [bp+4h]@1

  dword_10018318 = a5;
  dword_10018314 = a7;
  dword_10018310 = a6;
  dword_1001830C = a8;
  dword_10018308 = a10;
  dword_10018304 = a9;
  word_10018330 = __SS__;
  word_10018324 = __CS__;
  word_10018300 = __DS__;
  word_100182FC = __ES__;
  word_100182F8 = __FS__;
  word_100182F4 = __GS__;
  __asm { pushf }
  dword_10018328 = v12;
  dword_1001831C = v13;
  dword_10018320 = v15;
  dword_1001832C = (int)&a11;
  dword_10018268 = 65537;
  dword_10018224 = dword_10018320;
  dword_10018218 = -1073740791;
  dword_1001821C = 1;
  SetUnhandledExceptionFilter(0);
  UnhandledExceptionFilter(&ExceptionInfo);
  v14 = GetCurrentProcess();
  return TerminateProcess(v14, 0xC0000409u);
}
// 10018218: using guessed type int dword_10018218;
// 1001821C: using guessed type int dword_1001821C;
// 10018224: using guessed type int dword_10018224;
// 10018268: using guessed type int dword_10018268;
// 100182F4: using guessed type __int16 word_100182F4;
// 100182F8: using guessed type __int16 word_100182F8;
// 100182FC: using guessed type __int16 word_100182FC;
// 10018300: using guessed type __int16 word_10018300;
// 10018304: using guessed type int dword_10018304;
// 10018308: using guessed type int dword_10018308;
// 1001830C: using guessed type int dword_1001830C;
// 10018310: using guessed type int dword_10018310;
// 10018314: using guessed type int dword_10018314;
// 10018318: using guessed type int dword_10018318;
// 1001831C: using guessed type int dword_1001831C;
// 10018320: using guessed type int dword_10018320;
// 10018324: using guessed type __int16 word_10018324;
// 10018328: using guessed type int dword_10018328;
// 1001832C: using guessed type int dword_1001832C;
// 10018330: using guessed type __int16 word_10018330;

//----- (100155AD) --------------------------------------------------------
int __userpurge sub_100155AD<eax>(int result<eax>, int a2<ebp>, int a3)
{
  dword_100174A0[2] = a3;
  dword_100174A0[1] = result;
  dword_100174A0[3] = a2;
  return result;
}

//----- (100155CC) --------------------------------------------------------
int __usercall sub_100155CC<eax>(int (*a1)(void)<eax>)
{
  return a1();
}

//----- (100155D0) --------------------------------------------------------
bool __cdecl sub_100155D0(int a1)
{
  bool result; // eax@2
  int v2; // eax@3

  if ( *(_WORD *)a1 != 23117 || (v2 = a1 + *(_DWORD *)(a1 + 60), *(_DWORD *)v2 != 17744) )
    result = 0;
  else
    result = *(_WORD *)(v2 + 24) == 267;
  return result;
}

//----- (10015600) --------------------------------------------------------
int __cdecl sub_10015600(int a1, unsigned int a2)
{
  int result; // eax@1
  unsigned int v3; // edx@1
  unsigned int v4; // esi@1
  int v5; // ecx@1
  unsigned int v6; // ecx@2

  v5 = a1 + *(_DWORD *)(a1 + 60);
  v4 = *(_WORD *)(v5 + 6);
  v3 = 0;
  result = *(_WORD *)(v5 + 20) + v5 + 24;
  if ( *(_WORD *)(v5 + 6) )
  {
    while ( 1 )
    {
      v6 = *(_DWORD *)(result + 12);
      if ( a2 >= v6 )
      {
        if ( a2 < v6 + *(_DWORD *)(result + 8) )
          break;
      }
      ++v3;
      result += 40;
      if ( v3 >= v4 )
        goto LABEL_5;
    }
  }
  else
  {
LABEL_5:
    result = 0;
  }
  return result;
}

//----- (10015646) --------------------------------------------------------
unsigned int __cdecl sub_10015646(int a1)
{
  int v1; // edx@1
  int v2; // eax@2
  unsigned int result; // eax@3

  if ( sub_100155D0(268435456) && (v2 = sub_10015600(v1, a1 - v1)) != 0 )
    result = ~(unsigned __int8)(*(_DWORD *)(v2 + 36) >> 31) & 1;
  else
    result = 0;
  return result;
}

//----- (10015706) --------------------------------------------------------
signed int __stdcall sub_10015706(int a1, int a2, int a3)
{
  return 1;
}

//----- (10015765) --------------------------------------------------------
int __cdecl sub_10015765(int a1, int a2, int a3)
{
  return sub_10014E00((int)&dword_10017490, (void (__thiscall *)(_DWORD))sub_10014C70, a1, a2, a3);
}
// 10017490: using guessed type int dword_10017490;

//----- (1001578A) --------------------------------------------------------
DWORD __cdecl sub_1001578A()
{
  DWORD result; // eax@3
  DWORD v1; // esi@4
  DWORD v2; // esi@4
  DWORD v3; // esi@4
  DWORD v4; // esi@4
  LARGE_INTEGER PerformanceCount; // [sp+4h] [bp-10h]@4
  struct _FILETIME SystemTimeAsFileTime; // [sp+Ch] [bp-8h]@1

  SystemTimeAsFileTime.dwLowDateTime = 0;
  SystemTimeAsFileTime.dwHighDateTime = 0;
  if ( dword_10017490 != -1153374642 && dword_10017490 & 0xFFFF0000 )
  {
    result = ~dword_10017490;
    dword_10017494 = ~dword_10017490;
  }
  else
  {
    GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
    v2 = GetCurrentProcessId() ^ SystemTimeAsFileTime.dwLowDateTime ^ SystemTimeAsFileTime.dwHighDateTime;
    v3 = GetCurrentThreadId() ^ v2;
    v4 = GetTickCount() ^ v3;
    QueryPerformanceCounter(&PerformanceCount);
    result = PerformanceCount.LowPart ^ PerformanceCount.HighPart;
    v1 = PerformanceCount.LowPart ^ PerformanceCount.HighPart ^ v4;
    if ( v1 == -1153374642 )
      v1 = -1153374641;
    dword_10017490 = v1;
    dword_10017494 = ~v1;
  }
  return result;
}
// 10017490: using guessed type int dword_10017490;
// 10017494: using guessed type int dword_10017494;

//----- (10015820) --------------------------------------------------------
int __cdecl svchost_1_SEH(int a2, int a3, int a4, int a5)
{
  return sub_10002399(&unk_10016AE0, a2, a3, a4, a5);
}

// ALL OK, 271 function(s) have been successfully decompiled
