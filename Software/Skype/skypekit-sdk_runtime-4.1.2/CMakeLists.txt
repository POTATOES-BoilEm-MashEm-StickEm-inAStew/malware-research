CMAKE_MINIMUM_REQUIRED(VERSION 2.8.2)

PROJECT(skypekit)

SET(DISTRO_ROOT ${CMAKE_CURRENT_LIST_DIR})
SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} ${DISTRO_ROOT}/cmake_modules)

IF (NOT APPS_TO_BUILD)
    SET(APPS_TO_BUILD "all")
ENDIF()

IF (NOT OUTPUT_DIR)
    SET(OUTPUT_DIR ${CMAKE_CURRENT_SOURCE_DIR})
ENDIF()

SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY_RELEASE ${OUTPUT_DIR}/bin/${ARCH})
SET(CMAKE_RUNTIME_OUTPUT_DIRECTORY_DEBUG ${OUTPUT_DIR}/bin/${ARCH})
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_RELEASE ${OUTPUT_DIR}/lib)
SET(CMAKE_ARCHIVE_OUTPUT_DIRECTORY_DEBUG ${OUTPUT_DIR}/lib)

FUNCTION(BUILD_SKYPEKIT_CLIENT_CPP)
    ADD_SUBDIRECTORY(interfaces/skype/cpp_embedded)
ENDFUNCTION()

FUNCTION(BUILD_UIKIT)
    ADD_SUBDIRECTORY(examples/cpp/uikit)
	ADD_DEPENDENCIES(qtsimpleclient skypekit-cppwrapper_2_lib skypekit-cyassl_lib reference_opengl_lib)
ENDFUNCTION()


FUNCTION(BUILD_SKYPEKIT_CLIENT_JAVA)
    FIND_PROGRAM(ANT_EXECUTABLE ant PATHS $ENV{ANT_HOME} ENV PATH )
    ADD_CUSTOM_TARGET(javawrapper ALL
        COMMAND ${ANT_EXECUTABLE} install
        WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/interfaces/skype/java2/api
        COMMENT "Running Ant to build java wrapper api...")
    ADD_CUSTOM_TARGET(java_client ALL
        COMMAND ${ANT_EXECUTABLE}
        WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}/interfaces/skype/java2/client
        COMMENT "Running Ant to install java client...")
ENDFUNCTION()

IF (APPS_TO_BUILD MATCHES "cppwrapper")
    BUILD_SKYPEKIT_CLIENT_CPP()
ELSEIF (APPS_TO_BUILD MATCHES "uikit")
    BUILD_UIKIT()
ELSEIF (APPS_TO_BUILD MATCHES "javawrapper")
    BUILD_SKYPEKIT_CLIENT_JAVA()
ELSEIF (APPS_TO_BUILD MATCHES "wrappers")
    BUILD_SKYPEKIT_CLIENT_CPP()
    BUILD_SKYPEKIT_CLIENT_JAVA()
ELSEIF (APPS_TO_BUILD MATCHES "all")
    BUILD_SKYPEKIT_CLIENT_CPP()    
    BUILD_UIKIT()
    BUILD_SKYPEKIT_CLIENT_JAVA()
ENDIF()

